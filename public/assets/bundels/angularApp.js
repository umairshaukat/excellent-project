function itemDispatchClicked(n){var t=angular.element(document.getElementById("timelineDispatch")).scope();t.$root.$broadcast("itemDispatchClicked",{itemId:n})}function showToastrMessage(n,t,i){toastr.options={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-top-right",onclick:null,showDuration:"400",hideDuration:"1500",timeOut:"7000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr[n](i)}angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.collapse","ui.bootstrap.tabindex","ui.bootstrap.accordion","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.dateparser","ui.bootstrap.isClass","ui.bootstrap.datepicker","ui.bootstrap.position","ui.bootstrap.datepickerPopup","ui.bootstrap.debounce","ui.bootstrap.multiMap","ui.bootstrap.dropdown","ui.bootstrap.stackedMap","ui.bootstrap.modal","ui.bootstrap.paging","ui.bootstrap.pager","ui.bootstrap.pagination","ui.bootstrap.tooltip","ui.bootstrap.popover","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.typeahead"]);angular.module("ui.bootstrap.tpls",["uib/template/accordion/accordion-group.html","uib/template/accordion/accordion.html","uib/template/alert/alert.html","uib/template/carousel/carousel.html","uib/template/carousel/slide.html","uib/template/datepicker/datepicker.html","uib/template/datepicker/day.html","uib/template/datepicker/month.html","uib/template/datepicker/year.html","uib/template/datepickerPopup/popup.html","uib/template/modal/window.html","uib/template/pager/pager.html","uib/template/pagination/pagination.html","uib/template/tooltip/tooltip-html-popup.html","uib/template/tooltip/tooltip-popup.html","uib/template/tooltip/tooltip-template-popup.html","uib/template/popover/popover-html.html","uib/template/popover/popover-template.html","uib/template/popover/popover.html","uib/template/progressbar/bar.html","uib/template/progressbar/progress.html","uib/template/progressbar/progressbar.html","uib/template/rating/rating.html","uib/template/tabs/tab.html","uib/template/tabs/tabset.html","uib/template/timepicker/timepicker.html","uib/template/typeahead/typeahead-match.html","uib/template/typeahead/typeahead-popup.html"]);angular.module("ui.bootstrap.collapse",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(n,t,i,r){var u=r.has("$animateCss")?r.get("$animateCss"):null;return{link:function(r,f,e){function v(){l=!!("horizontal"in e);l?(s={width:""},o={width:"0"}):(s={height:""},o={height:"0"});r.$eval(e.uibCollapse)||f.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css(s)}function h(n){return l?{width:n.scrollWidth+"px"}:{height:n.scrollHeight+"px"}}function y(){f.hasClass("collapse")&&f.hasClass("in")||t.resolve(w(r)).then(function(){f.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1);u?u(f,{addClass:"in",easing:"ease",css:{overflow:"hidden"},to:h(f[0])}).start()["finally"](a):n.addClass(f,"in",{css:{overflow:"hidden"},to:h(f[0])}).then(a)},angular.noop)}function a(){f.removeClass("collapsing").addClass("collapse").css(s);b(r)}function p(){return f.hasClass("collapse")||f.hasClass("in")?void t.resolve(k(r)).then(function(){f.css(h(f[0])).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0);u?u(f,{removeClass:"in",to:o}).start()["finally"](c):n.removeClass(f,"in",{to:o}).then(c)},angular.noop):c()}function c(){f.css(o);f.removeClass("collapsing").addClass("collapse");d(r)}var w=i(e.expanding),b=i(e.expanded),k=i(e.collapsing),d=i(e.collapsed),l=!1,s={},o={};v();r.$watch(e.uibCollapse,function(n){n?p():y()})}}}]);angular.module("ui.bootstrap.tabindex",[]).directive("uibTabindexToggle",function(){return{restrict:"A",link:function(n,t,i){i.$observe("disabled",function(n){i.$set("tabindex",n?-1:null)})}}});angular.module("ui.bootstrap.accordion",["ui.bootstrap.collapse","ui.bootstrap.tabindex"]).constant("uibAccordionConfig",{closeOthers:!0}).controller("UibAccordionController",["$scope","$attrs","uibAccordionConfig",function(n,t,i){this.groups=[];this.closeOthers=function(r){var u=angular.isDefined(t.closeOthers)?n.$eval(t.closeOthers):i.closeOthers;u&&angular.forEach(this.groups,function(n){n!==r&&(n.isOpen=!1)})};this.addGroup=function(n){var t=this;this.groups.push(n);n.$on("$destroy",function(){t.removeGroup(n)})};this.removeGroup=function(n){var t=this.groups.indexOf(n);-1!==t&&this.groups.splice(t,1)}}]).directive("uibAccordion",function(){return{controller:"UibAccordionController",controllerAs:"accordion",transclude:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/accordion/accordion.html"}}}).directive("uibAccordionGroup",function(){return{require:"^uibAccordion",transclude:!0,restrict:"A",templateUrl:function(n,t){return t.templateUrl||"uib/template/accordion/accordion-group.html"},scope:{heading:"@",panelClass:"@?",isOpen:"=?",isDisabled:"=?"},controller:function(){this.setHeading=function(n){this.heading=n}},link:function(n,t,i,r){t.addClass("panel");r.addGroup(n);n.openClass=i.openClass||"panel-open";n.panelClass=i.panelClass||"panel-default";n.$watch("isOpen",function(i){t.toggleClass(n.openClass,!!i);i&&r.closeOthers(n)});n.toggleOpen=function(t){n.isDisabled||t&&32!==t.which||(n.isOpen=!n.isOpen)};var u="accordiongroup-"+n.$id+"-"+Math.floor(1e4*Math.random());n.headingId=u+"-tab";n.panelId=u+"-panel"}}}).directive("uibAccordionHeading",function(){return{transclude:!0,template:"",replace:!0,require:"^uibAccordionGroup",link:function(n,t,i,r,u){r.setHeading(u(n,angular.noop))}}}).directive("uibAccordionTransclude",function(){function n(){return"uib-accordion-header,data-uib-accordion-header,x-uib-accordion-header,uib\\:accordion-header,[uib-accordion-header],[data-uib-accordion-header],[x-uib-accordion-header]"}return{require:"^uibAccordionGroup",link:function(t,i,r,u){t.$watch(function(){return u[r.uibAccordionTransclude]},function(t){if(t){var r=angular.element(i[0].querySelector(n()));r.html("");r.append(t)}})}}});angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$element","$attrs","$interpolate","$timeout",function(n,t,i,r,u){n.closeable=!!i.close;t.addClass("alert");i.$set("role","alert");n.closeable&&t.addClass("alert-dismissible");var f=angular.isDefined(i.dismissOnTimeout)?r(i.dismissOnTimeout)(n.$parent):null;f&&u(function(){n.close()},parseInt(f,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",restrict:"A",templateUrl:function(n,t){return t.templateUrl||"uib/template/alert/alert.html"},transclude:!0,scope:{close:"&"}}});angular.module("ui.bootstrap.buttons",[]).constant("uibButtonConfig",{activeClass:"active",toggleEvent:"click"}).controller("UibButtonsController",["uibButtonConfig",function(n){this.activeClass=n.activeClass||"active";this.toggleEvent=n.toggleEvent||"click"}]).directive("uibBtnRadio",["$parse",function(n){return{require:["uibBtnRadio","ngModel"],controller:"UibButtonsController",controllerAs:"buttons",link:function(t,i,r,u){var e=u[0],f=u[1],o=n(r.uibUncheckable);i.find("input").css({display:"none"});f.$render=function(){i.toggleClass(e.activeClass,angular.equals(f.$modelValue,t.$eval(r.uibBtnRadio)))};i.on(e.toggleEvent,function(){if(!r.disabled){var n=i.hasClass(e.activeClass);n&&!angular.isDefined(r.uncheckable)||t.$apply(function(){f.$setViewValue(n?null:t.$eval(r.uibBtnRadio));f.$render()})}});r.uibUncheckable&&t.$watch(o,function(n){r.$set("uncheckable",n?"":void 0)})}}}]).directive("uibBtnCheckbox",function(){return{require:["uibBtnCheckbox","ngModel"],controller:"UibButtonsController",controllerAs:"button",link:function(n,t,i,r){function e(){return o(i.btnCheckboxTrue,!0)}function s(){return o(i.btnCheckboxFalse,!1)}function o(t,i){return angular.isDefined(t)?n.$eval(t):i}var f=r[0],u=r[1];t.find("input").css({display:"none"});u.$render=function(){t.toggleClass(f.activeClass,angular.equals(u.$modelValue,e()))};t.on(f.toggleEvent,function(){i.disabled||n.$apply(function(){u.$setViewValue(t.hasClass(f.activeClass)?s():e());u.$render()})})}}});angular.module("ui.bootstrap.carousel",[]).controller("UibCarouselController",["$scope","$element","$interval","$timeout","$animate",function(n,t,i,r,u){function s(n){for(var t=0;t<f.length;t++)f[t].slide.active=t===n}function w(i,r,h){if(!p){if(angular.extend(i,{direction:h}),angular.extend(f[o].slide||{},{direction:h}),u.enabled(t)&&!n.$currentTransition&&f[r].element&&e.slides.length>1){f[r].element.data(y,i.direction);var c=e.getCurrentIndex();angular.isNumber(c)&&f[c].element&&f[c].element.data(y,i.direction);n.$currentTransition=!0;u.on("addClass",f[r].element,function(t,i){"close"===i&&(n.$currentTransition=null,u.off("addClass",t))})}n.active=i.index;o=i.index;s(r);v()}}function l(n){for(var t=0;t<f.length;t++)if(f[t].slide===n)return t}function a(){h&&(i.cancel(h),h=null)}function b(t){t.length||(n.$currentTransition=null)}function v(){a();var t=+n.interval;!isNaN(t)&&t>0&&(h=i(k,t))}function k(){var t=+n.interval;c&&!isNaN(t)&&t>0&&f.length?n.next():n.pause()}var h,c,e=this,f=e.slides=n.slides=[],y="uib-slideDirection",o=n.active,p=!1;t.addClass("carousel");e.addSlide=function(t,i){f.push({slide:t,element:i});f.sort(function(n,t){return+n.slide.index-+t.slide.index});(t.index===n.active||1===f.length&&!angular.isNumber(n.active))&&(n.$currentTransition&&(n.$currentTransition=null),o=t.index,n.active=t.index,s(o),e.select(f[l(t)]),1===f.length&&n.play())};e.getCurrentIndex=function(){for(var n=0;n<f.length;n++)if(f[n].slide.index===o)return n};e.next=n.next=function(){var t=(e.getCurrentIndex()+1)%f.length;return 0===t&&n.noWrap()?void n.pause():e.select(f[t],"next")};e.prev=n.prev=function(){var t=e.getCurrentIndex()-1<0?f.length-1:e.getCurrentIndex()-1;return n.noWrap()&&t===f.length-1?void n.pause():e.select(f[t],"prev")};e.removeSlide=function(t){var i=l(t);f.splice(i,1);f.length>0&&o===i?i>=f.length?(o=f.length-1,n.active=o,s(o),e.select(f[f.length-1])):(o=i,n.active=o,s(o),e.select(f[i])):o>i&&(o--,n.active=o);0===f.length&&(o=null,n.active=null)};e.select=n.select=function(t,i){var r=l(t.slide);void 0===i&&(i=r>e.getCurrentIndex()?"next":"prev");t.slide.index===o||n.$currentTransition||w(t.slide,r,i)};n.indexOfSlide=function(n){return+n.slide.index};n.isActive=function(t){return n.active===t.slide.index};n.isPrevDisabled=function(){return 0===n.active&&n.noWrap()};n.isNextDisabled=function(){return n.active===f.length-1&&n.noWrap()};n.pause=function(){n.noPause||(c=!1,a())};n.play=function(){c||(c=!0,v())};t.on("mouseenter",n.pause);t.on("mouseleave",n.play);n.$on("$destroy",function(){p=!0;a()});n.$watch("noTransition",function(n){u.enabled(t,!n)});n.$watch("interval",v);n.$watchCollection("slides",b);n.$watch("active",function(n){var t,i;if(angular.isNumber(n)&&o!==n){for(t=0;t<f.length;t++)if(f[t].slide.index===n){n=t;break}i=f[n];i&&(s(n),e.select(f[n]),o=n)}})}]).directive("uibCarousel",function(){return{transclude:!0,controller:"UibCarouselController",controllerAs:"carousel",restrict:"A",templateUrl:function(n,t){return t.templateUrl||"uib/template/carousel/carousel.html"},scope:{active:"=",interval:"=",noTransition:"=",noPause:"=",noWrap:"&"}}}).directive("uibSlide",["$animate",function(n){return{require:"^uibCarousel",restrict:"A",transclude:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/carousel/slide.html"},scope:{actual:"=?",index:"=?"},link:function(t,i,r,u){i.addClass("item");u.addSlide(t,i);t.$on("$destroy",function(){u.removeSlide(t)});t.$watch("active",function(t){n[t?"addClass":"removeClass"](i,"active")})}}}]).animation(".item",["$animateCss",function(n){function t(n,t,i){n.removeClass(t);i&&i()}var i="uib-slideDirection";return{beforeAddClass:function(r,u,f){if("active"===u){var s=!1,e=r.data(i),o="next"===e?"left":"right",h=t.bind(this,r,o+" "+e,f);return r.addClass(e),n(r,{addClass:o}).start().done(h),function(){s=!0}}f()},beforeRemoveClass:function(r,u,f){if("active"===u){var o=!1,s=r.data(i),e="next"===s?"left":"right",h=t.bind(this,r,e,f);return n(r,{addClass:e}).start().done(h),function(){o=!0}}f()}}}]);angular.module("ui.bootstrap.dateparser",[]).service("uibDateParser",["$log","$locale","dateFilter","orderByFilter","filterFilter",function(n,t,i,r,u){function s(n){return u(f,{key:n},!0)[0]}function v(n){var e=[],i=n.split(""),o=n.indexOf("'"),u,t;if(o>-1){for(u=!1,n=n.split(""),t=o;t<n.length;t++)u?("'"===n[t]&&(t+1<n.length&&"'"===n[t+1]?(n[t+1]="$",i[t+1]=""):(i[t]="",u=!1)),n[t]="$"):"'"===n[t]&&(n[t]="$",i[t]="",u=!0);n=n.join("")}return angular.forEach(f,function(t){var r=n.indexOf(t.key),u,f;if(r>-1){for(n=n.split(""),i[r]="("+t.regex+")",n[r]="$",u=r+1,f=r+t.key.length;f>u;u++)i[u]="",n[u]="$";n=n.join("");e.push({index:r,key:t.key,apply:t.apply,matcher:t.regex})}}),{regex:new RegExp("^"+i.join("")+"$"),map:r(e,"index")}}function y(n){for(var r,i,u=[],t=0;t<n.length;)if(angular.isNumber(i)){if("'"===n.charAt(t))(t+1>=n.length||"'"!==n.charAt(t+1))&&(u.push(p(n,i,t)),i=null);else if(t===n.length)for(;i<n.length;)r=h(n,i),u.push(r),i=r.endIdx;t++}else"'"!==n.charAt(t)?(r=h(n,t),u.push(r.parser),t=r.endIdx):(i=t,t++);return u}function p(n,t,i){return function(){return n.substr(t+1,i-t-1)}}function h(n,t){for(var u,r=n.substr(t),i=0;i<f.length;i++)if(new RegExp("^"+f[i].key).test(r))return u=f[i],{endIdx:t+u.key.length,parser:u.formatter};return{endIdx:t+1,parser:function(){return r.charAt(0)}}}function w(n,t,i){return 1>i?!1:1===t&&i>28?29===i&&(n%4==0&&n%100!=0||n%400==0):3===t||5===t||8===t||10===t?31>i:!0}function c(n){return parseInt(n,10)}function b(n,t){return n&&t?e(n,t):n}function k(n,t){return n&&t?e(n,t,!0):n}function l(n,t){n=n.replace(/:/g,"");var i=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(i)?t:i}function a(n,t){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+t),n}function e(n,t,i){i=i?-1:1;var r=n.getTimezoneOffset(),u=l(t,r);return a(n,i*(u-r))}var o,f,d=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;this.init=function(){o=t.id;this.parsers={};this.formatters={};f=[{key:"yyyy",regex:"\\d{4}",apply:function(n){this.year=+n},formatter:function(n){var t=new Date;return t.setFullYear(Math.abs(n.getFullYear())),i(t,"yyyy")}},{key:"yy",regex:"\\d{2}",apply:function(n){n=+n;this.year=69>n?n+2e3:n+1900},formatter:function(n){var t=new Date;return t.setFullYear(Math.abs(n.getFullYear())),i(t,"yy")}},{key:"y",regex:"\\d{1,4}",apply:function(n){this.year=+n},formatter:function(n){var t=new Date;return t.setFullYear(Math.abs(n.getFullYear())),i(t,"y")}},{key:"M!",regex:"0?[1-9]|1[0-2]",apply:function(n){this.month=n-1},formatter:function(n){var t=n.getMonth();return/^[0-9]$/.test(t)?i(n,"MM"):i(n,"M")}},{key:"MMMM",regex:t.DATETIME_FORMATS.MONTH.join("|"),apply:function(n){this.month=t.DATETIME_FORMATS.MONTH.indexOf(n)},formatter:function(n){return i(n,"MMMM")}},{key:"MMM",regex:t.DATETIME_FORMATS.SHORTMONTH.join("|"),apply:function(n){this.month=t.DATETIME_FORMATS.SHORTMONTH.indexOf(n)},formatter:function(n){return i(n,"MMM")}},{key:"MM",regex:"0[1-9]|1[0-2]",apply:function(n){this.month=n-1},formatter:function(n){return i(n,"MM")}},{key:"M",regex:"[1-9]|1[0-2]",apply:function(n){this.month=n-1},formatter:function(n){return i(n,"M")}},{key:"d!",regex:"[0-2]?[0-9]{1}|3[0-1]{1}",apply:function(n){this.date=+n},formatter:function(n){var t=n.getDate();return/^[1-9]$/.test(t)?i(n,"dd"):i(n,"d")}},{key:"dd",regex:"[0-2][0-9]{1}|3[0-1]{1}",apply:function(n){this.date=+n},formatter:function(n){return i(n,"dd")}},{key:"d",regex:"[1-2]?[0-9]{1}|3[0-1]{1}",apply:function(n){this.date=+n},formatter:function(n){return i(n,"d")}},{key:"EEEE",regex:t.DATETIME_FORMATS.DAY.join("|"),formatter:function(n){return i(n,"EEEE")}},{key:"EEE",regex:t.DATETIME_FORMATS.SHORTDAY.join("|"),formatter:function(n){return i(n,"EEE")}},{key:"HH",regex:"(?:0|1)[0-9]|2[0-3]",apply:function(n){this.hours=+n},formatter:function(n){return i(n,"HH")}},{key:"hh",regex:"0[0-9]|1[0-2]",apply:function(n){this.hours=+n},formatter:function(n){return i(n,"hh")}},{key:"H",regex:"1?[0-9]|2[0-3]",apply:function(n){this.hours=+n},formatter:function(n){return i(n,"H")}},{key:"h",regex:"[0-9]|1[0-2]",apply:function(n){this.hours=+n},formatter:function(n){return i(n,"h")}},{key:"mm",regex:"[0-5][0-9]",apply:function(n){this.minutes=+n},formatter:function(n){return i(n,"mm")}},{key:"m",regex:"[0-9]|[1-5][0-9]",apply:function(n){this.minutes=+n},formatter:function(n){return i(n,"m")}},{key:"sss",regex:"[0-9][0-9][0-9]",apply:function(n){this.milliseconds=+n},formatter:function(n){return i(n,"sss")}},{key:"ss",regex:"[0-5][0-9]",apply:function(n){this.seconds=+n},formatter:function(n){return i(n,"ss")}},{key:"s",regex:"[0-9]|[1-5][0-9]",apply:function(n){this.seconds=+n},formatter:function(n){return i(n,"s")}},{key:"a",regex:t.DATETIME_FORMATS.AMPMS.join("|"),apply:function(n){12===this.hours&&(this.hours=0);"PM"===n&&(this.hours+=12)},formatter:function(n){return i(n,"a")}},{key:"Z",regex:"[+-]\\d{4}",apply:function(n){var t=n.match(/([+-])(\d{2})(\d{2})/),i=t[1],r=t[2],u=t[3];this.hours+=c(i+r);this.minutes+=c(i+u)},formatter:function(n){return i(n,"Z")}},{key:"ww",regex:"[0-4][0-9]|5[0-3]",formatter:function(n){return i(n,"ww")}},{key:"w",regex:"[0-9]|[1-4][0-9]|5[0-3]",formatter:function(n){return i(n,"w")}},{key:"GGGG",regex:t.DATETIME_FORMATS.ERANAMES.join("|").replace(/\s/g,"\\s"),formatter:function(n){return i(n,"GGGG")}},{key:"GGG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(n){return i(n,"GGG")}},{key:"GG",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(n){return i(n,"GG")}},{key:"G",regex:t.DATETIME_FORMATS.ERAS.join("|"),formatter:function(n){return i(n,"G")}}];angular.version.major>=1&&angular.version.minor>4&&f.push({key:"LLLL",regex:t.DATETIME_FORMATS.STANDALONEMONTH.join("|"),apply:function(n){this.month=t.DATETIME_FORMATS.STANDALONEMONTH.indexOf(n)},formatter:function(n){return i(n,"LLLL")}})};this.init();this.getParser=function(n){var t=s(n);return t&&t.apply||null};this.overrideParser=function(n,t){var i=s(n);i&&angular.isFunction(t)&&(this.parsers={},i.apply=t)}.bind(this);this.filter=function(n,i){if(!angular.isDate(n)||isNaN(n)||!i)return"";i=t.DATETIME_FORMATS[i]||i;t.id!==o&&this.init();this.formatters[i]||(this.formatters[i]=y(i));var r=this.formatters[i];return r.reduce(function(t,i){return t+i(n)},"")};this.parse=function(i,r,u){var f,e,s,b,l,a,y;if(!angular.isString(i)||!r)return i;r=t.DATETIME_FORMATS[r]||r;r=r.replace(d,"\\$&");t.id!==o&&this.init();this.parsers[r]||(this.parsers[r]=v(r,"apply"));var p=this.parsers[r],k=p.regex,g=p.map,h=i.match(k),c=!1;if(h&&h.length){for(angular.isDate(u)&&!isNaN(u.getTime())?f={year:u.getFullYear(),month:u.getMonth(),date:u.getDate(),hours:u.getHours(),minutes:u.getMinutes(),seconds:u.getSeconds(),milliseconds:u.getMilliseconds()}:(u&&n.warn("dateparser:","baseDate is not a valid date"),f={year:1900,month:0,date:1,hours:0,minutes:0,seconds:0,milliseconds:0}),s=1,b=h.length;b>s;s++)l=g[s-1],"Z"===l.matcher&&(c=!0),l.apply&&l.apply.call(f,h[s]);return a=c?Date.prototype.setUTCFullYear:Date.prototype.setFullYear,y=c?Date.prototype.setUTCHours:Date.prototype.setHours,w(f.year,f.month,f.date)&&(!angular.isDate(u)||isNaN(u.getTime())||c?(e=new Date(0),a.call(e,f.year,f.month,f.date),y.call(e,f.hours||0,f.minutes||0,f.seconds||0,f.milliseconds||0)):(e=new Date(u),a.call(e,f.year,f.month,f.date),y.call(e,f.hours,f.minutes,f.seconds,f.milliseconds))),e}};this.toTimezone=b;this.fromTimezone=k;this.timezoneToOffset=l;this.addDateMinutes=a;this.convertTimezoneToLocal=e}]);angular.module("ui.bootstrap.isClass",[]).directive("uibIsClass",["$animate",function(n){var t=/^\s*([\s\S]+?)\s+on\s+([\s\S]+?)\s*$/,i=/^\s*([\s\S]+?)\s+for\s+([\s\S]+?)\s*$/;return{restrict:"A",compile:function(r,u){function h(n,t){f.push(n);o.push({scope:n,element:t});y.forEach(function(t){c(t,n)});n.$on("$destroy",l)}function c(t,r){var h=t.match(i),c=r.$eval(h[1]),f=h[2],u=e[t],s;u||(s=function(t){var i=null;o.some(function(n){var r=n.scope.$eval(a);if(r===t)return(i=n,!0)});u.lastActivated!==i&&(u.lastActivated&&n.removeClass(u.lastActivated.element,c),i&&n.addClass(i.element,c),u.lastActivated=i)},e[t]=u={lastActivated:null,scope:r,watchFn:s,compareWithExp:f,watcher:r.$watch(f,s)});u.watchFn(r.$eval(f))}function l(n){var i=n.targetScope,r=f.indexOf(i),t;(f.splice(r,1),o.splice(r,1),f.length)?(t=f[0],angular.forEach(e,function(n){n.scope===i&&(n.watcher=t.$watch(n.compareWithExp,n.watchFn),n.scope=t)})):e={}}var f=[],o=[],e={},s=u.uibIsClass.match(t),a=s[2],v=s[1],y=v.split(",");return h}}}]);angular.module("ui.bootstrap.datepicker",["ui.bootstrap.dateparser","ui.bootstrap.isClass"]).value("$datepickerSuppressError",!1).value("$datepickerLiteralWarning",!0).constant("uibDatepickerConfig",{datepickerMode:"day",formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",maxDate:null,maxMode:"year",minDate:null,minMode:"day",monthColumns:3,ngModelOptions:{},shortcutPropagation:!1,showWeeks:!0,yearColumns:5,yearRows:4}).controller("UibDatepickerController",["$scope","$element","$attrs","$parse","$interpolate","$locale","$log","dateFilter","uibDatepickerConfig","$datepickerLiteralWarning","$datepickerSuppressError","uibDateParser",function(n,t,i,r,u,f,e,o,s,h,c,l){function w(t){n.datepickerMode=t;n.datepickerOptions.datepickerMode=t}function k(t){var i,r;return angular.version.minor<6?(i=t.$options||n.datepickerOptions.ngModelOptions||s.ngModelOptions||{},i.getOption=function(n){return i[n]}):(r=t.$options.getOption("timezone")||(n.datepickerOptions.ngModelOptions?n.datepickerOptions.ngModelOptions.timezone:null)||(s.ngModelOptions?s.ngModelOptions.timezone:null),i=t.$options.createChild(s.ngModelOptions).createChild(n.datepickerOptions.ngModelOptions).createChild(t.$options).createChild({timezone:r})),i}var a=this,v={$setViewValue:angular.noop},y={},p=[],b;t.addClass("uib-datepicker");i.$set("role","application");n.datepickerOptions||(n.datepickerOptions={});this.modes=["day","month","year"];["customClass","dateDisabled","datepickerMode","formatDay","formatDayHeader","formatDayTitle","formatMonth","formatMonthTitle","formatYear","maxDate","maxMode","minDate","minMode","monthColumns","showWeeks","shortcutPropagation","startingDay","yearColumns","yearRows"].forEach(function(t){switch(t){case"customClass":case"dateDisabled":n[t]=n.datepickerOptions[t]||angular.noop;break;case"datepickerMode":n.datepickerMode=angular.isDefined(n.datepickerOptions.datepickerMode)?n.datepickerOptions.datepickerMode:s.datepickerMode;break;case"formatDay":case"formatDayHeader":case"formatDayTitle":case"formatMonth":case"formatMonthTitle":case"formatYear":a[t]=angular.isDefined(n.datepickerOptions[t])?u(n.datepickerOptions[t])(n.$parent):s[t];break;case"monthColumns":case"showWeeks":case"shortcutPropagation":case"yearColumns":case"yearRows":a[t]=angular.isDefined(n.datepickerOptions[t])?n.datepickerOptions[t]:s[t];break;case"startingDay":a.startingDay=angular.isDefined(n.datepickerOptions.startingDay)?n.datepickerOptions.startingDay:angular.isNumber(s.startingDay)?s.startingDay:(f.DATETIME_FORMATS.FIRSTDAYOFWEEK+8)%7;break;case"maxDate":case"minDate":n.$watch("datepickerOptions."+t,function(n){n?angular.isDate(n)?a[t]=l.fromTimezone(new Date(n),y.getOption("timezone")):(h&&e.warn("Literal date support has been deprecated, please switch to date object usage"),a[t]=new Date(o(n,"medium"))):a[t]=s[t]?l.fromTimezone(new Date(s[t]),y.getOption("timezone")):null;a.refreshView()});break;case"maxMode":case"minMode":n.datepickerOptions[t]?n.$watch(function(){return n.datepickerOptions[t]},function(i){a[t]=n[t]=angular.isDefined(i)?i:n.datepickerOptions[t];("minMode"===t&&a.modes.indexOf(n.datepickerOptions.datepickerMode)<a.modes.indexOf(a[t])||"maxMode"===t&&a.modes.indexOf(n.datepickerOptions.datepickerMode)>a.modes.indexOf(a[t]))&&(n.datepickerMode=a[t],n.datepickerOptions.datepickerMode=a[t])}):a[t]=n[t]=s[t]||null}});n.uniqueId="datepicker-"+n.$id+"-"+Math.floor(1e4*Math.random());n.disabled=angular.isDefined(i.disabled)||!1;angular.isDefined(i.ngDisabled)&&p.push(n.$parent.$watch(i.ngDisabled,function(t){n.disabled=t;a.refreshView()}));n.isActive=function(t){return 0===a.compare(t.date,a.activeDate)?(n.activeDateId=t.uid,!0):!1};this.init=function(t){v=t;y=k(v);n.datepickerOptions.initDate?(a.activeDate=l.fromTimezone(n.datepickerOptions.initDate,y.getOption("timezone"))||new Date,n.$watch("datepickerOptions.initDate",function(n){n&&(v.$isEmpty(v.$modelValue)||v.$invalid)&&(a.activeDate=l.fromTimezone(n,y.getOption("timezone")),a.refreshView())})):a.activeDate=new Date;var i=v.$modelValue?new Date(v.$modelValue):new Date;this.activeDate=isNaN(i)?l.fromTimezone(new Date,y.getOption("timezone")):l.fromTimezone(i,y.getOption("timezone"));v.$render=function(){a.render()}};this.render=function(){if(v.$viewValue){var n=new Date(v.$viewValue),t=!isNaN(n);t?this.activeDate=l.fromTimezone(n,y.getOption("timezone")):c||e.error('Datepicker directive: "ng-model" value must be a Date object')}this.refreshView()};this.refreshView=function(){if(this.element){n.selectedDt=null;this._refreshView();n.activeDt&&(n.activeDateId=n.activeDt.uid);var t=v.$viewValue?new Date(v.$viewValue):null;t=l.fromTimezone(t,y.getOption("timezone"));v.$setValidity("dateDisabled",!t||this.element&&!this.isDisabled(t))}};this.createDateObject=function(t,i){var r=v.$viewValue?new Date(v.$viewValue):null,f,e,u;return r=l.fromTimezone(r,y.getOption("timezone")),f=new Date,f=l.fromTimezone(f,y.getOption("timezone")),e=this.compare(t,f),u={date:t,label:l.filter(t,i),selected:r&&0===this.compare(t,r),disabled:this.isDisabled(t),past:0>e,current:0===e,future:e>0,customClass:this.customClass(t)||null},r&&0===this.compare(t,r)&&(n.selectedDt=u),a.activeDate&&0===this.compare(u.date,a.activeDate)&&(n.activeDt=u),u};this.isDisabled=function(t){return n.disabled||this.minDate&&this.compare(t,this.minDate)<0||this.maxDate&&this.compare(t,this.maxDate)>0||n.dateDisabled&&n.dateDisabled({date:t,mode:n.datepickerMode})};this.customClass=function(t){return n.customClass({date:t,mode:n.datepickerMode})};this.split=function(n,t){for(var i=[];n.length>0;)i.push(n.splice(0,t));return i};n.select=function(t){if(n.datepickerMode===a.minMode){var i=v.$viewValue?l.fromTimezone(new Date(v.$viewValue),y.getOption("timezone")):new Date(0,0,0,0,0,0,0);i.setFullYear(t.getFullYear(),t.getMonth(),t.getDate());i=l.toTimezone(i,y.getOption("timezone"));v.$setViewValue(i);v.$render()}else a.activeDate=t,w(a.modes[a.modes.indexOf(n.datepickerMode)-1]),n.$emit("uib:datepicker.mode");n.$broadcast("uib:datepicker.focus")};n.move=function(n){var t=a.activeDate.getFullYear()+n*(a.step.years||0),i=a.activeDate.getMonth()+n*(a.step.months||0);a.activeDate.setFullYear(t,i,1);a.refreshView()};n.toggleMode=function(t){t=t||1;n.datepickerMode===a.maxMode&&1===t||n.datepickerMode===a.minMode&&-1===t||(w(a.modes[a.modes.indexOf(n.datepickerMode)+t]),n.$emit("uib:datepicker.mode"))};n.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};b=function(){a.element[0].focus()};n.$on("uib:datepicker.focus",b);n.keydown=function(t){var i=n.keys[t.which];if(i&&!t.shiftKey&&!t.altKey&&!n.disabled)if(t.preventDefault(),a.shortcutPropagation||t.stopPropagation(),"enter"===i||"space"===i){if(a.isDisabled(a.activeDate))return;n.select(a.activeDate)}else!t.ctrlKey||"up"!==i&&"down"!==i?(a.handleKeyDown(i,t),a.refreshView()):n.toggleMode("up"===i?1:-1)};t.on("keydown",function(t){n.$apply(function(){n.keydown(t)})});n.$on("$destroy",function(){for(;p.length;)p.shift()()})}]).controller("UibDaypickerController",["$scope","$element","dateFilter",function(n,t,i){function r(n,t){return 1!==t||n%4!=0||n%100==0&&n%400!=0?f[t]:29}function u(n){var t=new Date(n),i;return t.setDate(t.getDate()+4-(t.getDay()||7)),i=t.getTime(),t.setMonth(0),t.setDate(1),Math.floor(Math.round((i-t)/864e5)/7)+1}var f=[31,28,31,30,31,30,31,31,30,31,30,31];this.step={months:1};this.element=t;this.init=function(t){angular.extend(t,this);n.showWeeks=t.showWeeks;t.refreshView()};this.getDates=function(n,t){for(var r,u=new Array(t),i=new Date(n),f=0;t>f;)r=new Date(i),u[f++]=r,i.setDate(i.getDate()+1);return u};this._refreshView=function(){var a=this.activeDate.getFullYear(),h=this.activeDate.getMonth(),e=new Date(this.activeDate),t,r,f;e.setFullYear(a,h,1);var o=this.startingDay-e.getDay(),c=o>0?7-o:-o,l=new Date(e);for(c>0&&l.setDate(-c+1),t=this.getDates(l,42),r=0;42>r;r++)t[r]=angular.extend(this.createDateObject(t[r],this.formatDay),{secondary:t[r].getMonth()!==h,uid:n.uniqueId+"-"+r});for(n.labels=new Array(7),f=0;7>f;f++)n.labels[f]={abbr:i(t[f].date,this.formatDayHeader),full:i(t[f].date,"EEEE")};if(n.title=i(this.activeDate,this.formatDayTitle),n.rows=this.split(t,7),n.showWeeks){n.weekNumbers=[];for(var v=(11-this.startingDay)%7,y=n.rows.length,s=0;y>s;s++)n.weekNumbers.push(u(n.rows[s][v].date))}};this.compare=function(n,t){var i=new Date(n.getFullYear(),n.getMonth(),n.getDate()),r=new Date(t.getFullYear(),t.getMonth(),t.getDate());return i.setFullYear(n.getFullYear()),r.setFullYear(t.getFullYear()),i-r};this.handleKeyDown=function(n){var t=this.activeDate.getDate(),i;"left"===n?t-=1:"up"===n?t-=7:"right"===n?t+=1:"down"===n?t+=7:"pageup"===n||"pagedown"===n?(i=this.activeDate.getMonth()+("pageup"===n?-1:1),this.activeDate.setMonth(i,1),t=Math.min(r(this.activeDate.getFullYear(),this.activeDate.getMonth()),t)):"home"===n?t=1:"end"===n&&(t=r(this.activeDate.getFullYear(),this.activeDate.getMonth()));this.activeDate.setDate(t)}}]).controller("UibMonthpickerController",["$scope","$element","dateFilter",function(n,t,i){this.step={years:1};this.element=t;this.init=function(n){angular.extend(n,this);n.refreshView()};this._refreshView=function(){for(var r,u=new Array(12),f=this.activeDate.getFullYear(),t=0;12>t;t++)r=new Date(this.activeDate),r.setFullYear(f,t,1),u[t]=angular.extend(this.createDateObject(r,this.formatMonth),{uid:n.uniqueId+"-"+t});n.title=i(this.activeDate,this.formatMonthTitle);n.rows=this.split(u,this.monthColumns);n.yearHeaderColspan=this.monthColumns>3?this.monthColumns-2:1};this.compare=function(n,t){var i=new Date(n.getFullYear(),n.getMonth()),r=new Date(t.getFullYear(),t.getMonth());return i.setFullYear(n.getFullYear()),r.setFullYear(t.getFullYear()),i-r};this.handleKeyDown=function(n){var t=this.activeDate.getMonth(),i;"left"===n?t-=1:"up"===n?t-=this.monthColumns:"right"===n?t+=1:"down"===n?t+=this.monthColumns:"pageup"===n||"pagedown"===n?(i=this.activeDate.getFullYear()+("pageup"===n?-1:1),this.activeDate.setFullYear(i)):"home"===n?t=0:"end"===n&&(t=11);this.activeDate.setMonth(t)}}]).controller("UibYearpickerController",["$scope","$element","dateFilter",function(n,t){function u(n){return parseInt((n-1)/i,10)*i+1}var r,i;this.element=t;this.yearpickerInit=function(){r=this.yearColumns;i=this.yearRows*r;this.step={years:i}};this._refreshView=function(){for(var e,f=new Array(i),t=0,o=u(this.activeDate.getFullYear());i>t;t++)e=new Date(this.activeDate),e.setFullYear(o+t,0,1),f[t]=angular.extend(this.createDateObject(e,this.formatYear),{uid:n.uniqueId+"-"+t});n.title=[f[0].label,f[i-1].label].join(" - ");n.rows=this.split(f,r);n.columns=r};this.compare=function(n,t){return n.getFullYear()-t.getFullYear()};this.handleKeyDown=function(n){var t=this.activeDate.getFullYear();"left"===n?t-=1:"up"===n?t-=r:"right"===n?t+=1:"down"===n?t+=r:"pageup"===n||"pagedown"===n?t+=("pageup"===n?-1:1)*i:"home"===n?t=u(this.activeDate.getFullYear()):"end"===n&&(t=u(this.activeDate.getFullYear())+i-1);this.activeDate.setFullYear(t)}}]).directive("uibDatepicker",function(){return{templateUrl:function(n,t){return t.templateUrl||"uib/template/datepicker/datepicker.html"},scope:{datepickerOptions:"=?"},require:["uibDatepicker","^ngModel"],restrict:"A",controller:"UibDatepickerController",controllerAs:"datepicker",link:function(n,t,i,r){var u=r[0],f=r[1];u.init(f)}}}).directive("uibDaypicker",function(){return{templateUrl:function(n,t){return t.templateUrl||"uib/template/datepicker/day.html"},require:["^uibDatepicker","uibDaypicker"],restrict:"A",controller:"UibDaypickerController",link:function(n,t,i,r){var u=r[0],f=r[1];f.init(u)}}}).directive("uibMonthpicker",function(){return{templateUrl:function(n,t){return t.templateUrl||"uib/template/datepicker/month.html"},require:["^uibDatepicker","uibMonthpicker"],restrict:"A",controller:"UibMonthpickerController",link:function(n,t,i,r){var u=r[0],f=r[1];f.init(u)}}}).directive("uibYearpicker",function(){return{templateUrl:function(n,t){return t.templateUrl||"uib/template/datepicker/year.html"},require:["^uibDatepicker","uibYearpicker"],restrict:"A",controller:"UibYearpickerController",link:function(n,t,i,r){var u=r[0];angular.extend(u,r[1]);u.yearpickerInit();u.refreshView()}}});angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(n,t){var r,u,f={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},i={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},e=/(HTML|BODY)/;return{getRawNode:function(n){return n.nodeName?n:n[0]||n},parseStyle:function(n){return n=parseFloat(n),isFinite(n)?n:0},offsetParent:function(i){function u(n){return"static"===(t.getComputedStyle(n).position||"static")}i=this.getRawNode(i);for(var r=i.offsetParent||n[0].documentElement;r&&r!==n[0].documentElement&&u(r);)r=r.offsetParent;return r||n[0].documentElement},scrollbarWidth:function(i){var e,f;return i?(angular.isUndefined(u)&&(e=n.find("body"),e.addClass("uib-position-body-scrollbar-measure"),u=t.innerWidth-e[0].clientWidth,u=isFinite(u)?u:0,e.removeClass("uib-position-body-scrollbar-measure")),u):(angular.isUndefined(r)&&(f=angular.element('<div class="uib-position-scrollbar-measure"><\/div>'),n.find("body").append(f),r=f[0].offsetWidth-f[0].clientWidth,r=isFinite(r)?r:0,f.remove()),r)},scrollbarPadding:function(n){n=this.getRawNode(n);var u=t.getComputedStyle(n),f=this.parseStyle(u.paddingRight),o=this.parseStyle(u.paddingBottom),i=this.scrollParent(n,!1,!0),r=this.scrollbarWidth(e.test(i.tagName));return{scrollbarWidth:r,widthOverflow:i.scrollWidth>i.clientWidth,right:f+r,originalRight:f,heightOverflow:i.scrollHeight>i.clientHeight,bottom:o+r,originalBottom:o}},isScrollable:function(n,i){n=this.getRawNode(n);var u=i?f.hidden:f.normal,r=t.getComputedStyle(n);return u.test(r.overflow+r.overflowY+r.overflowX)},scrollParent:function(i,r,u){var c,e,s;i=this.getRawNode(i);var l=r?f.hidden:f.normal,h=n[0].documentElement,o=t.getComputedStyle(i);if(u&&l.test(o.overflow+o.overflowY+o.overflowX))return i;if(c="absolute"===o.position,e=i.parentElement||h,e===h||"fixed"===o.position)return h;for(;e.parentElement&&e!==h;){if(s=t.getComputedStyle(e),c&&"static"!==s.position&&(c=!1),!c&&l.test(s.overflow+s.overflowY+s.overflowX))break;e=e.parentElement}return e},position:function(i,r){var u,o,f,e;return i=this.getRawNode(i),u=this.offset(i),r&&(o=t.getComputedStyle(i),u.top-=this.parseStyle(o.marginTop),u.left-=this.parseStyle(o.marginLeft)),f=this.offsetParent(i),e={top:0,left:0},f!==n[0].documentElement&&(e=this.offset(f),e.top+=f.clientTop-f.scrollTop,e.left+=f.clientLeft-f.scrollLeft),{width:Math.round(angular.isNumber(u.width)?u.width:i.offsetWidth),height:Math.round(angular.isNumber(u.height)?u.height:i.offsetHeight),top:Math.round(u.top-e.top),left:Math.round(u.left-e.left)}},offset:function(i){i=this.getRawNode(i);var r=i.getBoundingClientRect();return{width:Math.round(angular.isNumber(r.width)?r.width:i.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:i.offsetHeight),top:Math.round(r.top+(t.pageYOffset||n[0].documentElement.scrollTop)),left:Math.round(r.left+(t.pageXOffset||n[0].documentElement.scrollLeft))}},viewportOffset:function(i,r,u){var o;i=this.getRawNode(i);u=u!==!1;var s=i.getBoundingClientRect(),f={top:0,left:0,bottom:0,right:0},e=r?n[0].documentElement:this.scrollParent(i),h=e.getBoundingClientRect();return(f.top=h.top+e.clientTop,f.left=h.left+e.clientLeft,e===n[0].documentElement&&(f.top+=t.pageYOffset,f.left+=t.pageXOffset),f.bottom=f.top+e.clientHeight,f.right=f.left+e.clientWidth,u)&&(o=t.getComputedStyle(e),f.top+=this.parseStyle(o.paddingTop),f.bottom-=this.parseStyle(o.paddingBottom),f.left+=this.parseStyle(o.paddingLeft),f.right-=this.parseStyle(o.paddingRight)),{top:Math.round(s.top-f.top),bottom:Math.round(f.bottom-s.bottom),left:Math.round(s.left-f.left),right:Math.round(f.right-s.right)}},parsePlacement:function(n){var t=i.auto.test(n);return t&&(n=n.replace(i.auto,"")),n=n.split("-"),n[0]=n[0]||"top",i.primary.test(n[0])||(n[0]="top"),n[1]=n[1]||"center",i.secondary.test(n[1])||(n[1]="center"),n[2]=t?!0:!1,n},positionElements:function(n,r,u,f){var c,l,e,h,v,y;if(n=this.getRawNode(n),r=this.getRawNode(r),c=angular.isDefined(r.offsetWidth)?r.offsetWidth:r.prop("offsetWidth"),l=angular.isDefined(r.offsetHeight)?r.offsetHeight:r.prop("offsetHeight"),u=this.parsePlacement(u),e=f?this.offset(n):this.position(n),h={top:0,left:0,placement:""},u[2]){var o=this.viewportOffset(n,f),a=t.getComputedStyle(r),s={width:c+Math.round(Math.abs(this.parseStyle(a.marginLeft)+this.parseStyle(a.marginRight))),height:l+Math.round(Math.abs(this.parseStyle(a.marginTop)+this.parseStyle(a.marginBottom)))};(u[0]="top"===u[0]&&s.height>o.top&&s.height<=o.bottom?"bottom":"bottom"===u[0]&&s.height>o.bottom&&s.height<=o.top?"top":"left"===u[0]&&s.width>o.left&&s.width<=o.right?"right":"right"===u[0]&&s.width>o.right&&s.width<=o.left?"left":u[0],u[1]="top"===u[1]&&s.height-e.height>o.bottom&&s.height-e.height<=o.top?"bottom":"bottom"===u[1]&&s.height-e.height>o.top&&s.height-e.height<=o.bottom?"top":"left"===u[1]&&s.width-e.width>o.right&&s.width-e.width<=o.left?"right":"right"===u[1]&&s.width-e.width>o.left&&s.width-e.width<=o.right?"left":u[1],"center"===u[1])&&(i.vertical.test(u[0])?(v=e.width/2-c/2,o.left+v<0&&s.width-e.width<=o.right?u[1]="left":o.right+v<0&&s.width-e.width<=o.left&&(u[1]="right")):(y=e.height/2-s.height/2,o.top+y<0&&s.height-e.height<=o.bottom?u[1]="top":o.bottom+y<0&&s.height-e.height<=o.top&&(u[1]="bottom")))}switch(u[0]){case"top":h.top=e.top-l;break;case"bottom":h.top=e.top+e.height;break;case"left":h.left=e.left-c;break;case"right":h.left=e.left+e.width}switch(u[1]){case"top":h.top=e.top;break;case"bottom":h.top=e.top+e.height-l;break;case"left":h.left=e.left;break;case"right":h.left=e.left+e.width-c;break;case"center":i.vertical.test(u[0])?h.left=e.left+e.width/2-c/2:h.top=e.top+e.height/2-l/2}return h.top=Math.round(h.top),h.left=Math.round(h.left),h.placement="center"===u[1]?u[0]:u[0]+"-"+u[1],h},adjustTop:function(n,t,i,r){if(-1!==n.indexOf("top")&&i!==r)return{top:t.top-r+"px"}},positionArrow:function(n,r){var o,f,e,u,c;if(n=this.getRawNode(n),o=n.querySelector(".tooltip-inner, .popover-inner"),o&&(f=angular.element(o).hasClass("tooltip-inner"),e=f?n.querySelector(".tooltip-arrow"):n.querySelector(".arrow"),e)){if(u={top:"",bottom:"",left:"",right:""},r=this.parsePlacement(r),"center"===r[1])return void angular.element(e).css(u);var l="border-"+r[0]+"-width",s=t.getComputedStyle(e)[l],h="border-";h+=i.vertical.test(r[0])?r[0]+"-"+r[1]:r[1]+"-"+r[0];h+="-radius";c=t.getComputedStyle(f?o:n)[h];switch(r[0]){case"top":u.bottom=f?"0":"-"+s;break;case"bottom":u.top=f?"0":"-"+s;break;case"left":u.right=f?"0":"-"+s;break;case"right":u.left=f?"0":"-"+s}u[r[1]]=c;angular.element(e).css(u)}}}}]);angular.module("ui.bootstrap.datepickerPopup",["ui.bootstrap.datepicker","ui.bootstrap.position"]).value("$datepickerPopupLiteralWarning",!0).constant("uibDatepickerPopupConfig",{altInputFormats:[],appendToBody:!1,clearText:"Clear",closeOnDateSelection:!0,closeText:"Done",currentText:"Today",datepickerPopup:"yyyy-MM-dd",datepickerPopupTemplateUrl:"uib/template/datepickerPopup/popup.html",datepickerTemplateUrl:"uib/template/datepicker/datepicker.html",html5Types:{date:"yyyy-MM-dd","datetime-local":"yyyy-MM-ddTHH:mm:ss.sss",month:"yyyy-MM"},onOpenFocus:!0,showButtonBar:!0,placement:"auto bottom-left"}).controller("UibDatepickerPopupController",["$scope","$element","$attrs","$compile","$log","$parse","$window","$document","$rootScope","$uibPosition","dateFilter","uibDateParser","uibDatepickerPopupConfig","$timeout","uibDatepickerConfig","$datepickerPopupLiteralWarning",function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){function ut(t){var i=l.parse(t,b,n.date),r;if(isNaN(i))for(r=0;r<ot.length;r++)if(i=l.parse(t,ot[r],n.date),!isNaN(i))return i;return i}function yt(n){if(angular.isNumber(n)&&(n=new Date(n)),!n)return null;if(angular.isDate(n)&&!isNaN(n))return n;if(angular.isString(n)){var t=ut(n);if(!isNaN(t))return l.toTimezone(t,g.getOption("timezone"))}if(g.getOption("allowInvalid"))return n}function pt(n,t){var r=n||t;return i.ngRequired||r?(angular.isNumber(r)&&(r=new Date(r)),r?angular.isDate(r)&&!isNaN(r)?!0:angular.isString(r)?!isNaN(ut(r)):!1:!0):!0}function ft(i){if(n.isOpen||!n.disabled){var r=nt[0],u=t[0].contains(i.target),f=void 0!==r.contains&&r.contains(i.target);!n.isOpen||u||f||n.$apply(function(){n.isOpen=!1})}}function ht(i){27===i.which&&n.isOpen?(i.preventDefault(),i.stopPropagation(),n.$apply(function(){n.isOpen=!1}),t[0].focus()):40!==i.which||n.isOpen||(i.preventDefault(),i.stopPropagation(),n.$apply(function(){n.isOpen=!0}))}function d(){if(n.isOpen){var r=angular.element(nt[0].querySelector(".uib-datepicker-popup")),f=i.popupPlacement?i.popupPlacement:a.placement,u=h.positionElements(t,r,f,it);r.css({top:u.top+"px",left:u.left+"px"});r.hasClass("uib-position-measure")&&r.removeClass("uib-position-measure")}}function wt(n){var t;return angular.version.minor<6?(t=angular.isObject(n.$options)?n.$options:{timezone:null},t.getOption=function(n){return t[n]}):t=n.$options,t}var b,ct,it,lt,at,vt,tt,et,k,w,g,nt,ot,rt=!1,st=[];this.init=function(u){if(w=u,g=wt(w),ct=angular.isDefined(i.closeOnDateSelection)?n.$parent.$eval(i.closeOnDateSelection):a.closeOnDateSelection,it=angular.isDefined(i.datepickerAppendToBody)?n.$parent.$eval(i.datepickerAppendToBody):a.appendToBody,lt=angular.isDefined(i.onOpenFocus)?n.$parent.$eval(i.onOpenFocus):a.onOpenFocus,at=angular.isDefined(i.datepickerPopupTemplateUrl)?i.datepickerPopupTemplateUrl:a.datepickerPopupTemplateUrl,vt=angular.isDefined(i.datepickerTemplateUrl)?i.datepickerTemplateUrl:a.datepickerTemplateUrl,ot=angular.isDefined(i.altInputFormats)?n.$parent.$eval(i.altInputFormats):a.altInputFormats,n.showButtonBar=angular.isDefined(i.showButtonBar)?n.$parent.$eval(i.showButtonBar):a.showButtonBar,a.html5Types[i.type]?(b=a.html5Types[i.type],rt=!0):(b=i.uibDatepickerPopup||a.datepickerPopup,i.$observe("uibDatepickerPopup",function(n){var t=n||a.datepickerPopup;if(t!==b&&(b=t,w.$modelValue=null,!b))throw new Error("uibDatepickerPopup must have a date format specified.");})),!b)throw new Error("uibDatepickerPopup must have a date format specified.");if(rt&&i.uibDatepickerPopup)throw new Error("HTML5 date input types do not support custom formats.");tt=angular.element("<div uib-datepicker-popup-wrap><div uib-datepicker><\/div><\/div>");tt.attr({"ng-model":"date","ng-change":"dateSelection(date)","template-url":at});et=angular.element(tt.children()[0]);et.attr("template-url",vt);n.datepickerOptions||(n.datepickerOptions={});rt&&"month"===i.type&&(n.datepickerOptions.datepickerMode="month",n.datepickerOptions.minMode="month");et.attr("datepicker-options","datepickerOptions");rt?w.$formatters.push(function(t){return n.date=l.fromTimezone(t,g.getOption("timezone")),t}):(w.$$parserName="date",w.$validators.date=pt,w.$parsers.unshift(yt),w.$formatters.push(function(t){return w.$isEmpty(t)?(n.date=t,t):(angular.isNumber(t)&&(t=new Date(t)),n.date=l.fromTimezone(t,g.getOption("timezone")),l.filter(n.date,b))}));w.$viewChangeListeners.push(function(){n.date=ut(w.$viewValue)});t.on("keydown",ht);nt=r(tt)(n);tt.remove();it?o.find("body").append(nt):t.after(nt);n.$on("$destroy",function(){for(n.isOpen===!0&&(s.$$phase||n.$apply(function(){n.isOpen=!1})),nt.remove(),t.off("keydown",ht),o.off("click",ft),k&&k.off("scroll",d),angular.element(e).off("resize",d);st.length;)st.shift()()})};n.getText=function(t){return n[t+"Text"]||a[t+"Text"]};n.isDisabled=function(t){"today"===t&&(t=l.fromTimezone(new Date,g.getOption("timezone")));var i={};return angular.forEach(["minDate","maxDate"],function(t){n.datepickerOptions[t]?angular.isDate(n.datepickerOptions[t])?i[t]=new Date(n.datepickerOptions[t]):(p&&u.warn("Literal date support has been deprecated, please switch to date object usage"),i[t]=new Date(c(n.datepickerOptions[t],"medium"))):i[t]=null}),n.datepickerOptions&&i.minDate&&n.compare(t,i.minDate)<0||i.maxDate&&n.compare(t,i.maxDate)>0};n.compare=function(n,t){return new Date(n.getFullYear(),n.getMonth(),n.getDate())-new Date(t.getFullYear(),t.getMonth(),t.getDate())};n.dateSelection=function(i){n.date=i;var r=n.date?l.filter(n.date,b):null;t.val(r);w.$setViewValue(r);ct&&(n.isOpen=!1,t[0].focus())};n.keydown=function(i){27===i.which&&(i.stopPropagation(),n.isOpen=!1,t[0].focus())};n.select=function(t,i){if(i.stopPropagation(),"today"===t){var r=new Date;angular.isDate(n.date)?(t=new Date(n.date),t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate())):(t=l.fromTimezone(r,g.getOption("timezone")),t.setHours(0,0,0,0))}n.dateSelection(t)};n.close=function(i){i.stopPropagation();n.isOpen=!1;t[0].focus()};n.disabled=angular.isDefined(i.disabled)||!1;i.ngDisabled&&st.push(n.$parent.$watch(f(i.ngDisabled),function(t){n.disabled=t}));n.$watch("isOpen",function(r){r?n.disabled?n.isOpen=!1:v(function(){d();lt&&n.$broadcast("uib:datepicker.focus");o.on("click",ft);var r=i.popupPlacement?i.popupPlacement:a.placement;it||h.parsePlacement(r)[2]?(k=k||angular.element(h.scrollParent(t)),k&&k.on("scroll",d)):k=null;angular.element(e).on("resize",d)},0,!1):(o.off("click",ft),k&&k.off("scroll",d),angular.element(e).off("resize",d))});n.$on("uib:datepicker.mode",function(){v(d,0,!1)})}]).directive("uibDatepickerPopup",function(){return{require:["ngModel","uibDatepickerPopup"],controller:"UibDatepickerPopupController",scope:{datepickerOptions:"=?",isOpen:"=?",currentText:"@",clearText:"@",closeText:"@"},link:function(n,t,i,r){var u=r[0],f=r[1];f.init(u)}}}).directive("uibDatepickerPopupWrap",function(){return{restrict:"A",transclude:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/datepickerPopup/popup.html"}}});angular.module("ui.bootstrap.debounce",[]).factory("$$debounce",["$timeout",function(n){return function(t,i){var r;return function(){var u=this,f=Array.prototype.slice.call(arguments);r&&n.cancel(r);r=n(function(){t.apply(u,f)},i)}}}]);angular.module("ui.bootstrap.multiMap",[]).factory("$$multiMap",function(){return{createNew:function(){var n={};return{entries:function(){return Object.keys(n).map(function(t){return{key:t,value:n[t]}})},get:function(t){return n[t]},hasKey:function(t){return!!n[t]},keys:function(){return Object.keys(n)},put:function(t,i){n[t]||(n[t]=[]);n[t].push(i)},remove:function(t,i){var r=n[t],u;r&&(u=r.indexOf(i),-1!==u&&r.splice(u,1),r.length||delete n[t])}}}}});angular.module("ui.bootstrap.dropdown",["ui.bootstrap.multiMap","ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope","$$multiMap",function(n,t,i){var r=null,u=i.createNew(),f;this.isOnlyOpen=function(n,t){var i=u.get(t),r;return i&&(r=i.reduce(function(t,i){return i.scope===n?i:t},{}),r)?1===i.length:!1};this.open=function(t,i,e){var o,s;(r||n.on("click",f),r&&r!==t&&(r.isOpen=!1),r=t,e)&&(o=u.get(e),o?(s=o.map(function(n){return n.scope}),-1===s.indexOf(t)&&u.put(e,{scope:t})):u.put(e,{scope:t}))};this.close=function(t,i,e){var o,s;(r===t&&(n.off("click",f),n.off("keydown",this.keybindFilter),r=null),e)&&(o=u.get(e),o&&(s=o.reduce(function(n,i){return i.scope===t?i:n},{}),s&&u.remove(e,s)))};f=function(n){var i,u;!r||!r.isOpen||n&&"disabled"===r.getAutoClose()||n&&3===n.which||(i=r.getToggleElement(),n&&i&&i[0].contains(n.target)||(u=r.getDropdownElement(),n&&"outsideClick"===r.getAutoClose()&&u&&u[0].contains(n.target)||(r.focusToggleElement(),r.isOpen=!1,t.$$phase||r.$apply())))};this.keybindFilter=function(n){if(r){var t=r.getDropdownElement(),i=r.getToggleElement(),u=t&&t[0].contains(n.target),e=i&&i[0].contains(n.target);27===n.which?(n.stopPropagation(),r.focusToggleElement(),f()):r.isKeynavEnabled()&&-1!==[38,40].indexOf(n.which)&&r.isOpen&&(u||e)&&(n.preventDefault(),n.stopPropagation(),r.focusDropdownEntry(n.which))}}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(n,t,i,r,u,f,e,o,s,h,c){function p(){t.append(l.dropdownMenu)}var y,w,l=this,a=n.$new(),k=u.appendToOpenClass,d=u.openClass,v=angular.noop,g=i.onToggle?r(i.onToggle):angular.noop,b=!1,nt=s.find("body");t.addClass("dropdown");this.init=function(){i.isOpen&&(w=r(i.isOpen),v=w.assign,n.$watch(w,function(n){a.isOpen=!!n}));b=angular.isDefined(i.keyboardNav)};this.toggle=function(n){return a.isOpen=arguments.length?!!n:!a.isOpen,angular.isFunction(v)&&v(a,a.isOpen),a.isOpen};this.isOpen=function(){return a.isOpen};a.getToggleElement=function(){return l.toggleElement};a.getAutoClose=function(){return i.autoClose||"always"};a.getElement=function(){return t};a.isKeynavEnabled=function(){return b};a.focusDropdownEntry=function(n){var i=l.dropdownMenu?angular.element(l.dropdownMenu).find("a"):t.find("ul").eq(0).find("a");switch(n){case 40:l.selectedOption=angular.isNumber(l.selectedOption)?l.selectedOption===i.length-1?l.selectedOption:l.selectedOption+1:0;break;case 38:l.selectedOption=angular.isNumber(l.selectedOption)?0===l.selectedOption?0:l.selectedOption-1:i.length-1}i[l.selectedOption].focus()};a.getDropdownElement=function(){return l.dropdownMenu};a.focusToggleElement=function(){l.toggleElement&&l.toggleElement[0].focus()};a.$watch("isOpen",function(u,w){var b=null,ft=!1,et,ct,tt,ot,rt,it,st,ut,vt,ht;angular.isDefined(i.dropdownAppendTo)&&(et=r(i.dropdownAppendTo)(a),et&&(b=angular.element(et)));angular.isDefined(i.dropdownAppendToBody)&&(ct=r(i.dropdownAppendToBody)(a),ct!==!1&&(ft=!0));(ft&&!b&&(b=nt),b&&l.dropdownMenu&&(u?(b.append(l.dropdownMenu),t.on("$destroy",p)):(t.off("$destroy",p),p())),b&&l.dropdownMenu)&&(it=o.positionElements(t,l.dropdownMenu,"bottom-left",!0),st=0,(tt={top:it.top+"px",display:u?"block":"none"},ot=l.dropdownMenu.hasClass("dropdown-menu-right"),ot?(tt.left="auto",rt=o.scrollbarPadding(b),rt.heightOverflow&&rt.scrollbarWidth&&(st=rt.scrollbarWidth),tt.right=window.innerWidth-st-(it.left+t.prop("offsetWidth"))+"px"):(tt.left=it.left+"px",tt.right="auto"),ft)||(ut=o.offset(b),tt.top=it.top-ut.top+"px",ot?tt.right=window.innerWidth-(it.left-ut.left+t.prop("offsetWidth"))+"px":tt.left=it.left-ut.left+"px"),l.dropdownMenu.css(tt));var lt=b?b:t,at=b?k:d,yt=lt.hasClass(at),pt=f.isOnlyOpen(n,b);yt===!u&&(vt=b?pt?"removeClass":"addClass":u?"addClass":"removeClass",e[vt](lt,at).then(function(){angular.isDefined(u)&&u!==w&&g(n,{open:!!u})}));u?(l.dropdownMenuTemplateUrl?c(l.dropdownMenuTemplateUrl).then(function(n){y=a.$new();h(n.trim())(y,function(n){var t=n;l.dropdownMenu.replaceWith(t);l.dropdownMenu=t;s.on("keydown",f.keybindFilter)})}):s.on("keydown",f.keybindFilter),a.focusToggleElement(),f.open(a,t,b)):((f.close(a,t,b),l.dropdownMenuTemplateUrl)&&(y&&y.$destroy(),ht=angular.element('<ul class="dropdown-menu"><\/ul>'),l.dropdownMenu.replaceWith(ht),l.dropdownMenu=ht),l.selectedOption=null);angular.isFunction(v)&&v(n,u)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(n,t,i,r){r.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(n,t,i,r){if(r&&!angular.isDefined(i.dropdownNested)){t.addClass("dropdown-menu");var u=i.templateUrl;u&&(r.dropdownMenuTemplateUrl=u);r.dropdownMenu||(r.dropdownMenu=t)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(n,t,i,r){if(r){t.addClass("dropdown-toggle");r.toggleElement=t;var u=function(u){u.preventDefault();t.hasClass("disabled")||i.disabled||n.$apply(function(){r.toggle()})};t.on("click",u);t.attr({"aria-haspopup":!0,"aria-expanded":!1});n.$watch(r.isOpen,function(n){t.attr("aria-expanded",!!n)});n.$on("$destroy",function(){t.off("click",u)})}}}});angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var n=[];return{add:function(t,i){n.push({key:t,value:i})},get:function(t){for(var i=0;i<n.length;i++)if(t===n[i].key)return n[i]},keys:function(){for(var i=[],t=0;t<n.length;t++)i.push(n[t].key);return i},top:function(){return n[n.length-1]},remove:function(t){for(var r=-1,i=0;i<n.length;i++)if(t===n[i].key){r=i;break}return n.splice(r,1)[0]},removeTop:function(){return n.pop()},length:function(){return n.length}}}}});angular.module("ui.bootstrap.modal",["ui.bootstrap.multiMap","ui.bootstrap.stackedMap","ui.bootstrap.position"]).provider("$uibResolve",function(){var n=this;this.resolver=null;this.setResolver=function(n){this.resolver=n};this.$get=["$injector","$q",function(t,i){var r=n.resolver?t.get(n.resolver):null;return{resolve:function(n,u,f,e){if(r)return r.resolve(n,u,f,e);var o=[];return angular.forEach(n,function(n){angular.isFunction(n)||angular.isArray(n)?o.push(i.resolve(t.invoke(n))):angular.isString(n)?o.push(i.resolve(t.get(n))):o.push(i.resolve(n))}),i.all(o).then(function(t){var i={},r=0;return angular.forEach(n,function(n,u){i[u]=t[r++]}),i})}}}]}).directive("uibModalBackdrop",["$animate","$injector","$uibModalStack",function(n,t,i){function r(t,r,u){u.modalInClass&&(n.addClass(r,u.modalInClass),t.$on(i.NOW_CLOSING_EVENT,function(i,f){var e=f();t.modalOptions.animation?n.removeClass(r,u.modalInClass).then(e):e()}))}return{restrict:"A",compile:function(n,t){return n.addClass(t.backdropClass),r}}}]).directive("uibModalWindow",["$uibModalStack","$q","$animateCss","$document",function(n,t,i,r){return{scope:{index:"@"},restrict:"A",transclude:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/modal/window.html"},link:function(u,f,e){f.addClass(e.windowTopClass||"");u.size=e.size;u.close=function(t){var i=n.getTop();i&&i.value.backdrop&&"static"!==i.value.backdrop&&t.target===t.currentTarget&&(t.preventDefault(),t.stopPropagation(),n.dismiss(i.key,"backdrop click"))};f.on("click",u.close);u.$isRendered=!0;var o=t.defer();u.$$postDigest(function(){o.resolve()});o.promise.then(function(){var o=null;e.modalInClass&&(o=i(f,{addClass:e.modalInClass}).start(),u.$on(n.NOW_CLOSING_EVENT,function(n,t){var r=t();i(f,{removeClass:e.modalInClass}).start().then(r)}));t.when(o).then(function(){var i=n.getTop(),t;(i&&n.modalRendered(i.key),r[0].activeElement&&f[0].contains(r[0].activeElement))||(t=f[0].querySelector("[autofocus]"),t?t.focus():f[0].focus())})})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(n,t){t.modalAnimation&&n.addClass(t.uibModalAnimationClass)}}}).directive("uibModalTransclude",["$animate",function(n){return{link:function(t,i,r,u,f){f(t.$parent,function(t){i.empty();n.enter(t,i)})}}}]).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap","$uibPosition",function(n,t,i,r,u,f,e,o,s){function ft(n){var t="-";return n.replace(ht,function(n,i){return(i?t:"")+n.toLowerCase()})}function et(n){return!!(n.offsetWidth||n.offsetHeight||n.getClientRects().length)}function b(){for(var n=-1,i=c.keys(),t=0;t<i.length;t++)c.get(i[t]).value.backdrop&&(n=t);return n>-1&&y>n&&(n=y),n}function d(n,t){var i=c.get(n).value,r=i.appendTo;c.remove(n);p=c.top();p&&(y=parseInt(p.value.modalDomEl.attr("index"),10));nt(i.modalDomEl,i.modalScope,function(){var t=i.openedClass||ut,u;k.remove(t,n);u=k.hasKey(t);r.toggleClass(t,u);!u&&a&&a.heightOverflow&&a.scrollbarWidth&&(a.originalRight?r.css({paddingRight:a.originalRight+"px"}):r.css({paddingRight:""}),a=null);g(!0)},i.closedDeferred);ot();t&&t.focus?t.focus():r.focus&&r.focus()}function g(n){var t;c.length()>0&&(t=c.top().value,t.modalDomEl.toggleClass(t.windowTopClass||"",n))}function ot(){if(l&&-1===b()){var n=v;nt(l,v,function(){n=null});l=void 0;v=void 0}}function nt(t,i,r,u){function o(){o.done||(o.done=!0,n.leave(t).then(function(){r&&r();t.remove();u&&u.resolve()}),i.$destroy())}var e,s=null,c=function(){return e||(e=f.defer(),s=e.promise),function(){e.resolve()}};return i.$broadcast(h.NOW_CLOSING_EVENT,c),f.when(s).then(o)}function tt(n){var t,i,r;if(n.isDefaultPrevented())return n;if(t=c.top(),t)switch(n.which){case 27:t.value.keyboard&&(n.preventDefault(),u.$apply(function(){h.dismiss(t.key,"escape key press")}));break;case 9:i=h.loadFocusElementList(t);r=!1;n.shiftKey?(h.isFocusInFirstItem(n,i)||h.isModalFocused(n,t))&&(r=h.focusLastFocusableElement(i)):h.isFocusInLastItem(n,i)&&(r=h.focusFirstFocusableElement(i));r&&(n.preventDefault(),n.stopPropagation())}}function it(n,t,i){return!n.value.modalScope.$broadcast("modal.closing",t,i).defaultPrevented}function rt(){Array.prototype.forEach.call(document.querySelectorAll("["+w+"]"),function(n){var i=parseInt(n.getAttribute(w),10),t=i-1;n.setAttribute(w,t);t||(n.removeAttribute(w),n.removeAttribute("aria-hidden"))})}var l,v,a,ut="modal-open",c=o.createNew(),k=e.createNew(),h={NOW_CLOSING_EVENT:"modal.stack.now-closing"},y=0,p=null,w="data-bootstrap-modal-aria-hidden-count",st="a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex='-1']), iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]",ht=/[A-Z]/g;return u.$watch(b,function(n){v&&(v.index=n)}),i.on("keydown",tt),u.$on("$destroy",function(){i.off("keydown",tt)}),h.open=function(t,f){function nt(n){function t(n){var t=n.parent()?n.parent().children():[];return Array.prototype.filter.call(t,function(t){return t!==n[0]})}if(n&&"BODY"!==n[0].tagName)return t(n).forEach(function(n){var i="true"===n.getAttribute("aria-hidden"),t=parseInt(n.getAttribute(w),10);t||(t=i?1:0);n.setAttribute(w,t+1);n.setAttribute("aria-hidden","true")}),nt(n.parent())}var it=i[0].activeElement,tt=f.openedClass||ut,e,d,h,o;g(!1);p=c.top();c.add(t,{deferred:f.deferred,renderDeferred:f.renderDeferred,closedDeferred:f.closedDeferred,modalScope:f.scope,backdrop:f.backdrop,keyboard:f.keyboard,openedClass:f.openedClass,windowTopClass:f.windowTopClass,animation:f.animation,appendTo:f.appendTo});k.put(tt,t);e=f.appendTo;d=b();d>=0&&!l&&(v=u.$new(!0),v.modalOptions=f,v.index=d,l=angular.element('<div uib-modal-backdrop="modal-backdrop"><\/div>'),l.attr({"class":"modal-backdrop","ng-style":"{'z-index': 1040 + (index && 1 || 0) + index*10}","uib-modal-animation-class":"fade","modal-in-class":"in"}),f.backdropClass&&l.addClass(f.backdropClass),f.animation&&l.attr("modal-animation","true"),r(l)(v),n.enter(l,e),s.isScrollable(e)&&(a=s.scrollbarPadding(e),a.heightOverflow&&a.scrollbarWidth&&e.css({paddingRight:a.right+"px"})));f.component?(h=document.createElement(ft(f.component.name)),h=angular.element(h),h.attr({resolve:"$resolve","modal-instance":"$uibModalInstance",close:"$close($value)",dismiss:"$dismiss($value)"})):h=f.content;y=p?parseInt(p.value.modalDomEl.attr("index"),10)+1:0;o=angular.element('<div uib-modal-window="modal-window"><\/div>');o.attr({"class":"modal","template-url":f.windowTemplateUrl,"window-top-class":f.windowTopClass,role:"dialog","aria-labelledby":f.ariaLabelledBy,"aria-describedby":f.ariaDescribedBy,size:f.size,index:y,animate:"animate","ng-style":"{'z-index': 3050 + $$topModalIndex*10, display: 'block'}",tabindex:-1,"uib-modal-animation-class":"fade","modal-in-class":"in"}).append(h);f.windowClass&&o.addClass(f.windowClass);f.animation&&o.attr("modal-animation","true");e.addClass(tt);f.scope&&(f.scope.$$topModalIndex=y);n.enter(r(o)(f.scope),e);c.top().value.modalDomEl=o;c.top().value.modalOpener=it;nt(o)},h.close=function(n,t){var i=c.get(n);return rt(),i&&it(i,t,!0)?(i.value.modalScope.$$uibDestructionScheduled=!0,i.value.deferred.resolve(t),d(n,i.value.modalOpener),!0):!i},h.dismiss=function(n,t){var i=c.get(n);return rt(),i&&it(i,t,!1)?(i.value.modalScope.$$uibDestructionScheduled=!0,i.value.deferred.reject(t),d(n,i.value.modalOpener),!0):!i},h.dismissAll=function(n){for(var t=this.getTop();t&&this.dismiss(t.key,n);)t=this.getTop()},h.getTop=function(){return c.top()},h.modalRendered=function(n){var t=c.get(n);t&&t.value.renderDeferred.resolve()},h.focusFirstFocusableElement=function(n){return n.length>0?(n[0].focus(),!0):!1},h.focusLastFocusableElement=function(n){return n.length>0?(n[n.length-1].focus(),!0):!1},h.isModalFocused=function(n,t){if(n&&t){var i=t.value.modalDomEl;if(i&&i.length)return(n.target||n.srcElement)===i[0]}return!1},h.isFocusInFirstItem=function(n,t){return t.length>0?(n.target||n.srcElement)===t[0]:!1},h.isFocusInLastItem=function(n,t){return t.length>0?(n.target||n.srcElement)===t[t.length-1]:!1},h.loadFocusElementList=function(n){var t,i;if(n&&(t=n.value.modalDomEl,t&&t.length))return i=t[0].querySelectorAll(st),i?Array.prototype.filter.call(i,function(n){return et(n)}):i},h}]).provider("$uibModal",function(){var n={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(t,i,r,u,f,e,o){function c(n){return n.template?i.when(n.template):u(angular.isFunction(n.templateUrl)?n.templateUrl():n.templateUrl)}var h={},s=null;return h.getPromiseChain=function(){return s},h.open=function(u){function v(){return w}var l=i.defer(),a=i.defer(),y=i.defer(),p=i.defer(),h={result:l.promise,opened:a.promise,closed:y.promise,rendered:p.promise,close:function(n){return o.close(h,n)},dismiss:function(n){return o.dismiss(h,n)}},w,b;if(u=angular.extend({},n.options,u),u.resolve=u.resolve||{},u.appendTo=u.appendTo||r.find("body").eq(0),!u.appendTo.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");if(!u.component&&!u.template&&!u.templateUrl)throw new Error("One of component or template or templateUrl options is required.");return w=u.component?i.when(e.resolve(u.resolve,{},null,null)):i.all([c(u),e.resolve(u.resolve,{},null,null)]),b=s=i.all([s]).then(v,v).then(function(n){function w(t,r,u,f){t.$scope=i;t.$scope.$resolve={};u?t.$scope.$uibModalInstance=h:t.$uibModalInstance=h;var e=r?n[1]:n;angular.forEach(e,function(n,i){f&&(t[i]=n);t.$scope.$resolve[i]=n})}var b=u.scope||t,i=b.$new();i.$close=h.close;i.$dismiss=h.dismiss;i.$on("$destroy",function(){i.$$uibDestructionScheduled||i.$dismiss("$uibUnscheduledDestruction")});var r,e,s={scope:i,deferred:l,renderDeferred:p,closedDeferred:y,animation:u.animation,backdrop:u.backdrop,keyboard:u.keyboard,backdropClass:u.backdropClass,windowTopClass:u.windowTopClass,windowClass:u.windowClass,windowTemplateUrl:u.windowTemplateUrl,ariaLabelledBy:u.ariaLabelledBy,ariaDescribedBy:u.ariaDescribedBy,size:u.size,openedClass:u.openedClass,appendTo:u.appendTo},c={},v={};u.component?(w(c,!1,!0,!1),c.name=u.component,s.component=c):u.controller&&(w(v,!0,!1,!0),e=f(u.controller,v,!0,u.controllerAs),u.controllerAs&&u.bindToController&&(r=e.instance,r.$close=i.$close,r.$dismiss=i.$dismiss,angular.extend(r,{$resolve:v.$scope.$resolve},b)),r=e(),angular.isFunction(r.$onInit)&&r.$onInit());u.component||(s.content=n[0]);o.open(h,s);a.resolve(!0)},function(n){a.reject(n);l.reject(n)})["finally"](function(){s===b&&(s=null)}),h},h}]};return n});angular.module("ui.bootstrap.paging",[]).factory("uibPaging",["$parse",function(n){return{create:function(t,i,r){t.setNumPages=r.numPages?n(r.numPages).assign:angular.noop;t.ngModelCtrl={$setViewValue:angular.noop};t._watchers=[];t.init=function(n,u){t.ngModelCtrl=n;t.config=u;n.$render=function(){t.render()};r.itemsPerPage?t._watchers.push(i.$parent.$watch(r.itemsPerPage,function(n){t.itemsPerPage=parseInt(n,10);i.totalPages=t.calculateTotalPages();t.updatePage()})):t.itemsPerPage=u.itemsPerPage;i.$watch("totalItems",function(n,r){(angular.isDefined(n)||n!==r)&&(i.totalPages=t.calculateTotalPages(),t.updatePage())})};t.calculateTotalPages=function(){var n=t.itemsPerPage<1?1:Math.ceil(i.totalItems/t.itemsPerPage);return Math.max(n||0,1)};t.render=function(){i.page=parseInt(t.ngModelCtrl.$viewValue,10)||1};i.selectPage=function(n,r){r&&r.preventDefault();var u=!i.ngDisabled||!r;u&&i.page!==n&&n>0&&n<=i.totalPages&&(r&&r.target&&r.target.blur(),t.ngModelCtrl.$setViewValue(n),t.ngModelCtrl.$render())};i.getText=function(n){return i[n+"Text"]||t.config[n+"Text"]};i.noPrevious=function(){return 1===i.page};i.noNext=function(){return i.page===i.totalPages};t.updatePage=function(){t.setNumPages(i.$parent,i.totalPages);i.page>i.totalPages?i.selectPage(i.totalPages):t.ngModelCtrl.$render()};i.$on("$destroy",function(){for(;t._watchers.length;)t._watchers.shift()()})}}}]);angular.module("ui.bootstrap.pager",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPagerController",["$scope","$attrs","uibPaging","uibPagerConfig",function(n,t,i,r){n.align=angular.isDefined(t.align)?n.$parent.$eval(t.align):r.align;i.create(this,n,t)}]).constant("uibPagerConfig",{itemsPerPage:10,previousText:"« Previous",nextText:"Next »",align:!0}).directive("uibPager",["uibPagerConfig",function(n){return{scope:{totalItems:"=",previousText:"@",nextText:"@",ngDisabled:"="},require:["uibPager","?ngModel"],restrict:"A",controller:"UibPagerController",controllerAs:"pager",templateUrl:function(n,t){return t.templateUrl||"uib/template/pager/pager.html"},link:function(t,i,r,u){i.addClass("pager");var e=u[0],f=u[1];f&&e.init(f,n)}}}]);angular.module("ui.bootstrap.pagination",["ui.bootstrap.paging","ui.bootstrap.tabindex"]).controller("UibPaginationController",["$scope","$attrs","$parse","uibPaging","uibPaginationConfig",function(n,t,i,r,u){function e(n,t,i){return{number:n,text:t,active:i}}function l(n,t){var u=[],i=1,r=t,c=angular.isDefined(f)&&t>f,s,l,y,p,w,b,k,d;for(c&&(h?(i=Math.max(n-Math.floor(f/2),1),r=i+f-1,r>t&&(r=t,i=r-f+1)):(i=(Math.ceil(n/f)-1)*f+1,r=Math.min(i+f-1,t))),s=i;r>=s;s++)l=e(s,v(s),s===n),u.push(l);return c&&f>0&&(!h||a||o)&&(i>1&&((!o||i>3)&&(y=e(i-1,"...",!1),u.unshift(y)),o&&(3===i&&(p=e(2,"2",!1),u.unshift(p)),w=e(1,"1",!1),u.unshift(w))),t>r&&((!o||t-2>r)&&(b=e(r+1,"...",!1),u.push(b)),o&&(r===t-2&&(k=e(t-1,t-1,!1),u.push(k)),d=e(t,t,!1),u.push(d)))),u}var s=this,f=angular.isDefined(t.maxSize)?n.$parent.$eval(t.maxSize):u.maxSize,h=angular.isDefined(t.rotate)?n.$parent.$eval(t.rotate):u.rotate,a=angular.isDefined(t.forceEllipses)?n.$parent.$eval(t.forceEllipses):u.forceEllipses,o=angular.isDefined(t.boundaryLinkNumbers)?n.$parent.$eval(t.boundaryLinkNumbers):u.boundaryLinkNumbers,v=angular.isDefined(t.pageLabel)?function(i){return n.$parent.$eval(t.pageLabel,{$page:i})}:angular.identity,c;n.boundaryLinks=angular.isDefined(t.boundaryLinks)?n.$parent.$eval(t.boundaryLinks):u.boundaryLinks;n.directionLinks=angular.isDefined(t.directionLinks)?n.$parent.$eval(t.directionLinks):u.directionLinks;t.$set("role","menu");r.create(this,n,t);t.maxSize&&s._watchers.push(n.$parent.$watch(i(t.maxSize),function(n){f=parseInt(n,10);s.render()}));c=this.render;this.render=function(){c();n.page>0&&n.page<=n.totalPages&&(n.pages=l(n.page,n.totalPages))}}]).constant("uibPaginationConfig",{itemsPerPage:10,boundaryLinks:!1,boundaryLinkNumbers:!1,directionLinks:!0,firstText:"First",previousText:"Previous",nextText:"Next",lastText:"Last",rotate:!0,forceEllipses:!1}).directive("uibPagination",["$parse","uibPaginationConfig",function(n,t){return{scope:{totalItems:"=",firstText:"@",previousText:"@",nextText:"@",lastText:"@",ngDisabled:"="},require:["uibPagination","?ngModel"],restrict:"A",controller:"UibPaginationController",controllerAs:"pagination",templateUrl:function(n,t){return t.templateUrl||"uib/template/pagination/pagination.html"},link:function(n,i,r,u){i.addClass("pagination");var e=u[0],f=u[1];f&&e.init(f,t)}}}]);angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){function i(n){var t="-";return n.replace(/[A-Z]/g,function(n,i){return(i?t:"")+n.toLowerCase()})}var r={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},n={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},t={};this.options=function(n){angular.extend(t,n)};this.setTriggers=function(t){angular.extend(n,t)};this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(u,f,e,o,s,h,c,l,a){function y(n){if(27===n.which){var t=v.top();t&&(t.value.close(),t=null)}}var v=a.createNew();return o.on("keyup",y),c.$on("$destroy",function(){o.off("keyup",y)}),function(u,c,a,y){function p(t){var i=(t||y.trigger||a).split(" "),r=i.map(function(t){return n[t]||t});return{show:i,hide:r}}y=angular.extend({},r,t,y);var k=i(u),w=h.startSymbol(),b=h.endSymbol(),d="<div "+k+'-popup uib-title="'+w+"title"+b+'" '+(y.useContentExp?'content-exp="contentExp()" ':'content="'+w+"content"+b+'" ')+'origin-scope="origScope" class="uib-position-measure '+c+'" tooltip-animation-class="fade"uib-tooltip-classes ng-class="{ in: isOpen }" ><\/div>';return{compile:function(){var n=f(d);return function(t,i,r){function g(){f.isOpen?nt():at()}function at(){oi&&!t.$eval(r[c+"Enable"])||(vt(),ri(),f.popupDelay?it||(it=e(dt,f.popupDelay,!1)):dt())}function nt(){st();f.popupCloseDelay?rt||(rt=e(k,f.popupCloseDelay,!1)):k()}function dt(){return st(),vt(),f.content?(ii(),void f.$evalAsync(function(){f.isOpen=!0;gt(!0);ot()})):angular.noop}function st(){it&&(e.cancel(it),it=null);d&&(e.cancel(d),d=null)}function k(){f&&f.$evalAsync(function(){f&&(f.isOpen=!1,gt(!1),f.animation?tt||(tt=e(yt,150,!1)):yt())})}function vt(){rt&&(e.cancel(rt),rt=null);tt&&(e.cancel(tt),tt=null)}function ii(){h||(b=f.$new(),h=n(b,function(n){ft?o.find("body").append(n):i.after(n)}),v.add(f,{close:k}),ui())}function yt(){st();vt();fi();h&&(h.remove(),h=null,ht&&e.cancel(ht));v.remove(f);b&&(b.$destroy(),b=null)}function ri(){var n,i,e;f.title=r[c+"Title"];f.content=ct?ct(t):r[u];f.popupClass=r[c+"Class"];f.placement=angular.isDefined(r[c+"Placement"])?r[c+"Placement"]:y.placement;n=s.parsePlacement(f.placement);ut=n[1]?n[0]+"-"+n[1]:n[0];i=parseInt(r[c+"PopupDelay"],10);e=parseInt(r[c+"PopupCloseDelay"],10);f.popupDelay=isNaN(i)?y.popupDelay:i;f.popupCloseDelay=isNaN(e)?y.popupCloseDelay:e}function gt(n){et&&angular.isFunction(et.assign)&&et.assign(t,n)}function ui(){a.length=0;ct?(a.push(t.$watch(ct,function(n){f.content=n;!n&&f.isOpen&&k()})),a.push(b.$watch(function(){pt||(pt=!0,b.$$postDigest(function(){pt=!1;f&&f.isOpen&&ot()}))}))):a.push(r.$observe(u,function(n){f.content=n;!n&&f.isOpen?k():ot()}));a.push(r.$observe(c+"Title",function(n){f.title=n;f.isOpen&&ot()}));a.push(r.$observe(c+"Placement",function(n){f.placement=n?n:y.placement;f.isOpen&&ot()}))}function fi(){a.length&&(angular.forEach(a,function(n){n()}),a.length=0)}function ni(n){f&&f.isOpen&&h&&(i[0].contains(n.target)||h[0].contains(n.target)||nt())}function ti(n){27===n.which&&nt()}function ei(){var u=[],f=[],n=t.$eval(r[c+"Trigger"]);wt();angular.isObject(n)?(Object.keys(n).forEach(function(t){u.push(t);f.push(n[t])}),w={show:u,hide:f}):w=p(n);"none"!==w.show&&w.show.forEach(function(n,t){"outsideClick"===n?(i.on("click",g),o.on("click",ni)):n===w.hide[t]?i.on(n,g):n&&(i.on(n,at),i.on(w.hide[t],nt));i.on("keypress",ti)})}var h,b,tt,it,rt,d,ht,ut,ft=angular.isDefined(y.appendToBody)?y.appendToBody:!1,w=p(void 0),oi=angular.isDefined(r[c+"Enable"]),f=t.$new(!0),pt=!1,et=angular.isDefined(r[c+"IsOpen"])?l(r[c+"IsOpen"]):!1,ct=y.useContentExp?l(r[u]):!1,a=[],ot=function(){h&&h.html()&&(d||(d=e(function(){var n=s.positionElements(i,h,f.placement,ft),r=angular.isDefined(h.offsetHeight)?h.offsetHeight:h.prop("offsetHeight"),u=ft?s.offset(i):s.position(i),t;h.css({top:n.top+"px",left:n.left+"px"});t=n.placement.split("-");h.hasClass(t[0])||(h.removeClass(ut.split("-")[0]),h.addClass(t[0]));h.hasClass(y.placementClassPrefix+n.placement)||(h.removeClass(y.placementClassPrefix+ut),h.addClass(y.placementClassPrefix+n.placement));ht=e(function(){var i=angular.isDefined(h.offsetHeight)?h.offsetHeight:h.prop("offsetHeight"),n=s.adjustTop(t,u,r,i);n&&h.css(n);ht=null},0,!1);h.hasClass("uib-position-measure")?(s.positionArrow(h,n.placement),h.removeClass("uib-position-measure")):ut!==n.placement&&s.positionArrow(h,n.placement);ut=n.placement;d=null},0,!1)))},wt,bt,kt,lt;f.origScope=t;f.isOpen=!1;f.contentExp=function(){return f.content};r.$observe("disabled",function(n){n&&st();n&&f.isOpen&&k()});et&&t.$watch(et,function(n){f&&!n===f.isOpen&&g()});wt=function(){w.show.forEach(function(n){"outsideClick"===n?i.off("click",g):(i.off(n,at),i.off(n,g));i.off("keypress",ti)});w.hide.forEach(function(n){"outsideClick"===n?o.off("click",ni):i.off(n,nt)})};ei();bt=t.$eval(r[c+"Animation"]);f.animation=angular.isDefined(bt)?!!bt:y.animation;lt=c+"AppendToBody";kt=lt in r&&void 0===r[lt]?!0:t.$eval(r[lt]);ft=angular.isDefined(kt)?kt:ft;t.$on("$destroy",function(){wt();yt();f=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(n,t,i,r){return{link:function(u,f,e){var o,s,h,a=u.$eval(e.tooltipTemplateTranscludeScope),l=0,c=function(){s&&(s.remove(),s=null);o&&(o.$destroy(),o=null);h&&(n.leave(h).then(function(){s=null}),s=h,h=null)};u.$watch(t.parseAsResourceUrl(e.uibTooltipTemplateTransclude),function(t){var e=++l;t?(r(t,!0).then(function(r){if(e===l){var u=a.$new(),s=r,v=i(s)(u,function(t){c();n.enter(t,f)});o=u;h=v;o.$emit("$includeContentLoaded",t)}},function(){e===l&&(c(),u.$emit("$includeContentError",t))}),u.$emit("$includeContentRequested",t)):c()});u.$on("$destroy",c)}}}]).directive("uibTooltipClasses",["$uibPosition",function(n){return{restrict:"A",link:function(t,i,r){if(t.placement){var u=n.parsePlacement(t.placement);i.addClass(u[0])}t.popupClass&&i.addClass(t.popupClass);t.animation&&i.addClass(r.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{restrict:"A",scope:{content:"@"},templateUrl:"uib/template/tooltip/tooltip-popup.html"}}).directive("uibTooltip",["$uibTooltip",function(n){return n("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{restrict:"A",scope:{contentExp:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(n){return n("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(n){return n("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]);angular.module("ui.bootstrap.popover",["ui.bootstrap.tooltip"]).directive("uibPopoverTemplatePopup",function(){return{restrict:"A",scope:{uibTitle:"@",contentExp:"&",originScope:"&"},templateUrl:"uib/template/popover/popover-template.html"}}).directive("uibPopoverTemplate",["$uibTooltip",function(n){return n("uibPopoverTemplate","popover","click",{useContentExp:!0})}]).directive("uibPopoverHtmlPopup",function(){return{restrict:"A",scope:{contentExp:"&",uibTitle:"@"},templateUrl:"uib/template/popover/popover-html.html"}}).directive("uibPopoverHtml",["$uibTooltip",function(n){return n("uibPopoverHtml","popover","click",{useContentExp:!0})}]).directive("uibPopoverPopup",function(){return{restrict:"A",scope:{uibTitle:"@",content:"@"},templateUrl:"uib/template/popover/popover.html"}}).directive("uibPopover",["$uibTooltip",function(n){return n("uibPopover","popover","click")}]);angular.module("ui.bootstrap.progressbar",[]).constant("uibProgressConfig",{animate:!0,max:100}).controller("UibProgressController",["$scope","$attrs","uibProgressConfig",function(n,t,i){function r(){return angular.isDefined(n.maxParam)?n.maxParam:i.max}var u=this,f=angular.isDefined(t.animate)?n.$parent.$eval(t.animate):i.animate;this.bars=[];n.max=r();this.addBar=function(n,t,i){f||t.css({transition:"none"});this.bars.push(n);n.max=r();n.title=i&&angular.isDefined(i.title)?i.title:"progressbar";n.$watch("value",function(){n.recalculatePercentage()});n.recalculatePercentage=function(){var t=u.bars.reduce(function(n,t){return t.percent=+(100*t.value/t.max).toFixed(2),n+t.percent},0);t>100&&(n.percent-=t-100)};n.$on("$destroy",function(){t=null;u.removeBar(n)})};this.removeBar=function(n){this.bars.splice(this.bars.indexOf(n),1);this.bars.forEach(function(n){n.recalculatePercentage()})};n.$watch("maxParam",function(){u.bars.forEach(function(n){n.max=r();n.recalculatePercentage()})})}]).directive("uibProgress",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",require:"uibProgress",scope:{maxParam:"=?max"},templateUrl:"uib/template/progressbar/progress.html"}}).directive("uibBar",function(){return{replace:!0,transclude:!0,require:"^uibProgress",scope:{value:"=",type:"@"},templateUrl:"uib/template/progressbar/bar.html",link:function(n,t,i,r){r.addBar(n,t,i)}}}).directive("uibProgressbar",function(){return{replace:!0,transclude:!0,controller:"UibProgressController",scope:{value:"=",maxParam:"=?max",type:"@"},templateUrl:"uib/template/progressbar/progressbar.html",link:function(n,t,i,r){r.addBar(n,angular.element(t.children()[0]),{title:i.title})}}});angular.module("ui.bootstrap.rating",[]).constant("uibRatingConfig",{max:5,stateOn:null,stateOff:null,enableReset:!0,titles:["one","two","three","four","five"]}).controller("UibRatingController",["$scope","$attrs","uibRatingConfig",function(n,t,i){var r={$setViewValue:angular.noop},u=this;this.init=function(u){var f,e;r=u;r.$render=this.render;r.$formatters.push(function(n){return angular.isNumber(n)&&n<<0!==n&&(n=Math.round(n)),n});this.stateOn=angular.isDefined(t.stateOn)?n.$parent.$eval(t.stateOn):i.stateOn;this.stateOff=angular.isDefined(t.stateOff)?n.$parent.$eval(t.stateOff):i.stateOff;this.enableReset=angular.isDefined(t.enableReset)?n.$parent.$eval(t.enableReset):i.enableReset;f=angular.isDefined(t.titles)?n.$parent.$eval(t.titles):i.titles;this.titles=angular.isArray(f)&&f.length>0?f:i.titles;e=angular.isDefined(t.ratingStates)?n.$parent.$eval(t.ratingStates):new Array(angular.isDefined(t.max)?n.$parent.$eval(t.max):i.max);n.range=this.buildTemplateObjects(e)};this.buildTemplateObjects=function(n){for(var t=0,i=n.length;i>t;t++)n[t]=angular.extend({index:t},{stateOn:this.stateOn,stateOff:this.stateOff,title:this.getTitle(t)},n[t]);return n};this.getTitle=function(n){return n>=this.titles.length?n+1:this.titles[n]};n.rate=function(t){if(!n.readonly&&t>=0&&t<=n.range.length){var i=u.enableReset&&r.$viewValue===t?0:t;r.$setViewValue(i);r.$render()}};n.enter=function(t){n.readonly||(n.value=t);n.onHover({value:t})};n.reset=function(){n.value=r.$viewValue;n.onLeave()};n.onKeydown=function(t){/(37|38|39|40)/.test(t.which)&&(t.preventDefault(),t.stopPropagation(),n.rate(n.value+(38===t.which||39===t.which?1:-1)))};this.render=function(){n.value=r.$viewValue;n.title=u.getTitle(n.value-1)}}]).directive("uibRating",function(){return{require:["uibRating","ngModel"],restrict:"A",scope:{readonly:"=?readOnly",onHover:"&",onLeave:"&"},controller:"UibRatingController",templateUrl:"uib/template/rating/rating.html",link:function(n,t,i,r){var u=r[0],f=r[1];u.init(f)}}});angular.module("ui.bootstrap.tabs",[]).controller("UibTabsetController",["$scope",function(n){function r(n){for(var i=0;i<t.tabs.length;i++)if(t.tabs[i].index===n)return i}var i,t=this,u;t.tabs=[];t.select=function(n,f){var s,o,e;if(!u){if(s=r(i),o=t.tabs[s],o){if(o.tab.onDeselect({$event:f,$selectedIndex:n}),f&&f.isDefaultPrevented())return;o.tab.active=!1}e=t.tabs[n];e?(e.tab.onSelect({$event:f}),e.tab.active=!0,t.active=e.index,i=e.index):!e&&angular.isDefined(i)&&(t.active=null,i=null)}};t.addTab=function(n){if(t.tabs.push({tab:n,index:n.index}),t.tabs.sort(function(n,t){return n.index>t.index?1:n.index<t.index?-1:0}),n.index===t.active||!angular.isDefined(t.active)&&1===t.tabs.length){var i=r(n.index);t.select(i)}};t.removeTab=function(n){for(var i,u,r=0;r<t.tabs.length;r++)if(t.tabs[r].tab===n){i=r;break}t.tabs[i].index===t.active&&(u=i===t.tabs.length-1?i-1:i+1%t.tabs.length,t.select(u));t.tabs.splice(i,1)};n.$watch("tabset.active",function(n){angular.isDefined(n)&&n!==i&&t.select(r(n))});n.$on("$destroy",function(){u=!0})}]).directive("uibTabset",function(){return{transclude:!0,replace:!0,scope:{},bindToController:{active:"=?",type:"@"},controller:"UibTabsetController",controllerAs:"tabset",templateUrl:function(n,t){return t.templateUrl||"uib/template/tabs/tabset.html"},link:function(n,t,i){n.vertical=angular.isDefined(i.vertical)?n.$parent.$eval(i.vertical):!1;n.justified=angular.isDefined(i.justified)?n.$parent.$eval(i.justified):!1}}}).directive("uibTab",["$parse",function(n){return{require:"^uibTabset",replace:!0,templateUrl:function(n,t){return t.templateUrl||"uib/template/tabs/tab.html"},transclude:!0,scope:{heading:"@",index:"=?",classes:"@?",onSelect:"&select",onDeselect:"&deselect"},controller:function(){},controllerAs:"tab",link:function(t,i,r,u,f){t.disabled=!1;r.disable&&t.$parent.$watch(n(r.disable),function(n){t.disabled=!!n});angular.isUndefined(r.index)&&(t.index=u.tabs&&u.tabs.length?Math.max.apply(null,u.tabs.map(function(n){return n.index}))+1:0);angular.isUndefined(r.classes)&&(t.classes="");t.select=function(n){if(!t.disabled){for(var r,i=0;i<u.tabs.length;i++)if(u.tabs[i].tab===t){r=i;break}u.select(r,n)}};u.addTab(t);t.$on("$destroy",function(){u.removeTab(t)});t.$transcludeFn=f}}}]).directive("uibTabHeadingTransclude",function(){return{restrict:"A",require:"^uibTab",link:function(n,t){n.$watch("headingElement",function(n){n&&(t.html(""),t.append(n))})}}}).directive("uibTabContentTransclude",function(){function n(n){return n.tagName&&(n.hasAttribute("uib-tab-heading")||n.hasAttribute("data-uib-tab-heading")||n.hasAttribute("x-uib-tab-heading")||"uib-tab-heading"===n.tagName.toLowerCase()||"data-uib-tab-heading"===n.tagName.toLowerCase()||"x-uib-tab-heading"===n.tagName.toLowerCase()||"uib:tab-heading"===n.tagName.toLowerCase())}return{restrict:"A",require:"^uibTabset",link:function(t,i,r){var u=t.$eval(r.uibTabContentTransclude).tab;u.$transcludeFn(u.$parent,function(t){angular.forEach(t,function(t){n(t)?u.headingElement=t:i.append(t)})})}}});angular.module("ui.bootstrap.timepicker",[]).constant("uibTimepickerConfig",{hourStep:1,minuteStep:1,secondStep:1,showMeridian:!0,showSeconds:!1,meridians:null,readonlyInput:!1,mousewheel:!0,arrowkeys:!0,showSpinners:!0,templateUrl:"uib/template/timepicker/timepicker.html"}).controller("UibTimepickerController",["$scope","$element","$attrs","$parse","$log","$locale","uibTimepickerConfig",function(n,t,i,r,u,f,e){function ut(){var t=+n.hours,i=n.showMeridian?t>0&&13>t:t>=0&&24>t;if(i&&""!==n.hours)return(n.showMeridian&&(12===t&&(t=0),n.meridian===v[1]&&(t+=12)),t)}function ft(){var t=+n.minutes,i=t>=0&&60>t;if(i&&""!==n.minutes)return t}function ct(){var t=+n.seconds;if(t>=0&&60>t)return t}function p(n,t){return null===n?"":angular.isDefined(n)&&n.toString().length<2&&!t?"0"+n:n.toString()}function g(n){nt();s.$setViewValue(new Date(o));ot(n)}function nt(){tt&&tt.$setValidity("hours",!0);it&&it.$setValidity("minutes",!0);rt&&rt.$setValidity("seconds",!0);s.$setValidity("time",!0);n.invalidHours=!1;n.invalidMinutes=!1;n.invalidSeconds=!1}function ot(t){if(s.$modelValue){var i=o.getHours(),r=o.getMinutes(),u=o.getSeconds();n.showMeridian&&(i=0===i||12===i?12:i%12);n.hours="h"===t?i:p(i,!ht);"m"!==t&&(n.minutes=p(r));n.meridian=o.getHours()<12?v[0]:v[1];"s"!==t&&(n.seconds=p(u));n.meridian=o.getHours()<12?v[0]:v[1]}else n.hours=null,n.minutes=null,n.seconds=null,n.meridian=v[0]}function y(n){o=et(o,n);g()}function w(n,t){return et(n,60*t)}function et(n,t){var i=new Date(n.getTime()+1e3*t),r=new Date(n);return r.setHours(i.getHours(),i.getMinutes(),i.getSeconds()),r}function st(){return(null===n.hours||""===n.hours)&&(null===n.minutes||""===n.minutes)&&(!n.showSeconds||n.showSeconds&&(null===n.seconds||""===n.seconds))}var tt,it,rt,o=new Date,a=[],s={$setViewValue:angular.noop},v=angular.isDefined(i.meridians)?n.$parent.$eval(i.meridians):e.meridians||f.DATETIME_FORMATS.AMPMS,ht=angular.isDefined(i.padHours)?n.$parent.$eval(i.padHours):!0,b,k,c,l,h,d;n.tabindex=angular.isDefined(i.tabindex)?i.tabindex:0;t.removeAttr("tabindex");this.init=function(t,r){var h,c;s=t;s.$render=this.render;s.$formatters.unshift(function(n){return n?new Date(n):null});var u=r.eq(0),f=r.eq(1),o=r.eq(2);tt=u.controller("ngModel");it=f.controller("ngModel");rt=o.controller("ngModel");h=angular.isDefined(i.mousewheel)?n.$parent.$eval(i.mousewheel):e.mousewheel;h&&this.setupMousewheelEvents(u,f,o);c=angular.isDefined(i.arrowkeys)?n.$parent.$eval(i.arrowkeys):e.arrowkeys;c&&this.setupArrowkeyEvents(u,f,o);n.readonlyInput=angular.isDefined(i.readonlyInput)?n.$parent.$eval(i.readonlyInput):e.readonlyInput;this.setupInputEvents(u,f,o)};b=e.hourStep;i.hourStep&&a.push(n.$parent.$watch(r(i.hourStep),function(n){b=+n}));k=e.minuteStep;i.minuteStep&&a.push(n.$parent.$watch(r(i.minuteStep),function(n){k=+n}));a.push(n.$parent.$watch(r(i.min),function(n){var t=new Date(n);c=isNaN(t)?void 0:t}));a.push(n.$parent.$watch(r(i.max),function(n){var t=new Date(n);l=isNaN(t)?void 0:t}));h=!1;i.ngDisabled&&a.push(n.$parent.$watch(r(i.ngDisabled),function(n){h=n}));n.noIncrementHours=function(){var n=w(o,60*b);return h||n>l||o>n&&c>n};n.noDecrementHours=function(){var n=w(o,60*-b);return h||c>n||n>o&&n>l};n.noIncrementMinutes=function(){var n=w(o,k);return h||n>l||o>n&&c>n};n.noDecrementMinutes=function(){var n=w(o,-k);return h||c>n||n>o&&n>l};n.noIncrementSeconds=function(){var n=et(o,d);return h||n>l||o>n&&c>n};n.noDecrementSeconds=function(){var n=et(o,-d);return h||c>n||n>o&&n>l};n.noToggleMeridian=function(){return o.getHours()<12?h||w(o,720)>l:h||w(o,-720)<c};d=e.secondStep;i.secondStep&&a.push(n.$parent.$watch(r(i.secondStep),function(n){d=+n}));n.showSeconds=e.showSeconds;i.showSeconds&&a.push(n.$parent.$watch(r(i.showSeconds),function(t){n.showSeconds=!!t}));n.showMeridian=e.showMeridian;i.showMeridian&&a.push(n.$parent.$watch(r(i.showMeridian),function(t){if(n.showMeridian=!!t,s.$error.time){var i=ut(),r=ft();angular.isDefined(i)&&angular.isDefined(r)&&(o.setHours(i),g())}else ot()}));this.setupMousewheelEvents=function(t,i,r){var u=function(n){n.originalEvent&&(n=n.originalEvent);var t=n.wheelDelta?n.wheelDelta:-n.deltaY;return n.detail||t>0};t.on("mousewheel wheel",function(t){h||n.$apply(u(t)?n.incrementHours():n.decrementHours());t.preventDefault()});i.on("mousewheel wheel",function(t){h||n.$apply(u(t)?n.incrementMinutes():n.decrementMinutes());t.preventDefault()});r.on("mousewheel wheel",function(t){h||n.$apply(u(t)?n.incrementSeconds():n.decrementSeconds());t.preventDefault()})};this.setupArrowkeyEvents=function(t,i,r){t.on("keydown",function(t){h||(38===t.which?(t.preventDefault(),n.incrementHours(),n.$apply()):40===t.which&&(t.preventDefault(),n.decrementHours(),n.$apply()))});i.on("keydown",function(t){h||(38===t.which?(t.preventDefault(),n.incrementMinutes(),n.$apply()):40===t.which&&(t.preventDefault(),n.decrementMinutes(),n.$apply()))});r.on("keydown",function(t){h||(38===t.which?(t.preventDefault(),n.incrementSeconds(),n.$apply()):40===t.which&&(t.preventDefault(),n.decrementSeconds(),n.$apply()))})};this.setupInputEvents=function(t,i,r){if(n.readonlyInput)return n.updateHours=angular.noop,n.updateMinutes=angular.noop,void(n.updateSeconds=angular.noop);var u=function(t,i,r){s.$setViewValue(null);s.$setValidity("time",!1);angular.isDefined(t)&&(n.invalidHours=t,tt&&tt.$setValidity("hours",!1));angular.isDefined(i)&&(n.invalidMinutes=i,it&&it.$setValidity("minutes",!1));angular.isDefined(r)&&(n.invalidSeconds=r,rt&&rt.$setValidity("seconds",!1))};n.updateHours=function(){var n=ut(),t=ft();s.$setDirty();angular.isDefined(n)&&angular.isDefined(t)?(o.setHours(n),o.setMinutes(t),c>o||o>l?u(!0):g("h")):u(!0)};t.on("blur",function(){s.$setTouched();st()?nt():null===n.hours||""===n.hours?u(!0):!n.invalidHours&&n.hours<10&&n.$apply(function(){n.hours=p(n.hours,!ht)})});n.updateMinutes=function(){var n=ft(),t=ut();s.$setDirty();angular.isDefined(n)&&angular.isDefined(t)?(o.setHours(t),o.setMinutes(n),c>o||o>l?u(void 0,!0):g("m")):u(void 0,!0)};i.on("blur",function(){s.$setTouched();st()?nt():null===n.minutes?u(void 0,!0):!n.invalidMinutes&&n.minutes<10&&n.$apply(function(){n.minutes=p(n.minutes)})});n.updateSeconds=function(){var n=ct();s.$setDirty();angular.isDefined(n)?(o.setSeconds(n),g("s")):u(void 0,void 0,!0)};r.on("blur",function(){st()?nt():!n.invalidSeconds&&n.seconds<10&&n.$apply(function(){n.seconds=p(n.seconds)})})};this.render=function(){var t=s.$viewValue;isNaN(t)?(s.$setValidity("time",!1),u.error('Timepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.')):(t&&(o=t),c>o||o>l?(s.$setValidity("time",!1),n.invalidHours=!0,n.invalidMinutes=!0):nt(),ot())};n.showSpinners=angular.isDefined(i.showSpinners)?n.$parent.$eval(i.showSpinners):e.showSpinners;n.incrementHours=function(){n.noIncrementHours()||y(3600*b)};n.decrementHours=function(){n.noDecrementHours()||y(3600*-b)};n.incrementMinutes=function(){n.noIncrementMinutes()||y(60*k)};n.decrementMinutes=function(){n.noDecrementMinutes()||y(60*-k)};n.incrementSeconds=function(){n.noIncrementSeconds()||y(d)};n.decrementSeconds=function(){n.noDecrementSeconds()||y(-d)};n.toggleMeridian=function(){var t=ft(),i=ut();n.noToggleMeridian()||(angular.isDefined(t)&&angular.isDefined(i)?y(720*(o.getHours()<12?60:-60)):n.meridian=n.meridian===v[0]?v[1]:v[0])};n.blur=function(){s.$setTouched()};n.$on("$destroy",function(){for(;a.length;)a.shift()()})}]).directive("uibTimepicker",["uibTimepickerConfig",function(n){return{require:["uibTimepicker","?^ngModel"],restrict:"A",controller:"UibTimepickerController",controllerAs:"timepicker",scope:{},templateUrl:function(t,i){return i.templateUrl||n.templateUrl},link:function(n,t,i,r){var f=r[0],u=r[1];u&&f.init(u,t.find("input"))}}}]);angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(n){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(i){var r=i.match(t);if(!r)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+i+'".');return{itemName:r[3],source:n(r[4]),viewMapper:n(r[2]||r[1]),modelMapper:n(r[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(n,t,i,r,u,f,e,o,s,h,c,l,a){function rt(){v.moveInProgress||(v.moveInProgress=!0,v.$digest());ti()}function bt(){v.position=nt?l.offset(t):l.position(t);v.position.top+=t.prop("offsetHeight")}function ri(n){var t;return angular.version.minor<6?(t=n.$options||{},t.getOption=function(n){return t[n]}):t=n.$options,t}var y,lt,ui=[9,13,27,38,40],d=n.$eval(i.typeaheadMinLength),at,g,ht,tt,p,b,ni,ct,ti,yt,ii,pt,wt,it;d||0===d||(d=1);n.$watch(i.typeaheadMinLength,function(n){d=n||0===n?n:1});at=n.$eval(i.typeaheadWaitMs)||0;g=n.$eval(i.typeaheadEditable)!==!1;n.$watch(i.typeaheadEditable,function(n){g=n!==!1});var ut,ft,et=u(i.typeaheadLoading).assign||angular.noop,fi=i.typeaheadShouldSelect?u(i.typeaheadShouldSelect):function(n,t){var i=t.$event;return 13===i.which||9===i.which},ei=u(i.typeaheadOnSelect),oi=angular.isDefined(i.typeaheadSelectOnBlur)?n.$eval(i.typeaheadSelectOnBlur):!1,ot=u(i.typeaheadNoResults).assign||angular.noop,kt=i.typeaheadInputFormatter?u(i.typeaheadInputFormatter):void 0,nt=i.typeaheadAppendToBody?n.$eval(i.typeaheadAppendToBody):!1,vt=i.typeaheadAppendTo?n.$eval(i.typeaheadAppendTo):null,si=n.$eval(i.typeaheadFocusFirst)!==!1,hi=i.typeaheadSelectOnExact?n.$eval(i.typeaheadSelectOnExact):!1,ci=u(i.typeaheadIsOpen).assign||angular.noop,st=n.$eval(i.typeaheadShowHint)||!1,dt=u(i.ngModel),li=u(i.ngModel+"($$$p)"),ai=function(t,i){return angular.isFunction(dt(n))&&lt.getOption("getterSetter")?li(t,{$$$p:i}):dt.assign(t,i)},w=a.parse(i.uibTypeahead),v=n.$new(),vi=n.$on("$destroy",function(){v.$destroy()});v.$on("$destroy",vi);ht="typeahead-"+v.$id+"-"+Math.floor(1e4*Math.random());t.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":ht});st&&(tt=angular.element("<div><\/div>"),tt.css("position","relative"),t.after(tt),p=t.clone(),p.attr("placeholder",""),p.attr("tabindex","-1"),p.val(""),p.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),t.css({position:"relative","vertical-align":"top","background-color":"transparent"}),p.attr("id")&&p.removeAttr("id"),tt.append(p),p.after(t));b=angular.element("<div uib-typeahead-popup><\/div>");b.attr({id:ht,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"});angular.isDefined(i.typeaheadTemplateUrl)&&b.attr("template-url",i.typeaheadTemplateUrl);angular.isDefined(i.typeaheadPopupTemplateUrl)&&b.attr("popup-template-url",i.typeaheadPopupTemplateUrl);var yi=function(){st&&p.val("")},k=function(){v.matches=[];v.activeIdx=-1;t.attr("aria-expanded",!1);yi()},gt=function(n){return ht+"-option-"+n};v.$watch("activeIdx",function(n){0>n?t.removeAttr("aria-activedescendant"):t.attr("aria-activedescendant",gt(n))});ni=function(n,t){return v.matches.length>t&&n?n.toUpperCase()===v.matches[t].label.toUpperCase():!1};ct=function(i,r){var u={$viewValue:i};et(n,!0);ot(n,!1);f.when(w.source(n,u)).then(function(f){var s=i===y.$viewValue,e,o;if(s&&ut)if(f&&f.length>0){for(v.activeIdx=si?0:-1,ot(n,!1),v.matches.length=0,e=0;e<f.length;e++)u[w.itemName]=f[e],v.matches.push({id:gt(e),label:w.viewMapper(v,u),model:f[e]});(v.query=i,bt(),t.attr("aria-expanded",!0),hi&&1===v.matches.length&&ni(i,0)&&(angular.isNumber(v.debounceUpdate)||angular.isObject(v.debounceUpdate)?c(function(){v.select(0,r)},angular.isNumber(v.debounceUpdate)?v.debounceUpdate:v.debounceUpdate["default"]):v.select(0,r)),st)&&(o=v.matches[0].label,angular.isString(i)&&i.length>0&&o.slice(0,i.length).toUpperCase()===i.toUpperCase()?p.val(i+o.slice(i.length)):p.val(""))}else k(),ot(n,!0);s&&et(n,!1)},function(){k();et(n,!1);ot(n,!0)})};nt&&(angular.element(s).on("resize",rt),o.find("body").on("scroll",rt));ti=c(function(){v.matches.length&&bt();v.moveInProgress=!1},200);v.moveInProgress=!1;v.query=void 0;ii=function(n){yt=e(function(){ct(n)},at)};pt=function(){yt&&e.cancel(yt)};k();v.assignIsOpen=function(t){ci(n,t)};v.select=function(r,u){var f,s,o={};ft=!0;o[w.itemName]=s=v.matches[r].model;f=w.modelMapper(n,o);ai(n,f);y.$setValidity("editable",!0);y.$setValidity("parse",!0);ei(n,{$item:s,$model:f,$label:w.viewMapper(n,o),$event:u});k();v.$eval(i.typeaheadFocusOnSelect)!==!1&&e(function(){t[0].focus()},0,!1)};t.on("keydown",function(t){var r,i;if(0!==v.matches.length&&-1!==ui.indexOf(t.which)){if(r=fi(n,{$event:t}),-1===v.activeIdx&&r||9===t.which&&t.shiftKey)return k(),void v.$digest();t.preventDefault();switch(t.which){case 27:t.stopPropagation();k();n.$digest();break;case 38:v.activeIdx=(v.activeIdx>0?v.activeIdx:v.matches.length)-1;v.$digest();i=b[0].querySelectorAll(".uib-typeahead-match")[v.activeIdx];i.parentNode.scrollTop=i.offsetTop;break;case 40:v.activeIdx=(v.activeIdx+1)%v.matches.length;v.$digest();i=b[0].querySelectorAll(".uib-typeahead-match")[v.activeIdx];i.parentNode.scrollTop=i.offsetTop;break;default:r&&v.$apply(function(){angular.isNumber(v.debounceUpdate)||angular.isObject(v.debounceUpdate)?c(function(){v.select(v.activeIdx,t)},angular.isNumber(v.debounceUpdate)?v.debounceUpdate:v.debounceUpdate["default"]):v.select(v.activeIdx,t)})}}});t.on("focus",function(n){ut=!0;0!==d||y.$viewValue||e(function(){ct(y.$viewValue,n)},0)});t.on("blur",function(n){oi&&v.matches.length&&-1!==v.activeIdx&&!ft&&(ft=!0,v.$apply(function(){angular.isObject(v.debounceUpdate)&&angular.isNumber(v.debounceUpdate.blur)?c(function(){v.select(v.activeIdx,n)},v.debounceUpdate.blur):v.select(v.activeIdx,n)}));!g&&y.$error.editable&&(y.$setViewValue(),v.$apply(function(){y.$setValidity("editable",!0);y.$setValidity("parse",!0)}),t.val(""));ut=!1;ft=!1});wt=function(i){t[0]!==i.target&&3!==i.which&&0!==v.matches.length&&(k(),h.$$phase||n.$digest())};o.on("click",wt);n.$on("$destroy",function(){o.off("click",wt);(nt||vt)&&it.remove();nt&&(angular.element(s).off("resize",rt),o.find("body").off("scroll",rt));b.remove();st&&tt.remove()});it=r(b)(v);nt?o.find("body").append(it):vt?angular.element(vt).eq(0).append(it):t.after(it);this.init=function(t){y=t;lt=ri(y);v.debounceUpdate=u(lt.getOption("debounce"))(n);y.$parsers.unshift(function(t){return ut=!0,0===d||t&&t.length>=d?at>0?(pt(),ii(t)):ct(t):(et(n,!1),pt(),k()),g?t:t?void y.$setValidity("editable",!1):(y.$setValidity("editable",!0),null)});y.$formatters.push(function(t){var r,u,i={};return g||y.$setValidity("editable",!0),kt?(i.$model=t,kt(n,i)):(i[w.itemName]=t,r=w.viewMapper(n,i),i[w.itemName]=void 0,u=w.viewMapper(n,i),r!==u?r:t)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","uibTypeahead"],link:function(n,t,i,r){r[1].init(r[0])}}}).directive("uibTypeaheadPopup",["$$debounce",function(n){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(n,t){return t.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(t,i,r){t.templateUrl=r.templateUrl;t.isOpen=function(){var n=t.matches.length>0;return t.assignIsOpen({isOpen:n}),n};t.isActive=function(n){return t.active===n};t.selectActive=function(n){t.active=n};t.selectMatch=function(i,r){var u=t.debounce();angular.isNumber(u)||angular.isObject(u)?n(function(){t.select({activeIdx:i,evt:r})},angular.isNumber(u)?u:u["default"]):t.select({activeIdx:i,evt:r})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(n,t,i){return{scope:{index:"=",match:"=",query:"="},link:function(r,u,f){var e=i(f.templateUrl)(r.$parent)||"uib/template/typeahead/typeahead-match.html";n(e).then(function(n){var i=angular.element(n.trim());u.replaceWith(i);t(i)(r)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(n,t,i){function u(n){return n.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function f(n){return/<.*>/g.test(n)}var r;return r=t.has("$sanitize"),function(t,e){return!r&&f(t)&&i.warn("Unsafe use of typeahead please use ngSanitize"),t=e?(""+t).replace(new RegExp(u(e),"gi"),"<strong>$&<\/strong>"):t,r||(t=n.trustAsHtml(t)),t}}]);angular.module("uib/template/accordion/accordion-group.html",[]).run(["$templateCache",function(n){n.put("uib/template/accordion/accordion-group.html",'<div role="tab" id="{{::headingId}}" aria-selected="{{isOpen}}" class="panel-heading" ng-keypress="toggleOpen($event)">\n  <h4 class="panel-title">\n    <a role="button" data-toggle="collapse" href aria-expanded="{{isOpen}}" aria-controls="{{::panelId}}" tabindex="0" class="accordion-toggle" ng-click="toggleOpen()" uib-accordion-transclude="heading" ng-disabled="isDisabled" uib-tabindex-toggle><span uib-accordion-header ng-class="{\'text-muted\': isDisabled}">{{heading}}<\/span><\/a>\n  <\/h4>\n<\/div>\n<div id="{{::panelId}}" aria-labelledby="{{::headingId}}" aria-hidden="{{!isOpen}}" role="tabpanel" class="panel-collapse collapse" uib-collapse="!isOpen">\n  <div class="panel-body" ng-transclude><\/div>\n<\/div>\n')}]);angular.module("uib/template/accordion/accordion.html",[]).run(["$templateCache",function(n){n.put("uib/template/accordion/accordion.html",'<div role="tablist" class="panel-group" ng-transclude><\/div>')}]);angular.module("uib/template/alert/alert.html",[]).run(["$templateCache",function(n){n.put("uib/template/alert/alert.html",'<button ng-show="closeable" type="button" class="close" ng-click="close({$event: $event})">\n  <span aria-hidden="true">&times;<\/span>\n  <span class="sr-only">Close<\/span>\n<\/button>\n<div ng-transclude><\/div>\n')}]);angular.module("uib/template/carousel/carousel.html",[]).run(["$templateCache",function(n){n.put("uib/template/carousel/carousel.html",'<div class="carousel-inner" ng-transclude><\/div>\n<a role="button" href class="left carousel-control" ng-click="prev()" ng-class="{ disabled: isPrevDisabled() }" ng-show="slides.length > 1">\n  <span aria-hidden="true" class="glyphicon glyphicon-chevron-left"><\/span>\n  <span class="sr-only">previous<\/span>\n<\/a>\n<a role="button" href class="right carousel-control" ng-click="next()" ng-class="{ disabled: isNextDisabled() }" ng-show="slides.length > 1">\n  <span aria-hidden="true" class="glyphicon glyphicon-chevron-right"><\/span>\n  <span class="sr-only">next<\/span>\n<\/a>\n<ol class="carousel-indicators" ng-show="slides.length > 1">\n  <li ng-repeat="slide in slides | orderBy:indexOfSlide track by $index" ng-class="{ active: isActive(slide) }" ng-click="select(slide)">\n    <span class="sr-only">slide {{ $index + 1 }} of {{ slides.length }}<span ng-if="isActive(slide)">, currently active<\/span><\/span>\n  <\/li>\n<\/ol>\n')}]);angular.module("uib/template/carousel/slide.html",[]).run(["$templateCache",function(n){n.put("uib/template/carousel/slide.html",'<div class="text-center" ng-transclude><\/div>\n')}]);angular.module("uib/template/datepicker/datepicker.html",[]).run(["$templateCache",function(n){n.put("uib/template/datepicker/datepicker.html",'<div ng-switch="datepickerMode">\n  <div uib-daypicker ng-switch-when="day" tabindex="0" class="uib-daypicker"><\/div>\n  <div uib-monthpicker ng-switch-when="month" tabindex="0" class="uib-monthpicker"><\/div>\n  <div uib-yearpicker ng-switch-when="year" tabindex="0" class="uib-yearpicker"><\/div>\n<\/div>\n')}]);angular.module("uib/template/datepicker/day.html",[]).run(["$templateCache",function(n){n.put("uib/template/datepicker/day.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"><\/i><span class="sr-only">previous<\/span><\/button><\/th>\n      <th colspan="{{::5 + showWeeks}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}<\/strong><\/button><\/th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"><\/i><span class="sr-only">next<\/span><\/button><\/th>\n    <\/tr>\n    <tr>\n      <th ng-if="showWeeks" class="text-center"><\/th>\n      <th ng-repeat="label in ::labels track by $index" class="text-center"><small aria-label="{{::label.full}}">{{::label.abbr}}<\/small><\/th>\n    <\/tr>\n  <\/thead>\n  <tbody>\n    <tr class="uib-weeks" ng-repeat="row in rows track by $index" role="row">\n      <td ng-if="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}<\/em><\/td>\n      <td ng-repeat="dt in row" class="uib-day text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default btn-sm"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{::dt.label}}<\/span><\/button>\n      <\/td>\n    <\/tr>\n  <\/tbody>\n<\/table>\n')}]);angular.module("uib/template/datepicker/month.html",[]).run(["$templateCache",function(n){n.put("uib/template/datepicker/month.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"><\/i><span class="sr-only">previous<\/span><\/button><\/th>\n      <th colspan="{{::yearHeaderColspan}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}<\/strong><\/button><\/th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"><\/i><span class="sr-only">next<\/span><\/i><\/button><\/th>\n    <\/tr>\n  <\/thead>\n  <tbody>\n    <tr class="uib-months" ng-repeat="row in rows track by $index" role="row">\n      <td ng-repeat="dt in row" class="uib-month text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}<\/span><\/button>\n      <\/td>\n    <\/tr>\n  <\/tbody>\n<\/table>\n')}]);angular.module("uib/template/datepicker/year.html",[]).run(["$templateCache",function(n){n.put("uib/template/datepicker/year.html",'<table role="grid" aria-labelledby="{{::uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n  <thead>\n    <tr>\n      <th><button type="button" class="btn btn-default btn-sm pull-left uib-left" ng-click="move(-1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-left"><\/i><span class="sr-only">previous<\/span><\/button><\/th>\n      <th colspan="{{::columns - 2}}"><button id="{{::uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm uib-title" ng-click="toggleMode()" ng-disabled="datepickerMode === maxMode" tabindex="-1"><strong>{{title}}<\/strong><\/button><\/th>\n      <th><button type="button" class="btn btn-default btn-sm pull-right uib-right" ng-click="move(1)" tabindex="-1"><i aria-hidden="true" class="glyphicon glyphicon-chevron-right"><\/i><span class="sr-only">next<\/span><\/button><\/th>\n    <\/tr>\n  <\/thead>\n  <tbody>\n    <tr class="uib-years" ng-repeat="row in rows track by $index" role="row">\n      <td ng-repeat="dt in row" class="uib-year text-center" role="gridcell"\n        id="{{::dt.uid}}"\n        ng-class="::dt.customClass">\n        <button type="button" class="btn btn-default"\n          uib-is-class="\n            \'btn-info\' for selectedDt,\n            \'active\' for activeDt\n            on dt"\n          ng-click="select(dt.date)"\n          ng-disabled="::dt.disabled"\n          tabindex="-1"><span ng-class="::{\'text-info\': dt.current}">{{::dt.label}}<\/span><\/button>\n      <\/td>\n    <\/tr>\n  <\/tbody>\n<\/table>\n')}]);angular.module("uib/template/datepickerPopup/popup.html",[]).run(["$templateCache",function(n){n.put("uib/template/datepickerPopup/popup.html",'<ul role="presentation" class="uib-datepicker-popup dropdown-menu uib-position-measure" dropdown-nested ng-if="isOpen" ng-keydown="keydown($event)" ng-click="$event.stopPropagation()">\n  <li ng-transclude><\/li>\n  <li ng-if="showButtonBar" class="uib-button-bar">\n    <span class="btn-group pull-left">\n      <button type="button" class="btn btn-sm btn-info uib-datepicker-current" ng-click="select(\'today\', $event)" ng-disabled="isDisabled(\'today\')">{{ getText(\'current\') }}<\/button>\n      <button type="button" class="btn btn-sm btn-danger uib-clear" ng-click="select(null, $event)">{{ getText(\'clear\') }}<\/button>\n    <\/span>\n    <button type="button" class="btn btn-sm btn-success pull-right uib-close" ng-click="close($event)">{{ getText(\'close\') }}<\/button>\n  <\/li>\n<\/ul>\n')}]);angular.module("uib/template/modal/window.html",[]).run(["$templateCache",function(n){n.put("uib/template/modal/window.html","<div class=\"modal-dialog {{size ? 'modal-' + size : ''}}\"><div class=\"modal-content\" uib-modal-transclude><\/div><\/div>\n")}]);angular.module("uib/template/pager/pager.html",[]).run(["$templateCache",function(n){n.put("uib/template/pager/pager.html",'<li ng-class="{disabled: noPrevious()||ngDisabled, previous: align}"><a href ng-click="selectPage(page - 1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'previous\')}}<\/a><\/li>\n<li ng-class="{disabled: noNext()||ngDisabled, next: align}"><a href ng-click="selectPage(page + 1, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'next\')}}<\/a><\/li>\n')}]);angular.module("uib/template/pagination/pagination.html",[]).run(["$templateCache",function(n){n.put("uib/template/pagination/pagination.html",'<li role="menuitem" ng-if="::boundaryLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-first"><a href ng-click="selectPage(1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'first\')}}<\/a><\/li>\n<li role="menuitem" ng-if="::directionLinks" ng-class="{disabled: noPrevious()||ngDisabled}" class="pagination-prev"><a href ng-click="selectPage(page - 1, $event)" ng-disabled="noPrevious()||ngDisabled" uib-tabindex-toggle>{{::getText(\'previous\')}}<\/a><\/li>\n<li role="menuitem" ng-repeat="page in pages track by $index" ng-class="{active: page.active,disabled: ngDisabled&&!page.active}" class="pagination-page"><a href ng-click="selectPage(page.number, $event)" ng-disabled="ngDisabled&&!page.active" uib-tabindex-toggle>{{page.text}}<\/a><\/li>\n<li role="menuitem" ng-if="::directionLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-next"><a href ng-click="selectPage(page + 1, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'next\')}}<\/a><\/li>\n<li role="menuitem" ng-if="::boundaryLinks" ng-class="{disabled: noNext()||ngDisabled}" class="pagination-last"><a href ng-click="selectPage(totalPages, $event)" ng-disabled="noNext()||ngDisabled" uib-tabindex-toggle>{{::getText(\'last\')}}<\/a><\/li>\n')}]);angular.module("uib/template/tooltip/tooltip-html-popup.html",[]).run(["$templateCache",function(n){n.put("uib/template/tooltip/tooltip-html-popup.html",'<div class="tooltip-arrow"><\/div>\n<div class="tooltip-inner" ng-bind-html="contentExp()"><\/div>\n')}]);angular.module("uib/template/tooltip/tooltip-popup.html",[]).run(["$templateCache",function(n){n.put("uib/template/tooltip/tooltip-popup.html",'<div class="tooltip-arrow"><\/div>\n<div class="tooltip-inner" ng-bind="content"><\/div>\n')}]);angular.module("uib/template/tooltip/tooltip-template-popup.html",[]).run(["$templateCache",function(n){n.put("uib/template/tooltip/tooltip-template-popup.html",'<div class="tooltip-arrow"><\/div>\n<div class="tooltip-inner"\n  uib-tooltip-template-transclude="contentExp()"\n  tooltip-template-transclude-scope="originScope()"><\/div>\n')}]);angular.module("uib/template/popover/popover-html.html",[]).run(["$templateCache",function(n){n.put("uib/template/popover/popover-html.html",'<div class="arrow"><\/div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"><\/h3>\n    <div class="popover-content" ng-bind-html="contentExp()"><\/div>\n<\/div>\n')}]);angular.module("uib/template/popover/popover-template.html",[]).run(["$templateCache",function(n){n.put("uib/template/popover/popover-template.html",'<div class="arrow"><\/div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"><\/h3>\n    <div class="popover-content"\n      uib-tooltip-template-transclude="contentExp()"\n      tooltip-template-transclude-scope="originScope()"><\/div>\n<\/div>\n')}]);angular.module("uib/template/popover/popover.html",[]).run(["$templateCache",function(n){n.put("uib/template/popover/popover.html",'<div class="arrow"><\/div>\n\n<div class="popover-inner">\n    <h3 class="popover-title" ng-bind="uibTitle" ng-if="uibTitle"><\/h3>\n    <div class="popover-content" ng-bind="content"><\/div>\n<\/div>\n')}]);angular.module("uib/template/progressbar/bar.html",[]).run(["$templateCache",function(n){n.put("uib/template/progressbar/bar.html",'<div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude><\/div>\n')}]);angular.module("uib/template/progressbar/progress.html",[]).run(["$templateCache",function(n){n.put("uib/template/progressbar/progress.html",'<div class="progress" ng-transclude aria-labelledby="{{::title}}"><\/div>')}]);angular.module("uib/template/progressbar/progressbar.html",[]).run(["$templateCache",function(n){n.put("uib/template/progressbar/progressbar.html",'<div class="progress">\n  <div class="progress-bar" ng-class="type && \'progress-bar-\' + type" role="progressbar" aria-valuenow="{{value}}" aria-valuemin="0" aria-valuemax="{{max}}" ng-style="{width: (percent < 100 ? percent : 100) + \'%\'}" aria-valuetext="{{percent | number:0}}%" aria-labelledby="{{::title}}" ng-transclude><\/div>\n<\/div>\n')}]);angular.module("uib/template/rating/rating.html",[]).run(["$templateCache",function(n){n.put("uib/template/rating/rating.html",'<span ng-mouseleave="reset()" ng-keydown="onKeydown($event)" tabindex="0" role="slider" aria-valuemin="0" aria-valuemax="{{range.length}}" aria-valuenow="{{value}}" aria-valuetext="{{title}}">\n    <span ng-repeat-start="r in range track by $index" class="sr-only">({{ $index < value ? \'*\' : \' \' }})<\/span>\n    <i ng-repeat-end ng-mouseenter="enter($index + 1)" ng-click="rate($index + 1)" class="glyphicon" ng-class="$index < value && (r.stateOn || \'glyphicon-star\') || (r.stateOff || \'glyphicon-star-empty\')" ng-attr-title="{{r.title}}"><\/i>\n<\/span>\n')}]);angular.module("uib/template/tabs/tab.html",[]).run(["$templateCache",function(n){n.put("uib/template/tabs/tab.html",'<li ng-class="[{active: active, disabled: disabled}, classes]" class="uib-tab nav-item">\n  <a href ng-click="select($event)" class="nav-link" uib-tab-heading-transclude>{{heading}}<\/a>\n<\/li>\n')}]);angular.module("uib/template/tabs/tabset.html",[]).run(["$templateCache",function(n){n.put("uib/template/tabs/tabset.html",'<div>\n  <ul class="nav nav-{{tabset.type || \'tabs\'}}" ng-class="{\'nav-stacked\': vertical, \'nav-justified\': justified}" ng-transclude><\/ul>\n  <div class="tab-content">\n    <div class="tab-pane"\n         ng-repeat="tab in tabset.tabs"\n         ng-class="{active: tabset.active === tab.index}"\n         uib-tab-content-transclude="tab">\n    <\/div>\n  <\/div>\n<\/div>\n')}]);angular.module("uib/template/timepicker/timepicker.html",[]).run(["$templateCache",function(n){n.put("uib/template/timepicker/timepicker.html",'<table class="uib-timepicker">\n  <tbody>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-increment hours"><a ng-click="incrementHours()" ng-class="{disabled: noIncrementHours()}" class="btn btn-link" ng-disabled="noIncrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"><\/span><\/a><\/td>\n      <td>&nbsp;<\/td>\n      <td class="uib-increment minutes"><a ng-click="incrementMinutes()" ng-class="{disabled: noIncrementMinutes()}" class="btn btn-link" ng-disabled="noIncrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"><\/span><\/a><\/td>\n      <td ng-show="showSeconds">&nbsp;<\/td>\n      <td ng-show="showSeconds" class="uib-increment seconds"><a ng-click="incrementSeconds()" ng-class="{disabled: noIncrementSeconds()}" class="btn btn-link" ng-disabled="noIncrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-up"><\/span><\/a><\/td>\n      <td ng-show="showMeridian"><\/td>\n    <\/tr>\n    <tr>\n      <td class="form-group uib-time hours" ng-class="{\'has-error\': invalidHours}">\n        <input type="text" placeholder="HH" ng-model="hours" ng-change="updateHours()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementHours()" ng-blur="blur()">\n      <\/td>\n      <td class="uib-separator">:<\/td>\n      <td class="form-group uib-time minutes" ng-class="{\'has-error\': invalidMinutes}">\n        <input type="text" placeholder="MM" ng-model="minutes" ng-change="updateMinutes()" class="form-control text-center" ng-readonly="::readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementMinutes()" ng-blur="blur()">\n      <\/td>\n      <td ng-show="showSeconds" class="uib-separator">:<\/td>\n      <td class="form-group uib-time seconds" ng-class="{\'has-error\': invalidSeconds}" ng-show="showSeconds">\n        <input type="text" placeholder="SS" ng-model="seconds" ng-change="updateSeconds()" class="form-control text-center" ng-readonly="readonlyInput" maxlength="2" tabindex="{{::tabindex}}" ng-disabled="noIncrementSeconds()" ng-blur="blur()">\n      <\/td>\n      <td ng-show="showMeridian" class="uib-time am-pm"><button type="button" ng-class="{disabled: noToggleMeridian()}" class="btn btn-default text-center" ng-click="toggleMeridian()" ng-disabled="noToggleMeridian()" tabindex="{{::tabindex}}">{{meridian}}<\/button><\/td>\n    <\/tr>\n    <tr class="text-center" ng-show="::showSpinners">\n      <td class="uib-decrement hours"><a ng-click="decrementHours()" ng-class="{disabled: noDecrementHours()}" class="btn btn-link" ng-disabled="noDecrementHours()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"><\/span><\/a><\/td>\n      <td>&nbsp;<\/td>\n      <td class="uib-decrement minutes"><a ng-click="decrementMinutes()" ng-class="{disabled: noDecrementMinutes()}" class="btn btn-link" ng-disabled="noDecrementMinutes()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"><\/span><\/a><\/td>\n      <td ng-show="showSeconds">&nbsp;<\/td>\n      <td ng-show="showSeconds" class="uib-decrement seconds"><a ng-click="decrementSeconds()" ng-class="{disabled: noDecrementSeconds()}" class="btn btn-link" ng-disabled="noDecrementSeconds()" tabindex="-1"><span class="glyphicon glyphicon-chevron-down"><\/span><\/a><\/td>\n      <td ng-show="showMeridian"><\/td>\n    <\/tr>\n  <\/tbody>\n<\/table>\n')}]);angular.module("uib/template/typeahead/typeahead-match.html",[]).run(["$templateCache",function(n){n.put("uib/template/typeahead/typeahead-match.html",'<a href\n   tabindex="-1"\n   ng-bind-html="match.label | uibTypeaheadHighlight:query"\n   ng-attr-title="{{match.label}}"><\/a>\n')}]);angular.module("uib/template/typeahead/typeahead-popup.html",[]).run(["$templateCache",function(n){n.put("uib/template/typeahead/typeahead-popup.html",'<ul class="dropdown-menu" ng-show="isOpen() && !moveInProgress" ng-style="{top: position().top+\'px\', left: position().left+\'px\'}" role="listbox" aria-hidden="{{!isOpen()}}">\n    <li class="uib-typeahead-match" ng-repeat="match in matches track by $index" ng-class="{active: isActive($index) }" ng-mouseenter="selectActive($index)" ng-click="selectMatch($index, $event)" role="option" id="{{::match.id}}">\n        <div uib-typeahead-match index="$index" match="match" query="query" template-url="templateUrl"><\/div>\n    <\/li>\n<\/ul>\n')}]);angular.module("ui.bootstrap.carousel").run(function(){angular.$$csp().noInlineStyle||angular.$$uibCarouselCss||angular.element(document).find("head").prepend('<style type="text/css">.ng-animate.item:not(.left):not(.right){-webkit-transition:0s ease-in-out left;transition:0s ease-in-out left}<\/style>');angular.$$uibCarouselCss=!0});angular.module("ui.bootstrap.datepicker").run(function(){angular.$$csp().noInlineStyle||angular.$$uibDatepickerCss||angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker .uib-title{width:100%;}.uib-day button,.uib-month button,.uib-year button{min-width:100%;}.uib-left,.uib-right{width:100%}<\/style>');angular.$$uibDatepickerCss=!0});angular.module("ui.bootstrap.position").run(function(){angular.$$csp().noInlineStyle||angular.$$uibPositionCss||angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}<\/style>');angular.$$uibPositionCss=!0});angular.module("ui.bootstrap.datepickerPopup").run(function(){angular.$$csp().noInlineStyle||angular.$$uibDatepickerpopupCss||angular.element(document).find("head").prepend('<style type="text/css">.uib-datepicker-popup.dropdown-menu{display:block;float:none;margin:0;}.uib-button-bar{padding:10px 9px 2px;}<\/style>');angular.$$uibDatepickerpopupCss=!0});angular.module("ui.bootstrap.tooltip").run(function(){angular.$$csp().noInlineStyle||angular.$$uibTooltipCss||angular.element(document).find("head").prepend('<style type="text/css">[uib-tooltip-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-html-popup].tooltip.right-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.top-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-left > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.bottom-right > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.left-bottom > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-top > .tooltip-arrow,[uib-tooltip-template-popup].tooltip.right-bottom > .tooltip-arrow,[uib-popover-popup].popover.top-left > .arrow,[uib-popover-popup].popover.top-right > .arrow,[uib-popover-popup].popover.bottom-left > .arrow,[uib-popover-popup].popover.bottom-right > .arrow,[uib-popover-popup].popover.left-top > .arrow,[uib-popover-popup].popover.left-bottom > .arrow,[uib-popover-popup].popover.right-top > .arrow,[uib-popover-popup].popover.right-bottom > .arrow,[uib-popover-html-popup].popover.top-left > .arrow,[uib-popover-html-popup].popover.top-right > .arrow,[uib-popover-html-popup].popover.bottom-left > .arrow,[uib-popover-html-popup].popover.bottom-right > .arrow,[uib-popover-html-popup].popover.left-top > .arrow,[uib-popover-html-popup].popover.left-bottom > .arrow,[uib-popover-html-popup].popover.right-top > .arrow,[uib-popover-html-popup].popover.right-bottom > .arrow,[uib-popover-template-popup].popover.top-left > .arrow,[uib-popover-template-popup].popover.top-right > .arrow,[uib-popover-template-popup].popover.bottom-left > .arrow,[uib-popover-template-popup].popover.bottom-right > .arrow,[uib-popover-template-popup].popover.left-top > .arrow,[uib-popover-template-popup].popover.left-bottom > .arrow,[uib-popover-template-popup].popover.right-top > .arrow,[uib-popover-template-popup].popover.right-bottom > .arrow{top:auto;bottom:auto;left:auto;right:auto;margin:0;}[uib-popover-popup].popover,[uib-popover-html-popup].popover,[uib-popover-template-popup].popover{display:block !important;}<\/style>');angular.$$uibTooltipCss=!0});angular.module("ui.bootstrap.timepicker").run(function(){angular.$$csp().noInlineStyle||angular.$$uibTimepickerCss||angular.element(document).find("head").prepend('<style type="text/css">.uib-time input{width:50px;}<\/style>');angular.$$uibTimepickerCss=!0});angular.module("ui.bootstrap.typeahead").run(function(){angular.$$csp().noInlineStyle||angular.$$uibTypeaheadCss||angular.element(document).find("head").prepend('<style type="text/css">[uib-typeahead-popup].dropdown-menu{display:block;}<\/style>');angular.$$uibTypeaheadCss=!0}),function(){function i(){return{require:"ngModel",link:r}}function r(n,i,r,u){u.$validators.multipleEmailValidator=function(n,i){var r=!0,f;return u.$isEmpty(i)||(f=i.split(/,|;/g),angular.forEach(f,function(n){t.test(n.trim())||(r=!1)})),r}}var n,t;Array.prototype.removeIf=function(n){for(var t=this.length;t--;)n(this[t],t)&&this.splice(t,1)};angular.module("bookingApp",["ui.bootstrap","ngSanitize","ngAutocomplete","pickadate","fk.eternicode-datepicker","icheck","ngFileUpload","ui.select","summernote","daterangepicker","angularPayments","ngVis"]);n=angular.module("bookingApp");n.filter("propsFilter",function(){return function(n,t){var i=[],r;return angular.isArray(n)?(r=Object.keys(t),n.forEach(function(n){for(var f,o,e=!1,u=0;u<r.length;u++)if(f=r[u],o=t[f].toLowerCase(),n[f].toString().toLowerCase().indexOf(o)!==-1){e=!0;break}e&&i.push(n)})):i=n,i}});n.filter("ifEmpty",function(){return function(n,t){return angular.isUndefined(n)||n===null||n===""?t:n}});n.filter("trusted",["$sce",function(n){return function(t){return n.trustAsResourceUrl(t)}}]);n.filter("trustAsHtml",["$sce",function(n){return n.trustAsHtml}]);t=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;n.directive("multipleEmailValidator",i)}(),function(n,t){var o=function(n){return n},b=function(){return!0},f=function(){},v=typeof t,w={"":o},r={createLambda:function(n){var r,t,i,u,f;if(null==n)return o;if("string"==typeof n){if(t=w[n],null!=t)return t;if(-1===n.indexOf("=>")){for(r=RegExp("[$]+","g"),t=0;null!=(i=r.exec(n));)i=i[0].length,i>t&&(t=i);for(r=[],i=1;i<=t;i++){for(u="",f=0;f<i;f++)u+="$";r.push(u)}t=Array.prototype.join.call(r,",");t=new Function(t,"return "+n)}else t=n.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/),t=new Function(t[1],"return "+t[2]);return w[n]=t}return n},isIEnumerable:function(n){if(typeof Enumerator!==v)try{return new Enumerator(n),!0}catch(t){}return!1},defineProperty:null!=Object.defineProperties?function(n,t,i){Object.defineProperty(n,t,{enumerable:!1,configurable:!0,writable:!0,value:i})}:function(n,t,i){n[t]=i},compare:function(n,t){return n===t?0:n>t?1:-1},dispose:function(n){null!=n&&n.dispose()}},u=function(n,t,i){var u=new k,r=0;this.current=u.current;this.moveNext=function(){try{switch(r){case 0:r=1;n();case 1:return t.apply(u)?!0:(this.dispose(),!1);case 2:return!1}}catch(i){throw this.dispose(),i;}};this.dispose=function(){if(1==r)try{i()}finally{r=2}}},k=function(){var n=null;this.current=function(){return n};this.yieldReturn=function(t){return n=t,!0};this.yieldBreak=function(){return!1}},i=function(n){this.getEnumerator=n},s,l,y,e,h,c;i.Utils={};i.Utils.createLambda=function(n){return r.createLambda(n)};i.Utils.createEnumerable=function(n){return new i(n)};i.Utils.createEnumerator=function(n,t,i){return new u(n,t,i)};i.Utils.extendTo=function(n){var u=n.prototype,t,f;n===Array?(n=e.prototype,r.defineProperty(u,"getSource",function(){return this})):(n=i.prototype,r.defineProperty(u,"getEnumerator",function(){return i.from(this).getEnumerator()}));for(t in n)if(f=n[t],u[t]!=f){if(null!=u[t]&&(t+="ByLinq",u[t]==f))continue;f instanceof Function&&r.defineProperty(u,t,f)}};i.choice=function(){var n=arguments;return new i(function(){return new u(function(){n=n[0]instanceof Array?n[0]:null!=n[0].getEnumerator?n[0].toArray():n},function(){return this.yieldReturn(n[Math.floor(Math.random()*n.length)])},f)})};i.cycle=function(){var n=arguments;return new i(function(){var t=0;return new u(function(){n=n[0]instanceof Array?n[0]:null!=n[0].getEnumerator?n[0].toArray():n},function(){return t>=n.length&&(t=0),this.yieldReturn(n[t++])},f)})};i.empty=function(){return new i(function(){return new u(f,function(){return!1},f)})};i.from=function(n){if(null==n)return i.empty();if(n instanceof i)return n;if("number"==typeof n||"boolean"==typeof n)return i.repeat(n,1);if("string"==typeof n)return new i(function(){var t=0;return new u(f,function(){return t<n.length?this.yieldReturn(n.charAt(t++)):!1},f)});if("function"!=typeof n){if("number"==typeof n.length)return new e(n);if(!(n instanceof Object)&&r.isIEnumerable(n))return new i(function(){var i=!0,t;return new u(function(){t=new Enumerator(n)},function(){return i?i=!1:t.moveNext(),t.atEnd()?!1:this.yieldReturn(t.item())},f)});if("object"==typeof Windows&&"function"==typeof n.first)return new i(function(){var i=!0,t;return new u(function(){t=n.first()},function(){return i?i=!1:t.moveNext(),t.hasCurrent?this.yieldReturn(t.current):this.yieldBreak()},f)})}return new i(function(){var t=[],i=0;return new u(function(){var i,r;for(i in n)r=n[i],r instanceof Function||!Object.prototype.hasOwnProperty.call(n,i)||t.push({key:i,value:r})},function(){return i<t.length?this.yieldReturn(t[i++]):!1},f)})};i.make=function(n){return i.repeat(n,1)};i.matches=function(n,t,r){return null==r&&(r=""),t instanceof RegExp&&(r+=t.ignoreCase?"i":"",r+=t.multiline?"m":"",t=t.source),-1===r.indexOf("g")&&(r+="g"),new i(function(){var i;return new u(function(){i=RegExp(t,r)},function(){var t=i.exec(n);return t?this.yieldReturn(t):!1},f)})};i.range=function(n,t,r){return null==r&&(r=1),new i(function(){var i,e=0;return new u(function(){i=n-r},function(){return e++<t?this.yieldReturn(i+=r):this.yieldBreak()},f)})};i.rangeDown=function(n,t,r){return null==r&&(r=1),new i(function(){var i,e=0;return new u(function(){i=n+r},function(){return e++<t?this.yieldReturn(i-=r):this.yieldBreak()},f)})};i.rangeTo=function(n,t,r){return null==r&&(r=1),n<t?new i(function(){var i;return new u(function(){i=n-r},function(){var n=i+=r;return n<=t?this.yieldReturn(n):this.yieldBreak()},f)}):new i(function(){var i;return new u(function(){i=n+r},function(){var n=i-=r;return n>=t?this.yieldReturn(n):this.yieldBreak()},f)})};i.repeat=function(n,t){return null!=t?i.repeat(n).take(t):new i(function(){return new u(f,function(){return this.yieldReturn(n)},f)})};i.repeatWithFinalize=function(n,t){return n=r.createLambda(n),t=r.createLambda(t),new i(function(){var i;return new u(function(){i=n()},function(){return this.yieldReturn(i)},function(){null!=i&&(t(i),i=null)})})};i.generate=function(n,t){return null!=t?i.generate(n).take(t):(n=r.createLambda(n),new i(function(){return new u(f,function(){return this.yieldReturn(n())},f)}))};i.toInfinity=function(n,t){return null==n&&(n=0),null==t&&(t=1),new i(function(){var i;return new u(function(){i=n-t},function(){return this.yieldReturn(i+=t)},f)})};i.toNegativeInfinity=function(n,t){return null==n&&(n=0),null==t&&(t=1),new i(function(){var i;return new u(function(){i=n+t},function(){return this.yieldReturn(i-=t)},f)})};i.unfold=function(n,t){return t=r.createLambda(t),new i(function(){var r=!0,i;return new u(f,function(){return r?(r=!1,i=n,this.yieldReturn(i)):(i=t(i),this.yieldReturn(i))},f)})};i.defer=function(n){return new i(function(){var t;return new u(function(){t=i.from(n()).getEnumerator()},function(){return t.moveNext()?this.yieldReturn(t.current()):this.yieldBreak()},function(){r.dispose(t)})})};i.prototype.traverseBreadthFirst=function(n,t){var f=this;return n=r.createLambda(n),t=r.createLambda(t),new i(function(){var e,s=0,o=[];return new u(function(){e=f.getEnumerator()},function(){for(;;){if(e.moveNext())return o.push(e.current()),this.yieldReturn(t(e.current(),s));var u=i.from(o).selectMany(function(t){return n(t)});if(u.any())s++,o=[],r.dispose(e),e=u.getEnumerator();else return!1}},function(){r.dispose(e)})})};i.prototype.traverseDepthFirst=function(n,t){var f=this;return n=r.createLambda(n),t=r.createLambda(t),new i(function(){var o=[],e;return new u(function(){e=f.getEnumerator()},function(){for(;;){if(e.moveNext()){var u=t(e.current(),o.length);return o.push(e),e=i.from(n(e.current())).getEnumerator(),this.yieldReturn(u)}if(0>=o.length)return!1;r.dispose(e);e=o.pop()}},function(){try{r.dispose(e)}finally{i.from(o).forEach(function(n){n.dispose()})}})})};i.prototype.flatten=function(){var n=this;return new i(function(){var f,t=null;return new u(function(){f=n.getEnumerator()},function(){for(;;){if(null!=t){if(t.moveNext())return this.yieldReturn(t.current());t=null}if(f.moveNext())if(f.current()instanceof Array){r.dispose(t);t=i.from(f.current()).selectMany(o).flatten().getEnumerator();continue}else return this.yieldReturn(f.current());return!1}},function(){try{r.dispose(f)}finally{r.dispose(t)}})})};i.prototype.pairwise=function(n){var t=this;return n=r.createLambda(n),new i(function(){var i;return new u(function(){i=t.getEnumerator();i.moveNext()},function(){var t=i.current();return i.moveNext()?this.yieldReturn(n(t,i.current())):!1},function(){r.dispose(i)})})};i.prototype.scan=function(n,t){var f,e;return null==t?(t=r.createLambda(n),f=!1):(t=r.createLambda(t),f=!0),e=this,new i(function(){var i,o,s=!0;return new u(function(){i=e.getEnumerator()},function(){if(s){if(s=!1,f)return this.yieldReturn(o=n);if(i.moveNext())return this.yieldReturn(o=i.current())}return i.moveNext()?this.yieldReturn(o=t(o,i.current())):!1},function(){r.dispose(i)})})};i.prototype.select=function(n){if(n=r.createLambda(n),1>=n.length)return new c(this,null,n);var t=this;return new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){return i.moveNext()?this.yieldReturn(n(i.current(),f++)):!1},function(){r.dispose(i)})})};i.prototype.selectMany=function(n,f){var e=this;return n=r.createLambda(n),null==f&&(f=function(n,t){return t}),f=r.createLambda(f),new i(function(){var s,o=t,h=0;return new u(function(){s=e.getEnumerator()},function(){if(o===t&&!s.moveNext())return!1;do{if(null==o){var u=n(s.current(),h++);o=i.from(u).getEnumerator()}if(o.moveNext())return this.yieldReturn(f(s.current(),o.current()));r.dispose(o);o=null}while(s.moveNext());return!1},function(){try{r.dispose(s)}finally{r.dispose(o)}})})};i.prototype.where=function(n){if(n=r.createLambda(n),1>=n.length)return new h(this,n);var t=this;return new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){for(;i.moveNext();)if(n(i.current(),f++))return this.yieldReturn(i.current());return!1},function(){r.dispose(i)})})};i.prototype.choose=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){for(;i.moveNext();){var t=n(i.current(),f++);if(null!=t)return this.yieldReturn(t)}return this.yieldBreak()},function(){r.dispose(i)})})};i.prototype.ofType=function(n){var t;switch(n){case Number:t="number";break;case String:t="string";break;case Boolean:t="boolean";break;case Function:t="function";break;default:t=null}return null===t?this.where(function(t){return t instanceof n}):this.where(function(n){return typeof n===t})};i.prototype.zip=function(){var e=arguments,n=r.createLambda(arguments[arguments.length-1]),t=this,f;return 2==arguments.length?(f=arguments[0],new i(function(){var e,o,s=0;return new u(function(){e=t.getEnumerator();o=i.from(f).getEnumerator()},function(){return e.moveNext()&&o.moveNext()?this.yieldReturn(n(e.current(),o.current(),s++)):!1},function(){try{r.dispose(e)}finally{r.dispose(o)}})})):new i(function(){var f,o=0;return new u(function(){var n=i.make(t).concat(i.from(e).takeExceptLast().select(i.from)).select(function(n){return n.getEnumerator()}).toArray();f=i.from(n)},function(){if(f.all(function(n){return n.moveNext()})){var t=f.select(function(n){return n.current()}).toArray();return t.push(o++),this.yieldReturn(n.apply(null,t))}return this.yieldBreak()},function(){i.from(f).forEach(r.dispose)})})};i.prototype.merge=function(){var n=arguments,t=this;return new i(function(){var f,e=-1;return new u(function(){f=i.make(t).concat(i.from(n).select(i.from)).select(function(n){return n.getEnumerator()}).toArray()},function(){for(;0<f.length;){e=e>=f.length-1?0:e+1;var n=f[e];if(n.moveNext())return this.yieldReturn(n.current());n.dispose();f.splice(e--,1)}return this.yieldBreak()},function(){i.from(f).forEach(r.dispose)})})};i.prototype.join=function(n,f,e,s,h){f=r.createLambda(f);e=r.createLambda(e);s=r.createLambda(s);h=r.createLambda(h);var c=this;return new i(function(){var l,v,a=null,y=0;return new u(function(){l=c.getEnumerator();v=i.from(n).toLookup(e,o,h)},function(){for(;;){if(null!=a){var n=a[y++];if(n!==t)return this.yieldReturn(s(l.current(),n));y=0}if(l.moveNext())n=f(l.current()),a=v.get(n).toArray();else return!1}},function(){r.dispose(l)})})};i.prototype.groupJoin=function(n,t,f,e,s){t=r.createLambda(t);f=r.createLambda(f);e=r.createLambda(e);s=r.createLambda(s);var h=this;return new i(function(){var c=h.getEnumerator(),l=null;return new u(function(){c=h.getEnumerator();l=i.from(n).toLookup(f,o,s)},function(){if(c.moveNext()){var n=l.get(t(c.current()));return this.yieldReturn(e(c.current(),n))}return!1},function(){r.dispose(c)})})};i.prototype.all=function(n){n=r.createLambda(n);var t=!0;return this.forEach(function(i){if(!n(i))return t=!1}),t};i.prototype.any=function(n){n=r.createLambda(n);var t=this.getEnumerator();try{if(0==arguments.length)return t.moveNext();for(;t.moveNext();)if(n(t.current()))return!0;return!1}finally{r.dispose(t)}};i.prototype.isEmpty=function(){return!this.any()};i.prototype.concat=function(){var n=this,t,f;return 1==arguments.length?(t=arguments[0],new i(function(){var e,f;return new u(function(){e=n.getEnumerator()},function(){if(null==f){if(e.moveNext())return this.yieldReturn(e.current());f=i.from(t).getEnumerator()}return f.moveNext()?this.yieldReturn(f.current()):!1},function(){try{r.dispose(e)}finally{r.dispose(f)}})})):(f=arguments,new i(function(){var t;return new u(function(){t=i.make(n).concat(i.from(f).select(i.from)).select(function(n){return n.getEnumerator()}).toArray()},function(){for(;0<t.length;){var n=t[0];if(n.moveNext())return this.yieldReturn(n.current());n.dispose();t.splice(0,1)}return this.yieldBreak()},function(){i.from(t).forEach(r.dispose)})}))};i.prototype.insert=function(n,t){var f=this;return new i(function(){var o,e,s=0,h=!1;return new u(function(){o=f.getEnumerator();e=i.from(t).getEnumerator()},function(){return s==n&&e.moveNext()?(h=!0,this.yieldReturn(e.current())):o.moveNext()?(s++,this.yieldReturn(o.current())):!h&&e.moveNext()?this.yieldReturn(e.current()):!1},function(){try{r.dispose(o)}finally{r.dispose(e)}})})};i.prototype.alternate=function(n){var t=this;return new i(function(){var f,e,s,o;return new u(function(){s=n instanceof Array||null!=n.getEnumerator?i.from(i.from(n).toArray()):i.make(n);e=t.getEnumerator();e.moveNext()&&(f=e.current())},function(){for(;;){if(null!=o){if(o.moveNext())return this.yieldReturn(o.current());o=null}if(null==f&&e.moveNext())f=e.current(),o=s.getEnumerator();else{if(null!=f){var n=f;return f=null,this.yieldReturn(n)}return this.yieldBreak()}}},function(){try{r.dispose(e)}finally{r.dispose(o)}})})};i.prototype.contains=function(n,t){t=r.createLambda(t);var i=this.getEnumerator();try{for(;i.moveNext();)if(t(i.current())===n)return!0;return!1}finally{r.dispose(i)}};i.prototype.defaultIfEmpty=function(n){var f=this;return n===t&&(n=null),new i(function(){var t,i=!0;return new u(function(){t=f.getEnumerator()},function(){return t.moveNext()?(i=!1,this.yieldReturn(t.current())):i?(i=!1,this.yieldReturn(n)):!1},function(){r.dispose(t)})})};i.prototype.distinct=function(n){return this.except(i.empty(),n)};i.prototype.distinctUntilChanged=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i,f,e;return new u(function(){i=t.getEnumerator()},function(){for(;i.moveNext();){var t=n(i.current());if(e)return e=!1,f=t,this.yieldReturn(i.current());if(f!==t)return f=t,this.yieldReturn(i.current())}return this.yieldBreak()},function(){r.dispose(i)})})};i.prototype.except=function(n,t){t=r.createLambda(t);var f=this;return new i(function(){var e,o;return new u(function(){e=f.getEnumerator();o=new a(t);i.from(n).forEach(function(n){o.add(n)})},function(){for(;e.moveNext();){var n=e.current();if(!o.contains(n))return o.add(n),this.yieldReturn(n)}return!1},function(){r.dispose(e)})})};i.prototype.intersect=function(n,t){t=r.createLambda(t);var f=this;return new i(function(){var e,o,s;return new u(function(){e=f.getEnumerator();o=new a(t);i.from(n).forEach(function(n){o.add(n)});s=new a(t)},function(){for(;e.moveNext();){var n=e.current();if(!s.contains(n)&&o.contains(n))return s.add(n),this.yieldReturn(n)}return!1},function(){r.dispose(e)})})};i.prototype.sequenceEqual=function(n,t){var f,u;t=r.createLambda(t);f=this.getEnumerator();try{u=i.from(n).getEnumerator();try{for(;f.moveNext();)if(!u.moveNext()||t(f.current())!==t(u.current()))return!1;return u.moveNext()?!1:!0}finally{r.dispose(u)}}finally{r.dispose(f)}};i.prototype.union=function(n,f){f=r.createLambda(f);var e=this;return new i(function(){var h,o,s;return new u(function(){h=e.getEnumerator();s=new a(f)},function(){var r;if(o===t){for(;h.moveNext();)if(r=h.current(),!s.contains(r))return s.add(r),this.yieldReturn(r);o=i.from(n).getEnumerator()}for(;o.moveNext();)if(r=o.current(),!s.contains(r))return s.add(r),this.yieldReturn(r);return!1},function(){try{r.dispose(h)}finally{r.dispose(o)}})})};i.prototype.orderBy=function(n){return new s(this,n,!1)};i.prototype.orderByDescending=function(n){return new s(this,n,!0)};i.prototype.reverse=function(){var n=this;return new i(function(){var t,i;return new u(function(){t=n.toArray();i=t.length},function(){return 0<i?this.yieldReturn(t[--i]):!1},f)})};i.prototype.shuffle=function(){var n=this;return new i(function(){var t;return new u(function(){t=n.toArray()},function(){if(0<t.length){var n=Math.floor(Math.random()*t.length);return this.yieldReturn(t.splice(n,1)[0])}return!1},f)})};i.prototype.weightedSample=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i,r=0;return new u(function(){i=t.choose(function(t){var i=n(t);return 0>=i?null:(r+=i,{value:t,bound:r})}).toArray()},function(){var t;if(0<i.length){for(var f=Math.floor(Math.random()*r)+1,u=-1,n=i.length;1<n-u;)t=Math.floor((u+n)/2),i[t].bound>=f?n=t:u=t;return this.yieldReturn(i[n].value)}return this.yieldBreak()},f)})};i.prototype.groupBy=function(n,t,f,e){var o=this;return n=r.createLambda(n),t=r.createLambda(t),null!=f&&(f=r.createLambda(f)),e=r.createLambda(e),new i(function(){var i;return new u(function(){i=o.toLookup(n,t,e).toEnumerable().getEnumerator()},function(){for(;i.moveNext();)return null==f?this.yieldReturn(i.current()):this.yieldReturn(f(i.current().key(),i.current()));return!1},function(){r.dispose(i)})})};i.prototype.partitionBy=function(n,t,f,e){var s=this,o;return n=r.createLambda(n),t=r.createLambda(t),e=r.createLambda(e),null==f?(o=!1,f=function(n,t){return new p(n,t)}):(o=!0,f=r.createLambda(f)),new i(function(){var h,l,a,c=[];return new u(function(){h=s.getEnumerator();h.moveNext()&&(l=n(h.current()),a=e(l),c.push(t(h.current())))},function(){for(var r,u;!0==(r=h.moveNext());)if(a===e(n(h.current())))c.push(t(h.current()));else break;return 0<c.length?(u=o?f(l,i.from(c)):f(l,c),r?(l=n(h.current()),a=e(l),c=[t(h.current())]):c=[],this.yieldReturn(u)):!1},function(){r.dispose(h)})})};i.prototype.buffer=function(n){var t=this;return new i(function(){var i;return new u(function(){i=t.getEnumerator()},function(){for(var t=[],r=0;i.moveNext();)if(t.push(i.current()),++r>=n)return this.yieldReturn(t);return 0<t.length?this.yieldReturn(t):!1},function(){r.dispose(i)})})};i.prototype.aggregate=function(n,t,i){return i=r.createLambda(i),i(this.scan(n,t,i).last())};i.prototype.average=function(n){n=r.createLambda(n);var t=0,i=0;return this.forEach(function(r){t+=n(r);++i}),t/i};i.prototype.count=function(n){n=null==n?b:r.createLambda(n);var t=0;return this.forEach(function(i,r){n(i,r)&&++t}),t};i.prototype.max=function(n){return null==n&&(n=o),this.select(n).aggregate(function(n,t){return n>t?n:t})};i.prototype.min=function(n){return null==n&&(n=o),this.select(n).aggregate(function(n,t){return n<t?n:t})};i.prototype.maxBy=function(n){return n=r.createLambda(n),this.aggregate(function(t,i){return n(t)>n(i)?t:i})};i.prototype.minBy=function(n){return n=r.createLambda(n),this.aggregate(function(t,i){return n(t)<n(i)?t:i})};i.prototype.sum=function(n){return null==n&&(n=o),this.select(n).aggregate(0,function(n,t){return n+t})};i.prototype.elementAt=function(n){var t,i=!1;if(this.forEach(function(r,u){if(u==n)return t=r,i=!0,!1}),!i)throw Error("index is less than 0 or greater than or equal to the number of elements in source.");return t};i.prototype.elementAtOrDefault=function(n,i){i===t&&(i=null);var r,u=!1;return this.forEach(function(t,i){if(i==n)return r=t,u=!0,!1}),u?r:i};i.prototype.first=function(n){if(null!=n)return this.where(n).first();var t,i=!1;if(this.forEach(function(n){return t=n,i=!0,!1}),!i)throw Error("first:No element satisfies the condition.");return t};i.prototype.firstOrDefault=function(n,t){if(n){if("function"==typeof n||"function"==typeof r.createLambda(n))return this.where(n).firstOrDefault(null,t);t=n}t=t||null;var i,u=!1;return this.forEach(function(n){return i=n,u=!0,!1}),u?i:t};i.prototype.last=function(n){if(null!=n)return this.where(n).last();var t,i=!1;if(this.forEach(function(n){i=!0;t=n}),!i)throw Error("last:No element satisfies the condition.");return t};i.prototype.lastOrDefault=function(n,t){if(n){if("function"==typeof n||"function"==typeof r.createLambda(n))return this.where(n).lastOrDefault(null,t);t=n}t=t||null;var i,u=!1;return this.forEach(function(n){u=!0;i=n}),u?i:t};i.prototype.single=function(n){if(null!=n)return this.where(n).single();var i,t=!1;if(this.forEach(function(n){if(t)throw Error("single:sequence contains more than one element.");t=!0;i=n}),!t)throw Error("single:No element satisfies the condition.");return i};i.prototype.singleOrDefault=function(n,i){if(i===t&&(i=null),null!=n)return this.where(n).singleOrDefault(null,i);var u,r=!1;return this.forEach(function(n){if(r)throw Error("single:sequence contains more than one element.");r=!0;u=n}),r?u:i};i.prototype.skip=function(n){var t=this;return new i(function(){var i,f=0;return new u(function(){for(i=t.getEnumerator();f++<n&&i.moveNext(););},function(){return i.moveNext()?this.yieldReturn(i.current()):!1},function(){r.dispose(i)})})};i.prototype.skipWhile=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i,e=0,f=!1;return new u(function(){i=t.getEnumerator()},function(){for(;!f;)if(i.moveNext()){if(!n(i.current(),e++))return f=!0,this.yieldReturn(i.current())}else return!1;return i.moveNext()?this.yieldReturn(i.current()):!1},function(){r.dispose(i)})})};i.prototype.take=function(n){var t=this;return new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){return f++<n&&i.moveNext()?this.yieldReturn(i.current()):!1},function(){r.dispose(i)})})};i.prototype.takeWhile=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){return i.moveNext()&&n(i.current(),f++)?this.yieldReturn(i.current()):!1},function(){r.dispose(i)})})};i.prototype.takeExceptLast=function(n){null==n&&(n=1);var t=this;return new i(function(){if(0>=n)return t.getEnumerator();var i,f=[];return new u(function(){i=t.getEnumerator()},function(){for(;i.moveNext();){if(f.length==n)return f.push(i.current()),this.yieldReturn(f.shift());f.push(i.current())}return!1},function(){r.dispose(i)})})};i.prototype.takeFromLast=function(n){if(0>=n||null==n)return i.empty();var t=this;return new i(function(){var o,f,e=[];return new u(function(){o=t.getEnumerator()},function(){for(;o.moveNext();)e.length==n&&e.shift(),e.push(o.current());return null==f&&(f=i.from(e).getEnumerator()),f.moveNext()?this.yieldReturn(f.current()):!1},function(){r.dispose(f)})})};i.prototype.indexOf=function(n){var t=null;return"function"==typeof n?this.forEach(function(i,r){if(n(i,r))return t=r,!1}):this.forEach(function(i,r){if(i===n)return t=r,!1}),null!==t?t:-1};i.prototype.lastIndexOf=function(n){var t=-1;return"function"==typeof n?this.forEach(function(i,r){n(i,r)&&(t=r)}):this.forEach(function(i,r){i===n&&(t=r)}),t};i.prototype.cast=function(){return this};i.prototype.asEnumerable=function(){return i.from(this)};i.prototype.toArray=function(){var n=[];return this.forEach(function(t){n.push(t)}),n};i.prototype.toLookup=function(n,i,u){n=r.createLambda(n);i=r.createLambda(i);u=r.createLambda(u);var f=new a(u);return this.forEach(function(r){var e=n(r),u;r=i(r);u=f.get(e);u!==t?u.push(r):f.add(e,[r])}),new d(f)};i.prototype.toObject=function(n,t){n=r.createLambda(n);t=r.createLambda(t);var i={};return this.forEach(function(r){i[n(r)]=t(r)}),i};i.prototype.toDictionary=function(n,t,i){n=r.createLambda(n);t=r.createLambda(t);i=r.createLambda(i);var u=new a(i);return this.forEach(function(i){u.add(n(i),t(i))}),u};i.prototype.toJSONString=function(n,t){if(typeof JSON===v||null==JSON.stringify)throw Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),n,t)};i.prototype.toJoinedString=function(n,t){return null==n&&(n=""),null==t&&(t=o),this.select(t).toArray().join(n)};i.prototype.doAction=function(n){var t=this;return n=r.createLambda(n),new i(function(){var i,f=0;return new u(function(){i=t.getEnumerator()},function(){return i.moveNext()?(n(i.current(),f++),this.yieldReturn(i.current())):!1},function(){r.dispose(i)})})};i.prototype.forEach=function(n){n=r.createLambda(n);var i=0,t=this.getEnumerator();try{for(;t.moveNext()&&!1!==n(t.current(),i++););}finally{r.dispose(t)}};i.prototype.write=function(n,t){null==n&&(n="");t=r.createLambda(t);var i=!0;this.forEach(function(r){i?i=!1:document.write(n);document.write(t(r))})};i.prototype.writeLine=function(n){n=r.createLambda(n);this.forEach(function(t){document.writeln(n(t)+"<br />")})};i.prototype.force=function(){var n=this.getEnumerator();try{for(;n.moveNext(););}finally{r.dispose(n)}};i.prototype.letBind=function(n){n=r.createLambda(n);var t=this;return new i(function(){var f;return new u(function(){f=i.from(n(t)).getEnumerator()},function(){return f.moveNext()?this.yieldReturn(f.current()):!1},function(){r.dispose(f)})})};i.prototype.share=function(){var i=this,n,t=!1;return new y(function(){return new u(function(){null==n&&(n=i.getEnumerator())},function(){if(t)throw Error("enumerator is disposed");return n.moveNext()?this.yieldReturn(n.current()):!1},f)},function(){t=!0;r.dispose(n)})};i.prototype.memoize=function(){var e=this,n,t,i=!1;return new y(function(){var r=-1;return new u(function(){null==t&&(t=e.getEnumerator(),n=[])},function(){if(i)throw Error("enumerator is disposed");return r++,n.length<=r?t.moveNext()?this.yieldReturn(n[r]=t.current()):!1:this.yieldReturn(n[r])},f)},function(){i=!0;r.dispose(t);n=null})};i.prototype.catchError=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i;return new u(function(){i=t.getEnumerator()},function(){try{return i.moveNext()?this.yieldReturn(i.current()):!1}catch(t){return n(t),!1}},function(){r.dispose(i)})})};i.prototype.finallyAction=function(n){n=r.createLambda(n);var t=this;return new i(function(){var i;return new u(function(){i=t.getEnumerator()},function(){return i.moveNext()?this.yieldReturn(i.current()):!1},function(){try{r.dispose(i)}finally{n()}})})};i.prototype.log=function(n){return n=r.createLambda(n),this.doAction(function(t){typeof console!==v&&console.log(n(t))})};i.prototype.trace=function(n,t){return null==n&&(n="Trace"),t=r.createLambda(t),this.doAction(function(i){typeof console!==v&&console.log(n,t(i))})};s=function(n,t,i,u){this.source=n;this.keySelector=r.createLambda(t);this.descending=i;this.parent=u};s.prototype=new i;s.prototype.createOrderedEnumerable=function(n,t){return new s(this.source,n,t,this)};s.prototype.thenBy=function(n){return this.createOrderedEnumerable(n,!1)};s.prototype.thenByDescending=function(n){return this.createOrderedEnumerable(n,!0)};s.prototype.getEnumerator=function(){var i=this,t,n,r=0;return new u(function(){t=[];n=[];i.source.forEach(function(i,r){t.push(i);n.push(r)});var r=l.create(i,null);r.GenerateKeys(t);n.sort(function(n,t){return r.compare(n,t)})},function(){return r<n.length?this.yieldReturn(t[n[r++]]):!1},f)};l=function(n,t,i){this.keySelector=n;this.descending=t;this.child=i;this.keys=null};l.create=function(n,t){var i=new l(n.keySelector,n.descending,t);return null!=n.parent?l.create(n.parent,i):i};l.prototype.GenerateKeys=function(n){for(var i=n.length,u=this.keySelector,r=Array(i),t=0;t<i;t++)r[t]=u(n[t]);this.keys=r;null!=this.child&&this.child.GenerateKeys(n)};l.prototype.compare=function(n,t){var i=r.compare(this.keys[n],this.keys[t]);return 0==i?null!=this.child?this.child.compare(n,t):r.compare(n,t):this.descending?-i:i};y=function(n,t){this.dispose=t;this.getEnumerator=n};y.prototype=new i;e=function(n){this.getSource=function(){return n}};e.prototype=new i;e.prototype.any=function(n){return null==n?0<this.getSource().length:i.prototype.any.apply(this,arguments)};e.prototype.count=function(n){return null==n?this.getSource().length:i.prototype.count.apply(this,arguments)};e.prototype.elementAt=function(n){var t=this.getSource();return 0<=n&&n<t.length?t[n]:i.prototype.elementAt.apply(this,arguments)};e.prototype.elementAtOrDefault=function(n,i){i===t&&(i=null);var r=this.getSource();return 0<=n&&n<r.length?r[n]:i};e.prototype.first=function(n){var t=this.getSource();return null==n&&0<t.length?t[0]:i.prototype.first.apply(this,arguments)};e.prototype.firstOrDefault=function(n,r){if(r===t&&(r=null),null!=n)return i.prototype.firstOrDefault.apply(this,arguments);var u=this.getSource();return 0<u.length?u[0]:r};e.prototype.last=function(n){var t=this.getSource();return null==n&&0<t.length?t[t.length-1]:i.prototype.last.apply(this,arguments)};e.prototype.lastOrDefault=function(n,r){if(r===t&&(r=null),null!=n)return i.prototype.lastOrDefault.apply(this,arguments);var u=this.getSource();return 0<u.length?u[u.length-1]:r};e.prototype.skip=function(n){var t=this.getSource();return new i(function(){var i;return new u(function(){i=0>n?0:n},function(){return i<t.length?this.yieldReturn(t[i++]):!1},f)})};e.prototype.takeExceptLast=function(n){return null==n&&(n=1),this.take(this.getSource().length-n)};e.prototype.takeFromLast=function(n){return this.skip(this.getSource().length-n)};e.prototype.reverse=function(){var n=this.getSource();return new i(function(){var t;return new u(function(){t=n.length},function(){return 0<t?this.yieldReturn(n[--t]):!1},f)})};e.prototype.sequenceEqual=function(n,t){return(n instanceof e||n instanceof Array)&&null==t&&i.from(n).count()!=this.count()?!1:i.prototype.sequenceEqual.apply(this,arguments)};e.prototype.toJoinedString=function(n,t){var r=this.getSource();return null!=t||!(r instanceof Array)?i.prototype.toJoinedString.apply(this,arguments):(null==n&&(n=""),r.join(n))};e.prototype.getEnumerator=function(){var n=this.getSource(),t=-1;return{current:function(){return n[t]},moveNext:function(){return++t<n.length},dispose:f}};h=function(n,t){this.prevSource=n;this.prevPredicate=t};h.prototype=new i;h.prototype.where=function(n){if(n=r.createLambda(n),1>=n.length){var t=this.prevPredicate;return new h(this.prevSource,function(i){return t(i)&&n(i)})}return i.prototype.where.call(this,n)};h.prototype.select=function(n){return n=r.createLambda(n),1>=n.length?new c(this.prevSource,this.prevPredicate,n):i.prototype.select.call(this,n)};h.prototype.getEnumerator=function(){var t=this.prevPredicate,i=this.prevSource,n;return new u(function(){n=i.getEnumerator()},function(){for(;n.moveNext();)if(t(n.current()))return this.yieldReturn(n.current());return!1},function(){r.dispose(n)})};c=function(n,t,i){this.prevSource=n;this.prevPredicate=t;this.prevSelector=i};c.prototype=new i;c.prototype.where=function(n){return n=r.createLambda(n),1>=n.length?new h(this,n):i.prototype.where.call(this,n)};c.prototype.select=function(n){if(n=r.createLambda(n),1>=n.length){var t=this.prevSelector;return new c(this.prevSource,this.prevPredicate,function(i){return n(t(i))})}return i.prototype.select.call(this,n)};c.prototype.getEnumerator=function(){var t=this.prevPredicate,i=this.prevSelector,f=this.prevSource,n;return new u(function(){n=f.getEnumerator()},function(){for(;n.moveNext();)if(null==t||t(n.current()))return this.yieldReturn(i(n.current()));return!1},function(){r.dispose(n)})};var a=function(){var n=function(n){return null===n?"null":n===t?"undefined":"function"==typeof n.toString?n.toString():Object.prototype.toString.call(n)},s=function(n,t){this.key=n;this.value=t;this.next=this.prev=null},r=function(){this.last=this.first=null},e;return r.prototype={addLast:function(n){null!=this.last?(this.last.next=n,n.prev=this.last,this.last=n):this.first=this.last=n},replace:function(n,t){null!=n.prev?(n.prev.next=t,t.prev=n.prev):this.first=t;null!=n.next?(n.next.prev=t,t.next=n.next):this.last=t},remove:function(n){null!=n.prev?n.prev.next=n.next:this.first=n.next;null!=n.next?n.next.prev=n.prev:this.last=n.prev}},e=function(n){this.countField=0;this.entryList=new r;this.buckets={};this.compareSelector=null==n?o:n},e.prototype={add:function(t,i){var e=this.compareSelector(t),r=n(e),f=new s(t,i),u;if(Object.prototype.hasOwnProperty.call(this.buckets,r)){for(r=this.buckets[r],u=0;u<r.length;u++)if(this.compareSelector(r[u].key)===e){this.entryList.replace(r[u],f);r[u]=f;return}r.push(f)}else this.buckets[r]=[f];this.countField++;this.entryList.addLast(f)},get:function(i){var r,u,f;if(i=this.compareSelector(i),r=n(i),!Object.prototype.hasOwnProperty.call(this.buckets,r))return t;for(r=this.buckets[r],u=0;u<r.length;u++)if(f=r[u],this.compareSelector(f.key)===i)return f.value;return t},set:function(t,i){var f=this.compareSelector(t),r=n(f),u;if(Object.prototype.hasOwnProperty.call(this.buckets,r))for(r=this.buckets[r],u=0;u<r.length;u++)if(this.compareSelector(r[u].key)===f)return f=new s(t,i),this.entryList.replace(r[u],f),r[u]=f,!0;return!1},contains:function(t){var i,r;if(t=this.compareSelector(t),i=n(t),!Object.prototype.hasOwnProperty.call(this.buckets,i))return!1;for(i=this.buckets[i],r=0;r<i.length;r++)if(this.compareSelector(i[r].key)===t)return!0;return!1},clear:function(){this.countField=0;this.buckets={};this.entryList=new r},remove:function(t){var u,i,r;if(t=this.compareSelector(t),u=n(t),Object.prototype.hasOwnProperty.call(this.buckets,u))for(i=this.buckets[u],r=0;r<i.length;r++)if(this.compareSelector(i[r].key)===t){this.entryList.remove(i[r]);i.splice(r,1);0==i.length&&delete this.buckets[u];this.countField--;break}},count:function(){return this.countField},toEnumerable:function(){var n=this;return new i(function(){var t;return new u(function(){t=n.entryList.first},function(){if(null!=t){var n={key:t.key,value:t.value};return t=t.next,this.yieldReturn(n)}return!1},f)})}},e}(),d=function(n){this.count=function(){return n.count()};this.get=function(t){return i.from(n.get(t))};this.contains=function(t){return n.contains(t)};this.toEnumerable=function(){return n.toEnumerable().select(function(n){return new p(n.key,n.value)})}},p=function(n,t){this.key=function(){return n};e.call(this,t)};p.prototype=new e;"function"==typeof define&&define.amd?define("linqjs",[],function(){return i}):typeof module!==v&&module.exports?module.exports=i:n.Enumerable=i}(this);angular.module("ngAutocomplete",[]).directive("ngAutocomplete",["$timeout",function(n){return{require:"ngModel",scope:{ngModel:"=",options:"=?",details:"=?",onChanged:"="},link:function(t,i,r,u){var f,o=!1,h=function(){f={};t.options&&(o=t.options.watchEnter!==!0?!1:!0,t.options.types?(f.types=[],f.types.push(t.options.types),t.gPlace.setTypes(f.types)):t.gPlace.setTypes([]),t.options.bounds?(f.bounds=t.options.bounds,t.gPlace.setBounds(f.bounds)):t.gPlace.setBounds(null),t.options.country?(f.componentRestrictions={country:t.options.country},t.gPlace.setComponentRestrictions(f.componentRestrictions)):t.gPlace.setComponentRestrictions(null))},e,s;if(t.gPlace==undefined){e=$(i[0]);t.gPlace=new google.maps.places.Autocomplete(i[0],{});e.click(function(){$(".pac-container").each(function(){$(this).html("")});n(function(){e.select()})});e.focus(function(){$(".pac-container").each(function(){$(this).html("")});n(function(){e.select()})});e.on("keydown",function(n){var f,i,t,r,u,o;if(n.which===13||n.which===9){if(f=$(".pac-container .pac-item-selected"),f.length>0)return;if(i=$(".pac-container .pac-item:first .pac-item-query"),!i)return;if(t=i.text(),!t||!t.trim())return;r=i.next();r&&(u=r.text(),u&&u.trim()&&(t=t+", "+r.text().trim()));setTimeout(function(){e.val(t)});o=new google.maps.Geocoder;console.log("enter pressed: "+t)}})}google.maps.event.addListener(t.gPlace,"place_changed",function(){console.log("place selected: "+t.gPlace);var r=t.gPlace.getPlace();r!==undefined&&(r.address_components!==undefined?t.$apply(function(){t.details=r;u.$setViewValue(i.val());n(function(){if(t.onChanged)t.onChanged(r)},100)}):o&&s(r))});s=function(r){var f=new google.maps.places.AutocompleteService;r.name.length>0&&f.getPlacePredictions({input:r.name,offset:r.name.length},function(r){if(r==null||r.length==0)t.$apply(function(){t.details=null});else{var f=new google.maps.places.PlacesService(i[0]);f.getDetails({reference:r[0].reference},function(r,f){f==google.maps.GeocoderStatus.OK&&t.$apply(function(){u.$setViewValue(r.formatted_address);i.val(r.formatted_address);t.details=r;var f=i.on("focusout",function(){i.val(r.formatted_address);i.unbind("focusout")});n(function(){if(t.onChanged)t.onChanged(r)},100)})})}})};u.$render=function(){var n=u.$viewValue;i.val(n)};t.watchOptions=function(){return t.options};t.$watch(t.watchOptions,function(){h()},!0)}}}]),function(n){"use strict";function t(){var t;this.setOptions=function(i){if(t)throw new Error("Already configured.");if(!(i instanceof Object))throw new TypeError("Invalid argument: `config` must be an `Object`.");return t=n.extend({},i)};this.$get=function(){var i=function(){function i(){}return Object.defineProperties(i.prototype,{getOptions:{value:function(){return n.copy(t)},writable:!0,enumerable:!0,configurable:!0}}),i}();return new i};this.$get.$inject=[]}function i(){var t;this.setOptions=function(i){if(t)throw new Error("Already configured.");if(!(i instanceof Object))throw new TypeError("Invalid argument: `config` must be an `Object`.");return t=n.extend({},i)};this.$get=function(){var i=function(){function i(){}return Object.defineProperties(i.prototype,{getOptions:{value:function(){return n.copy(t)},writable:!0,enumerable:!0,configurable:!0}}),i}();return new i};this.$get.$inject=[]}n.module("pickadate",[]);n.module("pickadate").provider("pickADate",t);n.module("pickadate").provider("pickATime",i);n.module("pickadate").directive("pickADate",["$parse","$timeout","pickADate",function(t,i,r){return{restrict:"A",require:"?ngModel",link:function(u,f,e,o){function w(n){if(n){var t=n instanceof Date?n:new Date(n);f.pickadate("picker").set("select",t.getTime());s.pickADate.assign(u,t)}else f.pickadate("picker").clear(),s.pickADate.assign(u,null)}function b(n){typeof n=="object"&&f.pickadate("picker").set(n)}var y=!1,p=t(e.updateModel),s={pickADate:t(e.pickADate),minDate:t(e.minDate),maxDate:t(e.maxDate),pickADateOptions:t(e.pickADateOptions)},h=r.getOptions()||{},c=s.pickADateOptions(u)||{},l=n.extend({},h,c),a,v;l.onSet=function(n){var i=this,r=arguments,t=f.pickadate("picker").get("select");u.$evalAsync(function(){if(n.hasOwnProperty("clear")){s.pickADate.assign(u,null);return}if(t){var f=s.pickADate(u);f||(f=new Date(0),s.pickADate.assign(u,f));f.setFullYear(t.obj.getFullYear(),t.obj.getMonth(),t.obj.getDate())}else s.pickADate.assign(u,t);c&&c.onSet&&c.onSet.apply(i,r);h&&h.onSet&&h.onSet.apply(i,r)})};l.onOpen=function(){o&&(y||(y=!0,u.$apply(function(){o.$setUntouched()})));c&&c.onOpen&&c.onOpen.apply(this,arguments);h&&h.onOpen&&h.onOpen.apply(this,arguments)};l.onClose=function(){o&&u.$apply(function(){o.$setTouched();p&&i(function(){p(u)})});c&&c.onClose&&c.onClose.apply(this,arguments);h&&h.onClose&&h.onClose.apply(this,arguments);f.blur()};f.pickadate(l);w(s.pickADate(u));a=s.minDate(u);v=s.maxDate(u);f.pickadate("picker").set("min",a?a:!1);f.pickadate("picker").set("max",v?v:!1);u.$watchGroup([e.pickADate,e.minDate,e.maxDate],function(n,t){var i=n[0],r=n[1],u=n[2],e=t[0],o=t[1],s=t[2];r!==o&&f.pickadate("picker").set("min",n[1]?n[1]:!1);u!==s&&f.pickadate("picker").set("max",n[2]?n[2]:!1);i!==e&&w(n[0])},!0);o&&o.$setPristine();u.$watch(e.pickADateOptions,function(n,t){n!==t&&b(n)},!0)}}}]);n.module("pickadate").directive("pickATime",["$parse","pickATime",function(t,i){return{restrict:"A",require:"?ngModel",link:function(r,u,f,e){function a(n){if(n){var t=n instanceof Date?n:new Date(n),i=t.getHours()*60+t.getMinutes();u.pickatime("picker").set("select",i);h.pickATime.assign(r,t)}else u.pickatime("picker").clear(),h.pickATime.assign(r,null)}function v(n){typeof n=="object"&&u.pickatime("picker").set(n)}var l=!1,h={pickATime:t(f.pickATime),pickATimeOptions:t(f.pickATimeOptions)},o=i.getOptions()||{},s=h.pickATimeOptions(r)||{},c=n.extend({},o,s);c.onSet=function(n){var i=this,f=arguments,t=u.pickatime("picker").get("select");r.$evalAsync(function(){if(n.hasOwnProperty("clear")){h.pickATime.assign(r,null);return}if(t){var u=h.pickATime(r);u||(u=new Date(0),h.pickATime.assign(r,u));u.setHours(t.hour);u.setMinutes(t.mins);u.setSeconds(0);u.setMilliseconds(0)}else h.pickATime.assign(r,t);s&&s.onSet&&s.onSet.apply(i,f);o&&o.onSet&&o.onSet.apply(i,f)})};c.onOpen=function(){e&&(l||(l=!0,r.$apply(function(){e.$setUntouched()})));s&&s.onOpen&&s.onOpen.apply(this,arguments);o&&o.onOpen&&o.onOpen.apply(this,arguments)};c.onClose=function(){e&&r.$applyAsync(function(){e.$setTouched()});s&&s.onClose&&s.onClose.apply(this,arguments);o&&o.onClose&&o.onClose.apply(this,arguments);u.blur()};u.pickatime(c);a(h.pickATime(r));r.$watch(f.pickATime,function(n,t){n!==t&&a(n)},!0);r.$watch(f.pickATimeOptions,function(n,t){n!==t&&v(n)},!0);e&&e.$setPristine()}}}])}(angular);angular.module("datetimepicker",[]).provider("datetimepicker",function(){var n={};this.setOptions=function(t){n=t};this.$get=function(){return{getOptions:function(){return n}}}}).directive("datetimepicker",["$timeout","datetimepicker",function(n,t){var i=t.getOptions();return{require:"?ngModel",restrict:"AE",scope:{datetimepickerOptions:"&datetimepickerOptions",datetimepickerMoment:"=?",datetimepickerChange:"&"},link:function(t,r,u,f){function o(){var n=e.defaultDate||null;f&&f.$viewValue&&(n=f.$viewValue);r.data("DateTimePicker").date(n)}var s=t.datetimepickerOptions(),e=jQuery.extend({},i,s);r.on("dp.change",function(i){f&&(t.datetimepickerMoment=i.date,n(function(){f.$setViewValue(i.target.value);t.datetimepickerChange&&t.datetimepickerChange()}))}).datetimepicker(e);f&&(f.$render=function(){o()});o()}}}]);!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):n("object"==typeof exports?require("jquery"):jQuery)}(function(n,t){function f(){return new Date(Date.UTC.apply(Date,arguments))}function o(){var n=new Date;return f(n.getFullYear(),n.getMonth(),n.getDate())}function l(n,t){return n.getUTCFullYear()===t.getUTCFullYear()&&n.getUTCMonth()===t.getUTCMonth()&&n.getUTCDate()===t.getUTCDate()}function h(i,r){return function(){return r!==t&&n.fn.datepicker.deprecated(r),this[i].apply(this,arguments)}}function p(n){return n&&!isNaN(n.getTime())}function w(t,i){function o(n,t){return t.toLowerCase()}var u,f=n(t).data(),e={},s=new RegExp("^"+i.toLowerCase()+"([A-Z])"),r;i=new RegExp("^"+i.toLowerCase());for(r in f)i.test(r)&&(u=r.replace(s,o),e[u]=f[r]);return e}function b(t){var u={},i;if(r[t]||(t=t.split("-")[0],r[t]))return i=r[t],n.each(y,function(n,t){t in i&&(u[t]=i[t])}),u}var a=function(){var t={get:function(n){return this.slice(n)[0]},contains:function(n){for(var i=n&&n.valueOf(),t=0,r=this.length;t<r;t++)if(0<=this[t].valueOf()-i&&this[t].valueOf()-i<864e5)return t;return-1},remove:function(n){this.splice(n,1)},replace:function(t){t&&(n.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.length=0},copy:function(){var n=new a;return n.replace(this),n}};return function(){var i=[];return i.push.apply(i,arguments),n.extend(i,t),i}}(),u=function(t,r){n.data(t,"datepicker",this);this._events=[];this._secondaryEvents=[];this._process_options(r);this.dates=new a;this.viewDate=this.o.defaultViewDate;this.focusDate=null;this.element=n(t);this.isInput=this.element.is("input");this.inputField=this.isInput?this.element:this.element.find("input");this.component=!!this.element.hasClass("date")&&this.element.find(".add-on, .input-group-addon, .input-group-append, .input-group-prepend, .btn");this.component&&0===this.component.length&&(this.component=!1);this.isInline=!this.component&&this.element.is("div");this.picker=n(i.template);this._check_template(this.o.templates.leftArrow)&&this.picker.find(".prev").html(this.o.templates.leftArrow);this._check_template(this.o.templates.rightArrow)&&this.picker.find(".next").html(this.o.templates.rightArrow);this._buildEvents();this._attachEvents();this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu");this.o.rtl&&this.picker.addClass("datepicker-rtl");this.o.calendarWeeks&&this.picker.find(".datepicker-days .datepicker-switch, thead .datepicker-title, tfoot .today, tfoot .clear").attr("colspan",function(n,t){return Number(t)+1});this._process_options({startDate:this._o.startDate,endDate:this._o.endDate,daysOfWeekDisabled:this.o.daysOfWeekDisabled,daysOfWeekHighlighted:this.o.daysOfWeekHighlighted,datesDisabled:this.o.datesDisabled});this._allow_update=!1;this.setViewMode(this.o.startView);this._allow_update=!0;this.fillDow();this.fillMonths();this.update();this.isInline&&this.show()},c,v,s,e,y,r,i;u.prototype={constructor:u,_resolveViewName:function(t){return n.each(i.viewModes,function(i,r){if(t===i||-1!==n.inArray(t,r.names))return t=i,!1}),t},_resolveDaysOfWeek:function(t){return n.isArray(t)||(t=t.split(/[,\s]*/)),n.map(t,Number)},_check_template:function(i){try{return i===t||""===i?!1:(i.match(/[<>]/g)||[]).length<=0?!0:n(i).length>0}catch(n){return!1}},_process_options:function(t){var u,h,l,s,c;if(this._o=n.extend({},this._o,t),u=this.o=n.extend({},this._o),h=u.language,r[h]||(h=h.split("-")[0],r[h]||(h=e.language)),u.language=h,u.startView=this._resolveViewName(u.startView),u.minViewMode=this._resolveViewName(u.minViewMode),u.maxViewMode=this._resolveViewName(u.maxViewMode),u.startView=Math.max(this.o.minViewMode,Math.min(this.o.maxViewMode,u.startView)),!0!==u.multidate&&(u.multidate=Number(u.multidate)||!1,!1!==u.multidate&&(u.multidate=Math.max(0,u.multidate))),u.multidateSeparator=String(u.multidateSeparator),u.weekStart%=7,u.weekEnd=(u.weekStart+6)%7,l=i.parseFormat(u.format),u.startDate!==-1/0&&(u.startDate=u.startDate?u.startDate instanceof Date?this._local_to_utc(this._zero_time(u.startDate)):i.parseDate(u.startDate,l,u.language,u.assumeNearbyYear):-1/0),u.endDate!==1/0&&(u.endDate=u.endDate?u.endDate instanceof Date?this._local_to_utc(this._zero_time(u.endDate)):i.parseDate(u.endDate,l,u.language,u.assumeNearbyYear):1/0),u.daysOfWeekDisabled=this._resolveDaysOfWeek(u.daysOfWeekDisabled||[]),u.daysOfWeekHighlighted=this._resolveDaysOfWeek(u.daysOfWeekHighlighted||[]),u.datesDisabled=u.datesDisabled||[],n.isArray(u.datesDisabled)||(u.datesDisabled=u.datesDisabled.split(",")),u.datesDisabled=n.map(u.datesDisabled,function(n){return i.parseDate(n,l,u.language,u.assumeNearbyYear)}),s=String(u.orientation).toLowerCase().split(/\s+/g),c=u.orientation.toLowerCase(),s=n.grep(s,function(n){return/^auto|left|right|top|bottom$/.test(n)}),u.orientation={x:"auto",y:"auto"},c&&"auto"!==c)if(1===s.length)switch(s[0]){case"top":case"bottom":u.orientation.y=s[0];break;case"left":case"right":u.orientation.x=s[0]}else c=n.grep(s,function(n){return/^left|right$/.test(n)}),u.orientation.x=c[0]||"auto",c=n.grep(s,function(n){return/^top|bottom$/.test(n)}),u.orientation.y=c[0]||"auto";if(u.defaultViewDate instanceof Date||"string"==typeof u.defaultViewDate)u.defaultViewDate=i.parseDate(u.defaultViewDate,l,u.language,u.assumeNearbyYear);else if(u.defaultViewDate){var a=u.defaultViewDate.year||(new Date).getFullYear(),v=u.defaultViewDate.month||0,y=u.defaultViewDate.day||1;u.defaultViewDate=f(a,v,y)}else u.defaultViewDate=o()},_applyEvents:function(n){for(var f,r,u,i=0;i<n.length;i++)f=n[i][0],2===n[i].length?(r=t,u=n[i][1]):3===n[i].length&&(r=n[i][1],u=n[i][2]),f.on(u,r)},_unapplyEvents:function(n){for(var f,r,u,i=0;i<n.length;i++)f=n[i][0],2===n[i].length?(u=t,r=n[i][1]):3===n[i].length&&(u=n[i][1],r=n[i][2]),f.off(r,u)},_buildEvents:function(){var t={keyup:n.proxy(function(t){-1===n.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:n.proxy(this.keydown,this),paste:n.proxy(this.paste,this)};!0===this.o.showOnFocus&&(t.focus=n.proxy(this.show,this));this._events=this.isInput?[[this.element,t]]:this.component&&this.inputField.length?[[this.inputField,t],[this.component,{click:n.proxy(this.show,this)}]]:[[this.element,{click:n.proxy(this.show,this),keydown:n.proxy(this.keydown,this)}]];this._events.push([this.element,"*",{blur:n.proxy(function(n){this._focused_from=n.target},this)}],[this.element,{blur:n.proxy(function(n){this._focused_from=n.target},this)}]);this.o.immediateUpdates&&this._events.push([this.element,{"changeYear changeMonth":n.proxy(function(n){this.update(n.date)},this)}]);this._secondaryEvents=[[this.picker,{click:n.proxy(this.click,this)}],[this.picker,".prev, .next",{click:n.proxy(this.navArrowsClick,this)}],[this.picker,".day:not(.disabled)",{click:n.proxy(this.dayCellClick,this)}],[n(window),{resize:n.proxy(this.place,this)}],[n(document),{"mousedown touchstart":n.proxy(function(n){this.element.is(n.target)||this.element.find(n.target).length||this.picker.is(n.target)||this.picker.find(n.target).length||this.isInline||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,r){var u=r||this.dates.get(-1),f=this._utc_to_local(u);this.element.trigger({type:t,date:f,viewMode:this.viewMode,dates:n.map(this.dates,this._utc_to_local),format:n.proxy(function(n,t){0===arguments.length?(n=this.dates.length-1,t=this.o.format):"string"==typeof n&&(t=n,n=this.dates.length-1);t=t||this.o.format;var r=this.dates.get(n);return i.formatDate(r,t,this.o.language)},this)})},show:function(){if(!(this.inputField.is(":disabled")||this.inputField.prop("readonly")&&!1===this.o.enableOnReadonly))return this.isInline||this.picker.appendTo(this.o.container),this.place(),this.picker.show(),this._attachSecondaryEvents(),this._trigger("show"),(window.navigator.msMaxTouchPoints||"ontouchstart"in document)&&this.o.disableTouchKeyboard&&n(this.element).blur(),this},hide:function(){return this.isInline||!this.picker.is(":visible")?this:(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.setViewMode(this.o.startView),this.o.forceParse&&this.inputField.val()&&this.setValue(),this._trigger("hide"),this)},destroy:function(){return this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date,this},paste:function(t){var i;if(t.originalEvent.clipboardData&&t.originalEvent.clipboardData.types&&-1!==n.inArray("text/plain",t.originalEvent.clipboardData.types))i=t.originalEvent.clipboardData.getData("text/plain");else{if(!window.clipboardData)return;i=window.clipboardData.getData("Text")}this.setDate(i);this.update();t.preventDefault()},_utc_to_local:function(n){if(!n)return n;var t=new Date(n.getTime()+6e4*n.getTimezoneOffset());return t.getTimezoneOffset()!==n.getTimezoneOffset()&&(t=new Date(n.getTime()+6e4*t.getTimezoneOffset())),t},_local_to_utc:function(n){return n&&new Date(n.getTime()-6e4*n.getTimezoneOffset())},_zero_time:function(n){return n&&new Date(n.getFullYear(),n.getMonth(),n.getDate())},_zero_utc_time:function(n){return n&&f(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())},getDates:function(){return n.map(this.dates,this._utc_to_local)},getUTCDates:function(){return n.map(this.dates,function(n){return new Date(n)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){var n=this.dates.get(-1);return n!==t?new Date(n):null},clearDates:function(){this.inputField.val("");this.update();this._trigger("changeDate");this.o.autoclose&&this.hide()},setDates:function(){var t=n.isArray(arguments[0])?arguments[0]:arguments;return this.update.apply(this,t),this._trigger("changeDate"),this.setValue(),this},setUTCDates:function(){var t=n.isArray(arguments[0])?arguments[0]:arguments;return this.setDates.apply(this,n.map(t,this._utc_to_local)),this},setDate:h("setDates"),setUTCDate:h("setUTCDates"),remove:h("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead"),setValue:function(){var n=this.getFormattedDate();return this.inputField.val(n),this},getFormattedDate:function(r){r===t&&(r=this.o.format);var u=this.o.language;return n.map(this.dates,function(n){return i.formatDate(n,r,u)}).join(this.o.multidateSeparator)},getStartDate:function(){return this.o.startDate},setStartDate:function(n){return this._process_options({startDate:n}),this.update(),this.updateNavArrows(),this},getEndDate:function(){return this.o.endDate},setEndDate:function(n){return this._process_options({endDate:n}),this.update(),this.updateNavArrows(),this},setDaysOfWeekDisabled:function(n){return this._process_options({daysOfWeekDisabled:n}),this.update(),this},setDaysOfWeekHighlighted:function(n){return this._process_options({daysOfWeekHighlighted:n}),this.update(),this},setDatesDisabled:function(n){return this._process_options({datesDisabled:n}),this.update(),this},place:function(){var y,r,p;if(this.isInline)return this;var f=this.picker.outerWidth(),s=this.picker.outerHeight(),e=n(this.o.container),h=e.width(),c="body"===this.o.container?n(document).scrollTop():e.scrollTop(),l=e.offset(),a=[0];this.element.parents().each(function(){var t=n(this).css("z-index");"auto"!==t&&0!==Number(t)&&a.push(Number(t))});var v=Math.max.apply(Math,a)+this.o.zIndexOffset,u=this.component?this.component.parent().offset():this.element.offset(),w=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),o=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),t=u.left-l.left,i=u.top-l.top;return"body"!==this.o.container&&(i+=c),this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(t-=f-o)):u.left<0?(this.picker.addClass("datepicker-orient-left"),t-=u.left-10):t+f>h?(this.picker.addClass("datepicker-orient-right"),t+=o-f):this.o.rtl?this.picker.addClass("datepicker-orient-right"):this.picker.addClass("datepicker-orient-left"),r=this.o.orientation.y,("auto"===r&&(y=-c+i-s,r=y<0?"bottom":"top"),this.picker.addClass("datepicker-orient-"+r),"top"===r?i-=s+parseInt(this.picker.css("padding-top")):i+=w,this.o.rtl)?(p=h-(t+o),this.picker.css({top:i,right:p,zIndex:v})):this.picker.css({top:i,left:t,zIndex:v}),this},_allow_update:!0,update:function(){if(!this._allow_update)return this;var u=this.dates.copy(),t=[],r=!1;return arguments.length?(n.each(arguments,n.proxy(function(n,i){i instanceof Date&&(i=this._local_to_utc(i));t.push(i)},this)),r=!0):(t=this.isInput?this.element.val():this.element.data("date")||this.inputField.val(),t=t&&this.o.multidate?t.split(this.o.multidateSeparator):[t],delete this.element.data().date),t=n.map(t,n.proxy(function(n){return i.parseDate(n,this.o.format,this.o.language,this.o.assumeNearbyYear)},this)),t=n.grep(t,n.proxy(function(n){return!this.dateWithinRange(n)||!n},this),!0),this.dates.replace(t),this.o.updateViewDate&&(this.viewDate=this.dates.length?new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?new Date(this.o.startDate):this.viewDate>this.o.endDate?new Date(this.o.endDate):this.o.defaultViewDate),r?(this.setValue(),this.element.change()):this.dates.length&&String(u)!==String(this.dates)&&r&&(this._trigger("changeDate"),this.element.change()),!this.dates.length&&u.length&&(this._trigger("clearDate"),this.element.change()),this.fill(),this},fillDow:function(){if(this.o.showWeekDays){var i=this.o.weekStart,t="<tr>";for(this.o.calendarWeeks&&(t+='<th class="cw">&#160;<\/th>');i<this.o.weekStart+7;)t+='<th class="dow',-1!==n.inArray(i,this.o.daysOfWeekDisabled)&&(t+=" disabled"),t+='">'+r[this.o.language].daysMin[i++%7]+"<\/th>";t+="<\/tr>";this.picker.find(".datepicker-days thead").append(t)}},fillMonths:function(){for(var t,i=this._utc_to_local(this.viewDate),u="",n=0;n<12;n++)t=i&&i.getMonth()===n?" focused":"",u+='<span class="month'+t+'">'+r[this.o.language].monthsShort[n]+"<\/span>";this.picker.find(".datepicker-months td").html(u)},setRange:function(t){t&&t.length?this.range=n.map(t,function(n){return n.valueOf()}):delete this.range;this.fill()},getClassNames:function(t){var i=[],r=this.viewDate.getUTCFullYear(),u=this.viewDate.getUTCMonth(),f=o();return t.getUTCFullYear()<r||t.getUTCFullYear()===r&&t.getUTCMonth()<u?i.push("old"):(t.getUTCFullYear()>r||t.getUTCFullYear()===r&&t.getUTCMonth()>u)&&i.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&i.push("focused"),this.o.todayHighlight&&l(t,f)&&i.push("today"),-1!==this.dates.contains(t)&&i.push("active"),this.dateWithinRange(t)||i.push("disabled"),this.dateIsDisabled(t)&&i.push("disabled","disabled-date"),-1!==n.inArray(t.getUTCDay(),this.o.daysOfWeekHighlighted)&&i.push("highlighted"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&i.push("range"),-1!==n.inArray(t.valueOf(),this.range)&&i.push("selected"),t.valueOf()===this.range[0]&&i.push("range-start"),t.valueOf()===this.range[this.range.length-1]&&i.push("range-end")),i},_fill_yearsView:function(i,r,u,f,e,o,s){for(var c,v,h,w="",l=u/10,b=this.picker.find(i),y=Math.floor(f/u)*u,p=y+9*l,k=Math.floor(this.viewDate.getFullYear()/l)*l,d=n.map(this.dates,function(n){return Math.floor(n.getUTCFullYear()/l)*l}),a=y-l;a<=p+l;a+=l)c=[r],v=null,a===y-l?c.push("old"):a===p+l&&c.push("new"),-1!==n.inArray(a,d)&&c.push("active"),(a<e||a>o)&&c.push("disabled"),a===k&&c.push("focused"),s!==n.noop&&(h=s(new Date(a,0,1)),h===t?h={}:"boolean"==typeof h?h={enabled:h}:"string"==typeof h&&(h={classes:h}),!1===h.enabled&&c.push("disabled"),h.classes&&(c=c.concat(h.classes.split(/\s+/))),h.tooltip&&(v=h.tooltip)),w+='<span class="'+c.join(" ")+'"'+(v?' title="'+v+'"':"")+">"+a+"<\/span>";b.find(".datepicker-switch").text(y+"-"+p);b.find("td").html(w)},fill:function(){var p,u,w=new Date(this.viewDate),s=w.getUTCFullYear(),nt=w.getUTCMonth(),v=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,et=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,y=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,ot=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,st=r[this.o.language].today||r.en.today||"",ht=r[this.o.language].clear||r.en.clear||"",ct=r[this.o.language].titleFormat||r.en.titleFormat,b=o(),lt=(!0===this.o.todayBtn||"linked"===this.o.todayBtn)&&b>=this.o.startDate&&b<=this.o.endDate&&!this.weekOfDateIsDisabled(b),e,tt,c,k,h,l,g,ut,a,ft;if(!isNaN(s)&&!isNaN(nt)){for(this.picker.find(".datepicker-days .datepicker-switch").text(i.formatDate(w,ct,this.o.language)),this.picker.find("tfoot .today").text(st).css("display",lt?"table-cell":"none"),this.picker.find("tfoot .clear").text(ht).css("display",!0===this.o.clearBtn?"table-cell":"none"),this.picker.find("thead .datepicker-title").text(this.o.title).css("display","string"==typeof this.o.title&&""!==this.o.title?"table-cell":"none"),this.updateNavArrows(),this.fillMonths(),e=f(s,nt,0),tt=e.getUTCDate(),e.setUTCDate(tt-(e.getUTCDay()-this.o.weekStart+7)%7),c=new Date(e),e.getUTCFullYear()<100&&c.setUTCFullYear(e.getUTCFullYear()),c.setUTCDate(c.getUTCDate()+42),c=c.valueOf(),l=[];e.valueOf()<c;){if((k=e.getUTCDay())===this.o.weekStart&&(l.push("<tr>"),this.o.calendarWeeks)){var it=new Date(+e+(this.o.weekStart-k-7)%7*864e5),rt=new Date(Number(it)+(11-it.getUTCDay())%7*864e5),d=new Date(Number(d=f(rt.getUTCFullYear(),0,1))+(11-d.getUTCDay())%7*864e5),at=(rt-d)/6048e5+1;l.push('<td class="cw">'+at+"<\/td>")}h=this.getClassNames(e);h.push("day");g=e.getUTCDate();this.o.beforeShowDay!==n.noop&&(u=this.o.beforeShowDay(this._utc_to_local(e)),u===t?u={}:"boolean"==typeof u?u={enabled:u}:"string"==typeof u&&(u={classes:u}),!1===u.enabled&&h.push("disabled"),u.classes&&(h=h.concat(u.classes.split(/\s+/))),u.tooltip&&(p=u.tooltip),u.content&&(g=u.content));h=n.isFunction(n.uniqueSort)?n.uniqueSort(h):n.unique(h);l.push('<td class="'+h.join(" ")+'"'+(p?' title="'+p+'"':"")+' data-date="'+e.getTime().toString()+'">'+g+"<\/td>");p=null;k===this.o.weekEnd&&l.push("<\/tr>");e.setUTCDate(e.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").html(l.join(""));ut=r[this.o.language].monthsTitle||r.en.monthsTitle||"Months";a=this.picker.find(".datepicker-months").find(".datepicker-switch").text(this.o.maxViewMode<2?ut:s).end().find("tbody span").removeClass("active");(n.each(this.dates,function(n,t){t.getUTCFullYear()===s&&a.eq(t.getUTCMonth()).addClass("active")}),(s<v||s>y)&&a.addClass("disabled"),s===v&&a.slice(0,et).addClass("disabled"),s===y&&a.slice(ot+1).addClass("disabled"),this.o.beforeShowMonth!==n.noop)&&(ft=this,n.each(a,function(i,r){var f=new Date(s,i,1),u=ft.o.beforeShowMonth(f);u===t?u={}:"boolean"==typeof u?u={enabled:u}:"string"==typeof u&&(u={classes:u});!1!==u.enabled||n(r).hasClass("disabled")||n(r).addClass("disabled");u.classes&&n(r).addClass(u.classes);u.tooltip&&n(r).prop("title",u.tooltip)}));this._fill_yearsView(".datepicker-years","year",10,s,v,y,this.o.beforeShowYear);this._fill_yearsView(".datepicker-decades","decade",100,s,v,y,this.o.beforeShowDecade);this._fill_yearsView(".datepicker-centuries","century",1e3,s,v,y,this.o.beforeShowCentury)}},updateNavArrows:function(){if(this._allow_update){var i,r,u=new Date(this.viewDate),t=u.getUTCFullYear(),f=u.getUTCMonth(),e=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,s=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,o=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,h=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,n=1;switch(this.viewMode){case 4:n*=10;case 3:n*=10;case 2:n*=10;case 1:i=Math.floor(t/n)*n<=e;r=Math.floor(t/n)*n+n>o;break;case 0:i=t<=e&&f<=s;r=t>=o&&f>=h}this.picker.find(".prev").toggleClass("disabled",i);this.picker.find(".next").toggleClass("disabled",r)}},click:function(t){t.preventDefault();t.stopPropagation();var r,s,u,e;r=n(t.target);r.hasClass("datepicker-switch")&&this.viewMode!==this.o.maxViewMode&&this.setViewMode(this.viewMode+1);r.hasClass("today")&&!r.hasClass("day")&&(this.setViewMode(0),this._setDate(o(),"linked"===this.o.todayBtn?null:"view"));r.hasClass("clear")&&this.clearDates();r.hasClass("disabled")||(r.hasClass("month")||r.hasClass("year")||r.hasClass("decade")||r.hasClass("century"))&&(this.viewDate.setUTCDate(1),s=1,1===this.viewMode?(e=r.parent().find("span").index(r),u=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(e)):(e=0,u=Number(r.text()),this.viewDate.setUTCFullYear(u)),this._trigger(i.viewModes[this.viewMode-1].e,this.viewDate),this.viewMode===this.o.minViewMode?this._setDate(f(u,e,s)):(this.setViewMode(this.viewMode-1),this.fill()));this.picker.is(":visible")&&this._focused_from&&this._focused_from.focus();delete this._focused_from},dayCellClick:function(t){var r=n(t.currentTarget),u=r.data("date"),i=new Date(u);this.o.updateViewDate&&(i.getUTCFullYear()!==this.viewDate.getUTCFullYear()&&this._trigger("changeYear",this.viewDate),i.getUTCMonth()!==this.viewDate.getUTCMonth()&&this._trigger("changeMonth",this.viewDate));this._setDate(i)},navArrowsClick:function(t){var u=n(t.currentTarget),r=u.hasClass("prev")?-1:1;0!==this.viewMode&&(r*=12*i.viewModes[this.viewMode].navStep);this.viewDate=this.moveMonth(this.viewDate,r);this._trigger(i.viewModes[this.viewMode].e,this.viewDate);this.fill()},_toggle_multidate:function(n){var t=this.dates.contains(n);if(n||this.dates.clear(),-1!==t?(!0===this.o.multidate||this.o.multidate>1||this.o.toggleActive)&&this.dates.remove(t):!1===this.o.multidate?(this.dates.clear(),this.dates.push(n)):this.dates.push(n),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(n,t){t&&"date"!==t||this._toggle_multidate(n&&new Date(n));(!t&&this.o.updateViewDate||"view"===t)&&(this.viewDate=n&&new Date(n));this.fill();this.setValue();t&&"view"===t||this._trigger("changeDate");this.inputField.trigger("change");!this.o.autoclose||t&&"date"!==t||this.hide()},moveDay:function(n,t){var i=new Date(n);return i.setUTCDate(n.getUTCDate()+t),i},moveWeek:function(n,t){return this.moveDay(n,7*t)},moveMonth:function(n,t){var f;if(!p(n))return this.o.defaultViewDate;if(!t)return n;var r,u,i=new Date(n.valueOf()),e=i.getUTCDate(),o=i.getUTCMonth(),s=Math.abs(t);if(t=t>0?1:-1,1===s)u=-1===t?function(){return i.getUTCMonth()===o}:function(){return i.getUTCMonth()!==r},r=o+t,i.setUTCMonth(r),r=(r+12)%12;else{for(f=0;f<s;f++)i=this.moveMonth(i,t);r=i.getUTCMonth();i.setUTCDate(e);u=function(){return r!==i.getUTCMonth()}}for(;u();)i.setUTCDate(--e),i.setUTCMonth(r);return i},moveYear:function(n,t){return this.moveMonth(n,12*t)},moveAvailableDate:function(n,t,i){do{if(n=this[i](n,t),!this.dateWithinRange(n))return!1;i="moveDay"}while(this.dateIsDisabled(n));return n},weekOfDateIsDisabled:function(t){return-1!==n.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled)},dateIsDisabled:function(t){return this.weekOfDateIsDisabled(t)||n.grep(this.o.datesDisabled,function(n){return l(t,n)}).length>0},dateWithinRange:function(n){return n>=this.o.startDate&&n<=this.o.endDate},keydown:function(n){if(!this.picker.is(":visible"))return void(40!==n.keyCode&&27!==n.keyCode||(this.show(),n.stopPropagation()));var t,r,u=!1,i=this.focusDate||this.viewDate;switch(n.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide();n.preventDefault();n.stopPropagation();break;case 37:case 38:case 39:case 40:if(!this.o.keyboardNavigation||7===this.o.daysOfWeekDisabled.length)break;t=37===n.keyCode||38===n.keyCode?-1:1;0===this.viewMode?n.ctrlKey?(r=this.moveAvailableDate(i,t,"moveYear"))&&this._trigger("changeYear",this.viewDate):n.shiftKey?(r=this.moveAvailableDate(i,t,"moveMonth"))&&this._trigger("changeMonth",this.viewDate):37===n.keyCode||39===n.keyCode?r=this.moveAvailableDate(i,t,"moveDay"):this.weekOfDateIsDisabled(i)||(r=this.moveAvailableDate(i,t,"moveWeek")):1===this.viewMode?(38!==n.keyCode&&40!==n.keyCode||(t*=4),r=this.moveAvailableDate(i,t,"moveMonth")):2===this.viewMode&&(38!==n.keyCode&&40!==n.keyCode||(t*=4),r=this.moveAvailableDate(i,t,"moveYear"));r&&(this.focusDate=this.viewDate=r,this.setValue(),this.fill(),n.preventDefault());break;case 13:if(!this.o.forceParse)break;i=this.focusDate||this.dates.get(-1)||this.viewDate;this.o.keyboardNavigation&&(this._toggle_multidate(i),u=!0);this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.setValue();this.fill();this.picker.is(":visible")&&(n.preventDefault(),n.stopPropagation(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null;this.viewDate=this.dates.get(-1)||this.viewDate;this.fill();this.hide()}u&&(this.dates.length?this._trigger("changeDate"):this._trigger("clearDate"),this.inputField.trigger("change"))},setViewMode:function(n){this.viewMode=n;this.picker.children("div").hide().filter(".datepicker-"+i.viewModes[this.viewMode].clsName).show();this.updateNavArrows();this._trigger("changeViewMode",new Date(this.viewDate))}};c=function(t,i){n.data(t,"datepicker",this);this.element=n(t);this.inputs=n.map(i.inputs,function(n){return n.jquery?n[0]:n});delete i.inputs;this.keepEmptyValues=i.keepEmptyValues;delete i.keepEmptyValues;s.call(n(this.inputs),i).on("changeDate",n.proxy(this.dateUpdated,this));this.pickers=n.map(this.inputs,function(t){return n.data(t,"datepicker")});this.updateDates()};c.prototype={updateDates:function(){this.dates=n.map(this.pickers,function(n){return n.getUTCDate()});this.updateRanges()},updateRanges:function(){var t=n.map(this.dates,function(n){return n.valueOf()});n.each(this.pickers,function(n,i){i.setRange(t)})},clearDates:function(){n.each(this.pickers,function(n,t){t.clearDates()})},dateUpdated:function(i){var u;if(!this.updating&&(this.updating=!0,u=n.data(i.target,"datepicker"),u!==t)){var r=u.getUTCDate(),s=this.keepEmptyValues,o=n.inArray(i.target,this.inputs),f=o-1,e=o+1,h=this.inputs.length;if(-1!==o){if(n.each(this.pickers,function(n,t){t.getUTCDate()||t!==u&&s||t.setUTCDate(r)}),r<this.dates[f])for(;f>=0&&r<this.dates[f];)this.pickers[f--].setUTCDate(r);else if(r>this.dates[e])for(;e<h&&r>this.dates[e];)this.pickers[e++].setUTCDate(r);this.updateDates();delete this.updating}}},destroy:function(){n.map(this.pickers,function(n){n.destroy()});n(this.inputs).off("changeDate",this.dateUpdated);delete this.element.data().datepicker},remove:h("destroy","Method `remove` is deprecated and will be removed in version 2.0. Use `destroy` instead")};v=n.fn.datepicker;s=function(i){var f=Array.apply(null,arguments),r;if(f.shift(),this.each(function(){var s=n(this),t=s.data("datepicker"),h="object"==typeof i&&i;if(!t){var l=w(this,"date"),a=n.extend({},e,l,h),v=b(a.language),o=n.extend({},e,v,l,h);s.hasClass("input-daterange")||o.inputs?(n.extend(o,{inputs:o.inputs||s.find("input").toArray()}),t=new c(this,o)):t=new u(this,o);s.data("datepicker",t)}"string"==typeof i&&"function"==typeof t[i]&&(r=t[i].apply(t,f))}),r===t||r instanceof u||r instanceof c)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+i+" function)");return r};n.fn.datepicker=s;e=n.fn.datepicker.defaults={assumeNearbyYear:!1,autoclose:!1,beforeShowDay:n.noop,beforeShowMonth:n.noop,beforeShowYear:n.noop,beforeShowDecade:n.noop,beforeShowCentury:n.noop,calendarWeeks:!1,clearBtn:!1,toggleActive:!1,daysOfWeekDisabled:[],daysOfWeekHighlighted:[],datesDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keepEmptyValues:!1,keyboardNavigation:!0,language:"en",minViewMode:0,maxViewMode:4,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,updateViewDate:!0,weekStart:0,disableTouchKeyboard:!1,enableOnReadonly:!0,showOnFocus:!0,zIndexOffset:10,container:"body",immediateUpdates:!1,title:"",templates:{leftArrow:"&#x00AB;",rightArrow:"&#x00BB;"},showWeekDays:!0};y=n.fn.datepicker.locale_opts=["format","rtl","weekStart"];n.fn.datepicker.Constructor=u;r=n.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM yyyy"}};i={viewModes:[{names:["days","month"],clsName:"days",e:"changeMonth"},{names:["months","year"],clsName:"months",e:"changeYear",navStep:1},{names:["years","decade"],clsName:"years",e:"changeDecade",navStep:10},{names:["decades","century"],clsName:"decades",e:"changeCentury",navStep:100},{names:["centuries","millennium"],clsName:"centuries",e:"changeMillennium",navStep:1e3}],validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\u5e74\u6708\u65e5\[-`{-~\t\n\r]+/g,parseFormat:function(n){if("function"==typeof n.toValue&&"function"==typeof n.toDisplay)return n;var t=n.replace(this.validParts,"\0").split("\0"),i=n.match(this.validParts);if(!t||!t.length||!i||0===i.length)throw new Error("Invalid date format.");return{separators:t,parts:i}},parseDate:function(f,e,s,h){function et(n,t){return!0===t&&(t=10),n<100&&(n+=2e3)>(new Date).getFullYear()+t&&(n-=100),n}function tt(){var n=this.slice(0,l[c].length),t=l[c].slice(0,n.length);return n.toLowerCase()===t.toLowerCase()}var l,y,it,c,rt,ut,g,v,ft,k,d;if(!f)return t;if(f instanceof Date)return f;if("string"==typeof e&&(e=i.parseFormat(e)),e.toValue)return e.toValue(f,e,s);if(ut={d:"moveDay",m:"moveMonth",w:"moveWeek",y:"moveYear"},g={yesterday:"-1d",today:"+0d",tomorrow:"+1d"},f in g&&(f=g[f]),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/i.test(f)){for(l=f.match(/([\-+]\d+)([dmwy])/gi),f=new Date,c=0;c<l.length;c++)y=l[c].match(/([\-+]\d+)([dmwy])/i),it=Number(y[1]),rt=ut[y[2].toLowerCase()],f=u.prototype[rt](f,it);return u.prototype._zero_utc_time(f)}l=f&&f.match(this.nonpunctuation)||[];var p,w,b={},nt=["yyyy","yy","M","MM","m","mm","d","dd"],a={yyyy:function(n,t){return n.setUTCFullYear(h?et(t,h):t)},m:function(n,t){if(isNaN(n))return n;for(t-=1;t<0;)t+=12;for(t%=12,n.setUTCMonth(t);n.getUTCMonth()!==t;)n.setUTCDate(n.getUTCDate()-1);return n},d:function(n,t){return n.setUTCDate(t)}};if(a.yy=a.yyyy,a.M=a.MM=a.mm=a.m,a.dd=a.d,f=o(),v=e.parts.slice(),l.length!==v.length&&(v=n(v).filter(function(t,i){return-1!==n.inArray(i,nt)}).toArray()),l.length===v.length){for(c=0,ft=v.length;c<ft;c++){if(p=parseInt(l[c],10),y=v[c],isNaN(p))switch(y){case"MM":w=n(r[s].months).filter(tt);p=n.inArray(w[0],r[s].months)+1;break;case"M":w=n(r[s].monthsShort).filter(tt);p=n.inArray(w[0],r[s].monthsShort)+1}b[y]=p}for(c=0;c<nt.length;c++)(d=nt[c])in b&&!isNaN(b[d])&&(k=new Date(f),a[d](k,b[d]),isNaN(k)||(f=k))}return f},formatDate:function(t,u,f){var e;if(!t)return"";if("string"==typeof u&&(u=i.parseFormat(u)),u.toDisplay)return u.toDisplay(t,u,f);e={d:t.getUTCDate(),D:r[f].daysShort[t.getUTCDay()],DD:r[f].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:r[f].monthsShort[t.getUTCMonth()],MM:r[f].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};e.dd=(e.d<10?"0":"")+e.d;e.mm=(e.m<10?"0":"")+e.m;t=[];for(var s=n.extend([],u.separators),o=0,h=u.parts.length;o<=h;o++)s.length&&t.push(s.shift()),t.push(e[u.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th colspan="7" class="datepicker-title"><\/th><\/tr><tr><th class="prev">'+e.templates.leftArrow+'<\/th><th colspan="5" class="datepicker-switch"><\/th><th class="next">'+e.templates.rightArrow+"<\/th><\/tr><\/thead>",contTemplate:'<tbody><tr><td colspan="7"><\/td><\/tr><\/tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"><\/th><\/tr><tr><th colspan="7" class="clear"><\/th><\/tr><\/tfoot>'};i.template='<div class="datepicker"><div class="datepicker-days"><table class="table-condensed">'+i.headTemplate+"<tbody><\/tbody>"+i.footTemplate+'<\/table><\/div><div class="datepicker-months"><table class="table-condensed">'+i.headTemplate+i.contTemplate+i.footTemplate+'<\/table><\/div><div class="datepicker-years"><table class="table-condensed">'+i.headTemplate+i.contTemplate+i.footTemplate+'<\/table><\/div><div class="datepicker-decades"><table class="table-condensed">'+i.headTemplate+i.contTemplate+i.footTemplate+'<\/table><\/div><div class="datepicker-centuries"><table class="table-condensed">'+i.headTemplate+i.contTemplate+i.footTemplate+"<\/table><\/div><\/div>";n.fn.datepicker.DPGlobal=i;n.fn.datepicker.noConflict=function(){return n.fn.datepicker=v,this};n.fn.datepicker.version="1.9.0";n.fn.datepicker.deprecated=function(n){var t=window.console;t&&t.warn&&t.warn("DEPRECATED: "+n)};n(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var i=n(this);i.data("datepicker")||(t.preventDefault(),s.call(i,"show"))});n(function(){s.call(n('[data-provide="datepicker-inline"]'))})}),function(){"use strict";angular.module("fk.eternicode-datepicker",[]).provider("datepickerDefaults",function(){var n;return n={},{setDefaultOptions:function(t){return n=t},$get:function(){return n}}}).directive("datepicker",["$timeout","datepickerDefaults",function(n,t){return{restrict:"A",require:"ngModel",scope:{ngModel:"=",dpOptions:"="},link:function(i,r){var u,f,e,o,s;if(r.is("input"))throw"You can not add the datepicker directive to an input field";return e=r.hasClass("date"),o=r.has("input").length>0,u=o&&!e?r.children("input").first():r,f=$.extend(!0,{},t,i.dpOptions),u.datepicker(f).on("changeDate",function(){var t;return t=u.datepicker("getUTCDate"),t.setUTCHours(0,0,0,0,0),n(function(){return i.$apply(function(){return i.ngModel=t})})}).on("clearDate",function(){return n(function(){return i.$apply(function(){return i.ngModel=null})})}),s=function(){return u.is(":focus")||u.children("input").first().is(":focus")},i.$watch("ngModel",function(n){var t,i;if(null!=n&&!s()&&(t=new Date(n),i=u.datepicker("getUTCDate"),null==i||t.getTime()!==i.getTime()))return u.datepicker("setUTCDate",t)})}}}])}.call(this),function(n){"use strict";function t(n){return{restrict:"A",require:"ngModel",link:function(t,i,r,u){return n(function(){var f;f=r.value;t.$watch(r.ngModel,function(){n(function(){$(i).iCheck("update")})});t.$watch(r.ngDisabled,function(t){t!==undefined&&n(function(){t===!1&&$(i).iCheck("update");t===!0&&$(i).iCheck("update")})});return $(i).iCheck({checkboxClass:"icheckbox_minimal-yellow",radioClass:"iradio_minimal-yellow"}).on("ifChanged",function(n){return $(i).attr("type")==="checkbox"&&r.ngModel&&t.$apply(function(){return u.$setViewValue(n.target.checked)}),$(i).attr("type")==="radio"&&r.ngModel?t.$apply(function(){return u.$setViewValue(f)}):void 0})})}}}n.module("icheck",[]).directive("icheck",["$timeout",t])}(angular);!function(){"use strict";function i(n){return angular.isUndefined(n)||null===n}var n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,COMMAND:91,MAP:{91:"COMMAND",8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CTRL",18:"ALT",19:"PAUSEBREAK",20:"CAPSLOCK",27:"ESC",32:"SPACE",33:"PAGE_UP",34:"PAGE_DOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",43:"+",44:"PRINTSCREEN",45:"INSERT",46:"DELETE",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NUMLOCK",145:"SCROLLLOCK",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},isControl:function(t){var i=t.which;switch(i){case n.COMMAND:case n.SHIFT:case n.CTRL:case n.ALT:return!0}return!!(t.metaKey||t.ctrlKey||t.altKey)},isFunctionKey:function(n){return n=n.which?n.which:n,n>=112&&n<=123},isVerticalMovement:function(t){return~[n.UP,n.DOWN].indexOf(t)},isHorizontalMovement:function(t){return~[n.LEFT,n.RIGHT,n.BACKSPACE,n.DELETE].indexOf(t)},toSeparator:function(t){var i={ENTER:"\n",TAB:"\t",SPACE:" "}[t];return i?i:n[t]?void 0:t}},r,t;void 0===angular.element.prototype.querySelectorAll&&(angular.element.prototype.querySelectorAll=function(n){return angular.element(this[0].querySelectorAll(n))});void 0===angular.element.prototype.closest&&(angular.element.prototype.closest=function(n){for(var t=this[0],i=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t;){if(i.bind(t)(n))return t;t=t.parentElement}return!1});r=0;t=angular.module("ui.select",[]).constant("uiSelectConfig",{theme:"bootstrap",searchEnabled:!0,sortable:!1,placeholder:"",refreshDelay:1e3,closeOnSelect:!0,skipFocusser:!1,dropdownPosition:"auto",removeSelected:!0,resetSearchInput:!0,generateId:function(){return r++},appendToBody:!1,spinnerEnabled:!1,spinnerClass:"glyphicon glyphicon-refresh ui-select-spin",backspaceReset:!0}).service("uiSelectMinErr",function(){var n=angular.$$minErr("ui.select");return function(){var t=n.apply(this,arguments),i=t.message.replace(new RegExp("\nhttp://errors.angularjs.org/.*"),"");return new Error(i)}}).directive("uisTranscludeAppend",function(){return{link:function(n,t,i,r,u){u(n,function(n){t.append(n)})}}}).filter("highlight",function(){function n(n){return(""+n).replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}return function(t,i){return i&&t?(""+t).replace(new RegExp(n(i),"gi"),'<span class="ui-select-highlight">$&<\/span>'):t}}).factory("uisOffset",["$document","$window",function(n,t){return function(i){var r=i[0].getBoundingClientRect();return{width:r.width||i.prop("offsetWidth"),height:r.height||i.prop("offsetHeight"),top:r.top+(t.pageYOffset||n[0].documentElement.scrollTop),left:r.left+(t.pageXOffset||n[0].documentElement.scrollLeft)}}}]);t.factory("$$uisDebounce",["$timeout",function(n){return function(t,i){var r;return function(){var u=this,f=Array.prototype.slice.call(arguments);r&&n.cancel(r);r=n(function(){t.apply(u,f)},i)}}}]);t.directive("uiSelectChoices",["uiSelectConfig","uisRepeatParser","uiSelectMinErr","$compile","$window",function(n,t,i,r,u){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){t.addClass("ui-select-choices");var i=t.parent().attr("theme")||n.theme;return i+"/choices.tpl.html"},compile:function(r,f){var s,l,h,c,e,o,a;if(!f.repeat)throw i("repeat","Expected 'repeat' expression.");if(s=f.groupBy,l=f.groupFilter,s){if(h=r.querySelectorAll(".ui-select-choices-group"),1!==h.length)throw i("rows","Expected 1 .ui-select-choices-group but got '{0}'.",h.length);h.attr("ng-repeat",t.getGroupNgRepeatExpression())}if(c=t.parse(f.repeat),e=r.querySelectorAll(".ui-select-choices-row"),1!==e.length)throw i("rows","Expected 1 .ui-select-choices-row but got '{0}'.",e.length);if(e.attr("ng-repeat",c.repeatExpression(s)).attr("ng-if","$select.open"),o=r.querySelectorAll(".ui-select-choices-row-inner"),1!==o.length)throw i("rows","Expected 1 .ui-select-choices-row-inner but got '{0}'.",o.length);return o.attr("uis-transclude-append",""),a=u.document.addEventListener?e:o,a.attr("ng-click","$select.select("+c.itemName+",$select.skipFocusser,$event)"),function(t,i,u,f){f.parseRepeatAttr(u.repeat,s,l);f.disableChoiceExpression=u.uiDisableChoice;f.onHighlightCallback=u.onHighlight;f.minimumInputLength=parseInt(u.minimumInputLength)||0;f.dropdownPosition=u.position?u.position.toLowerCase():n.dropdownPosition;t.$watch("$select.search",function(n){n&&!f.open&&f.multiple&&f.activate(!1,!0);f.activeIndex=f.tagging.isActivated?-1:0;!u.minimumInputLength||f.search.length>=u.minimumInputLength?f.refresh(u.refresh):f.items=[]});u.$observe("refreshDelay",function(){var i=t.$eval(u.refreshDelay);f.refreshDelay=void 0!==i?i:n.refreshDelay});t.$watch("$select.open",function(n){n?(r.attr("role","listbox"),f.refresh(u.refresh)):i.removeAttr("role")})}}}}]);t.controller("uiSelectCtrl",["$scope","$element","$timeout","$filter","$$uisDebounce","uisRepeatParser","uiSelectMinErr","uiSelectConfig","$parse","$injector","$window",function(t,r,u,f,e,o,s,h,c,l,a){function rt(n,t,i){if(n.findIndex)return n.findIndex(t,i);for(var f,u=Object(n),e=u.length>>>0,r=0;r<e;r++)if(f=u[r],t.call(i,f,r,u))return r;return-1}function w(){v.resetSearchInput&&(v.search=k,v.selected&&v.items.length&&!v.multiple&&(v.activeIndex=rt(v.items,function(n){return angular.equals(this,n)},v.selected)))}function ut(n,t){for(var i,u=[],r=0;r<t.length;r++)for(i=0;i<n.length;i++)n[i].name==[t[r]]&&u.push(n[i]);return u}function ft(n,t){var i=y.indexOf(n);t&&i===-1&&y.push(n);!t&&i>-1&&y.splice(i,1)}function b(n){return y.indexOf(n)>-1}function et(n){function i(n,i){var r=t.indexOf(n);i&&r===-1&&t.push(n);!i&&r>-1&&t.splice(r,1)}function r(n){return t.indexOf(n)>-1}if(n){var t=[];v.isLocked=function(n,t){var u=!1,f=v.selected[t];return f&&(n?(u=!!n.$eval(v.lockChoiceExpression),i(f,u)):u=r(f)),u}}}function ot(t){var f=!0,i,u,r;switch(t){case n.DOWN:if(!v.open&&v.multiple)v.activate(!1,!0);else if(v.activeIndex<v.items.length-1)for(i=++v.activeIndex;b(v.items[i])&&i<v.items.length;)v.activeIndex=++i;break;case n.UP:if(u=0===v.search.length&&v.tagging.isActivated?-1:0,!v.open&&v.multiple)v.activate(!1,!0);else if(v.activeIndex>u)for(r=--v.activeIndex;b(v.items[r])&&r>u;)v.activeIndex=--r;break;case n.TAB:v.multiple&&!v.open||v.select(v.items[v.activeIndex],!0);break;case n.ENTER:v.open&&(v.tagging.isActivated||v.activeIndex>=0)?v.select(v.items[v.activeIndex],v.skipFocusser):v.activate(!1,!0);break;case n.ESC:v.close();break;default:f=!1}return f}function it(){var n=r.querySelectorAll(".ui-select-choices-content"),u=n.querySelectorAll(".ui-select-choices-row");if(u.length<1)throw s("choices","Expected multiple .ui-select-choices-row but got '{0}'.",u.length);if(!(v.activeIndex<0)){var t=u[v.activeIndex],i=t.offsetTop+t.clientHeight-n[0].scrollTop,f=n[0].offsetHeight;i>f?n[0].scrollTop+=i-f:i<t.clientHeight&&(v.isGrouped&&0===v.activeIndex?n[0].scrollTop=0:n[0].scrollTop-=t.clientHeight-i)}}var v=this,k="",g,nt,y,p,d,tt;if(v.placeholder=h.placeholder,v.searchEnabled=h.searchEnabled,v.sortable=h.sortable,v.refreshDelay=h.refreshDelay,v.paste=h.paste,v.resetSearchInput=h.resetSearchInput,v.refreshing=!1,v.spinnerEnabled=h.spinnerEnabled,v.spinnerClass=h.spinnerClass,v.removeSelected=h.removeSelected,v.closeOnSelect=!0,v.skipFocusser=!1,v.search=k,v.activeIndex=0,v.items=[],v.open=!1,v.focus=!1,v.disabled=!1,v.selected=void 0,v.dropdownPosition="auto",v.focusser=void 0,v.multiple=void 0,v.disableChoiceExpression=void 0,v.tagging={isActivated:!1,fct:void 0},v.taggingTokens={isActivated:!1,tokens:void 0},v.lockChoiceExpression=void 0,v.clickTriggeredSelect=!1,v.$filter=f,v.$element=r,v.$animate=function(){try{return l.get("$animate")}catch(n){return null}}(),v.searchInput=r.querySelectorAll("input.ui-select-search"),1!==v.searchInput.length)throw s("searchInput","Expected 1 input.ui-select-search but got '{0}'.",v.searchInput.length);v.isEmpty=function(){return i(v.selected)||""===v.selected||v.multiple&&0===v.selected.length};v.activate=function(n,i){var e,o,f;v.disabled||v.open?v.open&&!v.searchEnabled&&v.close():(i||w(),t.$broadcast("uis:activate"),v.open=!0,v.activeIndex=v.activeIndex>=v.items.length?0:v.activeIndex,v.activeIndex===-1&&v.taggingLabel!==!1&&(v.activeIndex=0),e=r.querySelectorAll(".ui-select-choices-content"),o=r.querySelectorAll(".ui-select-search"),v.$animate&&v.$animate.on&&v.$animate.enabled(e[0])?(f=function(t,i){"start"===i&&0===v.items.length?(v.$animate.off("removeClass",o[0],f),u(function(){v.focusSearchInput(n)})):"close"===i&&(v.$animate.off("enter",e[0],f),u(function(){v.focusSearchInput(n)}))},v.items.length>0?v.$animate.on("enter",e[0],f):v.$animate.on("removeClass",o[0],f)):u(function(){v.focusSearchInput(n);!v.tagging.isActivated&&v.items.length>1&&it()}))};v.focusSearchInput=function(n){v.search=n||v.search;v.searchInput[0].focus()};v.findGroupByName=function(n){return v.groups&&v.groups.filter(function(t){return t.name===n})[0]};v.parseRepeatAttr=function(n,i,r){function e(n){var f=t.$eval(i),u;(v.groups=[],angular.forEach(n,function(n){var t=angular.isFunction(f)?f(n):n[f],i=v.findGroupByName(t);i?i.items.push(n):v.groups.push({name:t,items:[n]})}),r)&&(u=t.$eval(r),angular.isFunction(u)?v.groups=u(v.groups):angular.isArray(u)&&(v.groups=ut(v.groups,u)));v.items=[];v.groups.forEach(function(n){v.items=v.items.concat(n.items)})}function h(n){v.items=n||[]}v.setItemsFn=i?e:h;v.parserResult=o.parse(n);v.isGrouped=!!i;v.itemProperty=v.parserResult.itemName;var u=v.parserResult.source,f=function(){var n=u(t);t.$uisSource=Object.keys(n).map(function(t){var i={};return i[v.parserResult.keyName]=t,i.value=n[t],i})};v.parserResult.keyName&&(f(),v.parserResult.source=c("$uisSource"+v.parserResult.filters),t.$watch(u,function(n,t){n!==t&&f()},!0));v.refreshItems=function(n){var i,r;n=n||v.parserResult.source(t);i=v.selected;!v.isEmpty()&&(!angular.isArray(i)||i.length)&&v.multiple&&v.removeSelected?void 0!==n&&null!==n&&(r=n.filter(function(n){return angular.isArray(i)?i.every(function(t){return!angular.equals(n,t)}):!angular.equals(n,i)}),v.setItemsFn(r)):v.setItemsFn(n);"auto"!==v.dropdownPosition&&"up"!==v.dropdownPosition||t.calculateDropdownPos();t.$broadcast("uis:refresh")};t.$watchCollection(v.parserResult.source,function(n){if(void 0===n||null===n)v.items=[];else{if(!angular.isArray(n))throw s("items","Expected an array but got '{0}'.",n);v.refreshItems(n);angular.isDefined(v.ngModel.$modelValue)&&(v.ngModel.$modelValue=null)}})};v.refresh=function(n){void 0!==n&&(g&&u.cancel(g),g=u(function(){if(t.$select.search.length>=t.$select.minimumInputLength){var i=t.$eval(n);i&&angular.isFunction(i.then)&&!v.refreshing&&(v.refreshing=!0,i["finally"](function(){v.refreshing=!1}))}},v.refreshDelay))};v.isActive=function(n){if(!v.open)return!1;var i=v.items.indexOf(n[v.itemProperty]),t=i==v.activeIndex;return!(!t||i<0)&&(t&&!angular.isUndefined(v.onHighlightCallback)&&n.$eval(v.onHighlightCallback),t)};nt=function(n){return v.selected&&angular.isArray(v.selected)&&v.selected.filter(function(t){return angular.equals(t,n)}).length>0};y=[];v.isDisabled=function(n){if(v.open){var i=n[v.itemProperty],r=v.items.indexOf(i),t=!1;if(r>=0&&(angular.isDefined(v.disableChoiceExpression)||v.multiple)){if(i.isTag)return!1;v.multiple&&(t=nt(i));!t&&angular.isDefined(v.disableChoiceExpression)&&(t=!!n.$eval(v.disableChoiceExpression));ft(i,t)}return t}};v.select=function(n,r,u){if(i(n)||!b(n)){if(!v.items&&!v.search&&!v.tagging.isActivated)return;if(!n||!b(n)){if(v.clickTriggeredSelect=!1,u&&("click"===u.type||"touchend"===u.type)&&n&&(v.clickTriggeredSelect=!0),v.tagging.isActivated&&v.clickTriggeredSelect===!1){if(v.taggingLabel===!1)if(v.activeIndex<0){if(void 0===n&&(n=void 0!==v.tagging.fct?v.tagging.fct(v.search):v.search),!n||angular.equals(v.items[0],n))return}else n=v.items[v.activeIndex];else if(0===v.activeIndex){if(void 0===n)return;if(void 0!==v.tagging.fct&&"string"==typeof n){if(n=v.tagging.fct(n),!n)return}else"string"==typeof n&&(n=n.replace(v.taggingLabel,"").trim())}if(nt(n))return void v.close(r)}w();t.$broadcast("uis:select",n);v.closeOnSelect&&v.close(r)}}};v.close=function(n){v.open&&(v.ngModel&&v.ngModel.$setTouched&&v.ngModel.$setTouched(),v.open=!1,w(),t.$broadcast("uis:close",n))};v.setFocus=function(){v.focus||v.focusInput[0].focus()};v.clear=function(n){v.select(null);n.stopPropagation();u(function(){v.focusser[0].focus()},0,!1)};v.toggle=function(n){v.open?(v.close(),n.preventDefault(),n.stopPropagation()):v.activate()};v.isLocked=function(){return!1};t.$watch(function(){return angular.isDefined(v.lockChoiceExpression)&&""!==v.lockChoiceExpression},et);p=null;d=!1;v.sizeSearchInput=function(){var n=v.searchInput[0],f=v.$element[0],i=function(){return f.clientWidth*!!n.offsetParent},r=function(t){if(0===t)return!1;var i=t-n.offsetLeft;return i<50&&(i=t),v.searchInput.css("width",i+"px"),!0};v.searchInput.css("width","10px");u(function(){null!==p||r(i())||(p=t.$watch(function(){d||(d=!0,t.$$postDigest(function(){d=!1;r(i())&&(p(),p=null)}))},angular.noop))})};v.searchInput.on("keydown",function(i){var r=i.which;~[n.ENTER,n.ESC].indexOf(r)&&(i.preventDefault(),i.stopPropagation());t.$apply(function(){var f=!1,t;if((v.items.length>0||v.tagging.isActivated)&&(ot(r)||v.searchEnabled||(i.preventDefault(),i.stopPropagation()),v.taggingTokens.isActivated)){for(t=0;t<v.taggingTokens.tokens.length;t++)v.taggingTokens.tokens[t]===n.MAP[i.keyCode]&&v.search.length>0&&(f=!0);f&&u(function(){v.searchInput.triggerHandler("tagged");var t=v.search.replace(n.MAP[i.keyCode],"").trim();v.tagging.fct&&(t=v.tagging.fct(t));t&&v.select(t,!0)})}});n.isVerticalMovement(r)&&v.items.length>0&&it();r!==n.ENTER&&r!==n.ESC||(i.preventDefault(),i.stopPropagation())});v.searchInput.on("paste",function(t){var i,r,u,f,e;if(i=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):(t.originalEvent||t).clipboardData.getData("text/plain"),i=v.search+i,i&&i.length>0)if(v.taggingTokens.isActivated){for(r=[],u=0;u<v.taggingTokens.tokens.length;u++)if(f=n.toSeparator(v.taggingTokens.tokens[u])||v.taggingTokens.tokens[u],i.indexOf(f)>-1){r=i.split(f);break}0===r.length&&(r=[i]);e=v.search;angular.forEach(r,function(n){var t=v.tagging.fct?v.tagging.fct(n):n;t&&v.select(t,!0)});v.search=e||k;t.preventDefault();t.stopPropagation()}else v.paste&&(v.paste(i),v.search=k,t.preventDefault(),t.stopPropagation())});v.searchInput.on("tagged",function(){u(function(){w()})});tt=e(function(){v.sizeSearchInput()},50);angular.element(a).bind("resize",tt);t.$on("$destroy",function(){v.searchInput.off("keyup keydown tagged blur paste");angular.element(a).off("resize",tt)});t.$watch("$select.activeIndex",function(n){n&&r.find("input").attr("aria-activedescendant","ui-select-choices-row-"+v.generatedId+"-"+n)});t.$watch("$select.open",function(n){n||r.find("input").removeAttr("aria-activedescendant")})}]);t.directive("uiSelect",["$document","uiSelectConfig","uiSelectMinErr","uisOffset","$compile","$parse","$timeout",function(n,t,i,r,u,f,e){return{restrict:"EA",templateUrl:function(n,i){var r=i.theme||t.theme;return r+(angular.isDefined(i.multiple)?"/select-multiple.tpl.html":"/select.tpl.html")},replace:!0,transclude:!0,require:["uiSelect","^ngModel"],scope:!0,controller:"uiSelectCtrl",controllerAs:"$select",compile:function(u,o){var s=/{(.*)}\s*{(.*)}/.exec(o.ngClass),h;return s&&(h="{"+s[1]+", "+s[2]+"}",o.ngClass=h,u.attr("ng-class",h)),angular.isDefined(o.multiple)?u.append("<ui-select-multiple/>").removeAttr("multiple"):u.append("<ui-select-single/>"),o.inputId&&(u.querySelectorAll("input.ui-select-search")[0].id=o.inputId),function(u,o,s,h,c){function w(n){var i,t,f,r;l.open&&(i=!1,(i=window.jQuery?window.jQuery.contains(o[0],n.target):o[0].contains(n.target),i||l.clickTriggeredSelect)||(l.skipFocusser?t=!0:(f=["input","button","textarea","select"],r=angular.element(n.target).controller("uiSelect"),t=r&&r!==l,t||(t=~f.indexOf(n.target.tagName.toLowerCase()))),l.close(t),u.$digest()),l.clickTriggeredSelect=!1)}function tt(){var t=r(o);v=angular.element('<div class="ui-select-placeholder"><\/div>');v[0].style.width=t.width+"px";v[0].style.height=t.height+"px";o.after(v);k=o[0].style.width;n.find("body").append(o);o[0].style.position="absolute";o[0].style.left=t.left+"px";o[0].style.top=t.top+"px";o[0].style.width=t.width+"px"}function b(){null!==v&&(v.replaceWith(o),v=null,o[0].style.position="",o[0].style.left="",o[0].style.top="",o[0].style.width=k,l.setFocus())}var l=h[0],it=h[1],p;l.generatedId=t.generateId();l.baseTitle=s.title||"Select box";l.focusserTitle=l.baseTitle+" focus";l.focusserId="focusser-"+l.generatedId;l.closeOnSelect=function(){return angular.isDefined(s.closeOnSelect)?f(s.closeOnSelect)():t.closeOnSelect}();u.$watch("skipFocusser",function(){var n=u.$eval(s.skipFocusser);l.skipFocusser=void 0!==n?n:t.skipFocusser});l.onSelectCallback=f(s.onSelect);l.onRemoveCallback=f(s.onRemove);l.ngModel=it;l.choiceGrouped=function(n){return l.isGrouped&&n&&n.name};s.tabindex&&s.$observe("tabindex",function(n){l.focusInput.attr("tabindex",n);o.removeAttr("tabindex")});u.$watch(function(){return u.$eval(s.searchEnabled)},function(n){l.searchEnabled=void 0!==n?n:t.searchEnabled});u.$watch("sortable",function(){var n=u.$eval(s.sortable);l.sortable=void 0!==n?n:t.sortable});s.$observe("backspaceReset",function(){var n=u.$eval(s.backspaceReset);l.backspaceReset=void 0===n||n});s.$observe("limit",function(){l.limit=angular.isDefined(s.limit)?parseInt(s.limit,10):void 0});u.$watch("removeSelected",function(){var n=u.$eval(s.removeSelected);l.removeSelected=void 0!==n?n:t.removeSelected});s.$observe("disabled",function(){l.disabled=void 0!==s.disabled&&s.disabled});s.$observe("resetSearchInput",function(){var n=u.$eval(s.resetSearchInput);l.resetSearchInput=void 0===n||n});s.$observe("paste",function(){l.paste=u.$eval(s.paste)});s.$observe("tagging",function(){if(void 0!==s.tagging){var n=u.$eval(s.tagging);l.tagging={isActivated:!0,fct:n!==!0?n:void 0}}else l.tagging={isActivated:!1,fct:void 0}});s.$observe("taggingLabel",function(){void 0!==s.tagging&&(l.taggingLabel="false"===s.taggingLabel?!1:void 0!==s.taggingLabel?s.taggingLabel:"(new)")});s.$observe("taggingTokens",function(){if(void 0!==s.tagging){var n=void 0!==s.taggingTokens?s.taggingTokens.split("|"):[",","ENTER"];l.taggingTokens={isActivated:!0,tokens:n}}});s.$observe("spinnerEnabled",function(){var n=u.$eval(s.spinnerEnabled);l.spinnerEnabled=void 0!==n?n:t.spinnerEnabled});s.$observe("spinnerClass",function(){var n=s.spinnerClass;l.spinnerClass=void 0!==n?s.spinnerClass:t.spinnerClass});angular.isDefined(s.autofocus)&&e(function(){l.setFocus()});angular.isDefined(s.focusOn)&&u.$on(s.focusOn,function(){e(function(){l.setFocus()})});n.on("click",w);u.$on("$destroy",function(){n.off("click",w)});c(u,function(n){var f=angular.element("<div>").append(n),r=f.querySelectorAll(".ui-select-match"),t,u;if(r.removeAttr("ui-select-match"),r.removeAttr("data-ui-select-match"),1!==r.length)throw i("transcluded","Expected 1 .ui-select-match but got '{0}'.",r.length);if(o.querySelectorAll(".ui-select-match").replaceWith(r),t=f.querySelectorAll(".ui-select-choices"),t.removeAttr("ui-select-choices"),t.removeAttr("data-ui-select-choices"),1!==t.length)throw i("transcluded","Expected 1 .ui-select-choices but got '{0}'.",t.length);o.querySelectorAll(".ui-select-choices").replaceWith(t);u=f.querySelectorAll(".ui-select-no-choice");u.removeAttr("ui-select-no-choice");u.removeAttr("data-ui-select-no-choice");1==u.length&&o.querySelectorAll(".ui-select-no-choice").replaceWith(u)});p=u.$eval(s.appendToBody);(void 0!==p?p:t.appendToBody)&&(u.$watch("$select.open",function(n){n?tt():b()}),u.$on("$destroy",function(){b()}));var v=null,k="",a=null,y="direction-up";u.$watch("$select.open",function(){"auto"!==l.dropdownPosition&&"up"!==l.dropdownPosition||u.calculateDropdownPos()});var d=function(n,t){n=n||r(o);t=t||r(a);a[0].style.position="absolute";a[0].style.top=t.height*-1+"px";o.addClass(y)},rt=function(n,t){o.removeClass(y);n=n||r(o);t=t||r(a);a[0].style.position="";a[0].style.top=""},g=function(){e(function(){if("up"===l.dropdownPosition)d();else{o.removeClass(y);var t=r(o),i=r(a),u=n[0].documentElement.scrollTop||n[0].body.scrollTop;t.top+t.height+i.height>u+n[0].documentElement.clientHeight?d(t,i):rt(t,i)}a[0].style.opacity=1})},nt=!1;u.calculateDropdownPos=function(){if(l.open){if(a=angular.element(o).querySelectorAll(".ui-select-dropdown"),0===a.length)return;if(""!==l.search||nt||(a[0].style.opacity=0,nt=!0),!r(a).height&&l.$animate&&l.$animate.on&&l.$animate.enabled(a)){var n=!0;l.$animate.on("enter",a,function(t,i){"close"===i&&n&&(g(),n=!1)})}else g()}else{if(null===a||0===a.length)return;a[0].style.opacity=0;a[0].style.position="";a[0].style.top="";o.removeClass(y)}}}}}}]);t.directive("uiSelectMatch",["uiSelectConfig",function(n){function t(n,t){return n[0].hasAttribute(t)?n.attr(t):n[0].hasAttribute("data-"+t)?n.attr("data-"+t):n[0].hasAttribute("x-"+t)?n.attr("x-"+t):void 0}return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(i){i.addClass("ui-select-match");var r=i.parent(),u=t(r,"theme")||n.theme,f=angular.isDefined(t(r,"multiple"));return u+(f?"/match-multiple.tpl.html":"/match.tpl.html")},link:function(t,i,r,u){function f(n){u.allowClear=!!angular.isDefined(n)&&(""===n||"true"===n.toLowerCase())}u.lockChoiceExpression=r.uiLockChoice;r.$observe("placeholder",function(t){u.placeholder=void 0!==t?t:n.placeholder});r.$observe("allowClear",f);f(r.allowClear);u.multiple&&u.sizeSearchInput()}}}]);t.directive("uiSelectMultiple",["uiSelectMinErr","$timeout",function(t,r){return{restrict:"EA",require:["^uiSelect","^ngModel"],controller:["$scope","$timeout",function(n,t){var u,r=this,i=n.$select;angular.isUndefined(i.selected)&&(i.selected=[]);n.$evalAsync(function(){u=n.ngModel});r.activeMatchIndex=-1;r.updateModel=function(){u.$setViewValue(Date.now());r.refreshComponent()};r.refreshComponent=function(){i.refreshItems&&i.refreshItems();i.sizeSearchInput&&i.sizeSearchInput()};r.removeChoice=function(u){if(i.isLocked(null,u))return!1;var f=i.selected[u],e={};return e[i.parserResult.itemName]=f,i.selected.splice(u,1),r.activeMatchIndex=-1,i.sizeSearchInput(),t(function(){i.onRemoveCallback(n,{$item:f,$model:i.parserResult.modelMapper(n,e)})}),r.updateModel(),!0};r.getPlaceholder=function(){if(!i.selected||!i.selected.length)return i.placeholder}}],controllerAs:"$selectMultiple",link:function(u,f,e,o){function v(n){return angular.isNumber(n.selectionStart)?n.selectionStart:n.value.length}function y(t){function e(){switch(t){case n.LEFT:return~h.activeMatchIndex?f:r;case n.RIGHT:return~h.activeMatchIndex&&i!==r?l:(s.activate(),!1);case n.BACKSPACE:return~h.activeMatchIndex?h.removeChoice(i)?f:i:r;case n.DELETE:return!!~h.activeMatchIndex&&(h.removeChoice(h.activeMatchIndex),i)}}var o=v(s.searchInput[0]),c=s.selected.length,r=c-1,i=h.activeMatchIndex,l=h.activeMatchIndex+1,f=h.activeMatchIndex-1,u=i;return!(o>0||s.search.length&&t==n.RIGHT)&&(s.close(),u=e(),h.activeMatchIndex=s.selected.length&&u!==!1?Math.min(r,Math.max(0,u)):-1,!0)}function l(n){if(void 0===n||void 0===s.search)return!1;return n.filter(function(n){return void 0!==s.search.toUpperCase()&&void 0!==n&&n.toUpperCase()===s.search.toUpperCase()}).length>0}function a(n,t){var f=-1,r,i,u;if(angular.isArray(n))for(r=angular.copy(n),i=0;i<r.length;i++)void 0===s.tagging.fct?r[i]+" "+s.taggingLabel===t&&(f=i):(u=r[i],angular.isObject(u)&&(u.isTag=!0),angular.equals(u,t)&&(f=i));return f}var s=o[0],c=u.ngModel=o[1],h=u.$selectMultiple;s.multiple=!0;s.focusInput=s.searchInput;c.$isEmpty=function(n){return!n||0===n.length};c.$parsers.unshift(function(){for(var i,n={},r=[],t=s.selected.length-1;t>=0;t--)n={},n[s.parserResult.itemName]=s.selected[t],i=s.parserResult.modelMapper(u,n),r.unshift(i);return r});c.$formatters.unshift(function(n){var r,e=s.parserResult&&s.parserResult.source(u,{$select:{search:""}}),o={},t,f,i;if(!e)return n;if(t=[],f=function(n,i){var f,h,e;if(n&&n.length){for(f=n.length-1;f>=0;f--)if((o[s.parserResult.itemName]=n[f],r=s.parserResult.modelMapper(u,o),s.parserResult.trackByExp)&&(h=/(\w*)\./.exec(s.parserResult.trackByExp),e=/\.([^\s]+)/.exec(s.parserResult.trackByExp),h&&h.length>0&&h[1]==s.parserResult.itemName&&e&&e.length>0&&r[e[1]]==i[e[1]])||angular.equals(r,i))return t.unshift(n[f]),!0;return!1}},!n)return t;for(i=n.length-1;i>=0;i--)f(s.selected,n[i])||f(e,n[i])||t.unshift(n[i]);return t});u.$watchCollection(function(){return c.$modelValue},function(n,t){t!=n&&(angular.isDefined(c.$modelValue)&&(c.$modelValue=null),h.refreshComponent())});c.$render=function(){if(!angular.isArray(c.$viewValue)){if(!i(c.$viewValue))throw t("multiarr","Expected model value to be array but got '{0}'",c.$viewValue);c.$viewValue=[]}s.selected=c.$viewValue;h.refreshComponent();u.$evalAsync()};u.$on("uis:select",function(n,t){if(!(s.selected.length>=s.limit)){s.selected.push(t);var i={};i[s.parserResult.itemName]=t;r(function(){s.onSelectCallback(u,{$item:t,$model:s.parserResult.modelMapper(u,i)})});h.updateModel()}});u.$on("uis:activate",function(){h.activeMatchIndex=-1});u.$watch("$select.disabled",function(n,t){t&&!n&&s.sizeSearchInput()});s.searchInput.on("keydown",function(t){var i=t.which;u.$apply(function(){var r=!1;n.isHorizontalMovement(i)&&(r=y(i));r&&i!=n.TAB&&(t.preventDefault(),t.stopPropagation())})});s.searchInput.on("keyup",function(t){if(n.isVerticalMovement(t.which)||u.$evalAsync(function(){s.activeIndex=s.taggingLabel===!1?-1:0}),s.tagging.isActivated&&s.search.length>0){if(t.which===n.TAB||n.isControl(t)||n.isFunctionKey(t)||t.which===n.ESC||n.isVerticalMovement(t.which))return;if(s.activeIndex=s.taggingLabel===!1?-1:0,s.taggingLabel===!1)return;var r,v,e,h,i=angular.copy(s.items),f=angular.copy(s.items),o=!1,c=-1;if(void 0!==s.tagging.fct){if(e=s.$filter("filter")(i,{isTag:!0}),e.length>0&&(h=e[0]),i.length>0&&h&&(o=!0,i=i.slice(1,i.length),f=f.slice(1,f.length)),r=s.tagging.fct(s.search),f.some(function(n){return angular.equals(n,r)})||s.selected.some(function(n){return angular.equals(n,r)}))return void u.$evalAsync(function(){s.activeIndex=0;s.items=i});r&&(r.isTag=!0)}else{if(e=s.$filter("filter")(i,function(n){return n.match(s.taggingLabel)}),e.length>0&&(h=e[0]),v=i[0],void 0!==v&&i.length>0&&h&&(o=!0,i=i.slice(1,i.length),f=f.slice(1,f.length)),r=s.search+" "+s.taggingLabel,a(s.selected,s.search)>-1)return;if(l(f.concat(s.selected)))return void(o&&(i=f,u.$evalAsync(function(){s.activeIndex=0;s.items=i})));if(l(f))return void(o&&(s.items=f.slice(1,f.length)))}o&&(c=a(s.selected,r));c>-1?i=i.slice(c+1,i.length-1):(i=[],r&&i.push(r),i=i.concat(f));u.$evalAsync(function(){if(s.activeIndex=0,s.items=i,s.isGrouped){var n=r?i.slice(1):i;s.setItemsFn(n);r&&(s.items.unshift(r),s.groups.unshift({name:"",items:[r],tagging:!0}))}})}});s.searchInput.on("blur",function(){r(function(){h.activeMatchIndex=-1})})}}}]);t.directive("uiSelectNoChoice",["uiSelectConfig",function(n){return{restrict:"EA",require:"^uiSelect",replace:!0,transclude:!0,templateUrl:function(t){t.addClass("ui-select-no-choice");var i=t.parent().attr("theme")||n.theme;return i+"/no-choice.tpl.html"}}}]);t.directive("uiSelectSingle",["$timeout","$compile",function(t,r){return{restrict:"EA",require:["^uiSelect","^ngModel"],link:function(u,f,e,o){var s=o[0],c=o[1],h;c.$parsers.unshift(function(n){if(i(n))return n;var r,t={};return t[s.parserResult.itemName]=n,r=s.parserResult.modelMapper(u,t)});c.$formatters.unshift(function(n){var o,t,f,e,r;if(i(n))return n;if(t=s.parserResult&&s.parserResult.source(u,{$select:{search:""}}),f={},t){if(e=function(t){return f[s.parserResult.itemName]=t,o=s.parserResult.modelMapper(u,f),o===n},s.selected&&e(s.selected))return s.selected;for(r=t.length-1;r>=0;r--)if(e(t[r]))return t[r]}return n});u.$watch("$select.selected",function(n){c.$viewValue!==n&&c.$setViewValue(n)});c.$render=function(){s.selected=c.$viewValue};u.$on("uis:select",function(n,r){s.selected=r;var f={};f[s.parserResult.itemName]=r;t(function(){s.onSelectCallback(u,{$item:r,$model:i(r)?r:s.parserResult.modelMapper(u,f)})})});u.$on("uis:close",function(n,i){t(function(){s.focusser.prop("disabled",!1);i||s.focusser[0].focus()},0,!1)});u.$on("uis:activate",function(){h.prop("disabled",!0)});h=angular.element("<input ng-disabled='$select.disabled' class='ui-select-focusser ui-select-offscreen' type='text' id='{{ $select.focusserId }}' aria-label='{{ $select.focusserTitle }}' aria-haspopup='true' role='button' />");r(h)(u);s.focusser=h;s.focusInput=h;f.parent().append(h);h.bind("focus",function(){u.$evalAsync(function(){s.focus=!0})});h.bind("blur",function(){u.$evalAsync(function(){s.focus=!1})});h.bind("keydown",function(t){return t.which===n.BACKSPACE&&s.backspaceReset!==!1?(t.preventDefault(),t.stopPropagation(),s.select(void 0),void u.$apply()):void(t.which===n.TAB||n.isControl(t)||n.isFunctionKey(t)||t.which===n.ESC||(t.which!=n.DOWN&&t.which!=n.UP&&t.which!=n.ENTER&&t.which!=n.SPACE||(t.preventDefault(),t.stopPropagation(),s.activate()),u.$digest()))});h.bind("keyup input",function(t){t.which===n.TAB||n.isControl(t)||n.isFunctionKey(t)||t.which===n.ESC||t.which==n.ENTER||t.which===n.BACKSPACE||(s.activate(h.val()),h.val(""),u.$digest())})}}}]);t.directive("uiSelectSort",["$timeout","uiSelectConfig","uiSelectMinErr",function(n,t,i){return{require:["^^uiSelect","^ngModel"],link:function(t,r,u,f){if(null===t[u.uiSelectSort])throw i("sort","Expected a list to sort");var a=f[0],w=f[1],b=angular.extend({axis:"horizontal"},t.$eval(u.uiSelectSortOptions)),v=b.axis,h="dragging",c="dropping",o="dropping-before",s="dropping-after";t.$watch(function(){return a.sortable},function(n){n?r.attr("draggable",!0):r.removeAttr("draggable")});r.on("dragstart",function(n){r.addClass(h);(n.dataTransfer||n.originalEvent.dataTransfer).setData("text",t.$index.toString())});r.on("dragend",function(){e(h)});var y,k=function(n,t){this.splice(t,0,this.splice(n,1)[0])},e=function(n){angular.forEach(a.$element.querySelectorAll("."+n),function(t){angular.element(t).removeClass(n)})},p=function(n){n.preventDefault();var t="vertical"===v?n.offsetY||n.layerY||(n.originalEvent?n.originalEvent.offsetY:0):n.offsetX||n.layerX||(n.originalEvent?n.originalEvent.offsetX:0);t<this["vertical"===v?"offsetHeight":"offsetWidth"]/2?(e(s),r.addClass(o)):(e(o),r.addClass(s))},l=function(t){t.preventDefault();var i=parseInt((t.dataTransfer||t.originalEvent.dataTransfer).getData("text"),10);n.cancel(y);y=n(function(){d(i)},20)},d=function(n){var i=t.$eval(u.uiSelectSort),h=i[n],f=null;f=r.hasClass(o)?n<t.$index?t.$index-1:t.$index:n<t.$index?t.$index:t.$index+1;k.apply(i,[n,f]);w.$setViewValue(Date.now());t.$apply(function(){t.$emit("uiSelectSort:change",{array:i,item:h,from:n,to:f})});e(c);e(o);e(s);r.off("drop",l)};r.on("dragenter",function(){r.hasClass(h)||(r.addClass(c),r.on("dragover",p),r.on("drop",l))});r.on("dragleave",function(n){n.target==r&&(e(c),e(o),e(s),r.off("dragover",p),r.off("drop",l))})}}}]);t.directive("uisOpenClose",["$parse","$timeout",function(n,t){return{restrict:"A",require:"uiSelect",link:function(i,r,u,f){f.onOpenCloseCallback=n(u.uisOpenClose);i.$watch("$select.open",function(n,r){n!==r&&t(function(){f.onOpenCloseCallback(i,{isOpen:n})})})}}}]);t.service("uisRepeatParser",["uiSelectMinErr","$parse",function(n,t){var i=this;i.parse=function(i){var r,u,f,e;if(r=i.match(/^\s*(?:([\s\S]+?)\s+as\s+)?(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+(\s*[\s\S]+?)?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),!r)throw n("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",i);return u=r[5],f="",r[3]&&(u=r[5].replace(/(^\()|(\)$)/g,""),e=r[5].match(/^\s*(?:[\s\S]+?)(?:[^\|]|\|\|)+([\s\S]*)\s*$/),e&&e[1].trim()&&(f=e[1],u=u.replace(f,""))),{itemName:r[4]||r[2],keyName:r[3],source:t(u),filters:f,trackByExp:r[6],modelMapper:t(r[1]||r[4]||r[2]),repeatExpression:function(n){var t=this.itemName+" in "+(n?"$group.items":"$select.items");return this.trackByExp&&(t+=" track by "+this.trackByExp),t}}};i.getGroupNgRepeatExpression=function(){return"$group in $select.groups track by $group.name"}}])}();angular.module("ui.select").run(["$templateCache",function(n){n.put("bootstrap/choices.tpl.html",'<ul class="ui-select-choices ui-select-choices-content ui-select-dropdown dropdown-menu" ng-show="$select.open && $select.items.length > 0"><li class="ui-select-choices-group" id="ui-select-choices-{{ $select.generatedId }}"><div class="divider" ng-show="$select.isGrouped && $index > 0"><\/div><div ng-show="$select.isGrouped" class="ui-select-choices-group-label dropdown-header" ng-bind="$group.name"><\/div><div ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}" role="option"><span class="ui-select-choices-row-inner"><\/span><\/div><\/li><\/ul>');n.put("bootstrap/match-multiple.tpl.html",'<span class="ui-select-match"><span ng-repeat="$item in $select.selected track by $index"><span class="ui-select-match-item btn btn-default btn-xs" tabindex="-1" type="button" ng-disabled="$select.disabled" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'btn-primary\':$selectMultiple.activeMatchIndex === $index, \'select-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span class="close ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&nbsp;&times;<\/span> <span uis-transclude-append=""><\/span><\/span><\/span><\/span>');n.put("bootstrap/match.tpl.html",'<div class="ui-select-match" ng-hide="$select.open && $select.searchEnabled" ng-disabled="$select.disabled" ng-class="{\'btn-default-focus\':$select.focus}"><span tabindex="-1" class="btn btn-default form-control ui-select-toggle" aria-label="{{ $select.baseTitle }} activate" ng-disabled="$select.disabled" ng-click="$select.activate()" style="outline: 0;"><span ng-show="$select.isEmpty()" class="ui-select-placeholder text-muted">{{$select.placeholder}}<\/span> <span ng-hide="$select.isEmpty()" class="ui-select-match-text pull-left" ng-class="{\'ui-select-allow-clear\': $select.allowClear && !$select.isEmpty()}" ng-transclude=""><\/span> <i class="caret pull-right" ng-click="$select.toggle($event)"><\/i> <a ng-show="$select.allowClear && !$select.isEmpty() && ($select.disabled !== true)" aria-label="{{ $select.baseTitle }} clear" style="margin-right: 10px" ng-click="$select.clear($event)" class="btn btn-xs btn-link pull-right"><i class="glyphicon glyphicon-remove" aria-hidden="true"><\/i><\/a><\/span><\/div>');n.put("bootstrap/no-choice.tpl.html",'<ul class="ui-select-no-choice dropdown-menu" ng-show="$select.items.length == 0"><li ng-transclude=""><\/li><\/ul>');n.put("bootstrap/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple ui-select-bootstrap dropdown form-control" ng-class="{open: $select.open}"><div><div class="ui-select-match"><\/div><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" class="ui-select-search input-xs" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-click="$select.activate()" ng-model="$select.search" role="combobox" aria-expanded="{{$select.open}}" aria-label="{{$select.baseTitle}}" ng-class="{\'spinner\': $select.refreshing}" ondrop="return false;"><\/div><div class="ui-select-choices"><\/div><div class="ui-select-no-choice"><\/div><\/div>');n.put("bootstrap/select.tpl.html",'<div class="ui-select-container ui-select-bootstrap dropdown" ng-class="{open: $select.open}"><div class="ui-select-match"><\/div><span ng-show="$select.open && $select.refreshing && $select.spinnerEnabled" class="ui-select-refreshing {{$select.spinnerClass}}"><\/span> <input type="search" autocomplete="off" tabindex="-1" aria-expanded="true" aria-label="{{ $select.baseTitle }}" aria-owns="ui-select-choices-{{ $select.generatedId }}" class="form-control ui-select-search" ng-class="{ \'ui-select-search-hidden\' : !$select.searchEnabled }" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-show="$select.open"><div class="ui-select-choices"><\/div><div class="ui-select-no-choice"><\/div><\/div>');n.put("select2/choices.tpl.html",'<ul tabindex="-1" class="ui-select-choices ui-select-choices-content select2-results"><li class="ui-select-choices-group" ng-class="{\'select2-result-with-children\': $select.choiceGrouped($group) }"><div ng-show="$select.choiceGrouped($group)" class="ui-select-choices-group-label select2-result-label" ng-bind="$group.name"><\/div><ul id="ui-select-choices-{{ $select.generatedId }}" ng-class="{\'select2-result-sub\': $select.choiceGrouped($group), \'select2-result-single\': !$select.choiceGrouped($group) }"><li role="option" ng-attr-id="ui-select-choices-row-{{ $select.generatedId }}-{{$index}}" class="ui-select-choices-row" ng-class="{\'select2-highlighted\': $select.isActive(this), \'select2-disabled\': $select.isDisabled(this)}"><div class="select2-result-label ui-select-choices-row-inner"><\/div><\/li><\/ul><\/li><\/ul>');n.put("select2/match-multiple.tpl.html",'<span class="ui-select-match"><li class="ui-select-match-item select2-search-choice" ng-repeat="$item in $select.selected track by $index" ng-class="{\'select2-search-choice-focus\':$selectMultiple.activeMatchIndex === $index, \'select2-locked\':$select.isLocked(this, $index)}" ui-select-sort="$select.selected"><span uis-transclude-append=""><\/span> <a href="javascript:;" class="ui-select-match-close select2-search-choice-close" ng-click="$selectMultiple.removeChoice($index)" tabindex="-1"><\/a><\/li><\/span>');n.put("select2/match.tpl.html",'<a class="select2-choice ui-select-match" ng-class="{\'select2-default\': $select.isEmpty()}" ng-click="$select.toggle($event)" aria-label="{{ $select.baseTitle }} select"><span ng-show="$select.isEmpty()" class="select2-chosen">{{$select.placeholder}}<\/span> <span ng-hide="$select.isEmpty()" class="select2-chosen" ng-transclude=""><\/span> <abbr ng-if="$select.allowClear && !$select.isEmpty()" class="select2-search-choice-close" ng-click="$select.clear($event)"><\/abbr> <span class="select2-arrow ui-select-toggle"><b><\/b><\/span><\/a>');n.put("select2/no-choice.tpl.html",'<div class="ui-select-no-choice dropdown" ng-show="$select.items.length == 0"><div class="dropdown-content"><div data-selectable="" ng-transclude=""><\/div><\/div><\/div>');n.put("select2/select-multiple.tpl.html",'<div class="ui-select-container ui-select-multiple select2 select2-container select2-container-multi" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled}"><ul class="select2-choices"><span class="ui-select-match"><\/span><li class="select2-search-field"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" aria-activedescendant="ui-select-choices-row-{{ $select.generatedId }}-{{ $select.activeIndex }}" class="select2-input ui-select-search" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-disabled="$select.disabled" ng-hide="$select.disabled" ng-model="$select.search" ng-click="$select.activate()" style="width: 34px;" ondrop="return false;"><\/li><\/ul><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open || $select.items.length === 0}"><div class="ui-select-choices"><\/div><\/div><\/div>');n.put("select2/select.tpl.html",'<div class="ui-select-container select2 select2-container" ng-class="{\'select2-container-active select2-dropdown-open open\': $select.open, \'select2-container-disabled\': $select.disabled, \'select2-container-active\': $select.focus, \'select2-allowclear\': $select.allowClear && !$select.isEmpty()}"><div class="ui-select-match"><\/div><div class="ui-select-dropdown select2-drop select2-with-searchbox select2-drop-active" ng-class="{\'select2-display-none\': !$select.open}"><div class="search-container" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled, \'select2-search\':$select.searchEnabled}"><input type="search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" ng-class="{\'select2-active\': $select.refreshing}" role="combobox" aria-expanded="true" aria-owns="ui-select-choices-{{ $select.generatedId }}" aria-label="{{ $select.baseTitle }}" class="ui-select-search select2-input" ng-model="$select.search"><\/div><div class="ui-select-choices"><\/div><div class="ui-select-no-choice"><\/div><\/div><\/div>');n.put("selectize/choices.tpl.html",'<div ng-show="$select.open" class="ui-select-choices ui-select-dropdown selectize-dropdown" ng-class="{\'single\': !$select.multiple, \'multi\': $select.multiple}"><div class="ui-select-choices-content selectize-dropdown-content"><div class="ui-select-choices-group optgroup"><div ng-show="$select.isGrouped" class="ui-select-choices-group-label optgroup-header" ng-bind="$group.name"><\/div><div role="option" class="ui-select-choices-row" ng-class="{active: $select.isActive(this), disabled: $select.isDisabled(this)}"><div class="option ui-select-choices-row-inner" data-selectable=""><\/div><\/div><\/div><\/div><\/div>');n.put("selectize/match-multiple.tpl.html",'<div class="ui-select-match" data-value="" ng-repeat="$item in $select.selected track by $index" ng-click="$selectMultiple.activeMatchIndex = $index;" ng-class="{\'active\':$selectMultiple.activeMatchIndex === $index}" ui-select-sort="$select.selected"><span class="ui-select-match-item" ng-class="{\'select-locked\':$select.isLocked(this, $index)}"><span uis-transclude-append=""><\/span> <span class="remove ui-select-match-close" ng-hide="$select.disabled" ng-click="$selectMultiple.removeChoice($index)">&times;<\/span><\/span><\/div>');n.put("selectize/match.tpl.html",'<div ng-hide="$select.searchEnabled && ($select.open || $select.isEmpty())" class="ui-select-match"><span ng-show="!$select.searchEnabled && ($select.isEmpty() || $select.open)" class="ui-select-placeholder text-muted">{{$select.placeholder}}<\/span> <span ng-hide="$select.isEmpty() || $select.open" ng-transclude=""><\/span><\/div>');n.put("selectize/no-choice.tpl.html",'<div class="ui-select-no-choice selectize-dropdown" ng-show="$select.items.length == 0"><div class="selectize-dropdown-content"><div data-selectable="" ng-transclude=""><\/div><\/div><\/div>');n.put("selectize/select-multiple.tpl.html",'<div class="ui-select-container selectize-control multi plugin-remove_button" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"><\/div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" placeholder="{{$selectMultiple.getPlaceholder()}}" ng-model="$select.search" ng-disabled="$select.disabled" aria-expanded="{{$select.open}}" aria-label="{{ $select.baseTitle }}" ondrop="return false;"><\/div><div class="ui-select-choices"><\/div><div class="ui-select-no-choice"><\/div><\/div>');n.put("selectize/select.tpl.html",'<div class="ui-select-container selectize-control single" ng-class="{\'open\': $select.open}"><div class="selectize-input" ng-class="{\'focus\': $select.open, \'disabled\': $select.disabled, \'selectize-focus\' : $select.focus}" ng-click="$select.open && !$select.searchEnabled ? $select.toggle($event) : $select.activate()"><div class="ui-select-match"><\/div><input type="search" autocomplete="off" tabindex="-1" class="ui-select-search ui-select-toggle" ng-class="{\'ui-select-search-hidden\':!$select.searchEnabled}" ng-click="$select.toggle($event)" placeholder="{{$select.placeholder}}" ng-model="$select.search" ng-hide="!$select.isEmpty() && !$select.open" ng-disabled="$select.disabled" aria-label="{{ $select.baseTitle }}"><\/div><div class="ui-select-choices"><\/div><div class="ui-select-no-choice"><\/div><\/div>')}]);angular.module("summernote",[]).controller("SummernoteController",["$scope","$attrs","$timeout",function(n,t,i){"use strict";var u,r=angular.copy(n.summernoteConfig)||{};if(angular.isDefined(t.height)&&(r.height=+t.height),angular.isDefined(t.minHeight)&&(r.minHeight=+t.minHeight),angular.isDefined(t.maxHeight)&&(r.maxHeight=+t.maxHeight),angular.isDefined(t.placeholder)&&(r.placeholder=t.placeholder),angular.isDefined(t.focus)&&(r.focus=!0),angular.isDefined(t.airmode)&&(r.airMode=!0),angular.isDefined(t.lang)){if(!angular.isDefined($.summernote.lang[t.lang]))throw new Error('"'+t.lang+'" lang file must be exist.');r.lang=t.lang}r.callbacks=r.callbacks||{};angular.isDefined(t.onInit)&&(r.callbacks.onInit=function(t){n.init({evt:t})});angular.isDefined(t.onEnter)&&(r.callbacks.onEnter=function(t){n.enter({evt:t})});angular.isDefined(t.onFocus)&&(r.callbacks.onFocus=function(t){n.focus({evt:t})});angular.isDefined(t.onPaste)&&(r.callbacks.onPaste=function(t){n.paste({evt:t})});angular.isDefined(t.onKeyup)&&(r.callbacks.onKeyup=function(t){n.keyup({evt:t})});angular.isDefined(t.onKeydown)&&(r.callbacks.onKeydown=function(t){n.keydown({evt:t})});angular.isDefined(t.onImageUpload)&&(r.callbacks.onImageUpload=function(t){n.imageUpload({files:t,editable:n.editable})});angular.isDefined(t.onMediaDelete)&&(r.callbacks.onMediaDelete=function(t){var i={attrs:{}};i.tagName=t[0].tagName;angular.forEach(t[0].attributes,function(n){i.attrs[n.name]=n.value});n.mediaDelete({target:i})});this.activate=function(f,e,o){var h=function(){var n=e.summernote("code");e.summernote("isEmpty")&&(n="");o&&o.$viewValue!==n&&i(function(){o.$setViewValue(n)},0)},l=r.callbacks.onChange,c,s;r.callbacks.onChange=function(r){i(function(){e.summernote("isEmpty")&&(r="");h()},0);angular.isDefined(t.onChange)?n.change({contents:r,editable:n.editable}):angular.isFunction(l)&&l.apply(this,arguments)};angular.isDefined(t.onBlur)&&(r.callbacks.onBlur=function(t){r.airMode||e.blur();n.blur({evt:t})});e.summernote(r);s=e.next(".note-editor");s.find(".note-toolbar").click(function(){h();s.hasClass("codeview")?(s.on("keyup",h),o&&(c=f.$watch(function(){return o.$modelValue},function(n){s.find(".note-codable").val(n)}))):(s.off("keyup",h),angular.isFunction(c)&&c())});o&&(o.$render=function(){o.$viewValue?e.summernote("code",o.$viewValue):e.summernote("empty")});angular.isDefined(t.editable)&&(n.editable=s.find(".note-editable"));angular.isDefined(t.editor)&&(n.editor=e);u=e;e.on("$destroy",function(){e.summernote("destroy");n.summernoteDestroyed=!0})};n.$on("$destroy",function(){n.summernoteDestroyed||u.summernote("destroy")})}]).directive("summernote",[function(){"use strict";return{restrict:"EA",transclude:"element",replace:!0,require:["summernote","?ngModel"],controller:"SummernoteController",scope:{summernoteConfig:"=config",editable:"=",editor:"=",init:"&onInit",enter:"&onEnter",focus:"&onFocus",blur:"&onBlur",paste:"&onPaste",keyup:"&onKeyup",keydown:"&onKeydown",change:"&onChange",imageUpload:"&onImageUpload",mediaDelete:"&onMediaDelete"},template:'<div class="summernote"><\/div>',link:function(n,t,i,r,u){var e=r[0],f=r[1],o;f?o=n.$watch(function(){return f.$viewValue},function(i){o();t.append(i);e.activate(n,t,f)},!0):(u(n,function(n){t.append(n.html())}),e.activate(n,t,f))}}}]);angular.module("ngVis",[]).factory("VisDataSet",function(){"use strict";return function(n,t){return new vis.DataSet(n,t)}}).directive("visTimeline",function(){"use strict";return{restrict:"EA",transclude:!1,scope:{data:"=",options:"=",events:"="},link:function(n,t){var r=["rangechange","rangechanged","timechange","timechanged","select","doubleClick","click","contextmenu"],i=null;n.$watch("data",function(){if(n.data!=null&&(i!=null&&i.destroy(),i=new vis.Timeline(t[0],n.data.items,n.data.groups,n.options),angular.forEach(n.events,function(n,t){if(r.indexOf(String(t))>=0)i.on(t,n)}),n.events!=null&&n.events.onload!=null&&angular.isFunction(n.events.onload)))n.events.onload(i)});n.$watchCollection("options",function(n){i!=null&&i.setOptions(n)})}}}).directive("visNetwork",function(){return{restrict:"EA",transclude:!1,scope:{data:"=",options:"=",events:"="},link:function(n,t){var r=["click","doubleClick","oncontext","hold","release","selectNode","selectEdge","deselectNode","deselectEdge","dragStart","dragging","dragEnd","hoverNode","blurNode","zoom","showPopup","hidePopup","startStabilizing","stabilizationProgress","stabilizationIterationsDone","stabilized","resize","initRedraw","beforeDrawing","afterDrawing","animationFinished"],i=null;n.$watch("data",function(){if(n.data!=null&&(i!=null&&i.destroy(),i=new vis.Network(t[0],n.data,n.options),angular.forEach(n.events,function(n,t){if(r.indexOf(String(t))>=0)i.on(t,n)}),n.events!=null&&n.events.onload!=null&&angular.isFunction(n.events.onload)))n.events.onload(i)});n.$watchCollection("options",function(n){i!=null&&i.setOptions(n)})}}}).directive("visGraph2d",function(){"use strict";return{restrict:"EA",transclude:!1,scope:{data:"=",options:"=",events:"="},link:function(n,t){var r=["rangechange","rangechanged","timechange","timechanged","finishedRedraw"],i=null;n.$watch("data",function(){if(n.data!=null&&(i!=null&&i.destroy(),i=new vis.Graph2d(t[0],n.data.items,n.data.groups,n.options),angular.forEach(n.events,function(n,t){if(r.indexOf(String(t))>=0)i.on(t,n)}),n.events!=null&&n.events.onload!=null&&angular.isFunction(n.events.onload)))n.events.onload(i)});n.$watchCollection("options",function(n){i!=null&&i.setOptions(n)})}}}),function(n,t){var i,r;typeof define=="function"&&define.amd?define(["moment","jquery"],function(n,i){return i.fn||(i.fn={}),typeof n!="function"&&n.hasOwnProperty("default")&&(n=n["default"]),t(n,i)}):typeof module=="object"&&module.exports?(i=typeof window!="undefined"?window.jQuery:undefined,i||(i=require("jquery"),i.fn||(i.fn={})),r=typeof window!="undefined"&&typeof window.moment!="undefined"?window.moment:require("moment"),module.exports=t(r,i)):n.daterangepicker=t(n.moment,n.jQuery)}(this,function(n,t){var i=function(i,r,u){var y,f,o,e,c,v,s,h,a,l;if(this.parentEl="body",this.element=t(i),this.startDate=n().startOf("day"),this.endDate=n().endOf("day"),this.minDate=!1,this.maxDate=!1,this.maxSpan=!1,this.autoApply=!1,this.singleDatePicker=!1,this.showDropdowns=!1,this.minYear=n().subtract(100,"year").format("YYYY"),this.maxYear=n().add(100,"year").format("YYYY"),this.showWeekNumbers=!1,this.showISOWeekNumbers=!1,this.showCustomRangeLabel=!0,this.timePicker=!1,this.timePicker24Hour=!1,this.timePickerIncrement=1,this.timePickerSeconds=!1,this.linkedCalendars=!0,this.autoUpdateInput=!0,this.alwaysShowCalendars=!1,this.ranges={},this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses="btn btn-sm",this.applyButtonClasses="btn-primary",this.cancelButtonClasses="btn-default",this.locale={direction:"ltr",format:n.localeData().longDateFormat("L"),separator:" - ",applyLabel:"Apply",cancelLabel:"Cancel",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:n.weekdaysMin(),monthNames:n.monthsShort(),firstDay:n.localeData().firstDayOfWeek()},this.callback=function(){},this.isShowing=!1,this.leftCalendar={},this.rightCalendar={},(typeof r!="object"||r===null)&&(r={}),r=t.extend(this.element.data(),r),typeof r.template=="string"||r.template instanceof t||(r.template='<div class="daterangepicker"><div class="ranges"><\/div><div class="drp-calendar left"><div class="calendar-table"><\/div><div class="calendar-time"><\/div><\/div><div class="drp-calendar right"><div class="calendar-table"><\/div><div class="calendar-time"><\/div><\/div><div class="drp-buttons"><span class="drp-selected"><\/span><button class="cancelBtn" type="button"><\/button><button class="applyBtn" disabled="disabled" type="button"><\/button> <\/div><\/div>'),this.parentEl=r.parentEl&&t(r.parentEl).length?t(r.parentEl):t(this.parentEl),this.container=t(r.template).appendTo(this.parentEl),typeof r.locale=="object"&&(typeof r.locale.direction=="string"&&(this.locale.direction=r.locale.direction),typeof r.locale.format=="string"&&(this.locale.format=r.locale.format),typeof r.locale.separator=="string"&&(this.locale.separator=r.locale.separator),typeof r.locale.daysOfWeek=="object"&&(this.locale.daysOfWeek=r.locale.daysOfWeek.slice()),typeof r.locale.monthNames=="object"&&(this.locale.monthNames=r.locale.monthNames.slice()),typeof r.locale.firstDay=="number"&&(this.locale.firstDay=r.locale.firstDay),typeof r.locale.applyLabel=="string"&&(this.locale.applyLabel=r.locale.applyLabel),typeof r.locale.cancelLabel=="string"&&(this.locale.cancelLabel=r.locale.cancelLabel),typeof r.locale.weekLabel=="string"&&(this.locale.weekLabel=r.locale.weekLabel),typeof r.locale.customRangeLabel=="string"&&(h=document.createElement("textarea"),h.innerHTML=r.locale.customRangeLabel,a=h.value,this.locale.customRangeLabel=a)),this.container.addClass(this.locale.direction),typeof r.startDate=="string"&&(this.startDate=n(r.startDate,this.locale.format)),typeof r.endDate=="string"&&(this.endDate=n(r.endDate,this.locale.format)),typeof r.minDate=="string"&&(this.minDate=n(r.minDate,this.locale.format)),typeof r.maxDate=="string"&&(this.maxDate=n(r.maxDate,this.locale.format)),typeof r.startDate=="object"&&(this.startDate=n(r.startDate)),typeof r.endDate=="object"&&(this.endDate=n(r.endDate)),typeof r.minDate=="object"&&(this.minDate=n(r.minDate)),typeof r.maxDate=="object"&&(this.maxDate=n(r.maxDate)),this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone()),this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone()),typeof r.applyButtonClasses=="string"&&(this.applyButtonClasses=r.applyButtonClasses),typeof r.applyClass=="string"&&(this.applyButtonClasses=r.applyClass),typeof r.cancelButtonClasses=="string"&&(this.cancelButtonClasses=r.cancelButtonClasses),typeof r.cancelClass=="string"&&(this.cancelButtonClasses=r.cancelClass),typeof r.maxSpan=="object"&&(this.maxSpan=r.maxSpan),typeof r.dateLimit=="object"&&(this.maxSpan=r.dateLimit),typeof r.opens=="string"&&(this.opens=r.opens),typeof r.drops=="string"&&(this.drops=r.drops),typeof r.showWeekNumbers=="boolean"&&(this.showWeekNumbers=r.showWeekNumbers),typeof r.showISOWeekNumbers=="boolean"&&(this.showISOWeekNumbers=r.showISOWeekNumbers),typeof r.buttonClasses=="string"&&(this.buttonClasses=r.buttonClasses),typeof r.buttonClasses=="object"&&(this.buttonClasses=r.buttonClasses.join(" ")),typeof r.showDropdowns=="boolean"&&(this.showDropdowns=r.showDropdowns),typeof r.minYear=="number"&&(this.minYear=r.minYear),typeof r.maxYear=="number"&&(this.maxYear=r.maxYear),typeof r.showCustomRangeLabel=="boolean"&&(this.showCustomRangeLabel=r.showCustomRangeLabel),typeof r.singleDatePicker=="boolean"&&(this.singleDatePicker=r.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),typeof r.timePicker=="boolean"&&(this.timePicker=r.timePicker),typeof r.timePickerSeconds=="boolean"&&(this.timePickerSeconds=r.timePickerSeconds),typeof r.timePickerIncrement=="number"&&(this.timePickerIncrement=r.timePickerIncrement),typeof r.timePicker24Hour=="boolean"&&(this.timePicker24Hour=r.timePicker24Hour),typeof r.autoApply=="boolean"&&(this.autoApply=r.autoApply),typeof r.autoUpdateInput=="boolean"&&(this.autoUpdateInput=r.autoUpdateInput),typeof r.linkedCalendars=="boolean"&&(this.linkedCalendars=r.linkedCalendars),typeof r.isInvalidDate=="function"&&(this.isInvalidDate=r.isInvalidDate),typeof r.isCustomDate=="function"&&(this.isCustomDate=r.isCustomDate),typeof r.alwaysShowCalendars=="boolean"&&(this.alwaysShowCalendars=r.alwaysShowCalendars),this.locale.firstDay!=0)for(y=this.locale.firstDay;y>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),y--;if(typeof r.startDate=="undefined"&&typeof r.endDate=="undefined"&&t(this.element).is(":text")&&(c=t(this.element).val(),v=c.split(this.locale.separator),f=o=null,v.length==2?(f=n(v[0],this.locale.format),o=n(v[1],this.locale.format)):this.singleDatePicker&&c!==""&&(f=n(c,this.locale.format),o=n(c,this.locale.format)),f!==null&&o!==null&&(this.setStartDate(f),this.setEndDate(o))),typeof r.ranges=="object"){for(e in r.ranges)(f=typeof r.ranges[e][0]=="string"?n(r.ranges[e][0],this.locale.format):n(r.ranges[e][0]),o=typeof r.ranges[e][1]=="string"?n(r.ranges[e][1],this.locale.format):n(r.ranges[e][1]),this.minDate&&f.isBefore(this.minDate)&&(f=this.minDate.clone()),s=this.maxDate,this.maxSpan&&s&&f.clone().add(this.maxSpan).isAfter(s)&&(s=f.clone().add(this.maxSpan)),s&&o.isAfter(s)&&(o=s.clone()),this.minDate&&o.isBefore(this.minDate,this.timepicker?"minute":"day")||s&&f.isAfter(s,this.timepicker?"minute":"day"))||(h=document.createElement("textarea"),h.innerHTML=e,a=h.value,this.ranges[a]=[f,o]);l="<ul>";for(e in this.ranges)l+='<li data-range-key="'+e+'">'+e+"<\/li>";this.showCustomRangeLabel&&(l+='<li data-range-key="'+this.locale.customRangeLabel+'">'+this.locale.customRangeLabel+"<\/li>");l+="<\/ul>";this.container.find(".ranges").prepend(l)}typeof u=="function"&&(this.callback=u);this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day"),this.container.find(".calendar-time").hide());this.timePicker&&this.autoApply&&(this.autoApply=!1);this.autoApply&&this.container.addClass("auto-apply");typeof r.ranges=="object"&&this.container.addClass("show-ranges");this.singleDatePicker&&(this.container.addClass("single"),this.container.find(".drp-calendar.left").addClass("single"),this.container.find(".drp-calendar.left").show(),this.container.find(".drp-calendar.right").hide(),!this.timePicker&&this.autoApply&&this.container.addClass("auto-apply"));(typeof r.ranges=="undefined"&&!this.singleDatePicker||this.alwaysShowCalendars)&&this.container.addClass("show-calendar");this.container.addClass("opens"+this.opens);this.container.find(".applyBtn, .cancelBtn").addClass(this.buttonClasses);this.applyButtonClasses.length&&this.container.find(".applyBtn").addClass(this.applyButtonClasses);this.cancelButtonClasses.length&&this.container.find(".cancelBtn").addClass(this.cancelButtonClasses);this.container.find(".applyBtn").html(this.locale.applyLabel);this.container.find(".cancelBtn").html(this.locale.cancelLabel);this.container.find(".drp-calendar").on("click.daterangepicker",".prev",t.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",t.proxy(this.clickNext,this)).on("mousedown.daterangepicker","td.available",t.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",t.proxy(this.hoverDate,this)).on("change.daterangepicker","select.yearselect",t.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.monthselect",t.proxy(this.monthOrYearChanged,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",t.proxy(this.timeChanged,this));this.container.find(".ranges").on("click.daterangepicker","li",t.proxy(this.clickRange,this));this.container.find(".drp-buttons").on("click.daterangepicker","button.applyBtn",t.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",t.proxy(this.clickCancel,this));if(this.element.is("input")||this.element.is("button"))this.element.on({"click.daterangepicker":t.proxy(this.show,this),"focus.daterangepicker":t.proxy(this.show,this),"keyup.daterangepicker":t.proxy(this.elementChanged,this),"keydown.daterangepicker":t.proxy(this.keydown,this)});else{this.element.on("click.daterangepicker",t.proxy(this.toggle,this));this.element.on("keydown.daterangepicker",t.proxy(this.toggle,this))}this.updateElement()};return i.prototype={constructor:i,setStartDate:function(t){typeof t=="string"&&(this.startDate=n(t,this.locale.format));typeof t=="object"&&(this.startDate=n(t));this.timePicker||(this.startDate=this.startDate.startOf("day"));this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.minDate&&this.startDate.isBefore(this.minDate)&&(this.startDate=this.minDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.round(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement));this.maxDate&&this.startDate.isAfter(this.maxDate)&&(this.startDate=this.maxDate.clone(),this.timePicker&&this.timePickerIncrement&&this.startDate.minute(Math.floor(this.startDate.minute()/this.timePickerIncrement)*this.timePickerIncrement));this.isShowing||this.updateElement();this.updateMonthsInView()},setEndDate:function(t){typeof t=="string"&&(this.endDate=n(t,this.locale.format));typeof t=="object"&&(this.endDate=n(t));this.timePicker||(this.endDate=this.endDate.endOf("day"));this.timePicker&&this.timePickerIncrement&&this.endDate.minute(Math.round(this.endDate.minute()/this.timePickerIncrement)*this.timePickerIncrement);this.endDate.isBefore(this.startDate)&&(this.endDate=this.startDate.clone());this.maxDate&&this.endDate.isAfter(this.maxDate)&&(this.endDate=this.maxDate.clone());this.maxSpan&&this.startDate.clone().add(this.maxSpan).isBefore(this.endDate)&&(this.endDate=this.startDate.clone().add(this.maxSpan));this.previousRightTime=this.endDate.clone();this.container.find(".drp-selected").html(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));this.isShowing||this.updateElement();this.updateMonthsInView()},isInvalidDate:function(){return!1},isCustomDate:function(){return!1},updateView:function(){this.timePicker&&(this.renderTimePicker("left"),this.renderTimePicker("right"),this.endDate?this.container.find(".right .calendar-time select").prop("disabled",!1).removeClass("disabled"):this.container.find(".right .calendar-time select").prop("disabled",!0).addClass("disabled"));this.endDate&&this.container.find(".drp-selected").html(this.startDate.format(this.locale.format)+this.locale.separator+this.endDate.format(this.locale.format));this.updateMonthsInView();this.updateCalendars();this.updateFormInputs()},updateMonthsInView:function(){if(this.endDate){if(!this.singleDatePicker&&this.leftCalendar.month&&this.rightCalendar.month&&(this.startDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.startDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM"))&&(this.endDate.format("YYYY-MM")==this.leftCalendar.month.format("YYYY-MM")||this.endDate.format("YYYY-MM")==this.rightCalendar.month.format("YYYY-MM")))return;this.leftCalendar.month=this.startDate.clone().date(2);this.rightCalendar.month=this.linkedCalendars||this.endDate.month()==this.startDate.month()&&this.endDate.year()==this.startDate.year()?this.startDate.clone().date(2).add(1,"month"):this.endDate.clone().date(2)}else this.leftCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&this.rightCalendar.month.format("YYYY-MM")!=this.startDate.format("YYYY-MM")&&(this.leftCalendar.month=this.startDate.clone().date(2),this.rightCalendar.month=this.startDate.clone().date(2).add(1,"month"));this.maxDate&&this.linkedCalendars&&!this.singleDatePicker&&this.rightCalendar.month>this.maxDate&&(this.rightCalendar.month=this.maxDate.clone().date(2),this.leftCalendar.month=this.maxDate.clone().date(2).subtract(1,"month"))},updateCalendars:function(){var n,t,r,i;(this.timePicker&&(this.endDate?(n=parseInt(this.container.find(".left .hourselect").val(),10),t=parseInt(this.container.find(".left .minuteselect").val(),10),isNaN(t)&&(t=parseInt(this.container.find(".left .minuteselect option:last").val(),10)),r=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,this.timePicker24Hour||(i=this.container.find(".left .ampmselect").val(),i==="PM"&&n<12&&(n+=12),i==="AM"&&n===12&&(n=0))):(n=parseInt(this.container.find(".right .hourselect").val(),10),t=parseInt(this.container.find(".right .minuteselect").val(),10),isNaN(t)&&(t=parseInt(this.container.find(".right .minuteselect option:last").val(),10)),r=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,this.timePicker24Hour||(i=this.container.find(".right .ampmselect").val(),i==="PM"&&n<12&&(n+=12),i==="AM"&&n===12&&(n=0))),this.leftCalendar.month.hour(n).minute(t).second(r),this.rightCalendar.month.hour(n).minute(t).second(r)),this.renderCalendar("left"),this.renderCalendar("right"),this.container.find(".ranges li").removeClass("active"),this.endDate!=null)&&this.calculateChosenLabel()},renderCalendar:function(i){var r=i=="left"?this.leftCalendar:this.rightCalendar,d=r.month.month(),g=r.month.year(),yt=r.month.hour(),et=r.month.minute(),ot=r.month.second(),pt=n([g,d]).daysInMonth(),w=n([g,d,1]),wt=n([g,d,pt]),st=n(w).subtract(1,"month").month(),ht=n(w).subtract(1,"month").year(),nt=n([ht,st]).daysInMonth(),ct=w.day(),r=[],v,y,tt,c,b,a,ut,f,u,o,p,k,ft,s;for(r.firstDay=w,r.lastDay=wt,s=0;s<6;s++)r[s]=[];v=nt-ct+this.locale.firstDay+1;v>nt&&(v-=7);ct==this.locale.firstDay&&(v=nt-6);y=n([ht,st,v,12,et,ot]);for(var s=0,u=0,f=0;s<42;s++,u++,y=n(y).add(24,"hour"))s>0&&u%7==0&&(u=0,f++),r[f][u]=y.clone().hour(yt).minute(et).second(ot),y.hour(12),this.minDate&&r[f][u].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&r[f][u].isBefore(this.minDate)&&i=="left"&&(r[f][u]=this.minDate.clone()),this.maxDate&&r[f][u].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&r[f][u].isAfter(this.maxDate)&&i=="right"&&(r[f][u]=this.maxDate.clone());i=="left"?this.leftCalendar.calendar=r:this.rightCalendar.calendar=r;var l=i=="left"?this.minDate:this.startDate,h=this.maxDate,dt=i=="left"?this.startDate:this.endDate,gt=this.locale.direction=="ltr"?{left:"chevron-left",right:"chevron-right"}:{left:"chevron-right",right:"chevron-left"},e='<table class="table-condensed">';if(e+="<thead>",e+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(e+="<th><\/th>"),e+=l&&!l.isBefore(r.firstDay)||this.linkedCalendars&&i!="left"?"<th><\/th>":'<th class="prev available"><span><\/span><\/th>',tt=this.locale.monthNames[r[1][1].month()]+r[1][1].format(" YYYY"),this.showDropdowns){var lt=r[1][1].month(),it=r[1][1].year(),at=h&&h.year()||this.maxYear,vt=l&&l.year()||this.minYear,bt=it==vt,kt=it==at,rt='<select class="monthselect">';for(c=0;c<12;c++)rt+=(!bt||l&&c>=l.month())&&(!kt||h&&c<=h.month())?"<option value='"+c+"'"+(c===lt?" selected='selected'":"")+">"+this.locale.monthNames[c]+"<\/option>":"<option value='"+c+"'"+(c===lt?" selected='selected'":"")+" disabled='disabled'>"+this.locale.monthNames[c]+"<\/option>";for(rt+="<\/select>",b='<select class="yearselect">',a=vt;a<=at;a++)b+='<option value="'+a+'"'+(a===it?' selected="selected"':"")+">"+a+"<\/option>";b+="<\/select>";tt=rt+b}for(e+='<th colspan="5" class="month">'+tt+"<\/th>",e+=(!h||h.isAfter(r.lastDay))&&(!this.linkedCalendars||i=="right"||this.singleDatePicker)?'<th class="next available"><span><\/span><\/th>':"<th><\/th>",e+="<\/tr>",e+="<tr>",(this.showWeekNumbers||this.showISOWeekNumbers)&&(e+='<th class="week">'+this.locale.weekLabel+"<\/th>"),t.each(this.locale.daysOfWeek,function(n,t){e+="<th>"+t+"<\/th>"}),e+="<\/tr>",e+="<\/thead>",e+="<tbody>",this.endDate==null&&this.maxSpan&&(ut=this.startDate.clone().add(this.maxSpan).endOf("day"),(!h||ut.isBefore(h))&&(h=ut)),f=0;f<6;f++){for(e+="<tr>",this.showWeekNumbers?e+='<td class="week">'+r[f][0].week()+"<\/td>":this.showISOWeekNumbers&&(e+='<td class="week">'+r[f][0].isoWeek()+"<\/td>"),u=0;u<7;u++){for(o=[],r[f][u].isSame(new Date,"day")&&o.push("today"),r[f][u].isoWeekday()>5&&o.push("weekend"),r[f][u].month()!=r[1][1].month()&&o.push("off","ends"),this.minDate&&r[f][u].isBefore(this.minDate,"day")&&o.push("off","disabled"),h&&r[f][u].isAfter(h,"day")&&o.push("off","disabled"),this.isInvalidDate(r[f][u])&&o.push("off","disabled"),r[f][u].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&o.push("active","start-date"),this.endDate!=null&&r[f][u].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&o.push("active","end-date"),this.endDate!=null&&r[f][u]>this.startDate&&r[f][u]<this.endDate&&o.push("in-range"),p=this.isCustomDate(r[f][u]),p!==!1&&(typeof p=="string"?o.push(p):Array.prototype.push.apply(o,p)),k="",ft=!1,s=0;s<o.length;s++)k+=o[s]+" ",o[s]=="disabled"&&(ft=!0);ft||(k+="available");e+='<td class="'+k.replace(/^\s+|\s+$/g,"")+'" data-title="r'+f+"c"+u+'">'+r[f][u].date()+"<\/td>"}e+="<\/tr>"}e+="<\/tbody>";e+="<\/table>";this.container.find(".drp-calendar."+i+" .calendar-table").html(e)},renderTimePicker:function(n){var r,i,e,u,s,v,y,p,c,o,f,t,l,a;if(n!="right"||this.endDate){for(u=this.maxDate,this.maxSpan&&(!this.maxDate||this.startDate.clone().add(this.maxSpan).isBefore(this.maxDate))&&(u=this.startDate.clone().add(this.maxSpan)),n=="left"?(i=this.startDate.clone(),e=this.minDate):n=="right"&&(i=this.endDate.clone(),e=this.startDate,s=this.container.find(".drp-calendar.right .calendar-time"),s.html()!=""&&(i.hour(isNaN(i.hour())?s.find(".hourselect option:selected").val():i.hour()),i.minute(isNaN(i.minute())?s.find(".minuteselect option:selected").val():i.minute()),i.second(isNaN(i.second())?s.find(".secondselect option:selected").val():i.second()),this.timePicker24Hour||(v=s.find(".ampmselect option:selected").val(),v==="PM"&&i.hour()<12&&i.hour(i.hour()+12),v==="AM"&&i.hour()===12&&i.hour(0))),i.isBefore(this.startDate)&&(i=this.startDate.clone()),u&&i.isAfter(u)&&(i=u.clone())),r='<select class="hourselect">',y=this.timePicker24Hour?0:1,p=this.timePicker24Hour?23:12,t=y;t<=p;t++)c=t,this.timePicker24Hour||(c=i.hour()>=12?t==12?12:t+12:t==12?0:t),o=i.clone().hour(c),f=!1,e&&o.minute(59).isBefore(e)&&(f=!0),u&&o.minute(0).isAfter(u)&&(f=!0),r+=c!=i.hour()||f?f?'<option value="'+t+'" disabled="disabled" class="disabled">'+t+"<\/option>":'<option value="'+t+'">'+t+"<\/option>":'<option value="'+t+'" selected="selected">'+t+"<\/option>";for(r+="<\/select> ",r+=': <select class="minuteselect">',t=0;t<60;t+=this.timePickerIncrement){var h=t<10?"0"+t:t,o=i.clone().minute(t),f=!1;e&&o.second(59).isBefore(e)&&(f=!0);u&&o.second(0).isAfter(u)&&(f=!0);r+=i.minute()!=t||f?f?'<option value="'+t+'" disabled="disabled" class="disabled">'+h+"<\/option>":'<option value="'+t+'">'+h+"<\/option>":'<option value="'+t+'" selected="selected">'+h+"<\/option>"}if(r+="<\/select> ",this.timePickerSeconds){for(r+=': <select class="secondselect">',t=0;t<60;t++){var h=t<10?"0"+t:t,o=i.clone().second(t),f=!1;e&&o.isBefore(e)&&(f=!0);u&&o.isAfter(u)&&(f=!0);r+=i.second()!=t||f?f?'<option value="'+t+'" disabled="disabled" class="disabled">'+h+"<\/option>":'<option value="'+t+'">'+h+"<\/option>":'<option value="'+t+'" selected="selected">'+h+"<\/option>"}r+="<\/select> "}this.timePicker24Hour||(r+='<select class="ampmselect">',l="",a="",e&&i.clone().hour(12).minute(0).second(0).isBefore(e)&&(l=' disabled="disabled" class="disabled"'),u&&i.clone().hour(0).minute(0).second(0).isAfter(u)&&(a=' disabled="disabled" class="disabled"'),r+=i.hour()>=12?'<option value="AM"'+l+'>AM<\/option><option value="PM" selected="selected"'+a+">PM<\/option>":'<option value="AM" selected="selected"'+l+'>AM<\/option><option value="PM"'+a+">PM<\/option>",r+="<\/select>");this.container.find(".drp-calendar."+n+" .calendar-time").html(r)}},updateFormInputs:function(){this.singleDatePicker||this.endDate&&(this.startDate.isBefore(this.endDate)||this.startDate.isSame(this.endDate))?this.container.find("button.applyBtn").prop("disabled",!1):this.container.find("button.applyBtn").prop("disabled",!0)},move:function(){var i={top:0,left:0},n,f=this.drops,o=t(window).width(),u,e,r;this.parentEl.is("body")||(i={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},o=this.parentEl[0].clientWidth+this.parentEl.offset().left);switch(f){case"auto":n=this.element.offset().top+this.element.outerHeight()-i.top;n+this.container.outerHeight()>=this.parentEl[0].scrollHeight&&(n=this.element.offset().top-this.container.outerHeight()-i.top,f="up");break;case"up":n=this.element.offset().top-this.container.outerHeight()-i.top;break;default:n=this.element.offset().top+this.element.outerHeight()-i.top}this.container.css({top:0,left:0,right:"auto"});u=this.container.outerWidth();this.container.toggleClass("drop-up",f=="up");this.opens=="left"?(e=o-this.element.offset().left-this.element.outerWidth(),u+e>t(window).width()?this.container.css({top:n,right:"auto",left:9}):this.container.css({top:n,right:e,left:"auto"})):this.opens=="center"?(r=this.element.offset().left-i.left+this.element.outerWidth()/2-u/2,r<0?this.container.css({top:n,right:"auto",left:9}):r+u>t(window).width()?this.container.css({top:n,left:"auto",right:0}):this.container.css({top:n,left:r,right:"auto"})):(r=this.element.offset().left-i.left,r+u>t(window).width()?this.container.css({top:n,left:"auto",right:0}):this.container.css({top:n,left:r,right:"auto"}))},show:function(){if(!this.isShowing){this._outsideClickProxy=t.proxy(function(n){this.outsideClick(n)},this);t(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy);t(window).on("resize.daterangepicker",t.proxy(function(n){this.move(n)},this));this.oldStartDate=this.startDate.clone();this.oldEndDate=this.endDate.clone();this.previousRightTime=this.endDate.clone();this.updateView();this.container.show();this.move();this.element.trigger("show.daterangepicker",this);this.isShowing=!0}},hide:function(){this.isShowing&&(this.endDate||(this.startDate=this.oldStartDate.clone(),this.endDate=this.oldEndDate.clone()),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.callback(this.startDate.clone(),this.endDate.clone(),this.chosenLabel),this.updateElement(),t(document).off(".daterangepicker"),t(window).off(".daterangepicker"),this.container.hide(),this.element.trigger("hide.daterangepicker",this),this.isShowing=!1)},toggle:function(){this.isShowing?this.hide():this.show()},outsideClick:function(n){var i=t(n.target);n.type=="focusin"||i.closest(this.element).length||i.closest(this.container).length||i.closest(".calendar-table").length||(this.hide(),this.element.trigger("outsideClick.daterangepicker",this))},showCalendars:function(){this.container.addClass("show-calendar");this.move();this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar");this.element.trigger("hideCalendar.daterangepicker",this)},clickRange:function(n){var t=n.target.getAttribute("data-range-key"),i;this.chosenLabel=t;t==this.locale.customRangeLabel?this.showCalendars():(i=this.ranges[t],this.startDate=i[0],this.endDate=i[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.alwaysShowCalendars||this.hideCalendars(),this.clickApply())},clickPrev:function(n){var i=t(n.target).parents(".drp-calendar");i.hasClass("left")?(this.leftCalendar.month.subtract(1,"month"),this.linkedCalendars&&this.rightCalendar.month.subtract(1,"month")):this.rightCalendar.month.subtract(1,"month");this.updateCalendars()},clickNext:function(n){var i=t(n.target).parents(".drp-calendar");i.hasClass("left")?this.leftCalendar.month.add(1,"month"):(this.rightCalendar.month.add(1,"month"),this.linkedCalendars&&this.leftCalendar.month.add(1,"month"));this.updateCalendars()},hoverDate:function(n){if(t(n.target).hasClass("available")){var i=t(n.target).attr("data-title"),r=i.substr(1,1),u=i.substr(3,1),e=t(n.target).parents(".drp-calendar"),f=e.hasClass("left")?this.leftCalendar.calendar[r][u]:this.rightCalendar.calendar[r][u],o=this.leftCalendar,s=this.rightCalendar,h=this.startDate;this.endDate||this.container.find(".drp-calendar tbody td").each(function(n,i){if(!t(i).hasClass("week")){var u=t(i).attr("data-title"),e=u.substr(1,1),c=u.substr(3,1),l=t(i).parents(".drp-calendar"),r=l.hasClass("left")?o.calendar[e][c]:s.calendar[e][c];r.isAfter(h)&&r.isBefore(f)||r.isSame(f,"day")?t(i).addClass("in-range"):t(i).removeClass("in-range")}})}},clickDate:function(n){var i,f,u,e;if(t(n.target).hasClass("available")){var o=t(n.target).attr("data-title"),s=o.substr(1,1),h=o.substr(3,1),c=t(n.target).parents(".drp-calendar"),r=c.hasClass("left")?this.leftCalendar.calendar[s][h]:this.rightCalendar.calendar[s][h];this.endDate||r.isBefore(this.startDate,"day")?(this.timePicker&&(i=parseInt(this.container.find(".left .hourselect").val(),10),this.timePicker24Hour||(f=this.container.find(".left .ampmselect").val(),f==="PM"&&i<12&&(i+=12),f==="AM"&&i===12&&(i=0)),u=parseInt(this.container.find(".left .minuteselect").val(),10),isNaN(u)&&(u=parseInt(this.container.find(".left .minuteselect option:last").val(),10)),e=this.timePickerSeconds?parseInt(this.container.find(".left .secondselect").val(),10):0,r=r.clone().hour(i).minute(u).second(e)),this.endDate=null,this.setStartDate(r.clone())):!this.endDate&&r.isBefore(this.startDate)?this.setEndDate(this.startDate.clone()):(this.timePicker&&(i=parseInt(this.container.find(".right .hourselect").val(),10),this.timePicker24Hour||(f=this.container.find(".right .ampmselect").val(),f==="PM"&&i<12&&(i+=12),f==="AM"&&i===12&&(i=0)),u=parseInt(this.container.find(".right .minuteselect").val(),10),isNaN(u)&&(u=parseInt(this.container.find(".right .minuteselect option:last").val(),10)),e=this.timePickerSeconds?parseInt(this.container.find(".right .secondselect").val(),10):0,r=r.clone().hour(i).minute(u).second(e)),this.setEndDate(r.clone()),this.autoApply&&(this.calculateChosenLabel(),this.clickApply()));this.singleDatePicker&&(this.setEndDate(this.startDate),!this.timePicker&&this.autoApply&&this.clickApply());this.updateView();n.stopPropagation()}},calculateChosenLabel:function(){var i=!0,r=0,n,t;for(n in this.ranges){if(this.timePicker){if(t=this.timePickerSeconds?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",this.startDate.format(t)==this.ranges[n][0].format(t)&&this.endDate.format(t)==this.ranges[n][1].format(t)){i=!1;this.chosenLabel=this.container.find(".ranges li:eq("+r+")").addClass("active").attr("data-range-key");break}}else if(this.startDate.format("YYYY-MM-DD")==this.ranges[n][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[n][1].format("YYYY-MM-DD")){i=!1;this.chosenLabel=this.container.find(".ranges li:eq("+r+")").addClass("active").attr("data-range-key");break}r++}i&&(this.chosenLabel=this.showCustomRangeLabel?this.container.find(".ranges li:last").addClass("active").attr("data-range-key"):null,this.showCalendars())},clickApply:function(){this.hide();this.element.trigger("apply.daterangepicker",this)},clickCancel:function(){this.startDate=this.oldStartDate;this.endDate=this.oldEndDate;this.hide();this.element.trigger("cancel.daterangepicker",this)},monthOrYearChanged:function(n){var u=t(n.target).closest(".drp-calendar").hasClass("left"),e=u?"left":"right",f=this.container.find(".drp-calendar."+e),r=parseInt(f.find(".monthselect").val(),10),i=f.find(".yearselect").val();u||(i<this.startDate.year()||i==this.startDate.year()&&r<this.startDate.month())&&(r=this.startDate.month(),i=this.startDate.year());this.minDate&&(i<this.minDate.year()||i==this.minDate.year()&&r<this.minDate.month())&&(r=this.minDate.month(),i=this.minDate.year());this.maxDate&&(i>this.maxDate.year()||i==this.maxDate.year()&&r>this.maxDate.month())&&(r=this.maxDate.month(),i=this.maxDate.year());u?(this.leftCalendar.month.month(r).year(i),this.linkedCalendars&&(this.rightCalendar.month=this.leftCalendar.month.clone().add(1,"month"))):(this.rightCalendar.month.month(r).year(i),this.linkedCalendars&&(this.leftCalendar.month=this.rightCalendar.month.clone().subtract(1,"month")));this.updateCalendars()},timeChanged:function(n){var r=t(n.target).closest(".drp-calendar"),h=r.hasClass("left"),u=parseInt(r.find(".hourselect").val(),10),e=parseInt(r.find(".minuteselect").val(),10),o,s,i,f;isNaN(e)&&(e=parseInt(r.find(".minuteselect option:last").val(),10));o=this.timePickerSeconds?parseInt(r.find(".secondselect").val(),10):0;this.timePicker24Hour||(s=r.find(".ampmselect").val(),s==="PM"&&u<12&&(u+=12),s==="AM"&&u===12&&(u=0));h?(i=this.startDate.clone(),i.hour(u),i.minute(e),i.second(o),this.setStartDate(i),this.singleDatePicker?this.endDate=this.startDate.clone():this.endDate&&this.endDate.format("YYYY-MM-DD")==i.format("YYYY-MM-DD")&&this.endDate.isBefore(i)&&this.setEndDate(i.clone())):this.endDate&&(f=this.endDate.clone(),f.hour(u),f.minute(e),f.second(o),this.setEndDate(f));this.updateCalendars();this.updateFormInputs();this.renderTimePicker("left");this.renderTimePicker("right")},elementChanged:function(){if(this.element.is("input")&&this.element.val().length){var r=this.element.val().split(this.locale.separator),t=null,i=null;(r.length===2&&(t=n(r[0],this.locale.format),i=n(r[1],this.locale.format)),(this.singleDatePicker||t===null||i===null)&&(t=n(this.element.val(),this.locale.format),i=t),t.isValid()&&i.isValid())&&(this.setStartDate(t),this.setEndDate(i),this.updateView())}},keydown:function(n){(n.keyCode===9||n.keyCode===13)&&this.hide();n.keyCode===27&&(n.preventDefault(),n.stopPropagation(),this.hide())},updateElement:function(){if(this.element.is("input")&&this.autoUpdateInput){var n=this.startDate.format(this.locale.format);this.singleDatePicker||(n+=this.locale.separator+this.endDate.format(this.locale.format));n!==this.element.val()&&this.element.val(n).trigger("change")}},remove:function(){this.container.remove();this.element.off(".daterangepicker");this.element.removeData()}},t.fn.daterangepicker=function(n,r){var u=t.extend(!0,{},t.fn.daterangepicker.defaultOptions,n);return this.each(function(){var n=t(this);n.data("daterangepicker")&&n.data("daterangepicker").remove();n.data("daterangepicker",new i(n,u,r))}),this},i}),function(){var n;n=angular.module("daterangepicker",[]);n.constant("dateRangePickerConfig",{cancelOnOutsideClick:!0,locale:{separator:" - ",format:"YYYY-MM-DD",clearLabel:"Clear"}});n.directive("dateRangePicker",["$compile","$timeout","$parse","dateRangePickerConfig",function(n,t,i,r){return{require:"ngModel",restrict:"A",scope:{min:"=",max:"=",picker:"=?",model:"=ngModel",opts:"=options",clearable:"="},link:function(n,i,u,f){var k,a,v,l,o,y,h,c,p,w,d,s,b,e;return l=function(){var n,t;return t=angular.extend.apply(angular,Array.prototype.slice.call(arguments).map(function(n){if(null!=n)return n.locale}).filter(function(n){return!!n})),n=angular.extend.apply(angular,arguments),n.locale=t,n},s=$(i),s.attr("ng-trim","false"),u.ngTrim="false",w=!1,function(){var t,n;if(f.$options&&"function"==typeof f.$options.getOption?(n=f.$options.getOption("updateOn"),w=!!f.$options.getOption("allowInvalid")):(n=f.$options&&f.$options.updateOn||"",w=!(!f.$options||!f.$options.allowInvalid)),!n.includes("change"))return"function"==typeof f.$overrideModelOptions?(n+=" change",f.$overrideModelOptions({"*":"$inherit",updateOn:n})):(n+=" change",n.replace(/default/g," "),t=angular.copy(f.$options)||{},t.updateOn=n,t.updateOnDefault=!1,f.$options=t)}(),d=n.opts,e=l({},angular.copy(r),d),o=null,k=function(){if(o)return o.setStartDate(),o.setEndDate()},y=function(n){return function(t){if(t&&(!moment.isMoment(t)||t.isValid()))return t=moment(t),o?n(t):void 0}},c=y(function(n){return n&&o.endDate<n&&o.setEndDate(n),o.setStartDate(n),e.startDate=o.startDate}),h=y(function(n){return n&&o.startDate>n?(o.setEndDate(o.startDate),e.endDate=o.endDate,o.setStartDate(n),e.startDate=o.startDate):(o.setEndDate(n),e.endDate=o.endDate)}),b=function(n){var t;return t=function(n){return moment.isMoment(n)?n.format(e.locale.format):moment(n).format(e.locale.format)},e.singleDatePicker&&n?t(n):n&&(n.startDate||n.endDate)?[t(n.startDate),t(n.endDate)].join(e.locale.separator):""},f.$formatters.push(function(n){return b(n)}),f.$renderOriginal=f.$render,f.$render=function(){if(f.$modelValue&&e.singleDatePicker?(c(f.$modelValue),h(f.$modelValue)):f.$modelValue&&(f.$modelValue.startDate||f.$modelValue.endDate)?(c(f.$modelValue.startDate),h(f.$modelValue.endDate)):k(),f.$valid)return f.$renderOriginal()},f.$parsers.push(function(n){var r,t,i;return r=function(n){var t;return t=moment(n,e.locale.format),t.isValid()&&t||null},t=e.singleDatePicker?null:{startDate:null,endDate:null},angular.isString(n)&&n.length>0&&(e.singleDatePicker?t=r(n):(i=n.split(e.locale.separator).map(r),t.startDate=i[0]?i[0].startOf("day"):null,t.endDate=i[1]?i[1].endOf("day"):null)),t}),f.$isEmpty=function(n){return!(angular.isString(n)&&n.length>0)},a=function(){var t;s.daterangepicker(angular.extend(e,{autoUpdateInput:!1}),function(){return n.$apply(function(){if("function"==typeof e.changeCallback)return e.changeCallback.apply(this,arguments)})});o=s.data("daterangepicker");n.picker=o;o.container.hide();o.container.addClass((e.pickerClasses||"")+" "+(u.pickerClasses||""));s.on("show.daterangepicker",function(t,i){return s.addClass("picker-open"),n.$apply(function(){e.singleDatePicker?i.startDate.isSame(n.model)||(c(n.model),h(n.model)):(n.model&&!i.startDate.isSame(n.model.startDate)&&c(n.model.startDate),n.model&&!i.endDate.isSame(n.model.endDate)&&h(n.model.endDate));i.updateView()})});s.on("hide.daterangepicker",function(){return s.removeClass("picker-open")});s.on("apply.daterangepicker",function(t,i){return n.$apply(function(){e.singleDatePicker?i.startDate?i.startDate.isSame(n.model)||(n.model=i.startDate):n.model=null:i.startDate.isSame(i.oldStartDate)&&i.endDate.isSame(i.oldEndDate)&&n.model&&i.startDate.isSame(n.model.startDate)&&i.endDate.isSame(n.model.endDate)||(n.model={startDate:i.startDate,endDate:i.endDate,label:i.chosenLabel})})});s.on("outsideClick.daterangepicker",function(t,i){return e.cancelOnOutsideClick?n.$apply(function(){return i.cancelingClick=!0,i.clickCancel()}):i.clickApply()});for(t in e.eventHandlers)s.on(t,function(t){var i;return i=t.type+"."+t.namespace,n.$evalAsync(e.eventHandlers[i])});if(f.$validate(),!n.model)return s.trigger("change")},n.$watch(function(){return b(n.model)},function(n){return"function"==typeof f.$processModelValue?(f.$processModelValue(),f.$render()):("function"==typeof f.$$updateEmptyClasses&&f.$$updateEmptyClasses(n),f.$viewValue=f.$$lastCommittedViewValue=n,f.$render())}),f.$validators.invalid=function(n,t){var i,r;return i=u.required&&!f.$isEmpty(t),r=e.singleDatePicker?n&&n.isValid():n&&n.startDate&&n.startDate.isValid()&&n.endDate&&n.endDate.isValid(),!i||!!r},p=function(n,t,i){var r;return!n||!t&&!i||(r=[n,t,i].map(function(n){return n?moment(n):n}),n=r[0],t=r[1],i=r[2],(!t||t.isBefore(n)||t.isSame(n,"day"))&&(!i||i.isSame(n,"day")||i.isAfter(n)))},v=function(i,r,s,h){if(f.$validators[i]=function(n){return!e[h]||(e.singleDatePicker?"min"===i?!n||r(n,e.minDate,n):"max"===i?!n||r(n,n,e.maxDate):void 0:n&&r(n[s],e.minDate,e.maxDate))},u[i])return n.$watch(i,function(n){if(e[h]=!!n&&moment(n),o)return o[h]=e[h],t(function(){return f.$validate()})})},v("min",p,"startDate","minDate"),v("max",p,"endDate","maxDate"),n.$watch("opts",function(n){return null==n&&(n={}),e=l(e,n),a()},!0),u.clearable&&n.$watch("clearable",function(i){if(i&&(e=l(e,{locale:{cancelLabel:e.locale.clearLabel}})),a(),i)return s.on("cancel.daterangepicker",function(i,r){return r.cancelingClick||(n.model=e.singleDatePicker?null:{startDate:null,endDate:null},s.val("")),r.cancelingClick=null,t(function(){return n.$apply()})})}),n.$on("$destroy",function(){if(null!=o)return o.remove()})}}}])}.call(this),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){e.timelineModel={};e.dateRangeOptions={locale:{applyLabel:"Apply",cancelLabel:"Cancel",customRangeLabel:"Custom range",separator:" --> ",format:"DD-MMM-YY"},eventHandlers:{"apply.daterangepicker":function(){e.dateRangeFilterChanged()}}};e.startDate=moment().subtract(1,"days").startOf("day");e.endDate=moment().add(3,"days").endOf("day");e.dateRange={startDate:moment().subtract(1,"days").startOf("day"),endDate:moment().add(3,"days").endOf("day")};e.startDate=e.dateRange.startDate.format(t.Settings.ServerDateTimeFormat);e.endDate=e.dateRange.endDate.format(t.Settings.ServerDateTimeFormat);e.timelineModel.options={editable:!1,selectable:!0,start:moment().subtract(3,"hours"),end:moment().add(3,"hours"),min:e.dateRange.startDate,max:e.dateRange.endDate,zoomMin:36e5,zoomMax:1728e5};e.timelineModel.events={};e.initData();e.getBookingsForTimeline()};e.getBookingsForTimeline=function(){var n={startDate:e.startDate,endDate:e.endDate};i.getBookingsForTimeline(n).then(function(n){var u,i,f,r;n.data.success&&(u=n.data.result.bookings,i=[],u.forEach(function(n){var r,u;console.log(n);n.pickupDate=moment(n.pickupDateTimeMoment,t.Settings.ServerDateTimeFormat);n.gmtPickupDate=moment.utc(n.gmtPickupDateTimeMoment,t.Settings.ServerDateTimeFormat);n.finishDateTime=moment(n.pickupDateTimeMoment,t.Settings.ServerDateTimeFormat).add(n.durationInMinutes,"minutes");n.pickupDateDisplay=n.pickupDate.format("ddd, DD MMM");n.pickupTimeDisplay=n.pickupDate.format("HH:mm A");n.finishDateTimeDisplay=n.finishDateTime.format("HH:mm A");r=0;n.companyCarId&&(r=n.companyCarId);u={id:n.customerId,guid:n.guid,group:r,title:e.getBookingCardContent(n,!0),content:e.getBookingCardContent(n,!1),start:n.pickupDate,end:n.finishDateTime};i.push(u)}),f=n.data.result.cars,r=[],f.forEach(function(n){console.log(n);var t={id:n.id,content:e.getCarCardContent(n),value:n.id};r.push(t)}),e.timelineModel.cars=r,e.timelineModel.data.groups.update(r),e.timelineModel.bookings=i,e.timelineModel.data.items.update(i))})};e.dateRangeFilterChanged=function(){e.dateRange.startDate&&e.dateRange.endDate&&(e.startDate=e.dateRange.startDate.format(t.Settings.ServerDateTimeFormat),e.endDate=e.dateRange.endDate.format(t.Settings.ServerDateTimeFormat),e.timelineModel.options.min=e.dateRange.startDate.startOf("day"),e.timelineModel.options.max=e.dateRange.endDate.endOf("day"),e.getBookingsForTimeline())};n.$on("itemDispatchClicked",function(n,t){console.log(t);var i=e.timelineModel.bookings.find(function(n){return n.id===t.itemId});i&&e.assignDriver(i)});e.getBookingCardContent=function(n,t){var i="";return t||(i="<div><button class='btn btn-xs btn-success' onclick='itemDispatchClicked(\""+n.customerId+"\")'>A<\/button><\/div>"),i+="<b>"+n.customerId+"<\/b> - "+n.carClassName+"- <b>"+n.pickupTimeDisplay+"<\/b> <br/>",i+="<div><b>"+n.durationInMinutes+" min:<\/b> "+n.pickupTimeDisplay+" -> "+n.finishDateTimeDisplay+"<\/div>",i+="<div>F: "+n.from.address+" <\/div>",n.to&&(i+="<div>T: "+n.to.address+" <\/div>"),i};e.getCarCardContent=function(n){return"<b>"+n.registrationNumber+"<\/b><br/> "+n.carClassName};e.initData=function(){e.groups=f([{id:0,content:"<b>NOT <br/> ASSIGNED<\/b>",value:0},]);e.items=f([]);e.timelineModel.data={groups:e.groups,items:e.items}};e.assignDriver=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><assign-driver-to-booking booking-id='vm.guid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/assign-driver-to-booking><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return"Assign driver to booking"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){t.getBookingsForTimeline()}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("timelineDispatch",{controller:["$scope","AppSettings","bookingApi","htmlPageService","$uibModal","VisDataSet",t],controllerAs:"vm",bindings:{guid:"<",websiteGuid:"<"},template:'<div class="ibox float-e-margins"><div class="ibox-title"><h5>Daily planner<\/h5><div ibox-tools><\/div><\/div><div class="ibox-content"><div class="row"><div class="col-sm-12"><div class="input-group date m-b-sm"><input date-range-picker name="dateRange" class="form-control date-picker" style="min-width: 200px;" placeholder="From -> To Dates" type="text" ng-change="vm.dateRangeFilterChanged()" ng-model="vm.dateRange" options="vm.dateRangeOptions"><\/div><\/div><\/div><div class="row"><div class="col-sm-12"><vis-timeline data="vm.timelineModel.data" options="vm.timelineModel.options" events="vm.timelineModel.events"><\/vis-timeline><\/div><\/div><\/div><\/div>'})}();angular.module("angularPayments",[]);angular.module("angularPayments").factory("Common",[function(){var n={};return n.parseExpiry=function(n){var i,r,t,u;return n=n||"",n=n.replace(/\s/g,""),u=n.split("/",2),i=u[0],t=u[1],2===(null!=t?t.length:void 0)&&/^\d+$/.test(t)&&(r=(new Date).getFullYear(),r=r.toString().slice(0,2),t=r+t),i=parseInt(i,10),t=parseInt(t,10),{month:i,year:t}},n}]);angular.module("angularPayments").factory("Cards",[function(){var n=/(\d{1,4})/g,t=/(?:^|\s)(\d{4})$/,i=[{type:"maestro",pattern:/^(5018|5020|5038|6304|6759|676[1-3])/,format:n,inputFormat:t,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"dinersclub",pattern:/^(36|38|30[0-5])/,format:n,inputFormat:t,length:[14],cvcLength:[3],luhn:!0},{type:"laser",pattern:/^(6706|6771|6709)/,format:n,inputFormat:t,length:[16,17,18,19],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:n,inputFormat:t,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",pattern:/^62/,format:n,inputFormat:t,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"discover",pattern:/^(6011|65|64[4-9]|622)/,format:n,inputFormat:t,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[1-5]/,format:n,inputFormat:t,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,inputFormat:/^(\d{4}|\d{4}\s\d{6})$/,length:[15],cvcLength:[3,4],luhn:!0},{type:"visa",pattern:/^4/,format:n,inputFormat:t,length:[13,14,15,16],cvcLength:[3],luhn:!0}],r=function(n){var r,t,u;for(n=(n+"").replace(/\D/g,""),t=0,u=i.length;u>t;t++)if(r=i[t],r.pattern.test(n))return r},u=function(n){for(var r,t=0,u=i.length;u>t;t++)if(r=i[t],r.type===n)return r};return{fromNumber:function(n){return r(n)},fromType:function(n){return u(n)},defaultFormat:function(){return n},defaultInputFormat:function(){return t}}}]);angular.module("angularPayments").factory("_Format",["Cards","Common","$filter",function(n,t,i){var r={},u=function(n){var t;return null!=n.prop("selectionStart")&&n.prop("selectionStart")!==n.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)?!0:!1},s=function(t){var u,f,r,s,e,o,i;if(r=String.fromCharCode(t.which),u=angular.element(t.currentTarget),i=u.val(),f=n.fromNumber(i+r),s=(i.replace(/\D/g,"")+r).length,o=16,f&&(o=f.length[f.length.length-1]),!(s>=o)){if(!/^\d+$/.test(r)&&!t.meta&&t.keyCode>=46)return void t.preventDefault();if(null==u.prop("selectionStart")||u.prop("selectionStart")===i.length)return e=n.defaultInputFormat(),f&&(e=f.inputFormat),e.test(i)?(t.preventDefault(),u.val(i+" "+r)):e.test(i+r)?(t.preventDefault(),u.val(i+r+" ")):void 0}},h=function(t){var f,i,e,r;f=angular.element(t.currentTarget);e=String.fromCharCode(t.which);/^\d+$/.test(e)&&(u(f)||(r=(f.val()+e).replace(/\D/g,""),i=n.fromNumber(r),i?r.length<=i.length[i.length.length-1]||t.preventDefault():r.length<=16||t.preventDefault()))},c=function(n){var t,i;return t=angular.element(n.currentTarget),i=t.val(),n.meta||8!==n.which||null!=t.prop("selectionStart")&&t.prop("selectionStart")!==i.length?void 0:/\d\s$/.test(i)&&!n.meta&&n.keyCode>=46?(n.preventDefault(),t.val(i.replace(/\d\s$/,""))):/\s\d?$/.test(i)?(n.preventDefault(),t.val(i.replace(/\s\d?$/,""))):void 0},f=function(t){var i,r,u,f;return(i=n.fromNumber(t))?(u=i.length[i.length.length-1],t=t.replace(/\D/g,""),t=t.slice(0,+u+1||9e9),i.format.global?null!=(f=t.match(i.format))?f.join(" "):void 0:(r=i.format.exec(t),null!=r&&r.shift(),null!=r?r.join(" "):void 0)):t},l=function(n){return setTimeout(function(){var i,t;return i=angular.element(n.target),t=i.val(),t=f(t),i.val(t)})},a=function(n){return null!=n?n.replace(/\s/g,""):n},e,o;return r.card=function(n,t){n.bind("keypress",h);n.bind("keypress",s);n.bind("keydown",c);n.bind("paste",l);t.$parsers.push(a);t.$formatters.push(f)},_formatCVC=function(n){return $target=angular.element(n.currentTarget),digit=String.fromCharCode(n.which),!/^\d+$/.test(digit)&&!n.meta&&n.keyCode>=46?void n.preventDefault():(val=$target.val()+digit,val.length<=4?void 0:void n.preventDefault())},r.cvc=function(n){n.bind("keypress",_formatCVC)},_restrictExpiry=function(n){var i,r,t;return i=angular.element(n.currentTarget),r=String.fromCharCode(n.which),!/^\d+$/.test(r)&&!n.meta&&n.keyCode>=46?void n.preventDefault():u(i)?void 0:(t=i.val()+r,t=t.replace(/\D/g,""),t.length>6?void n.preventDefault():void 0)},_formatExpiry=function(n){var i,r,t;return r=String.fromCharCode(n.which),!/^\d+$/.test(r)&&!n.meta&&n.keyCode>=46?void n.preventDefault():(i=angular.element(n.currentTarget),t=i.val()+r,/^\d$/.test(t)&&"0"!==t&&"1"!==t?(n.preventDefault(),i.val("0"+t+" / ")):/^\d\d$/.test(t)?(n.preventDefault(),i.val(""+t+" / ")):void 0)},_formatForwardExpiry=function(n){var t,r,i;return r=String.fromCharCode(n.which),!/^\d+$/.test(r)&&!n.meta&&n.keyCode>=46?void 0:(t=angular.element(n.currentTarget),i=t.val(),/^\d\d$/.test(i)?t.val(""+i+" / "):void 0)},_formatForwardSlash=function(n){var i,r,t;return r=String.fromCharCode(n.which),"/"===r?(i=angular.element(n.currentTarget),t=i.val(),/^\d$/.test(t)&&"0"!==t?i.val("0"+t+" / "):void 0):void 0},_formatBackExpiry=function(n){var t,i;if(!n.meta&&(t=angular.element(n.currentTarget),i=t.val(),8===n.which&&(null==t.prop("selectionStart")||t.prop("selectionStart")===i.length)))return/\d(\s|\/)+$/.test(i)?(n.preventDefault(),t.val(i.replace(/\d(\s|\/)*$/,""))):/\s\/\s?\d?$/.test(i)?(n.preventDefault(),t.val(i.replace(/\s\/\s?\d?$/,""))):void 0},e=function(n){if(null!=n){var r=t.parseExpiry(n),u=new Date(r.year,r.month-1);return i("date")(u,"MM/yyyy")}return null},o=function(n){if(null!=n){var r=t.parseExpiry(n),u=new Date(r.year,r.month-1);return i("date")(u,"MM / yyyy")}return null},r.expiry=function(n,t){n.bind("keypress",_restrictExpiry);n.bind("keypress",_formatExpiry);n.bind("keypress",_formatForwardSlash);n.bind("keypress",_formatForwardExpiry);n.bind("keydown",_formatBackExpiry);t.$parsers.push(e);t.$formatters.push(o)},function(n,t,i){if(!r[n])throw types=Object.keys(r),errstr='Unknown type for formatting: "'+n+'". ',errstr+='Should be one of: "'+types.join('", "')+'"';return r[n](t,i)}}]).directive("paymentsFormat",["$window","_Format",function(n,t){return{restrict:"A",require:"ngModel",link:function(n,i,r,u){t(r.paymentsFormat,i,u)}}}]);angular.module("angularPayments").factory("_Validate",["Cards","Common","$parse",function(n,t,i){var u=[].indexOf||function(n){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===n)return t;return-1},f=function(n){var t,r,u,f,i,e;for(u=!0,f=0,r=(n+"").split("").reverse(),i=0,e=r.length;e>i;i++)t=r[i],t=parseInt(t,10),(u=!u)&&(t*=2),t>9&&(t-=9),f+=t;return f%10==0},r={};return r.cvc=function(t,r,f,e){var s,h,o,c;return null==t||0==t.length?!0:/^\d+$/.test(t)?(e.paymentsTypeModel&&(c=i(e.paymentsTypeModel),o=c(f)),o?(s=t.length,u.call(null!=(h=n.fromType(o))?h.cvcLength:void 0,s)>=0):t.length>=3&&t.length<=4):!1},r.card=function(t,r,e,o){var s,l,h,c;return o.paymentsTypeModel&&(h=i(o.paymentsTypeModel)),c=function(){h&&h.assign(e,null);r.$card=null},null==t||0==t.length?(c(),!0):(t=(t+"").replace(/\s+|-/g,""),/^\d+$/.test(t)&&(s=n.fromNumber(t))?(r.$card=angular.copy(s),h&&h.assign(e,s.type),l=t.length,ret=u.call(s.length,l)>=0&&(s.luhn===!1||f(t)),ret):(c(),!1))},r.expiry=function(n){if(null==n||0==n.length)return!0;obj=t.parseExpiry(n);month=obj.month;year=obj.year;var u,i,r;return month&&year&&/^\d+$/.test(month)&&/^\d+$/.test(year)&&parseInt(month,10)<=12?(2===year.length&&(r=(new Date).getFullYear(),r=r.toString().slice(0,2),year=r+year),i=new Date(year,month),u=new Date,i.setMonth(i.getMonth()-1),i.setMonth(i.getMonth()+1,1),i>u):!1},function(n,t,i,u,f){if(!r[n])throw types=Object.keys(r),errstr='Unknown type for validation: "'+n+'". ',errstr+='Should be one of: "'+types.join('", "')+'"';return r[n](t,i,u,f)}}]).factory("_ValidateWatch",["_Validate",function(n){var t={};return t.cvc=function(t,i,r,u){u.paymentsTypeModel&&r.$watch(u.paymentsTypeModel,function(f,e){if(f!=e){var o=n(t,i.$modelValue,i,r,u);i.$setValidity(t,o)}})},function(n,i,r,u){if(t[n])return t[n](n,i,r,u)}}]).directive("paymentsValidate",["$window","_Validate","_ValidateWatch",function(n,t,i){return{restrict:"A",require:"ngModel",link:function(n,r,u,f){var e=u.paymentsValidate,o;i(e,f,n,u);o=function(i){var r=t(e,i,f,n,u);return f.$setValidity(e,r),r?i:void 0};f.$formatters.push(o);f.$parsers.push(o)}}}]);angular.module("angularPayments").directive("stripeForm",["$window","$parse","Common",function(n,t,r){return _getDataToSend=function(n){var t=["number","expMonth","expYear","cvc","name","addressLine1","addressLine2","addressCity","addressState","addressZip","addressCountry"],u=function(n){return n.replace(/([A-Z])/g,function(n){return"_"+n.toLowerCase()})},r={};for(i in t)n.hasOwnProperty(t[i])&&(r[u(t[i])]=angular.copy(n[t[i]]));return r.number=(r.number||"").replace(/ /g,""),r},{restrict:"A",link:function(t,i,u){if(!n.Stripe)throw"stripeForm requires that you have stripe.js installed. Include https://js.stripe.com/v2/ into your html.";var f=angular.element(i);f.bind("submit",function(){expMonthUsed=t.expMonth?!0:!1;expYearUsed=t.expYear?!0:!1;expMonthUsed&&expYearUsed||(exp=r.parseExpiry(t.expiry),t.expMonth=exp.month,t.expYear=exp.year);var i=f.find("button");i.prop("disabled",!0);f.hasClass("ng-valid")?n.Stripe.createToken(_getDataToSend(t),function(){var n=arguments;t.$apply(function(){t[u.stripeForm].apply(t,n)});i.prop("disabled",!1)}):(t.$apply(function(){t[u.stripeForm].apply(t,[400,{error:"Invalid form submitted."}])}),i.prop("disabled",!1));t.expMonth=null;t.expYear=null})}}}]),function(){"use strict";var n=angular.module("bookingApp");n.service("bookingApi",["$http","$location","$q","AppSettings",function(n,t,i,r){var f=this,u=t.$$protocol+"://"+t.$$host+(t.$$port?":"+t.$$port:"");window.baseApiUrl&&(console.log(window.baseApiUrl),u=window.baseApiUrl);f.getQuoteInfo=function(t){return t?n.get(u+"/QuotationsApi/GetQuotationInfo?guid="+t):n.get(u+"/QuotationsApi/GetQuotationInfo")};f.setQuotationPrice=function(t){return n.post(u+"/QuotationsApi/SetQuotationPrice",t)};f.saveQuotationInfo=function(t){return n.post(u+"/QuotationsApi/SaveQuotationInfo",t)};f.setBookingDriverStatuses=function(t){return n.post(u+"/BookingApi/SetBookingDriverStatuses",t)};f.getUsers=function(t){return t?n.get(u+"/BookingApi/GetUsers/"+t):n.get(u+"/BookingApi/GetUsers/")};f.getClients=function(t,i){return i?n.get(u+"/accountApi/GetClients/"+t+"/?searchText="+i):n.get(u+"/accountApi/GetClients/"+t+"/")};f.getCars=function(t){return n.get(u+"/driversApi/GetCars/"+t+"/")};f.getCarDetails=function(t,i){return n.get(u+"/driversApi/GetCarDetails/"+t+"/"+i)};f.saveCarDeatails=function(t){return n.post(u+"/driversApi/saveCarDetails/",t)};f.deleteCar=function(t){return n.get(u+"/driversApi/DeleteCar/"+t)};f.getCarClasses=function(){return n.get(u+"/driversApi/GetCarClasses/")};f.getCarClassInfo=function(t,i){return i?n.get(u+"/driversApi/GetCarClass/"+t+"/"+i):n.get(u+"/driversApi/GetCarClass/"+t+"/")};f.saveCarClassInfo=function(t){return n.post(u+"/driversApi/saveCarClassInfo/",t)};f.deleteCarType=function(t){return n.get(u+"/driversApi/DeleteCarClass/"+t)};f.getAllDriversAllowedAreas=function(t){return n.get(u+"/driversApi/getAllDriversAllowedAreas/"+t)};f.getAllowedAreas=function(t){return n.get(u+"/driversApi/getAllowedAreas/"+t)};f.getDriverInfo=function(t,i){return i?n.get(u+"/driversApi/GetDriverInfo/"+t+"/"+i):n.get(u+"/driversApi/GetDriverInfo/"+t+"/")};f.saveDriver=function(t){return n.post(u+"/driversApi/saveDriver/",t)};f.getAllowedPickupRegions=function(t){return n.get(u+"/websitesApi/getAllowedPickupRegions/"+t)};f.getPickupRegionDetails=function(t,i,r){return n.get(u+"/websitesApi/getPickupRegionDetails/"+t+"/"+i+"/"+r)};f.savePickupRegion=function(t){return n.post(u+"/websitesApi/savePickupRegion/",t)};f.deletePickupRegion=function(t){return n.post(u+"/websitesApi/deletePickupRegion/"+t)};f.getPricePlanConfiguration=function(t,i,r){var f=u+"/pricingApi/getPricePlanConfiguration/"+t+"/"+i;return r&&(f+="?regionGuid="+r),n.get(f)};f.savePricePlanConfiguration=function(t){return n.post(u+"/pricingApi/savePricePlanConfiguration/",t)};f.getWebsiteRegions=function(t){return n.get(u+"/pricingApi/getWebsiteRegions/"+t)};f.getWebsiteRegionInfo=function(t,i,r){return n.get(u+"/pricingApi/getWebsiteRegionDetails/"+t+"/"+i+"/"+r)};f.saveWebsiteRegion=function(t){return n.post(u+"/pricingApi/saveWebsiteRegion/",t)};f.deleteWebsiteRegion=function(t,i){return n.post(u+"/pricingApi/deleteWebsiteRegion/"+t+"/"+i)};f.deleteWebsiteRegionPricePlan=function(t,i){return n.post(u+"/pricingApi/deleteWebsiteRegionPricePlan/"+t+"/"+i)};f.getPricesForCarType=function(t,i,r){return n.get(u+"/pricingApi/getPricesForCarType/"+t+"/"+i+"/"+r)};f.savePricesForCarType=function(t){return n.post(u+"/pricingApi/savePricesForCarType/",t)};f.getFixedPrices=function(t,i){return n.get(u+"/pricingApi/getFixedPrices/"+t+"/"+i)};f.getFixedPriceInfo=function(t,i,r,f){return n.get(u+"/pricingApi/getFixedPriceDetails/"+t+"/"+i+"/"+r+"/"+f)};f.saveFixedPrice=function(t){return n.post(u+"/pricingApi/saveFixedPrice/",t)};f.getWebsiteFixedPrices=function(t,i){return n.get(u+"/pricingApi/getWebsiteFixedPrices/"+t+"/"+i)};f.getWebsiteFixedPriceInfo=function(t,i,r,f){return n.get(u+"/pricingApi/getWebsiteFixedPriceDetails/"+t+"/"+i+"/"+r+"/"+f)};f.saveWebsiteFixedPrice=function(t){return n.post(u+"/pricingApi/saveWebsiteFixedPrice/",t)};f.getClientFixedPrices=function(t,i){return n.get(u+"/pricingApi/getClientFixedPrices/"+t+"/"+i)};f.getClientFixedPriceInfo=function(t,i,r,f){return n.get(u+"/pricingApi/getClientFixedPriceDetails/"+t+"/"+i+"/"+r+"/"+f)};f.saveClientFixedPrice=function(t){return n.post(u+"/pricingApi/saveClientFixedPrice/",t)};f.deleteWebsiteFixedPrice=function(t,i){return n.post(u+"/pricingApi/deleteWebsiteFixedPrice/"+t+"/"+i)};f.getHourlySurcharges=function(t,i){return n.get(u+"/pricingApi/getHourlySurcharges/"+t+"/"+i)};f.saveHourlySurcharges=function(t){return n.post(u+"/pricingApi/saveHourlySurcharges/",t)};f.getTaxSurcharges=function(t,i){return n.get(u+"/pricingApi/getTaxSurcharges/"+t+"/"+i)};f.saveTaxSurcharges=function(t,i,r){return n.post(u+"/pricingApi/saveTaxSurcharges/"+t+"/"+i,r)};f.getPaymentMethodsSurcharges=function(t,i){return n.get(u+"/pricingApi/getPaymentMethodsSurcharges/"+t+"/"+i)};f.savePaymentMethodsSurcharges=function(t,i,r){return n.post(u+"/pricingApi/savePaymentMethodsSurcharges/"+t+"/"+i,r)};f.getTimeLeftSurcharges=function(t,i){return n.get(u+"/pricingApi/getTimeLeftSurcharges/"+t+"/"+i)};f.saveTimeLeftSurcharges=function(t,i,r){return n.post(u+"/pricingApi/saveTimeLeftSurcharges/"+t+"/"+i,r)};f.deleteFixedPrice=function(t){return n.post(u+"/pricingApi/deleteFixedPrice/"+t)};f.getClientPrices=function(t){return n.get(u+"/pricingApi/getClientPrices/"+t)};f.saveClientPrices=function(t){return n.post(u+"/pricingApi/saveClientPrices/",t)};f.getCompanies=function(t){return n.get(u+"/InvoiceApi/GetCompanies/"+t)};f.getCompanyInfo=function(t,i){return n.get(u+"/InvoiceApi/GetCompanyDetails/"+t+"/"+i)};f.saveCompanyDetails=function(t){return n.post(u+"/InvoiceApi/SaveCompanyDetails/",t)};f.setDefaultWebsite=function(t){return n.post(u+"/account/website/"+t)};f.registerWebsite=function(t){return n.post(u+"/WebsitesApi/registerWebsite/",t)};f.deleteWebsite=function(t){return n.get(u+"/WebsitesApi/DeleteWebsite/"+t)};f.restoreWebsite=function(t){return n.get(u+"/WebsitesApi/RestoreWebsite/"+t)};f.getWebsites=function(){return n.post(u+"/WebsitesApi/GetWebsites/",{showRemoved:!0})};f.getWebsiteInfo=function(t){return n.get(u+"/WebsitesApi/GetWebsiteDetails/"+t)};f.updateWebsiteInfo=function(t){return n.post(u+"/WebsitesApi/UpdateWebsiteDetails/",t)};f.getWebsiteNotificationSettings=function(t){return n.get(u+"/WebsitesApi/GetWebsiteNotificationsSettings/"+t)};f.updateWebsiteNotificationSettings=function(t){return n.post(u+"/WebsitesApi/SaveNotificationSettings/",t)};f.getWebsiteOperationsSettings=function(t){return n.get(u+"/WebsitesApi/GetWebsiteOperationsSettings/"+t)};f.getWebsiteCancellationSettings=function(t){return n.get(u+"/WebsitesApi/GetWebsiteCancellationSettings/"+t)};f.updateWebsiteOperationsSettings=function(t){return n.post(u+"/WebsitesApi/SaveOperationsSettings/",t)};f.getWebsiteFilesSettings=function(t){return n.get(u+"/WebsitesApi/GetWebsiteFilesSettings/"+t)};f.updateWebsiteFilesSettings=function(t){return n.post(u+"/WebsitesApi/SaveFilesSettings/",t)};f.getWebsiteIFrameSettings=function(t){return n.get(u+"/WebsitesApi/GetWebsiteIFrameSettings/"+t)};f.saveWebsiteIFrameSettings=function(t){return n.post(u+"/WebsitesApi/SaveWebsiteIFrameSettings/",t)};f.saveWebsiteGeneralDetails=function(t){return n.post(u+"/WebsitesApi/SaveGeneralDetails/",t)};f.getWebsiteUsers=function(t){return t?n.get(u+"/WebsitesApi/GetWebsiteUsers/"+t+"/"):n.get(u+"/WebsitesApi/GetWebsiteUsers/")};f.getWebsiteUserRoles=function(t,i){return n.get(u+"/WebsitesApi/GetWebsiteUserRoles/"+t+"/"+i)};f.getUserInfo=function(t,i){return i?n.get(u+"/accountApi/GetUserInfo/"+t+"/"+i):n.get(u+"/accountApi/GetUserInfo/"+t+"/")};f.updateUserInfo=function(t){return n.post(u+"/accountApi/UpdateUserInfo/",t)};f.getUserCreditInfo=function(t,i){return n.get(u+"/accountApi/getUserCreditInfo/"+t+"/"+i)};f.getUserRoles=function(t,i){return i?n.get(u+"/accountApi/GetUserRoles/"+t+"/"+i):n.get(u+"/accountApi/GetUserRoles/"+t+"/")};f.updateUserRoles=function(t){return n.post(u+"/accountApi/UpdateUserRoles/",t)};f.loginAsUser=function(t){return n.get(u+"/accountApi/LoginAsUser/"+t)};f.deleteUser=function(t){return n.post(u+"/accountApi/DeleteUserInfo/",t)};f.deleteClient=function(t){return n.post(u+"/accountApi/DeleteClient/",t)};f.getNextBookings=function(t){return n.post(u+"/BookingApi/GetNextBookings",t)};f.getSingleBooking=function(t){return n.get(u+"/BookingApi/GetSingleBooking/"+t)};f.sendBookingConfirmationToClient=function(t){return n.post(u+"/BookingApi/SendBookingConfirmationToClient/"+t)};f.sendDriverInfoToClient=function(t){return n.post(u+"/BookingApi/SendDriverInfoToClient/"+t)};f.sendDriverReviewRequestToClient=function(t){return n.post(u+"/BookingApi/SendDriverReviewRequestToClient/"+t)};f.sendBookingConfirmationToDriver=function(t){return n.post(u+"/BookingApi/SendBookingConfirmationToDriver/"+t)};f.sendBookingConfirmationSmsToDriver=function(t){return n.post(u+"/BookingApi/SendBookingConfirmationSmsToDriver/"+t)};f.getMessagePreview=function(t,i){return n.get(u+"/SmsApi/GetMessagePreview/"+t+"/"+i)};f.sendMessage=function(t){return n.post(u+"/MessagingApi/SendMessage/",t)};f.sendSmsMessage=function(t){return n.post(u+"/SmsApi/SendSmsMessage/",t)};f.getBookingDetails=function(t){return n.get(u+"/BookingApi/GetBooking/"+t)};f.updateBookingPaymentStatus=function(t,i,r){return n.post(u+"/BookingApi/updateBookingPaymentStatus/",{guid:t,paymentStatus:r,paymentMethod:i})};f.addBookingPayment=function(t){return n.post(u+"/BookingApi/addBookingPayment/",t)};f.deleteBookingPayment=function(t){return n.post(u+"/BookingApi/deleteBookingPayment/",t)};f.getBookingDetailsForView=function(t){return n.get(u+"/BookingApi/GetBookingDetails/"+t)};f.getAnonymousDriverBookingDetails=function(t){return n.get(u+"/ABookingApi/GetDriverBooking/"+t)};f.driverAnonymousAcceptBooking=function(t){return n.post(u+"/ABookingApi/DriverAcceptBooking/",t)};f.driverAnonymousRejectBooking=function(t){return n.post(u+"/ABookingApi/DriverRejectBooking/",t)};f.setOnRouteStatus=function(t){return n.post(u+"/ABookingApi/DriverSetOnRouteStatus/",t)};f.getAnonymousBookingDetails=function(t){return n.get(u+"/ABookingApi/GetBooking/"+t)};f.getAnonymousBookingCancelationDetails=function(t){return n.get(u+"/ABookingApi/GetBookingCancellationInfo/"+t)};f.cancelAnonymousBooking=function(t){return n.post(u+"/ABookingApi/CancelBooking/",t)};f.getBookingSugestedPrice=function(t){return n.get(u+"/BookingApi/GetBookingPrice/"+t)};f.setBookingPrice=function(t,i,r){return n.post(u+"/BookingApi/SetBookingPrice",{guid:t,price:i,sendEmailToClient:r})};f.getInvoiceDetails=function(t){return n.get(u+"/InvoiceApi/GetInvoiceDetails/"+t)};f.updateInvoicePaymentStatus=function(t){return n.post(u+"/InvoiceApi/updateInvoicePaymentStatus",t)};f.getBookingBasicDetails=function(t){return n.get(u+"/BookingApi/GetBookingBasicDetails/"+t)};f.getBookingBasicDetailsWithDriver=function(t){return n.get(u+"/BookingApi/GetBookingBasicDetailsWithDriver/"+t)};f.deleteBooking=function(t){return n.get(u+"/BookingApi/DeleteBooking/"+t)};f.restoreBooking=function(t){return n.post(u+"/BookingApi/RestoreBooking/"+t)};f.getUserAccount=function(t){return n.get(u+"/accountApi/getAccountInfo/"+t)};f.closeCurrentBid=function(t){return n.post(u+"/bookingApi/deleteBookingDispatch/"+t)};f.dispatchBooking=function(t){return n.post(u+"/bookingApi/dispatchBooking/",t)};f.updateDriverQuoteStatus=function(t){return n.post(u+"/bookingApi/updateDriverQuoteStatus/",t)};f.getBookingDispatchInfo=function(t){return n.get(u+"/bookingApi/getBookingDispatchInfo/"+t)};f.getBookingPaymentInfo=function(t){return n.get(u+"/bookingApi/getBookingPaymentInfo/"+t)};f.getBookingLogInfo=function(t){return n.get(u+"/bookingApi/getBookingLogInfo/"+t)};f.updateUserAccount=function(t){return n.post(u+"/accountApi/updateAccountInfo",t)};f.changeUserPassword=function(t){return n.post(u+"/accountApi/changeUserPassword",t)};f.setUserPassword=function(t){return n.post(u+"/accountApi/setUserPassword",t)};f.sendDriverNotification=function(t){return n.post(u+"/driversApi/sendDriverNotification",t)};f.getUserAccountCompanyInvoiceInfo=function(t){return n.get(u+"/accountApi/getAccountInvoiceInfo/"+t)};f.updateUserCompanyInvoiceInfo=function(t){return n.post(u+"/accountApi/updateAccountInvoiceInfo",t)};f.computeBookingPriceForAdmin=function(t){return n.post(u+"/bookingApi/computeBookingPriceForAdmin",t)};f.getBookingPrice=function(t){return n.post(u+"/bookingApi/getBookingPrices",{guid:t.guid,websiteId:t.websiteId,type:t.bookingType,durationInHours:t.selectedDuration,from:t.from,to:t.bookingType===2?null:t.to,viaPoints:t.viaPoints,pickupDateTime:t.pickupDateTime.format(r.Settings.ServerDateTimeFormat),pickupDateDisplayed:t.pickupDateDisplay,carTypeId:t.selectedCarType.id,clientId:t.selectedClient?t.selectedClient.id:null})};f.updateBooking=function(t){var i={},f;return t.passengerDetails&&(i={salutation:t.passengerDetails.salutation,firstName:t.passengerDetails.firstName,lastName:t.passengerDetails.lastName,email:t.passengerDetails.email,phone:t.passengerDetails.phone,adultsNumber:t.passengerDetails.adultsNumber,childrenNumber:t.passengerDetails.childrenNumber,airline:t.passengerDetails.airline,largeLuggageNumber:t.passengerDetails.largeLuggageNumber,mediumLuggageNumber:t.passengerDetails.mediumLuggageNumber,roomNumber:t.passengerDetails.roomNumber,flightNumber:t.passengerDetails.flightNumber,comingFrom:t.passengerDetails.comingFrom,additionalRequirements:t.passengerDetails.additionalRequirements,driverInstructions:t.passengerDetails.driverInstructions,culture:t.passengerDetails.culture}),f={guid:t.guid,returnGuid:t.bookingType===3?t.returnBookingGuid:null,websiteId:t.websiteId,bookingType:t.bookingType,region:t.region,from:t.from,to:t.bookingType===2?null:t.to,viaPoints:t.viaPoints,selectedDurationInHours:t.selectedDuration,durationInMinutes:t.durationInMinutes,distanceInMiles:t.distanceInMiles,pickupDateTime:t.pickupDateTime.format(r.Settings.ServerDateTimeFormat),pickupDateDisplayed:t.pickupDateDisplay,pickupTimeDisplayed:t.pickupTimeDisplay,returnPickupDateTime:t.returnPickupDateTime?t.returnPickupDateTime.format(r.Settings.ServerDateTimeFormat):null,returnPickupDateDisplayed:t.returnPickupDateDisplay,returnPickupTimeDisplayed:t.returnPickupTimeDisplay,price:t.price,currency:t.currencyCode,numberOfCars:t.numberOfCars,hasVat:t.hasVat,platformPrice:t.platformPrice,paymentStatusString:t.paymentStatusString,requireCardPayment:t.requireCardPayment,carTypeId:t.selectedCarType.id,selectedPaymentOption:t.selectedPaymentOption,clientId:t.selectedClient!=null?t.selectedClient.id:null,externalRefNumber:t.externalRefNumber,dispatcherInstructions:t.dispatcherInstructions,passengerDetails:i,extras:t.extras},n.post(u+"/BookingApi/UpdateBooking",f)};f.getBookingDrivers=function(t){return n.get(u+"/BookingApi/GetBookingDriversToAssign/"+t)};f.getBookingDriversByFilter=function(t){return n.post(u+"/BookingApi/GetBookingDriversToAssign/",t)};f.getBookingDriversToDispatch=function(t){return n.get(u+"/driversApi/GetDriversToDispatch/"+t)};f.getBookingAvailableCarTypes=function(t){return n.get(u+"/BookingApi/GetCarTypes/"+t)};f.assignDriverToBooking=function(t){return n.post(u+"/BookingApi/AssignDriver/",t)};f.payBookingWithStripe=function(t){return n.post(u+"/BookingApi/PayBookingWithStripe/",t)};f.getSoftwareInvoices=function(t){return n.post(u+"/InvoiceApi/GetUserInvoices",t)};f.getSoftwareInvoice=function(t,i){return n.get(u+"/InvoiceApi/GetSoftwareInvoice/"+t+"?duplicate="+i)};f.saveSoftwareInvoice=function(t){return n.post(u+"/InvoiceApi/saveSoftwareInvoice/",t)};f.removeSoftwareInvoice=function(t){return n.post(u+"/InvoiceApi/RemoveSoftwareInvoice/"+t)};f.getBraintreeClientToken=function(t,i){return n.post(u+"/BtPaymentsApi/GetBtClientToken/",{websiteGuid:t,invoicesGuids:i})};f.completeBraintreePayment=function(t){return n.post(u+"/BtPaymentsApi/CompleteBraintreePayment/",t)};f.getBookingsForTimeline=function(t){return n.post(u+"/BookingApi/GetBookingsForTimeline/",t)};f.removeSupplier=function(t){return n.get(u+"/BookingApi/UnassignSupplierFromBooking?bookingGuid="+t)}}])}(),function(){"use strict";var n=angular.module("bookingApp");n.service("htmlPageService",["$timeout","$q","$window",function(n,t,i){var r=this;r.showNotificationListWithTitle=function(n,t,i){for(var f=" - "+i[0],e=i.length,u=1;u<e;u++)f+="<br> - "+i[u];r.showNotificationWithTitle(n,t,f)};r.showNotificationList=function(n,t){var u,f,i;if(t.length===1)r.showNotification(n,t[0]);else{for(u=" - "+t[0],f=t.length,i=1;i<f;i++)u+="<br> - "+t[i];r.showNotification(n,u)}};r.showNotificationWithTitle=function(n,t,i){toastr.options={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-top-right",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"7000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr[n](i,t)};r.showNotification=function(n,t){toastr.options={closeButton:!0,debug:!1,progressBar:!0,preventDuplicates:!1,positionClass:"toast-top-right",onclick:null,showDuration:"400",hideDuration:"1000",timeOut:"7000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr[n](t)};r.showConfirmation=function(n,i,r){r||(r="warning");var u=t.defer();return swal({title:n,text:i,type:r,showCancelButton:!0,cancelButtonText:"No",confirmButtonColor:"#3b97ef",confirmButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0,buttons:{confirm:"Confirm",cancel:!0}},function(){u.resolve(!0)}),u.promise};r.showError=function(n,i,r){r||(r="error");var u=t.defer();return swal({title:n,text:i,type:r,showCancelButton:!1,cancelButtonText:"No",confirmButtonColor:"#3b97ef",confirmButtonText:"Yes",closeOnConfirm:!0,closeOnCancel:!0,buttons:{confirm:"Confirm",cancel:!1}},function(){u.resolve(!0)}),u.promise};r.scrollElement=function(t,i,r){n(function(){i||(i=0);var u=$("#header"),n=$(t).offset();$("body,html").animate({scrollTop:n.top-i-u.height(),scrollLeft:n.left},500,r);$(".modal").animate({scrollTop:n.top-i-u.height(),scrollLeft:n.left},500,r)},50)};r.focusFirstError=function(n){var t="input.ng-invalid";n&&(t=n+" "+t);$(t).first().focus()};r.copyToClipboard=function(n){var e=angular.element(i.document.body),r=angular.element("<textarea/>"),u,f;r.css({position:"fixed",opacity:"0"});u=t.defer();u.notify("copying the text to clipboard");r.val(n);e.append(r);r[0].select();try{if(f=i.document.execCommand("copy"),!f)throw f;u.resolve(f)}catch(o){u.reject(o)}finally{r.remove()}return u.promise};r.loadScript=function(n){return new Promise(t=>{const i=document.createElement("script");i.type="text/javascript";i.src=n;i.readyState?i.onreadystatechange=()=>{(i.readyState==="loaded"||i.readyState==="complete")&&(i.onreadystatechange=null,t({script:n,loaded:!0,status:"Loaded"}))}:i.onload=()=>{t({script:n,loaded:!0,status:"Loaded"})};i.onerror=()=>t({script:n,loaded:!1,status:"Loaded"});document.getElementsByTagName("head")[0].appendChild(i)})};r.loadStyle=function(n){return new Promise(t=>{const i=document.createElement("link");i.rel="stylesheet";i.type="text/css";i.href=n;i.readyState?i.onreadystatechange=()=>{(i.readyState==="loaded"||i.readyState==="complete")&&(i.onreadystatechange=null,t({script:n,loaded:!0,status:"Loaded"}))}:i.onload=()=>{t({script:n,loaded:!0,status:"Loaded"})};i.onerror=()=>t({script:n,loaded:!1,status:"Loaded"});document.getElementsByTagName("head")[0].appendChild(i)})}}])}(),function(){"use strict";var n=[{group:"US (Common)",zones:[{value:"America/Puerto_Rico",name:"Puerto Rico (Atlantic)"},{value:"America/New_York",name:"New York (Eastern)"},{value:"America/Chicago",name:"Chicago (Central)"},{value:"America/Denver",name:"Denver (Mountain)"},{value:"America/Phoenix",name:"Phoenix (MST)"},{value:"America/Los_Angeles",name:"Los Angeles (Pacific)"},{value:"America/Anchorage",name:"Anchorage (Alaska)"},{value:"Pacific/Honolulu",name:"Honolulu (Hawaii)"}]},{group:"America",zones:[{value:"America/Adak",name:"Adak"},{value:"America/Anchorage",name:"Anchorage"},{value:"America/Anguilla",name:"Anguilla"},{value:"America/Antigua",name:"Antigua"},{value:"America/Araguaina",name:"Araguaina"},{value:"America/Argentina/Buenos_Aires",name:"Argentina - Buenos Aires"},{value:"America/Argentina/Catamarca",name:"Argentina - Catamarca"},{value:"America/Argentina/ComodRivadavia",name:"Argentina - ComodRivadavia"},{value:"America/Argentina/Cordoba",name:"Argentina - Cordoba"},{value:"America/Argentina/Jujuy",name:"Argentina - Jujuy"},{value:"America/Argentina/La_Rioja",name:"Argentina - La Rioja"},{value:"America/Argentina/Mendoza",name:"Argentina - Mendoza"},{value:"America/Argentina/Rio_Gallegos",name:"Argentina - Rio Gallegos"},{value:"America/Argentina/Salta",name:"Argentina - Salta"},{value:"America/Argentina/San_Juan",name:"Argentina - San Juan"},{value:"America/Argentina/San_Luis",name:"Argentina - San Luis"},{value:"America/Argentina/Tucuman",name:"Argentina - Tucuman"},{value:"America/Argentina/Ushuaia",name:"Argentina - Ushuaia"},{value:"America/Aruba",name:"Aruba"},{value:"America/Asuncion",name:"Asuncion"},{value:"America/Atikokan",name:"Atikokan"},{value:"America/Atka",name:"Atka"},{value:"America/Bahia",name:"Bahia"},{value:"America/Barbados",name:"Barbados"},{value:"America/Belem",name:"Belem"},{value:"America/Belize",name:"Belize"},{value:"America/Blanc-Sablon",name:"Blanc-Sablon"},{value:"America/Boa_Vista",name:"Boa Vista"},{value:"America/Bogota",name:"Bogota"},{value:"America/Boise",name:"Boise"},{value:"America/Buenos_Aires",name:"Buenos Aires"},{value:"America/Cambridge_Bay",name:"Cambridge Bay"},{value:"America/Campo_Grande",name:"Campo Grande"},{value:"America/Cancun",name:"Cancun"},{value:"America/Caracas",name:"Caracas"},{value:"America/Catamarca",name:"Catamarca"},{value:"America/Cayenne",name:"Cayenne"},{value:"America/Cayman",name:"Cayman"},{value:"America/Chicago",name:"Chicago"},{value:"America/Chihuahua",name:"Chihuahua"},{value:"America/Coral_Harbour",name:"Coral Harbour"},{value:"America/Cordoba",name:"Cordoba"},{value:"America/Costa_Rica",name:"Costa Rica"},{value:"America/Cuiaba",name:"Cuiaba"},{value:"America/Curacao",name:"Curacao"},{value:"America/Danmarkshavn",name:"Danmarkshavn"},{value:"America/Dawson",name:"Dawson"},{value:"America/Dawson_Creek",name:"Dawson Creek"},{value:"America/Denver",name:"Denver"},{value:"America/Detroit",name:"Detroit"},{value:"America/Dominica",name:"Dominica"},{value:"America/Edmonton",name:"Edmonton"},{value:"America/Eirunepe",name:"Eirunepe"},{value:"America/El_Salvador",name:"El Salvador"},{value:"America/Ensenada",name:"Ensenada"},{value:"America/Fortaleza",name:"Fortaleza"},{value:"America/Fort_Wayne",name:"Fort Wayne"},{value:"America/Glace_Bay",name:"Glace Bay"},{value:"America/Godthab",name:"Godthab"},{value:"America/Goose_Bay",name:"Goose Bay"},{value:"America/Grand_Turk",name:"Grand Turk"},{value:"America/Grenada",name:"Grenada"},{value:"America/Guadeloupe",name:"Guadeloupe"},{value:"America/Guatemala",name:"Guatemala"},{value:"America/Guayaquil",name:"Guayaquil"},{value:"America/Guyana",name:"Guyana"},{value:"America/Halifax",name:"Halifax"},{value:"America/Havana",name:"Havana"},{value:"America/Hermosillo",name:"Hermosillo"},{value:"America/Indiana/Indianapolis",name:"Indiana - Indianapolis"},{value:"America/Indiana/Knox",name:"Indiana - Knox"},{value:"America/Indiana/Marengo",name:"Indiana - Marengo"},{value:"America/Indiana/Petersburg",name:"Indiana - Petersburg"},{value:"America/Indiana/Tell_City",name:"Indiana - Tell City"},{value:"America/Indiana/Vevay",name:"Indiana - Vevay"},{value:"America/Indiana/Vincennes",name:"Indiana - Vincennes"},{value:"America/Indiana/Winamac",name:"Indiana - Winamac"},{value:"America/Indianapolis",name:"Indianapolis"},{value:"America/Inuvik",name:"Inuvik"},{value:"America/Iqaluit",name:"Iqaluit"},{value:"America/Jamaica",name:"Jamaica"},{value:"America/Jujuy",name:"Jujuy"},{value:"America/Juneau",name:"Juneau"},{value:"America/Kentucky/Louisville",name:"Kentucky - Louisville"},{value:"America/Kentucky/Monticello",name:"Kentucky - Monticello"},{value:"America/Knox_IN",name:"Knox IN"},{value:"America/La_Paz",name:"La Paz"},{value:"America/Lima",name:"Lima"},{value:"America/Los_Angeles",name:"Los Angeles"},{value:"America/Louisville",name:"Louisville"},{value:"America/Maceio",name:"Maceio"},{value:"America/Managua",name:"Managua"},{value:"America/Manaus",name:"Manaus"},{value:"America/Marigot",name:"Marigot"},{value:"America/Martinique",name:"Martinique"},{value:"America/Matamoros",name:"Matamoros"},{value:"America/Mazatlan",name:"Mazatlan"},{value:"America/Mendoza",name:"Mendoza"},{value:"America/Menominee",name:"Menominee"},{value:"America/Merida",name:"Merida"},{value:"America/Mexico_City",name:"Mexico City"},{value:"America/Miquelon",name:"Miquelon"},{value:"America/Moncton",name:"Moncton"},{value:"America/Monterrey",name:"Monterrey"},{value:"America/Montevideo",name:"Montevideo"},{value:"America/Montreal",name:"Montreal"},{value:"America/Montserrat",name:"Montserrat"},{value:"America/Nassau",name:"Nassau"},{value:"America/New_York",name:"New York"},{value:"America/Nipigon",name:"Nipigon"},{value:"America/Nome",name:"Nome"},{value:"America/Noronha",name:"Noronha"},{value:"America/North_Dakota/Center",name:"North Dakota - Center"},{value:"America/North_Dakota/New_Salem",name:"North Dakota - New Salem"},{value:"America/Ojinaga",name:"Ojinaga"},{value:"America/Panama",name:"Panama"},{value:"America/Pangnirtung",name:"Pangnirtung"},{value:"America/Paramaribo",name:"Paramaribo"},{value:"America/Phoenix",name:"Phoenix"},{value:"America/Port-au-Prince",name:"Port-au-Prince"},{value:"America/Porto_Acre",name:"Porto Acre"},{value:"America/Port_of_Spain",name:"Port of Spain"},{value:"America/Porto_Velho",name:"Porto Velho"},{value:"America/Puerto_Rico",name:"Puerto Rico"},{value:"America/Rainy_River",name:"Rainy River"},{value:"America/Rankin_Inlet",name:"Rankin Inlet"},{value:"America/Recife",name:"Recife"},{value:"America/Regina",name:"Regina"},{value:"America/Resolute",name:"Resolute"},{value:"America/Rio_Branco",name:"Rio Branco"},{value:"America/Rosario",name:"Rosario"},{value:"America/Santa_Isabel",name:"Santa Isabel"},{value:"America/Santarem",name:"Santarem"},{value:"America/Santiago",name:"Santiago"},{value:"America/Santo_Domingo",name:"Santo Domingo"},{value:"America/Sao_Paulo",name:"Sao Paulo"},{value:"America/Scoresbysund",name:"Scoresbysund"},{value:"America/Shiprock",name:"Shiprock"},{value:"America/St_Barthelemy",name:"St Barthelemy"},{value:"America/St_Johns",name:"St Johns"},{value:"America/St_Kitts",name:"St Kitts"},{value:"America/St_Lucia",name:"St Lucia"},{value:"America/St_Thomas",name:"St Thomas"},{value:"America/St_Vincent",name:"St Vincent"},{value:"America/Swift_Current",name:"Swift Current"},{value:"America/Tegucigalpa",name:"Tegucigalpa"},{value:"America/Thule",name:"Thule"},{value:"America/Thunder_Bay",name:"Thunder Bay"},{value:"America/Tijuana",name:"Tijuana"},{value:"America/Toronto",name:"Toronto"},{value:"America/Tortola",name:"Tortola"},{value:"America/Vancouver",name:"Vancouver"},{value:"America/Virgin",name:"Virgin"},{value:"America/Whitehorse",name:"Whitehorse"},{value:"America/Winnipeg",name:"Winnipeg"},{value:"America/Yakutat",name:"Yakutat"},{value:"America/Yellowknife",name:"Yellowknife"}]},{group:"Europe",zones:[{value:"Europe/Amsterdam",name:"Amsterdam"},{value:"Europe/Andorra",name:"Andorra"},{value:"Europe/Athens",name:"Athens"},{value:"Europe/Belfast",name:"Belfast"},{value:"Europe/Belgrade",name:"Belgrade"},{value:"Europe/Berlin",name:"Berlin"},{value:"Europe/Bratislava",name:"Bratislava"},{value:"Europe/Brussels",name:"Brussels"},{value:"Europe/Bucharest",name:"Bucharest"},{value:"Europe/Budapest",name:"Budapest"},{value:"Europe/Chisinau",name:"Chisinau"},{value:"Europe/Copenhagen",name:"Copenhagen"},{value:"Europe/Dublin",name:"Dublin"},{value:"Europe/Gibraltar",name:"Gibraltar"},{value:"Europe/Guernsey",name:"Guernsey"},{value:"Europe/Helsinki",name:"Helsinki"},{value:"Europe/Isle_of_Man",name:"Isle of Man"},{value:"Europe/Istanbul",name:"Istanbul"},{value:"Europe/Jersey",name:"Jersey"},{value:"Europe/Kaliningrad",name:"Kaliningrad"},{value:"Europe/Kiev",name:"Kiev"},{value:"Europe/Lisbon",name:"Lisbon"},{value:"Europe/Ljubljana",name:"Ljubljana"},{value:"Europe/London",name:"London"},{value:"Europe/Luxembourg",name:"Luxembourg"},{value:"Europe/Madrid",name:"Madrid"},{value:"Europe/Malta",name:"Malta"},{value:"Europe/Mariehamn",name:"Mariehamn"},{value:"Europe/Minsk",name:"Minsk"},{value:"Europe/Monaco",name:"Monaco"},{value:"Europe/Moscow",name:"Moscow"},{value:"Europe/Nicosia",name:"Nicosia"},{value:"Europe/Oslo",name:"Oslo"},{value:"Europe/Paris",name:"Paris"},{value:"Europe/Podgorica",name:"Podgorica"},{value:"Europe/Prague",name:"Prague"},{value:"Europe/Riga",name:"Riga"},{value:"Europe/Rome",name:"Rome"},{value:"Europe/Samara",name:"Samara"},{value:"Europe/San_Marino",name:"San Marino"},{value:"Europe/Sarajevo",name:"Sarajevo"},{value:"Europe/Simferopol",name:"Simferopol"},{value:"Europe/Skopje",name:"Skopje"},{value:"Europe/Sofia",name:"Sofia"},{value:"Europe/Stockholm",name:"Stockholm"},{value:"Europe/Tallinn",name:"Tallinn"},{value:"Europe/Tirane",name:"Tirane"},{value:"Europe/Tiraspol",name:"Tiraspol"},{value:"Europe/Uzhgorod",name:"Uzhgorod"},{value:"Europe/Vaduz",name:"Vaduz"},{value:"Europe/Vatican",name:"Vatican"},{value:"Europe/Vienna",name:"Vienna"},{value:"Europe/Vilnius",name:"Vilnius"},{value:"Europe/Volgograd",name:"Volgograd"},{value:"Europe/Warsaw",name:"Warsaw"},{value:"Europe/Zagreb",name:"Zagreb"},{value:"Europe/Zaporozhye",name:"Zaporozhye"},{value:"Europe/Zurich",name:"Zurich"}]},{group:"Asia",zones:[{value:"Asia/Aden",name:"Aden"},{value:"Asia/Almaty",name:"Almaty"},{value:"Asia/Amman",name:"Amman"},{value:"Asia/Anadyr",name:"Anadyr"},{value:"Asia/Aqtau",name:"Aqtau"},{value:"Asia/Aqtobe",name:"Aqtobe"},{value:"Asia/Ashgabat",name:"Ashgabat"},{value:"Asia/Ashkhabad",name:"Ashkhabad"},{value:"Asia/Baghdad",name:"Baghdad"},{value:"Asia/Bahrain",name:"Bahrain"},{value:"Asia/Baku",name:"Baku"},{value:"Asia/Bangkok",name:"Bangkok"},{value:"Asia/Beirut",name:"Beirut"},{value:"Asia/Bishkek",name:"Bishkek"},{value:"Asia/Brunei",name:"Brunei"},{value:"Asia/Calcutta",name:"Calcutta"},{value:"Asia/Choibalsan",name:"Choibalsan"},{value:"Asia/Chongqing",name:"Chongqing"},{value:"Asia/Chungking",name:"Chungking"},{value:"Asia/Colombo",name:"Colombo"},{value:"Asia/Dacca",name:"Dacca"},{value:"Asia/Damascus",name:"Damascus"},{value:"Asia/Dhaka",name:"Dhaka"},{value:"Asia/Dili",name:"Dili"},{value:"Asia/Dubai",name:"Dubai"},{value:"Asia/Dushanbe",name:"Dushanbe"},{value:"Asia/Gaza",name:"Gaza"},{value:"Asia/Harbin",name:"Harbin"},{value:"Asia/Ho_Chi_Minh",name:"Ho Chi Minh"},{value:"Asia/Hong_Kong",name:"Hong Kong"},{value:"Asia/Hovd",name:"Hovd"},{value:"Asia/Irkutsk",name:"Irkutsk"},{value:"Asia/Istanbul",name:"Istanbul"},{value:"Asia/Jakarta",name:"Jakarta"},{value:"Asia/Jayapura",name:"Jayapura"},{value:"Asia/Jerusalem",name:"Jerusalem"},{value:"Asia/Kabul",name:"Kabul"},{value:"Asia/Kamchatka",name:"Kamchatka"},{value:"Asia/Karachi",name:"Karachi"},{value:"Asia/Kashgar",name:"Kashgar"},{value:"Asia/Kathmandu",name:"Kathmandu"},{value:"Asia/Katmandu",name:"Katmandu"},{value:"Asia/Kolkata",name:"Kolkata"},{value:"Asia/Krasnoyarsk",name:"Krasnoyarsk"},{value:"Asia/Kuala_Lumpur",name:"Kuala Lumpur"},{value:"Asia/Kuching",name:"Kuching"},{value:"Asia/Kuwait",name:"Kuwait"},{value:"Asia/Macao",name:"Macao"},{value:"Asia/Macau",name:"Macau"},{value:"Asia/Magadan",name:"Magadan"},{value:"Asia/Makassar",name:"Makassar"},{value:"Asia/Manila",name:"Manila"},{value:"Asia/Muscat",name:"Muscat"},{value:"Asia/Nicosia",name:"Nicosia"},{value:"Asia/Novokuznetsk",name:"Novokuznetsk"},{value:"Asia/Novosibirsk",name:"Novosibirsk"},{value:"Asia/Omsk",name:"Omsk"},{value:"Asia/Oral",name:"Oral"},{value:"Asia/Phnom_Penh",name:"Phnom Penh"},{value:"Asia/Pontianak",name:"Pontianak"},{value:"Asia/Pyongyang",name:"Pyongyang"},{value:"Asia/Qatar",name:"Qatar"},{value:"Asia/Qyzylorda",name:"Qyzylorda"},{value:"Asia/Rangoon",name:"Rangoon"},{value:"Asia/Riyadh",name:"Riyadh"},{value:"Asia/Saigon",name:"Saigon"},{value:"Asia/Sakhalin",name:"Sakhalin"},{value:"Asia/Samarkand",name:"Samarkand"},{value:"Asia/Seoul",name:"Seoul"},{value:"Asia/Shanghai",name:"Shanghai"},{value:"Asia/Singapore",name:"Singapore"},{value:"Asia/Taipei",name:"Taipei"},{value:"Asia/Tashkent",name:"Tashkent"},{value:"Asia/Tbilisi",name:"Tbilisi"},{value:"Asia/Tehran",name:"Tehran"},{value:"Asia/Tel_Aviv",name:"Tel Aviv"},{value:"Asia/Thimbu",name:"Thimbu"},{value:"Asia/Thimphu",name:"Thimphu"},{value:"Asia/Tokyo",name:"Tokyo"},{value:"Asia/Ujung_Pandang",name:"Ujung Pandang"},{value:"Asia/Ulaanbaatar",name:"Ulaanbaatar"},{value:"Asia/Ulan_Bator",name:"Ulan Bator"},{value:"Asia/Urumqi",name:"Urumqi"},{value:"Asia/Vientiane",name:"Vientiane"},{value:"Asia/Vladivostok",name:"Vladivostok"},{value:"Asia/Yakutsk",name:"Yakutsk"},{value:"Asia/Yekaterinburg",name:"Yekaterinburg"},{value:"Asia/Yerevan",name:"Yerevan"}]},{group:"Africa",zones:[{value:"Africa/Abidjan",name:"Abidjan"},{value:"Africa/Accra",name:"Accra"},{value:"Africa/Addis_Ababa",name:"Addis Ababa"},{value:"Africa/Algiers",name:"Algiers"},{value:"Africa/Asmara",name:"Asmara"},{value:"Africa/Asmera",name:"Asmera"},{value:"Africa/Bamako",name:"Bamako"},{value:"Africa/Bangui",name:"Bangui"},{value:"Africa/Banjul",name:"Banjul"},{value:"Africa/Bissau",name:"Bissau"},{value:"Africa/Blantyre",name:"Blantyre"},{value:"Africa/Brazzaville",name:"Brazzaville"},{value:"Africa/Bujumbura",name:"Bujumbura"},{value:"Africa/Cairo",name:"Cairo"},{value:"Africa/Casablanca",name:"Casablanca"},{value:"Africa/Ceuta",name:"Ceuta"},{value:"Africa/Conakry",name:"Conakry"},{value:"Africa/Dakar",name:"Dakar"},{value:"Africa/Dar_es_Salaam",name:"Dar es Salaam"},{value:"Africa/Djibouti",name:"Djibouti"},{value:"Africa/Douala",name:"Douala"},{value:"Africa/El_Aaiun",name:"El Aaiun"},{value:"Africa/Freetown",name:"Freetown"},{value:"Africa/Gaborone",name:"Gaborone"},{value:"Africa/Harare",name:"Harare"},{value:"Africa/Johannesburg",name:"Johannesburg"},{value:"Africa/Kampala",name:"Kampala"},{value:"Africa/Khartoum",name:"Khartoum"},{value:"Africa/Kigali",name:"Kigali"},{value:"Africa/Kinshasa",name:"Kinshasa"},{value:"Africa/Lagos",name:"Lagos"},{value:"Africa/Libreville",name:"Libreville"},{value:"Africa/Lome",name:"Lome"},{value:"Africa/Luanda",name:"Luanda"},{value:"Africa/Lubumbashi",name:"Lubumbashi"},{value:"Africa/Lusaka",name:"Lusaka"},{value:"Africa/Malabo",name:"Malabo"},{value:"Africa/Maputo",name:"Maputo"},{value:"Africa/Maseru",name:"Maseru"},{value:"Africa/Mbabane",name:"Mbabane"},{value:"Africa/Mogadishu",name:"Mogadishu"},{value:"Africa/Monrovia",name:"Monrovia"},{value:"Africa/Nairobi",name:"Nairobi"},{value:"Africa/Ndjamena",name:"Ndjamena"},{value:"Africa/Niamey",name:"Niamey"},{value:"Africa/Nouakchott",name:"Nouakchott"},{value:"Africa/Ouagadougou",name:"Ouagadougou"},{value:"Africa/Porto-Novo",name:"Porto-Novo"},{value:"Africa/Sao_Tome",name:"Sao Tome"},{value:"Africa/Timbuktu",name:"Timbuktu"},{value:"Africa/Tripoli",name:"Tripoli"},{value:"Africa/Tunis",name:"Tunis"},{value:"Africa/Windhoek",name:"Windhoek"}]},{group:"Australia",zones:[{value:"Australia/ACT",name:"ACT"},{value:"Australia/Adelaide",name:"Adelaide"},{value:"Australia/Brisbane",name:"Brisbane"},{value:"Australia/Broken_Hill",name:"Broken Hill"},{value:"Australia/Canberra",name:"Canberra"},{value:"Australia/Currie",name:"Currie"},{value:"Australia/Darwin",name:"Darwin"},{value:"Australia/Eucla",name:"Eucla"},{value:"Australia/Hobart",name:"Hobart"},{value:"Australia/LHI",name:"LHI"},{value:"Australia/Lindeman",name:"Lindeman"},{value:"Australia/Lord_Howe",name:"Lord Howe"},{value:"Australia/Melbourne",name:"Melbourne"},{value:"Australia/North",name:"North"},{value:"Australia/NSW",name:"NSW"},{value:"Australia/Perth",name:"Perth"},{value:"Australia/Queensland",name:"Queensland"},{value:"Australia/South",name:"South"},{value:"Australia/Sydney",name:"Sydney"},{value:"Australia/Tasmania",name:"Tasmania"},{value:"Australia/Victoria",name:"Victoria"},{value:"Australia/West",name:"West"},{value:"Australia/Yancowinna",name:"Yancowinna"}]},{group:"Indian",zones:[{value:"Indian/Antananarivo",name:"Antananarivo"},{value:"Indian/Chagos",name:"Chagos"},{value:"Indian/Christmas",name:"Christmas"},{value:"Indian/Cocos",name:"Cocos"},{value:"Indian/Comoro",name:"Comoro"},{value:"Indian/Kerguelen",name:"Kerguelen"},{value:"Indian/Mahe",name:"Mahe"},{value:"Indian/Maldives",name:"Maldives"},{value:"Indian/Mauritius",name:"Mauritius"},{value:"Indian/Mayotte",name:"Mayotte"},{value:"Indian/Reunion",name:"Reunion"}]},{group:"Atlantic",zones:[{value:"Atlantic/Azores",name:"Azores"},{value:"Atlantic/Bermuda",name:"Bermuda"},{value:"Atlantic/Canary",name:"Canary"},{value:"Atlantic/Cape_Verde",name:"Cape Verde"},{value:"Atlantic/Faeroe",name:"Faeroe"},{value:"Atlantic/Faroe",name:"Faroe"},{value:"Atlantic/Jan_Mayen",name:"Jan Mayen"},{value:"Atlantic/Madeira",name:"Madeira"},{value:"Atlantic/Reykjavik",name:"Reykjavik"},{value:"Atlantic/South_Georgia",name:"South Georgia"},{value:"Atlantic/Stanley",name:"Stanley"},{value:"Atlantic/St_Helena",name:"St Helena"}]},{group:"Pacific",zones:[{value:"Pacific/Apia",name:"Apia"},{value:"Pacific/Auckland",name:"Auckland"},{value:"Pacific/Chatham",name:"Chatham"},{value:"Pacific/Easter",name:"Easter"},{value:"Pacific/Efate",name:"Efate"},{value:"Pacific/Enderbury",name:"Enderbury"},{value:"Pacific/Fakaofo",name:"Fakaofo"},{value:"Pacific/Fiji",name:"Fiji"},{value:"Pacific/Funafuti",name:"Funafuti"},{value:"Pacific/Galapagos",name:"Galapagos"},{value:"Pacific/Gambier",name:"Gambier"},{value:"Pacific/Guadalcanal",name:"Guadalcanal"},{value:"Pacific/Guam",name:"Guam"},{value:"Pacific/Honolulu",name:"Honolulu"},{value:"Pacific/Johnston",name:"Johnston"},{value:"Pacific/Kiritimati",name:"Kiritimati"},{value:"Pacific/Kosrae",name:"Kosrae"},{value:"Pacific/Kwajalein",name:"Kwajalein"},{value:"Pacific/Majuro",name:"Majuro"},{value:"Pacific/Marquesas",name:"Marquesas"},{value:"Pacific/Midway",name:"Midway"},{value:"Pacific/Nauru",name:"Nauru"},{value:"Pacific/Niue",name:"Niue"},{value:"Pacific/Norfolk",name:"Norfolk"},{value:"Pacific/Noumea",name:"Noumea"},{value:"Pacific/Pago_Pago",name:"Pago Pago"},{value:"Pacific/Palau",name:"Palau"},{value:"Pacific/Pitcairn",name:"Pitcairn"},{value:"Pacific/Ponape",name:"Ponape"},{value:"Pacific/Port_Moresby",name:"Port Moresby"},{value:"Pacific/Rarotonga",name:"Rarotonga"},{value:"Pacific/Saipan",name:"Saipan"},{value:"Pacific/Samoa",name:"Samoa"},{value:"Pacific/Tahiti",name:"Tahiti"},{value:"Pacific/Tarawa",name:"Tarawa"},{value:"Pacific/Tongatapu",name:"Tongatapu"},{value:"Pacific/Truk",name:"Truk"},{value:"Pacific/Wake",name:"Wake"},{value:"Pacific/Wallis",name:"Wallis"},{value:"Pacific/Yap",name:"Yap"}]},{group:"Antarctica",zones:[{value:"Antarctica/Casey",name:"Casey"},{value:"Antarctica/Davis",name:"Davis"},{value:"Antarctica/DumontDUrville",name:"DumontDUrville"},{value:"Antarctica/Macquarie",name:"Macquarie"},{value:"Antarctica/Mawson",name:"Mawson"},{value:"Antarctica/McMurdo",name:"McMurdo"},{value:"Antarctica/Palmer",name:"Palmer"},{value:"Antarctica/Rothera",name:"Rothera"},{value:"Antarctica/South_Pole",name:"South Pole"},{value:"Antarctica/Syowa",name:"Syowa"},{value:"Antarctica/Vostok",name:"Vostok"}]},{group:"Arctic",zones:[{value:"Arctic/Longyearbyen",name:"Longyearbyen"}]},{group:"UTC",zones:[{value:"UTC",name:"UTC"}]},{group:"Manual Offsets",zones:[{value:"UTC-12",name:"UTC-12"},{value:"UTC-11",name:"UTC-11"},{value:"UTC-10",name:"UTC-10"},{value:"UTC-9",name:"UTC-9"},{value:"UTC-8",name:"UTC-8"},{value:"UTC-7",name:"UTC-7"},{value:"UTC-6",name:"UTC-6"},{value:"UTC-5",name:"UTC-5"},{value:"UTC-4",name:"UTC-4"},{value:"UTC-3",name:"UTC-3"},{value:"UTC-2",name:"UTC-2"},{value:"UTC-1",name:"UTC-1"},{value:"UTC+0",name:"UTC+0"},{value:"UTC+1",name:"UTC+1"},{value:"UTC+2",name:"UTC+2"},{value:"UTC+3",name:"UTC+3"},{value:"UTC+4",name:"UTC+4"},{value:"UTC+5",name:"UTC+5"},{value:"UTC+6",name:"UTC+6"},{value:"UTC+7",name:"UTC+7"},{value:"UTC+8",name:"UTC+8"},{value:"UTC+9",name:"UTC+9"},{value:"UTC+10",name:"UTC+10"},{value:"UTC+11",name:"UTC+11"},{value:"UTC+12",name:"UTC+12"},{value:"UTC+13",name:"UTC+13"},{value:"UTC+14",name:"UTC+14"}]}],t=angular.module("bookingApp");t.constant("AppSettings",{Settings:{BaseUrl:"https://londonvipchauffeur.com",BookingUrl:"/BookingApi/SaveBooking",ComputePriceUrl:"/BookingApi/GetTripPrices",ServerDateTimeFormat:"DD-MM-YYYY HH:mm A",ServerDateFormat:"DD-MM-YYYY"},StaticData:{Timezones:n,Cultures:n},Steps:{BookingForm:"BookingForm",CarSelection:"CarSelection",PassengerInfo:"PassengerInfo",Payment:"Payment"}})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.booking={};u.$onInit=function(){r.getBookingDrivers(u.bookingId).then(function(n){u.model=n.data},function(){i.showNotification("error","Error when getting available drivers for this booking.")});r.getBookingDetails(u.bookingId).then(function(n){u.booking=n.data},function(){i.showNotification("error","Error when reading booking details.")})};u.selectedDriverChanged=function(){if(console.log(u.selectedDriver),u.selectedDriver&&(u.model.driverGuid=u.selectedDriver.guid),u.model.companyCars&&(u.selectedMainCar=u.model.companyCars[0]),u.selectedDriver&&u.selectedDriver.mainCarId&&u.model.companyCars){var n=u.model.companyCars.find(function(n){return n.id===u.selectedDriver.mainCarId});n?(u.selectedMainCar=n,u.model.carId=n.id):(u.model.carId=u.model.companyCars[0].id,u.selectedMainCar=u.model.companyCars[0])}};u.selectedCarChanged=function(){u.selectedMainCar&&(u.model.carId=u.selectedMainCar.id)};u.cancel=function(){u.modalInstance.dismiss("cancel")};u.ok=function(){(u.sent=!0,!u.sending&&n.assignDriverForm.$valid)&&(u.sending=!0,n.assignDriverForm.$valid&&r.assignDriverToBooking(u.model).then(function(n){var r,t;u.sending=!1;u.modalInstance.close();n.data.success?(t="Driver assigned successfully",n.data.result.emailSentToClient&&(t+="<br> - email sent to client"),n.data.result.emailSentToDriver&&(t+="<br> - email sent to driver"),n.data.result.smsSentToDriver&&(t+="<br> - SMS sent to driver"),i.showNotification("success",t)):(r=n.data.errors[0],i.showNotification("error",r))},function(){i.showNotification("error","Could not assign driver. Error occurred.");u.sending=!1}))}}var n=angular.module("bookingApp");n.component("assignDriver",{controller:["$scope","$http","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{bookingId:"<",modalInstance:"<"},template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Assign driver<\/h4><\/div><div class="modal-body"><div><b>Booking Id:<\/b> {{vm.bookingId}}<\/div><div><b>From:<\/b> {{vm.booking.fromAddress}}<\/div><div><b>To:<\/b> {{vm.booking.toAddress}}<\/div><div><b>Duration:<\/b> {{vm.booking.durationInMinutes}} minutes<\/div><div><b>Distance:<\/b> {{vm.booking.distanceInMiles}} miles<\/div><div><b>Price:<\/b> {{vm.booking.price}}<b>&pound;<\/b><\/div><hr><form name="assignDriverForm" novalidate><div class="form-group"><label for="sel1">Select driver:<\/label><select class="form-control" ng-options="item as item.displayName group by item.carClass for item in vm.model.drivers track by item.id" name="selectedDriver" required ng-change="vm.selectedDriverChanged()" ng-model="vm.selectedDriver"><\/select><p style="color:red; font-weight: bold;" ng-show="(assignDriverForm.selectedDriver.$error.required && vm.sent) || (assignDriverForm.selectedDriver.$touched && assignDriverForm.selectedDriver.$error.required)">Please select driver.<\/p><\/div><div class="form-group" ng-show="vm.selectedDriver.isHired && vm.model.companyCars.length > 0"><label>Booking car:<\/label><select class="form-control" ng-options="item as item.name for item in vm.model.companyCars" ng-change="vm.selectedCarChanged()" name="selectedMainCarId" ng-model="vm.selectedMainCar"><\/select><\/div><div class="form-group"><label for="payAmmountToDriver">Pay driver <span>{{vm.selectedDriver.currency}}<\/span><\/label> <input class="form-control" id="payAmmountToDriver" type="number" ng-model="vm.model.payToDriver" name="payAmmountToDriver" placeholder="Amount to pay"><p style="color:red; font-weight: bold;" ng-show="(assignDriverForm.payAmmountToDriver.$error.required && vm.sent) || (assignDriverForm.payAmmountToDriver.$touched && assignDriverForm.payAmmountToDriver.$error.required)">Please set amount to pay.<\/p><\/div><div ng-class="{\'text-danger\': vm.booking.price - vm.payToDriver < 0}"><p>Remaining: {{vm.booking.price - vm.model.payToDriver - vm.payToPlatform | number:2}}<\/p><\/div><\/form><br><button type="button" class="btn btn-default" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-primary" ng-click="vm.ok()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Save changes<\/button><\/div>'})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.booking={};u.$onInit=function(){r.getBookingDetails(u.bookingId).then(function(n){u.booking=n.data;u.sendEmailToClient=n.data.price==0;r.getBookingSugestedPrice(u.bookingId).then(function(n){u.booking.sugestedPrice=n.data.price;console.log(n.data)})},function(){i.showNotification("error","Error when reading booking details.")})};u.cancel=function(){u.modalInstance.dismiss("cancel")};u.ok=function(){(u.sent=!0,!u.sending&&n.quickQuoteForm.$valid)&&(u.sending=!0,n.quickQuoteForm.$valid&&r.setBookingPrice(u.bookingId,u.bookingPrice,u.sendEmailToClient).then(function(n){var r,t;u.sending=!1;u.modalInstance.close();n.data.success?(t="Driver assigned successfully",n.data.result.emailSentToClient&&(t+="<br> - email sent to client"),n.data.result.emailSentToDriver&&(t+="<br> - email sent to driver"),n.data.result.smsSentToDriver&&(t+="<br> - SMS sent to driver"),i.showNotification("success",t)):(r=n.data.errors[0],i.showNotification("error",r))},function(){i.showNotification("error","Could not assign driver. Error occurred.");u.sending=!1}))}}var n=angular.module("bookingApp");n.component("bookingQuickQuote",{controller:["$scope","$http","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{bookingId:"<",modalInstance:"<"},template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Quick quote booking<\/h4><\/div><div class="modal-body"><div><b>Booking Id:<\/b> {{vm.bookingId}}<\/div><div><b>From:<\/b> {{vm.booking.fromAddress}}<\/div><div><b>To:<\/b> {{vm.booking.toAddress}}<\/div><div><b>Duration:<\/b> {{vm.booking.durationInMinutes}} minutes<\/div><div><b>Distance:<\/b> {{vm.booking.distanceInMiles}} miles<\/div><br><div><b>Current Price:<\/b> {{vm.booking.price}}<b>&pound;<\/b><\/div><hr><form name="quickQuoteForm" novalidate><div ng-class="text-danger"><p><b>Suggested price: {{vm.booking.sugestedPrice | number:2}} GBP<\/b> (based on website pricing)<\/p><\/div><div class="form-group"><label for="bookingPrice">Booking price:<\/label> <input id="bookingPrice" class="form-control" name="bookingPrice" required ng-model="vm.bookingPrice"><p style="color: red; font-weight: bold;" ng-show="(quickQuoteForm.bookingPrice.$error.required && vm.sent) || (quickQuoteForm.bookingPrice.$touched && quickQuoteForm.bookingPrice.$error.required)">Please select booking price.<\/p><\/div><div class="form-group"><div class="i-checks"><label class="form-check-label"><input class="form-check-input" type="checkbox" ng-model="vm.sendEmailToClient"> Send confirmation email to client<\/label><\/div><\/div><div ng-class="{\'text-danger\': vm.bookingPrice - vm.booking.sugestedPrice < 0}"><p>Difference: {{vm.bookingPrice - vm.booking.sugestedPrice | number:2}}<\/p><\/div><\/form><br><button type="button" class="btn btn-default" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-primary" ng-click="vm.ok()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Save changes<\/button><\/div>'})}(),function(){"use strict";function t(){var n=this;n.booking={};n.$onInit=function(){console.log(n)}}var n=angular.module("bookingApp");n.component("adminEditBooking",{controller:["htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",modalInstance:"<"},template:'<div class="edit-booking-details"><create-booking-form duplicate-booking="vm.duplicateBooking" booking-id="vm.bookingId" is-full-page="true" action-button-text="\'Save Booking\'"><\/create-booking-form><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){function e(n,t){$rootScope.$broadcast("bookingFormChanged",{isValid:n,wasChangedByUser:t,bookingInfo:f.bookingInfo})}var f=this;f.$onInit=function(){f.actionButtonText||(f.actionButtonText="Check price");f.isFullPage||(f.isFullPage=!0);var n=f.bookingId?f.bookingId:"website";f.getBookingFromServer(n)};f.submitted=!1;f.mapDetails={};f.bookingInfo={guid:null,bookingType:1,selectedDuration:"Booking Duration"};f.checkPrices=function(){f.submitted=!0;var n=f.isValid();if(n){e(!1,!0);return}f.bookingInfo.lastCheckPiceTimestamp=moment();e(!0,!0);console.log(f.bookingInfo)};f.updateBookingPrice=function(n){n.pickupDateTime&&r.getBookingPrice(n).then(function(n){n.data.success&&(f.priceInfo=n.data);console.log(n.data)})};f.getBookingFromServer=function(n){r.getBookingDetails(n).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);f.bookingInfo=n.data;f.duplicateBooking&&(f.bookingInfo.guid=null);f.bookingInfo.selectedCarType={id:f.bookingInfo.carTypeId,name:f.bookingInfo.carClass};f.bookingInfo.selectedDuration=n.data.durationInHours?n.data.durationInHours.toString():null;f.bookingInfo.pickupDateTimeMoment&&(f.pickupDate=moment(f.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.pickupDateTime=f.pickupDate,f.bookingInfo.pickupDateTime=f.pickupDate,f.selectedPickupMinute=f.pickupDate.format("mm"),f.selectedPickupHour=f.pickupDate.format("HH"),f.bookingInfo.returnPickupDateTimeMoment&&(f.returnPickupDate=moment(f.bookingInfo.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.selectedReturnPickupMinute=f.returnPickupDate.format("mm"),f.selectedReturnPickupHour=f.returnPickupDate.format("HH")))})};f.hasFirstNameError=function(){return f.submitted&&f.passengerForm.firstName.$invalid||f.passengerForm.firstName.$invalid&&!f.passengerForm.firstName.$pristine};f.canChangeBookingType=function(){return!f.bookingInfo.guid};f.bookingInfoChanged=function(n){console.log(n);f.mapDetails={from:n.from,to:n.to,bookingType:n.bookingType};f.updateBookingPrice(n)};f.mapChanged=function(n){console.log(n);f.bookingInfo.distanceInMiles=n.distanceInMiles;f.bookingInfo.durationInMinutes=n.timeInMinutes};f.hasLastNameError=function(){return f.submitted&&f.passengerForm.lastName.$invalid||f.passengerForm.lastName.$invalid&&!f.passengerForm.lastName.$pristine};f.hasEmailRequiredError=function(){return f.submitted&&f.passengerForm.email.$error.required||f.passengerForm.email.$error.required&&!f.passengerForm.email.$pristine};f.hasEmailFormatError=function(){return f.submitted&&f.passengerForm.email.$error.email||f.passengerForm.email.$error.email&&!f.passengerForm.email.$pristine};f.hasPhoneError=function(){return f.submitted&&f.passengerForm.telephone.$invalid||f.passengerForm.telephone.$invalid&&!f.passengerForm.telephone.$pristine};f.updateBooking=function(){f.submitted=!0;n(function(){var o=f.bookingInfo.validate()&&f.passengerForm.$valid,i,e;o&&(i=f.bookingInfo.guid==null,e=i?"Save booking?":"Update booking?",u.showConfirmation(e,"").then(function(){r.updateBooking(f.bookingInfo).then(function(i){if(console.log(i),i.data.success)u.showNotification("success","Booking saved."),n(function(){i.data.returnUrl&&(t.location.href=i.data.returnUrl)},3500);else{var r=i.data.errors[0];u.showNotification("error",r)}})}))})}}var n=angular.module("bookingApp");n.component("bookingForm",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<"},template:'<booking-info booking-info="vm.bookingInfo" booking-info-changed="vm.bookingInfoChanged(bookingInfo)" show-validation-errors="vm.submitted" booking-type="vm.bookingInfo.bookingType" is-full-page="true"><\/booking-info><hr><div class="booking-form margin-bottom-30" name="bookingForm"><div ng-show="vm.bookingInfo.showPriceEditor"><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="m-b"><label class="control-label">Normal price<\/label><div class="input-group m-b"><span class="input-group-addon">GBP<\/span> <input type="text" class="form-control" disabled ng-model="vm.priceInfo.price.price"><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="row"><div class="col-xs-6"><div class="m-b"><label class="control-label">Price<\/label><div class="input-group"><span class="input-group-addon">GBP<\/span> <input type="text" class="form-control" ng-model="vm.bookingInfo.price"><\/div><\/div><\/div><div class="col-xs-6"><div class="m-b"><label class="control-label">Platform<\/label><div class="input-group"><span class="input-group-addon">GBP<\/span> <input type="text" class="form-control" ng-model="vm.bookingInfo.platformPrice"><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="col-xs-6"><select class="form-control" ng-options="item as item for item in vm.bookingInfo.paymnetStatusesList" name="paymentStatus" required ng-model="vm.bookingInfo.paymentStatusString"><\/select><\/div><div class="col-xs-6"><select class="form-control" ng-options="item as item.name for item in vm.bookingInfo.clientsList track by item.id" name="selectedClient" required ng-model="vm.bookingInfo.selectedClient"><\/select><\/div><\/div><hr><\/div><div class="row"><div class="col-md-12"><form class="passengerForm nomargin-bottom" name="vm.passengerForm" novalidate><div class="row nomargin-bottom"><div class="col-xs-12"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input type="radio" id="passengerDetailsMrSalutation" name="passengerDetailsSalutation" value="Mr." ng-data-value="Mr." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMrSalutation">Mr.<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input type="radio" id="passengerDetailsMsSalutation" name="passengerDetailsSalutation" value="Ms." ng-data-value="Ms." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMsSalutation">Ms.<\/label><\/div><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasFirstNameError()}"><input type="text" name="firstName" class="form-control original-style nomargin-bottom" ng-model="vm.bookingInfo.passengerDetails.firstName" required placeholder="First name"><div class="help-block ng-hide" ng-show="vm.hasFirstNameError()">First name is required.<\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasLastNameError()}"><input type="text" name="lastName" class="form-control nomargin-bottom original-style" ng-model="vm.bookingInfo.passengerDetails.lastName" required placeholder="Last Name"><div class="help-block ng-hide" ng-show="vm.hasLastNameError()">Last name is required.<\/div><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasEmailRequiredError() || vm.hasEmailFormatError()}"><input type="email" class="form-control original-style" placeholder="E-Mail" name="email" required ng-model="vm.bookingInfo.passengerDetails.email"><div class="help-block ng-hide" ng-show="vm.hasEmailRequiredError()">Email is required.<\/div><div class="help-block ng-hide" ng-show="vm.hasEmailFormatError()">Email has invalid format.<\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasPhoneError()}"><input type="tel" class="form-control original-style" placeholder="Telephone" name="telephone" required ng-model="vm.bookingInfo.passengerDetails.phone"><div class="help-block ng-hide" ng-show="vm.hasPhoneError()">Phone number is required.<\/div><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header">Pickup info<\/h5><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.roomNumber" name="roomNumber" placeholder="Room number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.flightNumber" name="flightNumber" placeholder="Flight number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.comingFrom" name="arivingFrom" placeholder="Ariving from"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Additional Requirements<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.additionalRequirements" name="additionalRequirements" placeholder="Additional Requirements"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom" ng-hide="vm.bookingInfo.hideAdvancedBookingControls"><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Persons<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="adultsNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.adultsNumber" name="adultsNumber" placeholder="Adults number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="childrenNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.childrenNumber" name="childrenNumber" placeholder="Children number"><\/div><\/div><\/div><\/div><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Luggage<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="largeLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.largeLuggageNumber" name="largeLuggageNumber" placeholder="Large luggage number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="mediumLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.mediumLuggageNumber" name="mediumLuggageNumber" placeholder="Medium luggage number"><\/div><\/div><\/div><\/div><\/div><div class="row nomargin-bottom"><\/div><\/form><\/div><\/div><br><div class="row get-quote-button-container text-center"><button type="submit" ng-click="vm.updateBooking()" class="get-quote-button btn btn-primary button-action red-button">{{vm.actionButtonText}}<\/button><\/div><\/div><booking-map booking-info="vm.mapDetails" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map>'})}(),function(){"use strict";function t(n,t,i,r,u,f){function o(n,t){console.log("booking changed",e.bookingInfo);$rootScope.$broadcast("bookingFormChanged",{isValid:n,wasChangedByUser:t,bookingInfo:e.bookingInfo})}var e=this;e.loading=!0;e.$onInit=function(){e.actionButtonText||(e.actionButtonText="Check price");e.isFullPage||(e.isFullPage=!0);e.bookingInfo.extras=[];var n=e.bookingId?e.bookingId:"website";e.getBookingFromServer(n)};e.submitted=!1;e.mapDetails={};e.bookingInfo={guid:null,bookingType:1};e.checkPrices=function(){e.submitted=!0;var n=e.isValid();if(n){o(!1,!0);return}e.bookingInfo.lastCheckPiceTimestamp=moment();o(!0,!0);console.log(e.bookingInfo)};e.updateBookingPrice=function(n){n.pickupDateTime&&n.showPriceEditor&&(n.viaPoints&&n.viaPoints.removeIf(function(n){return!n.addressName}),u.getBookingPrice(n).then(function(n){n.data.success?(e.priceInfo=n.data,e.bookingInfo.durationInMinutes=e.priceInfo.timeInMinutes,e.bookingInfo.distanceInMiles=e.priceInfo.distanceInMiles):e.priceInfo=null},function(){e.priceInfo=null}))};e.bookingExtrasChanged=function(){e.updateBookingPrices()};e.updateBookingPrices=function(){var n=e.bookingInfo.hasVat?parseFloat(e.bookingInfo.clientTotalBookingPrice):null,t=e.bookingInfo.hasVat?null:parseFloat(e.bookingInfo.price),i={clientTotalBookingPrice:n,bookingPrice:t,extras:e.bookingInfo.extras,pricesIncludeTax:e.bookingInfo.hasVat,taxPercentage:e.bookingInfo.taxPercentage};u.computeBookingPriceForAdmin(i).then(function(n){var u=JSON.stringify(n.data,null,4),r;if(console.log(u),n.data.success){if(e.bookingInfo.priceWithoutTaxes=n.data.result.bookingPrice,e.bookingInfo.price=n.data.result.bookingPrice,e.bookingInfo.taxesTotalValue=n.data.result.taxesTotalValue,e.bookingInfo.extrasTotalValueWithoutTaxes=n.data.result.extrasTotalValue,e.bookingInfo.clientTotalPrice=n.data.result.clientTotalPrice,n.data.result.extras)for(r=0;r<n.data.result.extras.length;++r){var t=n.data.result.extras[r],f=t.guid,i=e.bookingInfo.extras.find(function(n){return n.guid===f});i?(i.companyTotal=t.companyTotal,i.companyAmount=t.companyAmount,i.taxPercentage=t.taxPercentage,i.numberOfItems=t.numberOfItems):e.bookingInfo.extras.push(t)}e.bookingInfo.extras&&e.bookingInfo.extras.sort(function(n,t){return n.isTaxItem?1:t.isTaxItem?-1:0});console.log(e.bookingInfo.extras)}})};e.getBookingFromServer=function(i){u.getBookingDetails(i).then(function(i){e.bookingInfo=i.data;e.bookingInfo.passengerDetails||(e.bookingInfo.passengerDetails={});u.getAllowedAreas(e.bookingInfo.websiteId).then(function(n){n.data.success&&(e.allowedAreas=n.data.result)});e.duplicateBooking==="duplicate"&&(e.bookingInfo.guid=null,e.bookingInfo.paymentStatusString="Pending",e.bookingInfo.selectedPaymentOption="PayLater");e.bookingInfo.selectedCarType={id:e.bookingInfo.carTypeId,name:e.bookingInfo.carClass};e.bookingInfo.selectedDuration=i.data.durationInHours;e.bookingInfo.requireCardPayment=e.bookingInfo.requireCardPayment?"true":"false";e.bookingInfo.pickupDateTimeMoment&&(e.pickupDate=moment(e.bookingInfo.pickupDateTimeMoment,r.Settings.ServerDateTimeFormat),e.bookingInfo.pickupDateTime=e.pickupDate,e.selectedPickupMinute=e.pickupDate.format("mm"),e.selectedPickupHour=e.pickupDate.format("HH"),e.bookingInfo.returnPickupDateTimeMoment&&(e.returnPickupDate=moment(e.bookingInfo.returnPickupDateTimeMoment,r.Settings.ServerDateTimeFormat),e.bookingInfo.returnPickupDateTime=e.returnPickupDate,e.bookingInfo.returnPickupDateTime=e.returnPickupDate,e.selectedReturnPickupMinute=e.returnPickupDate.format("mm"),e.selectedReturnPickupHour=e.returnPickupDate.format("HH")));e.bookingInfo.extras||(e.bookingInfo.extras=[]);e.loading=!1;n(function(){e.updateBookingPrices()});e.bookingInfo.hasPendingInvoices&&n(function(){f.showError("Past Due Invoices","You have outstanding balance for your account. We kindly ask you to complete payment in order to continue using dispatch software.").then(function(){t.location="/invoice/softwareinvoices/"})},4e3)})};e.hasFirstNameError=function(){return e.submitted&&e.passengerForm.firstName.$invalid||e.passengerForm.firstName.$invalid&&!e.passengerForm.firstName.$pristine};e.recomputePrice=function(){n(function(){e.updateBookingPrice(e.bookingInfo)})};e.suggestPrice=function(){e.updateBookingPrice(e.bookingInfo)};e.fillClientInfo=function(){if(!e.bookingInfo.selectedClient||e.bookingInfo.selectedClient.id<=0){f.showNotification("warning","There is no client selected. Please select client first.");return}if(e.bookingInfo.passengerDetails&&(e.bookingInfo.passengerDetails.firstName||e.bookingInfo.passengerDetails.lastName||e.bookingInfo.passengerDetails.email||e.bookingInfo.passengerDetails.phone)){f.showConfirmation("Overwrite passenger data?","You have already defined passenger data. Are you sure you want to overwrite using client info?").then(function(){e.bookingInfo.passengerDetails.salutation=e.bookingInfo.selectedClient.salutation;e.bookingInfo.passengerDetails.firstName=e.bookingInfo.selectedClient.firstName;e.bookingInfo.passengerDetails.lastName=e.bookingInfo.selectedClient.lastName;e.bookingInfo.passengerDetails.email=e.bookingInfo.selectedClient.email;e.bookingInfo.passengerDetails.phone=e.bookingInfo.selectedClient.phone});return}e.bookingInfo.passengerDetails.salutation=e.bookingInfo.selectedClient.salutation;e.bookingInfo.passengerDetails.firstName=e.bookingInfo.selectedClient.firstName;e.bookingInfo.passengerDetails.lastName=e.bookingInfo.selectedClient.lastName;e.bookingInfo.passengerDetails.email=e.bookingInfo.selectedClient.email;e.bookingInfo.passengerDetails.phone=e.bookingInfo.selectedClient.phone};e.bookingInfoChanged=function(n){n.selectedClient&&(n.selectedClient.currency&&n.selectedClient.currency!==e.bookingInfo.currencyCode&&(e.bookingInfo.currencyCode=n.selectedClient.currency),n.selectedClient.culture&&n.selectedClient.culture!==e.bookingInfo.passengerDetails.culture&&(e.bookingInfo.passengerDetails.culture=n.selectedClient.culture));e.mapDetails={from:n.from,to:n.to,bookingType:n.bookingType}};e.mapChanged=function(n){e.bookingInfo.distanceInMiles=n.distanceInMiles;e.bookingInfo.durationInMinutes=n.timeInMinutes};e.hasLastNameError=function(){return e.submitted&&e.passengerForm.lastName.$invalid||e.passengerForm.lastName.$invalid&&!e.passengerForm.lastName.$pristine};e.hasEmailRequiredError=function(){return e.submitted&&e.passengerForm.email.$error.required||e.passengerForm.email.$error.required&&!e.passengerForm.email.$pristine};e.hasEmailFormatError=function(){return e.submitted&&e.passengerForm.email.$error.multipleEmailValidator||e.passengerForm.email.$error.email&&!e.passengerForm.email.$pristine};e.hasPhoneError=function(){return e.submitted&&e.passengerForm.telephone.$invalid||e.passengerForm.telephone.$invalid&&!e.passengerForm.telephone.$pristine};e.isSaveInProgress=!1;e.updateBooking=function(){e.isSaveInProgress||(e.priceInfo&&(e.bookingInfo.distanceInMiles=e.priceInfo.distanceInMiles,e.bookingInfo.durationInMinutes=e.priceInfo.timeInMinutes),e.submitted=!0,n(function(){var o=e.bookingInfo.validate()&&e.passengerForm.$valid,i,r;if(!o){f.scrollElement(".has-error");return}i=e.bookingInfo.guid==null;r=i?"Save booking?":"Update booking?";f.showConfirmation(r,"").then(function(){e.isSaveInProgress=!0;u.updateBooking(e.bookingInfo).then(function(i){if(i.data.success)if(f.showNotification("success","Booking saved."),e.onSave&&e.cancelButtonText)e.onSave({itemGuid:i.data.guid});else n(function(){i.data.returnUrl&&(t.location.href=i.data.returnUrl)},1500);else{e.isSaveInProgress=!1;var r=i.data.errors[0];f.showNotification("error",r)}},function(){e.isSaveInProgress=!1;f.showNotification("error","An error occurred when saving booking. Please tray again.")})})}))};e.closeDialog=function(){e.onCancel&&e.onCancel()}}var n=angular.module("bookingApp");n.component("createBookingForm",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<",cancelButtonText:"<",onCancel:"&",onSave:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div ng-show="!vm.loading"><create-booking-info booking-info="vm.bookingInfo" booking-info-changed="vm.bookingInfoChanged(bookingInfo)" show-validation-errors="vm.submitted" booking-type="vm.bookingInfo.bookingType" is-full-page="true"><\/create-booking-info><div class="row" ng-show="vm.bookingInfo.linkedBookingCustomerId"><div class="col-sm-12 text-center"><span ng-show="vm.bookingInfo.isReturnBooking">This booking is a return for booking number<\/span> <span ng-show="!vm.bookingInfo.isReturnBooking">This booking has a return booking number<\/span> <span><b>{{vm.bookingInfo.linkedBookingCustomerId}}<\/b> on <b>{{vm.bookingInfo.linkedBookingPickupDateTime}}<\/b><\/span><\/div><\/div><hr><div class="booking-form margin-bottom-30" name="bookingForm"><div ng-show="vm.bookingInfo.showPriceEditor"><div class="row"><div class="col-sm-12 col-md-6"><div class="row"><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label"><span ng-show="vm.bookingInfo.bookingType !== 3">Trip price:<\/span> <span ng-show="vm.bookingInfo.bookingType === 3">One way price<\/span> <span ng-show="vm.bookingInfo.bookingType === 3 && vm.bookingInfo.price >= 0">.This booking total price will be 2 x {{vm.bookingInfo.price}} = {{2 * vm.bookingInfo.price}} GBP)<\/span> <b class="field-validation-error" ng-show="vm.priceInfo.isFullyBooked">FULLY BOOKED!!!<\/b><\/label><div class="pull-right"><button class="btn btn-xs m-l-sm" ng-click="vm.suggestPrice()">Suggest<\/button><\/div><div class="input-group" ng-show="vm.bookingInfo.hasVat"><span class="input-group-addon" style="border: none; padding: 0; min-width: 90px;"><select name="currency" ng-model="vm.bookingInfo.currencyCode" class="form-control"><option value="EUR">EUR<\/option><option value="USD">USD<\/option><option value="CAD">CAD<\/option><option value="CHF">CHF<\/option><option value="PLN">PLN<\/option><option value="GBP">GBP<\/option><option value="AUD">AUD<\/option><option value="NZD">NZD<\/option><option value="SGD">SGD<\/option><option value="THB">THB<\/option><option value="MYR">MYR<\/option><option value="IDR">IDRs<\/option><option value="VND">VND<\/option><\/select><\/span> <input type="text" class="form-control" ng-model-options="{ debounce: 500 }" ng-change="vm.updateBookingPrices()" ng-model="vm.bookingInfo.clientTotalBookingPrice"><\/div><div class="m-t-xs"><span ng-show="vm.bookingInfo.bookingType !== 3" class="font-bold"><span ng-show="vm.priceInfo.price">{{vm.priceInfo.price}} {{vm.bookingInfo.currencyCode}}<\/span> <span ng-show="vm.priceInfo.discountPercentage">= {{vm.priceInfo.initialPrice}} x {{vm.priceInfo.discountPercentage}}% OFF<\/span><\/span> <span ng-show="vm.bookingInfo.bookingType === 3"><span ng-show="vm.priceInfo.price">{{vm.priceInfo.price * 2}} {{vm.bookingInfo.currencyCode}} = 2 x {{vm.priceInfo.price}}<\/span> <span ng-show="vm.priceInfo.discountPercentage">(2 x {{vm.priceInfo.initialPrice}} x {{vm.priceInfo.discountPercentage}}% OFF)<\/span><\/span><div ng-show="vm.priceInfo.description">{{vm.priceInfo.description}}<\/div><\/div><div ng-show="vm.priceInfo.price && vm.bookingInfo.bookingType !== 2"><span ng-show="vm.priceInfo.isMiles">{{vm.priceInfo.distanceInMiles}} miles & {{vm.priceInfo.timeInMinutes}} min<\/span> <span ng-show="!vm.priceInfo.isMiles">{{vm.priceInfo.distanceInKm}} km & {{vm.priceInfo.timeInMinutes}} min<\/span><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="m-b"><div><div class="clearfix"><span class="pull-left">Car price:<\/span> <span class="pull-right">{{vm.bookingInfo.priceWithoutTaxes | number : 2}}<\/span><\/div><div class="clearfix"><span class="pull-left">Extras:<\/span> <span class="pull-right">{{ vm.bookingInfo.extrasTotalValueWithoutTaxes | number : 2 }}<\/span><\/div><div class="clearfix" ng-show="vm.bookingInfo.taxesTotalValue"><span class="pull-left">Taxes:<\/span> <span class="pull-right">{{ vm.bookingInfo.taxesTotalValue | number : 2 }}<\/span><\/div><div style="border-bottom: 1px solid gray;"><\/div><div class="clearfix fs-18 fw-800"><span class="pull-left">Total:<\/span> <span class="pull-right">{{vm.bookingInfo.clientTotalPrice | number : 2 }}<\/span><\/div><\/div><\/div><\/div><\/div><\/div><div class="col-sm-12 col-md-6"><div class="row"><div class="col-sm-12"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top margin-right-10"><input icheck type="radio" id="requireCardPaymentTrue" name="requireCardPayment" value="true" ng-data-value="true" ng-model="vm.bookingInfo.requireCardPayment"> <label class="vertical-align-middle" for="requireCardPaymentTrue">Require client card payment<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input icheck type="radio" id="requireCardPaymentFalse" name="requireCardPayment" value="false" ng-data-value="false" ng-model="vm.bookingInfo.requireCardPayment"> <label class="vertical-align-middle" for="requireCardPaymentFalse">Booking is or will be paid by account<\/label><\/div><\/div><\/div><\/div><div class="row"><div class="col-lg-4 col-md-4 col-sm-12 col-xs-12"><input icheck type="checkbox" id="automaticallyAskForDriverReview" name="automaticallyAskForDriverReview" value="false" ng-data-value="false" ng-model="vm.bookingInfo.automaticallyAskForDriverReview"> <label class="vertical-align-middle" style="line-break: auto; display: inline;" for="automaticallyAskForDriverReview">Ask client to review driver<\/label><\/div><div class="col-lg-4 col-md-4 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label">Ext Ref No.<\/label><div class="input-group full-width"><input type="text" class="form-control" ng-model="vm.bookingInfo.externalRefNumber"><\/div><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label">Number of cars<\/label><div class="input-group full-width"><input type="text" class="form-control" ng-model="vm.bookingInfo.numberOfCars"><\/div><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="col-md-12"><form class="passengerForm nomargin-bottom" name="vm.passengerForm" novalidate><div class="row nomargin-bottom"><div class="col-xs-12 col-md-6"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top margin-right-10"><input icheck type="radio" id="passengerDetailsMrSalutation" name="passengerDetailsSalutation" value="Mr." ng-data-value="Mr." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMrSalutation">Mr.<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input icheck type="radio" id="passengerDetailsMsSalutation" name="passengerDetailsSalutation" value="Ms." ng-data-value="Ms." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMsSalutation">Ms.<\/label><\/div><button class="btn btn-xs btn-success m-l-xl" ng-click="vm.fillClientInfo()"><i class="fa fa-arrow-down"><\/i> Fill Client Info<\/button><\/div><\/div><div class="col-xs-12 col-md-6 m-b-sm"><select name="culture" ng-model="vm.bookingInfo.passengerDetails.culture" class="form-control"><option value="en-GB">English<\/option><option value="pl">Polish<\/option><option value="de-CH">German - Switzerland<\/option><\/select><div><i class="fa fa-info"><\/i> Emails with customer will use this language<\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasFirstNameError()}"><input type="text" name="firstName" class="form-control original-style nomargin-bottom" ng-model="vm.bookingInfo.passengerDetails.firstName" placeholder="First name"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasLastNameError()}"><input type="text" name="lastName" class="form-control nomargin-bottom original-style" ng-model="vm.bookingInfo.passengerDetails.lastName" placeholder="Last Name"><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasEmailRequiredError() || vm.hasEmailFormatError()}"><input type="text" class="form-control original-style" multiple-email-validator placeholder="E-Mail" name="email" ng-model="vm.bookingInfo.passengerDetails.email"><div class="help-block ng-hide" ng-show="vm.hasEmailFormatError()">Email has invalid format.<\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasPhoneError()}"><input type="tel" class="form-control original-style" placeholder="Telephone" name="telephone" ng-model="vm.bookingInfo.passengerDetails.phone"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header">Pickup info<\/h5><\/div><div class="col-lg-3 col-md-3 col-sm-3 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.roomNumber" name="roomNumber" placeholder="Room number"><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-3 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.airline" name="airline" placeholder="Airline"><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-3 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.flightNumber" name="flightNumber" placeholder="Flight number"><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-3 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.comingFrom" name="arivingFrom" placeholder="Ariving from"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Dispatcher Notes (Visible to dispatcher only. Passenger & driver do not see this.)<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.dispatcherInstructions" name="additionalRequirements" placeholder="Dispatcher Instructions"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Client Extra Requirements (Visible to driver & passenger)<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.additionalRequirements" name="additionalRequirements" placeholder="Additional Requirements"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Driver Instructions (Visible to driver only. Passenger do not see.)<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.driverInstructions" name="driverInstructions" placeholder="Driver Instructions (only assigned driver will see this)"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom" ng-hide="vm.bookingInfo.hideAdvancedBookingControls"><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Persons<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="adultsNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.adultsNumber" name="adultsNumber" placeholder="Adults number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="childrenNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.childrenNumber" name="childrenNumber" placeholder="Children number"><\/div><\/div><\/div><\/div><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Luggage<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="largeLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.largeLuggageNumber" name="largeLuggageNumber" placeholder="Large luggage number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="mediumLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.mediumLuggageNumber" name="mediumLuggageNumber" placeholder="Medium luggage number"><\/div><\/div><\/div><\/div><\/div><div class="row nomargin-bottom"><\/div><\/form><\/div><\/div><br><hr ng-show="vm.bookingInfo.showPriceEditor"><booking-extra-services ng-show="vm.bookingInfo.showPriceEditor" booking-info="vm.bookingInfo" booking-extras-changed="vm.bookingExtrasChanged()"><\/booking-extra-services><div class="row get-quote-button-container text-center"><button type="submit" ng-click="vm.updateBooking()" class="get-quote-button btn btn-primary button-action"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaveInProgress"><\/i> {{vm.actionButtonText}}<\/button> <button type="button" ng-show="vm.cancelButtonText" ng-click="vm.closeDialog()" class="btn btn-danger button-action m-l-md">{{vm.cancelButtonText}}<\/button><\/div><\/div><booking-map location-info="vm.mapDetails" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map><\/div>'})}(),function(){"use strict";function t(n,t,i){var r=this,e=3,u,f;for(r.$onInit=function(){r.actionButtonText||(r.actionButtonText="Check price");r.isFullPage||(r.isFullPage=!0);r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.selectedDuration=""},r.$onChanges=function(n){var t,u,f;if(n.showValidationErrors&&(r.submitted=n.showValidationErrors.currentValue),n.bookingInfo){if(t=n.bookingInfo.currentValue,!t)return;r.bookingInfo.guid=t.guid;r.bookingInfo.carClasses=r.bookingInfo.carClasses;r.bookingInfo.selectedCarType={id:t.carTypeId,name:t.carClass};r.bookingInfo.selectedPaymentOption=t.selectedPaymentOption;r.bookingInfo.paymentStatusString=t.paymentStatusString;r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.selectedDuration=t.durationInHours;t.from&&(r.origin={name:t.from.addressName},u={formatted_address:t.from.address,geometry:{location:{lat:function(){return t.from.latLng.lat},lng:function(){return t.from.latLng.lng}}}},r.originChangedHandler(u));t.to&&(r.destination={name:t.to.addressName},f={formatted_address:t.to.address,geometry:{location:{lat:function(){return t.to.latLng.lat},lng:function(){return t.to.latLng.lng}}}},r.destinationChangedHandler(f));r.bookingInfo.pickupDateTimeMoment&&(r.pickupDate=moment(t.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.pickupDateTime=r.pickupDate,r.selectedPickupMinute=r.pickupDate.format("mm"),r.selectedPickupHour=r.pickupDate.format("HH"),r.bookingInfo.bookingType===2&&r.bookingInfo.durationInMinutes>=0&&(r.dropoffDate=moment(r.pickupDate),r.dropoffDate.add(r.bookingInfo.durationInMinutes,"minutes"),r.bookingInfo.dropoffDateTime=r.dropoffDate,r.selectedDropoffMinute=r.dropoffDate.format("mm"),r.selectedDropoffHour=r.dropoffDate.format("HH"),r.bookingInfo.selectedDuration=r.bookingInfo.durationInMinutes/60,r.bookingInfo.selectedDuration=Math.round(r.bookingInfo.selectedDuration*100)/100),r.bookingInfo.returnPickupDateTimeMoment&&(r.returnPickupDate=moment(t.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.selectedReturnPickupMinute=r.returnPickupDate.format("mm"),r.selectedReturnPickupHour=r.returnPickupDate.format("HH")));t.countryCode&&r.locationOptions.country!==t.countryCode&&(r.locationOptions={country:t.countryCode,watchEnter:!0});t.hideAdvancedBookingControls===!0&&(this.pickupDateStart=(new Date).setHours(0,0,0,0),this.returnPickupDateStart=this.pickupDateStart)}},r.pickupDate=null,r.selectedPickupHour="Hour",r.selectedPickupMinute="Minute",r.selectedReturnPickupHour="Hour",r.selectedReturnPickupMinute="Minute",r.locationOptions={country:null,watchEnter:!0},r.hourItems=[{hour:"00",text:"00 - (12 AM)"},{hour:"01",text:"01 - (1 AM)"},{hour:"02",text:"02 - (2 AM)"},{hour:"03",text:"03 - (3 AM)"},{hour:"04",text:"04 - (4 AM)"},{hour:"05",text:"05 - (5 AM)"},{hour:"06",text:"06 - (6 AM)"},{hour:"07",text:"07 - (7 AM)"},{hour:"08",text:"08 - (8 AM)"},{hour:"09",text:"09 - (9 AM)"},{hour:"10",text:"10 - (10 AM)"},{hour:"11",text:"11 - (11 AM)"},{hour:"12",text:"12 - (12 PM)"},{hour:"13",text:"13 - (1 PM)"},{hour:"14",text:"14 - (2 PM)"},{hour:"15",text:"15 - (3 PM)"},{hour:"16",text:"16 - (4 PM)"},{hour:"17",text:"17 - (5 PM)"},{hour:"18",text:"18 - (6 PM)"},{hour:"19",text:"19 - (7 PM)"},{hour:"20",text:"20 - (8 PM)"},{hour:"21",text:"21 - (9 PM)"},{hour:"22",text:"22 - (10 PM)"},{hour:"23",text:"23 - (11 PM)"}],r.minuteItems=[{minute:"00",text:"00"},{minute:"05",text:"05"},{minute:"10",text:"10"},{minute:"15",text:"15"},{minute:"20",text:"20"},{minute:"25",text:"25"},{minute:"30",text:"30"},{minute:"35",text:"35"},{minute:"40",text:"40"},{minute:"45",text:"45"},{minute:"50",text:"50"},{minute:"55",text:"55"}],r.isHourly=function(){return r.bookingInfo.bookingType===2},r.durationItems=[],u=3;u<=24;u=u+1)f=u*10,r.durationItems.push({hours:u,text:u+" hours (max. "+f+" miles)"});r.loaded=!0;r.originChangedHandler=function(n){console.log(n);console.log(r.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());r.bookingInfo.from={addressName:r.origin.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.from.address==="United Kingdom"&&(r.bookingInfo.from.address=r.origin.name);r.raiseEvent()};r.destinationChangedHandler=function(n){r.bookingInfo.to={addressName:r.destination.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.to.address==="United Kingdom"&&(r.bookingInfo.to.address=r.destination.name);r.raiseEvent()};r.recomputePrice=function(){t(function(){r.raiseEvent()})};r.raiseEvent=function(){var n=r.bookingInfo;n.isValid=r.isValid();r.bookingInfo.isValid=n.isValid;r.bookingInfoChanged({bookingInfo:n})};r.clientSelected=function(){r.raiseEvent()};r.addNewViaAddress=function(){r.bookingInfo.viaPoints||(r.bookingInfo.viaPoints=[]);r.bookingInfo.viaPoints.push({hasData:!1})};r.removeViaPoint=function(n){r.bookingInfo.viaPoints.splice(n,1)};r.viaPointChangedHandler=function(n){console.log("via point changed",n);var t=r.bookingInfo.viaPoints.find(function(t){return t.details===n});t&&(t.hasData=!0,t.address=n.formatted_address,t.latLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()});console.log("via point found",t);r.raiseEvent()};r.pickupDateChangedHandler=function(){console.log(r.pickupDate);r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());r.updatePickupDate(r.pickupDate)};r.dropoffDateChangedHandler=function(){console.log(r.dropoffDate);r.bookingInfo.dropoffDateTime&&r.bookingInfo.dropoffDateTime._isAMomentObject||(r.bookingInfo.dropoffDateTime=moment());r.updateDropoffDate(r.dropoffDate)};r.dropoffTimeChanged=function(n,t){r.bookingInfo.dropoffDateTime&&r.bookingInfo.dropoffDateTime._isAMomentObject||(r.bookingInfo.dropoffDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.dropoffDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.dropoffDateTime.minute(t);r.bookingInfo.dropoffDateTime.second(0);r.bookingInfo.dropoffTimeDisplay=r.bookingInfo.dropoffDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.dropoffPeriod=r.bookingInfo.dropoffDateTime.format("A");r.bookingInfo.bookingType===2&&r.updateBookingDuration();r.raiseEvent()};r.updateDropoffDate=function(n){if(n){r.bookingInfo.dropoffDateTime&&r.bookingInfo.dropoffDateTime._isAMomentObject||(r.bookingInfo.dropoffDateTime=moment(),r.bookingInfo.dropoffDateTime.second(0));var t=moment(n);r.bookingInfo.dropoffDateTime.year(t.year());r.bookingInfo.dropoffDateTime.month(t.month());r.bookingInfo.dropoffDateTime.date(t.date());r.bookingInfo.dropoffDateTime.second(0);r.bookingInfo.dropoffDateDisplay=t.format("dddd, DD MMM YYYY");r.bookingInfo.bookingType===2&&r.updateBookingDuration();r.raiseEvent()}};r.updateBookingDuration=function(){var n=!1;if(r.bookingInfo.bookingType!==2&&(n=!0),r.selectedDropoffHour&&r.selectedDropoffMinute&&r.selectedPickupHour&&r.selectedPickupMinute||(n=!0),r.bookingInfo.pickupDateTime&&r.bookingInfo.dropoffDateTime||(n=!0),n){r.bookingInfo.durationInMinutes=null;r.bookingInfo.selectedDuration=null;return}if(console.log("pickup: ",r.bookingInfo.pickupDateTime),console.log("dropoff: ",r.bookingInfo.dropoffDateTime),r.bookingInfo.durationInMinutes=moment.duration(r.bookingInfo.dropoffDateTime.diff(r.bookingInfo.pickupDateTime)).asMinutes(),r.bookingInfo.durationInMinutes<0){r.bookingInfo.selectedDuration=null;r.bookingInfo.durationInMinutes=null;return}r.bookingInfo.durationInMinutes=Math.floor(r.bookingInfo.durationInMinutes);r.bookingInfo.selectedDuration=r.bookingInfo.durationInMinutes/60;r.bookingInfo.selectedDuration=Math.round(r.bookingInfo.selectedDuration*100)/100;console.log("Hours: ",r.bookingInfo.selectedDuration)};r.returnPickupDateChangedHandler=function(){console.log(r.returnPickupDate);r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());r.updateReturnPickupDate(r.returnPickupDate)};r.updatePickupDate=function(n){if(n){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment(),r.bookingInfo.pickupDateTime.second(0));var t=moment(n);r.bookingInfo.pickupDateTime.year(t.year());r.bookingInfo.pickupDateTime.month(t.month());r.bookingInfo.pickupDateTime.date(t.date());r.bookingInfo.pickupDateTime.second(0);r.bookingInfo.pickupDateDisplay=t.format("dddd, DD MMM YYYY");r.bookingInfo.bookingType===2&&(r.updateBookingDuration(),r.bookingInfo.dropoffDateTime||(r.bookingInfo.dropoffDateTime=r.bookingInfo.pickupDateTime.clone(),r.dropoffDate=n,r.updateDropoffDate(n),r.dropoffDateText=r.bookingInfo.dropoffDateTime.format("dddd, DD MMM YYYY")));r.raiseEvent()}};r.updateReturnPickupDate=function(n){if(n){r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());var t=moment(n);r.bookingInfo.returnPickupDateTime.year(t.year());r.bookingInfo.returnPickupDateTime.month(t.month());r.bookingInfo.returnPickupDateTime.date(t.date());r.bookingInfo.returnPickupDateDisplay=t.format("dddd, DD MMM YYYY");r.raiseEvent()}};r.returnPickupTimeChanged=function(n,t){r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.returnPickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.returnPickupDateTime.minute(t);r.bookingInfo.returnPickupTimeDisplay=r.bookingInfo.returnPickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.returnPickupTimePeriod=r.bookingInfo.returnPickupDateTime.format("A");r.raiseEvent()};r.pickupTimeChanged=function(n,t){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.pickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.pickupDateTime.minute(t);r.bookingInfo.pickupDateTime.second(0);r.bookingInfo.pickupTimeDisplay=r.bookingInfo.pickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.pickupPeriod=r.bookingInfo.pickupDateTime.format("A");r.bookingInfo.bookingType===2&&r.updateBookingDuration();r.raiseEvent()};r.hasOriginError=function(){return r.submitted&&(!r.origin||!r.origin.name||!r.bookingInfo.from||!r.bookingInfo.from.address)};r.hasBookingDurationError=function(){return r.submitted&&r.bookingInfo.bookingType===2&&(!r.bookingInfo.durationInMinutes||r.bookingInfo.durationInMinutes<=0)};r.hasDropoffTimeError=function(){if(r.bookingInfo.bookingType!==2)return!1;var n=r.submitted&&(!r.selectedDropoffHour||r.selectedDropoffHour==="Hour"),t=r.submitted&&(!r.selectedDropoffMinute||r.selectedDropoffMinute==="Minute");return n||t};r.isBookingDropoffBeforePickup=function(){return r.bookingInfo.bookingType!==2?!1:!r.bookingInfo.pickupDateTime||!r.bookingInfo.dropoffDateTime?!1:r.submitted&&r.bookingInfo.dropoffDateTime.isBefore(r.bookingInfo.pickupDateTime)};r.hasDropoffDateError=function(){return r.submitted&&r.bookingInfo.bookingType===2&&!r.bookingInfo.dropoffDateTime};this.hasDestinationError=function(){return r.submitted&&r.bookingInfo.bookingType!==2&&(!r.destination||!r.destination.name||!r.bookingInfo.to||!r.bookingInfo.to.address)};this.hasPickupDateError=function(){return r.submitted&&!r.pickupDate};this.hasPickupTimeError=function(){var n=r.submitted&&(!r.selectedPickupHour||r.selectedPickupHour==="Hour"),t=r.submitted&&(!r.selectedPickupMinute||r.selectedPickupMinute==="Minute");return n||t};this.hasReturnPickupDateError=function(){return r.submitted&&!r.returnPickupDate};this.hasReturnPickupTimeError=function(){var n=r.submitted&&(!r.selectedReturnPickupHour||r.selectedReturnPickupHour==="Hour"),t=r.submitted&&(!r.selectedReturnPickupMinute||r.selectedReturnPickupMinute==="Minute");return n||t};r.hasCarClassError=function(){return r.submitted&&r.bookingInfo.selectedCarType.id<0};r.canChangeBookingType=function(){return r.bookingInfo&&!r.bookingInfo.guid};r.showReturnBookingType=function(){return r.bookingInfo==null||r.bookingInfo.guid==null};r.isValid=function(){var n=r.hasOriginError()||r.hasDestinationError()||r.hasPickupDateError()||r.hasPickupTimeError()||r.hasCarClassError()||r.hasBookingDurationError()||r.hasDropoffDateError()||r.hasDropoffTimeError()||r.isBookingDropoffBeforePickup()||!r.bookingInfo.selectedClient||r.bookingInfo.bookingType===e&&(r.hasReturnPickupDateError()||r.hasReturnPickupTimeError());return!n}}var n=angular.module("bookingApp");n.component("createBookingInfo",{controller:["$rootScope","$timeout","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingInfo:"<",bookingInfoChanged:"&",showValidationErrors:"<",isFullPage:"<",actionButtonText:"<"},template:'<div class="booking-form" name="bookingForm"><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group bookingTypeCheckboxes text-left"><div class="checkbox checkbox-inline checkbox-primary margin-right-10"><input type="radio" icheck id="bookingTypeOneWay" name="bookingType" value="1" ng-disabled="!vm.canChangeBookingType()" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="1"> <label for="bookingTypeOneWay">One way<\/label><\/div><div class="checkbox checkbox-inline checkbox-primary"><input type="radio" icheck id="bookingTypeHourly" name="bookingType" value="2" ng-disabled="!vm.canChangeBookingType()" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="2"> <label for="bookingTypeHourly">Hourly<\/label><\/div><div class="checkbox checkbox-inline checkbox-primary" ng-show="vm.showReturnBookingType()"><input type="radio" icheck id="bookingTypeReturn" name="bookingType" value="3" ng-disabled="!vm.canChangeBookingType()" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="3"> <label for="bookingTypeReturn">Return<\/label><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="row"><div class="col-sm-6 col-md-6"><div class="m-b form-group" ng-class="{\'has-error\': vm.hasCarClassError()}"><select class="form-control" ng-class="{default: vm.bookingInfo.selectedCarType.id < 0 }" ng-change="vm.recomputePrice()" ng-options="item as item.name for item in vm.bookingInfo.carClasses track by item.id" name="selectedCar" required ng-model="vm.bookingInfo.selectedCarType"><\/select><div class="help-block ng-hide" ng-show="vm.hasCarClassError()">Please select car class.<\/div><\/div><\/div><div class="col-sm-6 col-md-6"><div class="m-b form-group" ng-class="{\'has-error\': vm.submitted && !vm.bookingInfo.selectedClient}"><style>\r\n                            .form-control.select2-container .select2-choice {\r\n                                height: 32px;\r\n                                line-height: 32px;\r\n                            }\r\n\r\n                            .ui-select-choices-row:hover {\r\n                                background-color: #f5f5f5;\r\n                                color: black;\r\n                            }\r\n                        <\/style><ui-select class="form-control" ng-model="vm.bookingInfo.selectedClient" on-select="vm.clientSelected($item, $model)" theme="select2" style="padding: 0; border: none;" title="Select client" append-to-body="true"><ui-select-match placeholder="Select client">{{$select.selected.email}}<\/ui-select-match><ui-select-choices repeat="user in vm.bookingInfo.clients | filter: $select.search"><div ng-bind-html="user.firstName + \' \' + user.lastName | highlight: $select.search"><\/div><small><span ng-bind-html="user.companyName ? (user.email + \' - \' + user.companyName) : (user.email) | highlight: $select.search"><\/span><\/small><\/ui-select-choices><\/ui-select><div class="help-block ng-hide" ng-show="vm.submitted && !vm.bookingInfo.selectedClient">Please select client.<\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="colBookingOrigin" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-5\':vm.isFullPage}"><div class="form-group origin-form-group" ng-class="{\'has-error\': vm.hasOriginError()}"><input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.origin.name" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasOriginError()">Pick-up location is required.<\/div><\/div><\/div><div class="text-center" ng-hide="vm.bookingInfo.bookingType == 2" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-2\':vm.isFullPage}"><button class="btn btn-sm btn-primary" tabindex="-1" ng-click="vm.addNewViaAddress()"><i class="fa fa-plus"><\/i> Via<\/button><\/div><div ng-show="vm.bookingInfo.bookingType == 2" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-6\':vm.isFullPage}"><strong>Duration:<\/strong> <span ng-show="vm.bookingInfo.selectedDuration">{{vm.bookingInfo.selectedDuration}} hours<\/span> <span ng-show="vm.bookingInfo.selectedDuration">({{vm.bookingInfo.durationInMinutes}} min)<\/span><\/div><div class="colBookingDestinationOrDuration" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-5\':vm.isFullPage}"><div class="form-group destination-form-group" ng-hide="vm.bookingInfo.bookingType == 2" ng-class="{\'has-error\': vm.hasDestinationError()}"><input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Drop-off address or airport" ng-autocomplete ng-model="vm.destination.name" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasDestinationError()">Drop-off location is required.<\/div><\/div><\/div><\/div><div ng-show="vm.bookingInfo.viaPoints"><ul class="list-unstyled"><li class="m-b-sm" ng-repeat="viaPoint in vm.bookingInfo.viaPoints"><div class="input-group"><span class="input-group-addon">Via {{$index+1}}<\/span> <input type="text" class="form-control" placeholder="Via Address or airport" ng-autocomplete ng-model="viaPoint.addressName" details="viaPoint.details" options="vm.locationOptions" on-changed="vm.viaPointChangedHandler"> <span class="input-group-btn"><button class="btn btn-danger" ng-click="vm.removeViaPoint($index)"><i class="fa fa-remove"><\/i> Remove<\/button><\/span><\/div><\/li><\/ul><\/div><style>\r\n        .booking-form .checkbox label,\r\n        .booking-form .radio label {\r\n            padding-left: 0;\r\n        }\r\n\r\n        .booking-form .checkbox-inline, .booking-form .radio-inline {\r\n            padding-left: 0;\r\n        }\r\n\r\n        select.default {\r\n            color: darkgrey;\r\n        }\r\n\r\n        .booking-form .picker, .picker__holder {\r\n            position: fixed;\r\n        }\r\n    <\/style><div class="row pickup-datetime-row"><div ng-class="{\'col-sm-12\': !vm.isHourly(), \'col-sm-6\': vm.isHourly()}"><div class="row"><div class="form-group pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupDateError()}"><input type="text" class="form-control original-style" name="pickupDate" placeholder="Pickup date & time" autocomplete="off" pick-a-date="vm.pickupDate" min-date="vm.pickupDateStart" ng-model="vm.pickupDateText" update-model="vm.pickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasPickupDateError()">Please end date.<\/div><\/div><div class="form-group pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupTimeError()}"><div class="row"><div class="col-xs-7 pickup-time-hour-form-group" style="padding-right: 5px;"><select class="form-control original-style" placeholder="Hour" name="pickupTimeHour" ng-model="vm.selectedPickupHour" ng-class="{default: vm.selectedPickupHour === \'Hour\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-5 pickup-time-minute-form-group" style="padding-left: 5px;"><select class="form-control original-style" placeholder="Minute" name="pickupTimeMinute" ng-model="vm.selectedPickupMinute" ng-class="{default: vm.selectedPickupMinute === \'Minute\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><\/div><div class="col-sm-6" ng-show="vm.isHourly()"><div class="row"><div class="form-group dropoff-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasDropoffDateError()}"><input type="text" class="form-control original-style" name="pickupDate" placeholder="Dropoff date & time" autocomplete="off" pick-a-date="vm.dropoffDate" min-date="vm.dropoffDateStart" ng-model="vm.dropoffDateText" update-model="vm.dropoffDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasDropoffDateError()">Please set dropoff date.<\/div><\/div><div class="form-group dropoff-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasBookingDurationError()}"><div class="row"><div class="col-xs-7 dropoff-time-hour-form-group" style="padding-right: 5px;"><select class="form-control original-style" placeholder="Hour" name="dropoffTimeHour" ng-model="vm.selectedDropoffHour" ng-class="{default: vm.selectedDropoffHour === \'Hour\'}" ng-change="vm.dropoffTimeChanged(vm.selectedDropoffHour, vm.selectedDropoffMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-5 dropoff-time-minute-form-group" style="padding-left: 5px;"><select class="form-control original-style" placeholder="Minute" name="dropoffTimeMinute" ng-model="vm.selectedDropoffMinute" ng-class="{default: vm.selectedDropoffMinute === \'Minute\'}" ng-change="vm.dropoffTimeChanged(vm.selectedDropoffHour, vm.selectedDropoffMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasDropoffTimeError()">Please set dropoff time.<\/div><\/div><div class="col-sm-12" ng-show="vm.isBookingDropoffBeforePickup()" ng-class="{\'has-error\': vm.isBookingDropoffBeforePickup()}"><div class="help-block ng-hide" ng-show="vm.isBookingDropoffBeforePickup()">Dropoff date & time is before pickup date. Please update.<\/div><\/div><\/div><\/div><\/div><div class="row return-pickup-datetime-row" ng-hide="vm.bookingInfo.bookingType != 3"><div class="form-group return-pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupDateError()}"><input type="text" class="form-control original-style" name="returnPickupDate" placeholder="Return date & time" autocomplete="off" pick-a-date="vm.returnPickupDate" min-date="vm.returnPickupDateStart" ng-model="vm.returnPickupDateText" update-model="vm.returnPickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasReturnPickupDateError()">Please select return pickup date.<\/div><\/div><div class="form-group return-pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupTimeError()}"><div class="row nomargin-bottom"><div class="col-xs-6 return-pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="returnPickupTimeHour" ng-class="{default: vm.selectedReturnPickupHour === \'Hour\'}" ng-model="vm.selectedReturnPickupHour" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 return-pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="returnPickupTimeMinute" ng-class="{default: vm.selectedReturnPickupMinute === \'Minute\'}" ng-model="vm.selectedReturnPickupMinute" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasReturnPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){function e(n,t){$rootScope.$broadcast("bookingFormChanged",{isValid:n,wasChangedByUser:t,bookingInfo:f.bookingInfo})}var f=this;f.$onInit=function(){f.actionButtonText||(f.actionButtonText="Check price");f.isFullPage||(f.isFullPage=!0);var n=f.bookingId?f.bookingId:"website";f.getBookingFromServer(n)};f.submitted=!1;f.priceRequested=!1;f.mapDetails={};f.bookingInfo={guid:null,bookingType:1,selectedDuration:"Booking Duration"};f.checkPrices=function(){f.submitted=!0;var n=f.isValid();if(n){e(!1,!0);return}f.bookingInfo.lastCheckPiceTimestamp=moment();e(!0,!0);console.log(f.bookingInfo)};f.updateBookingPrice=function(n){f.bookingInfo.testIfValid()&&(f.loadingPrice=!0,r.getBookingPrice(n).then(function(n){n.data.success?(f.priceRequested=!0,f.priceInfo=n.data,f.bookingInfo.price=f.priceInfo.price,f.bookingInfo.extras=f.priceInfo.extras,f.loadingPrice=!1):(f.priceRequested=!0,f.priceInfo=n.data,f.bookingInfo.price=0,f.loadingPrice=!1)},function(){f.priceRequested=!0;f.priceInfo=null;f.bookingInfo.price=0;f.loadingPrice=!1}))};f.getBookingFromServer=function(t){r.getBookingDetails(t).then(function(t){var u=JSON.stringify(t.data,null,4),r;console.log(u);f.supressPriceUpdates=!0;f.bookingInfo=t.data;f.duplicateBooking==="duplicate"&&(f.bookingInfo.guid=null);r={id:-2,name:"Please select client"};f.bookingInfo.clientsList&&f.bookingInfo.clientsList.splice(0,0,r);f.bookingInfo.selectedClient||(f.bookingInfo.selectedClient=r);f.bookingInfo.selectedCarType={id:f.bookingInfo.carTypeId,name:f.bookingInfo.carClass};f.bookingInfo.selectedDuration=t.data.durationInHours?t.data.durationInHours.toString():null;f.bookingInfo.pickupDateTimeMoment&&(f.pickupDate=moment(f.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.pickupDateTime=f.pickupDate,f.bookingInfo.pickupDateTime=f.pickupDate,f.selectedPickupMinute=f.pickupDate.format("mm"),f.selectedPickupHour=f.pickupDate.format("HH"),f.bookingInfo.returnPickupDateTimeMoment&&(f.returnPickupDate=moment(f.bookingInfo.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.selectedReturnPickupMinute=f.returnPickupDate.format("mm"),f.selectedReturnPickupHour=f.returnPickupDate.format("HH")));f.bookingInfo.guid&&f.bookingInfo.price&&(f.priceRequested=!0,f.priceInfo={price:f.bookingInfo.price,initialPrice:f.bookingInfo.price,totalPrice:f.bookingInfo.totalPriceWithTax,extras:f.bookingInfo.extras});n(function(){f.supressPriceUpdates=!1},300)})};f.hasFirstNameError=function(){return f.submitted&&f.passengerForm.firstName.$invalid||f.passengerForm.firstName.$invalid&&!f.passengerForm.firstName.$pristine};f.canChangeBookingType=function(){return!f.bookingInfo.guid};f.recomputePrice=function(){n(function(){f.updateBookingPrice(f.bookingInfo)})};f.bookingInfoChanged=function(n){f.mapDetails={from:n.from,to:n.to,bookingType:n.bookingType};f.updateBookingPrice(n)};f.mapChanged=function(n){f.bookingInfo.distanceInMiles=n.distanceInMiles;f.bookingInfo.durationInMinutes=n.timeInMinutes};f.hasLastNameError=function(){return f.submitted&&f.passengerForm.lastName.$invalid||f.passengerForm.lastName.$invalid&&!f.passengerForm.lastName.$pristine};f.hasEmailRequiredError=function(){return f.submitted&&f.passengerForm.email.$error.required||f.passengerForm.email.$error.required&&!f.passengerForm.email.$pristine};f.hasEmailFormatError=function(){return f.submitted&&f.passengerForm.email.$error.email||f.passengerForm.email.$error.email&&!f.passengerForm.email.$pristine};f.hasPhoneError=function(){return f.submitted&&f.passengerForm.telephone.$invalid||f.passengerForm.telephone.$invalid&&!f.passengerForm.telephone.$pristine};f.hasMaxPersonsError=function(){var n=0,t,i;return!f.bookingInfo.passengerDetails||!f.priceInfo?!1:(t=parseInt(f.bookingInfo.passengerDetails.childrenNumber),t>0&&(n+=t),i=parseInt(f.bookingInfo.passengerDetails.adultsNumber),i>0&&(n+=i),f.submitted&&n>f.priceInfo.maxPassengers)};f.updateBooking=function(){f.submitted=!0;n(function(){var i,e,o;if(f.priceInfo&&(f.bookingInfo.distanceInMiles=f.priceInfo.distanceInMiles,f.bookingInfo.durationInMinutes=f.priceInfo.timeInMinutes),i=f.bookingInfo.validate()&&f.passengerForm.$valid&&!f.hasMaxPersonsError(),!i){u.scrollElement(".has-error");return}e=f.bookingInfo.guid==null;o=e?"Save booking?":"Update booking?";u.showConfirmation(o,"").then(function(){r.updateBooking(f.bookingInfo).then(function(i){if(console.log(i),i.data.success)u.showNotification("success","Booking saved."),n(function(){i.data.returnUrl&&(t.location.href=i.data.returnUrl)},2500);else{var r=i.data.errors[0];u.showNotification("error",r)}})})})}}var n=angular.module("bookingApp");n.component("clientCreateBookingForm",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<"},template:'<client-create-booking-info booking-info="vm.bookingInfo" booking-info-changed="vm.bookingInfoChanged(bookingInfo)" show-validation-errors="vm.submitted" booking-type="vm.bookingInfo.bookingType" is-full-page="true"><\/client-create-booking-info><h2 class="text-center" ng-show="vm.priceInfo || !vm.bookingInfo.guid"><span ng-show="vm.loadingPrice"><i class="fa fa-spin fa-spinner"><\/i> Computing price...<\/span> <span ng-show="!vm.loadingPrice"><span ng-show="!vm.priceRequested">Fill booking details to view price<\/span> <span ng-show="vm.priceRequested && !vm.priceInfo.isFullyBooked && (!vm.priceInfo.price || vm.priceInfo.price === 0)">Price not available. They will be set by operator.<\/span> <span ng-show="vm.priceRequested && vm.priceInfo.price"><span ng-show="vm.priceInfo.extras"><span class="price-label">Car price:<\/span> <span class="price-value">{{vm.priceInfo.initialPrice | number : 2}} {{vm.bookingInfo.currencyCode}}<\/span><br><span ng-repeat="extra in vm.priceInfo.extras"><span class="price-label">{{extra.description}}:<\/span> <span class="price-value">{{extra.companyAmount | number : 2}} {{vm.bookingInfo.currencyCode}}<\/span><br><\/span> <span class="price-label font-bold margin-top-10">Total:<\/span> <span class="price-value font-bold margin-top-10">{{vm.priceInfo.totalPrice | number : 2}} {{vm.bookingInfo.currencyCode}}<\/span><\/span> <span ng-show="!vm.priceInfo.extras"><b>Price: {{vm.priceInfo.price | number : 2}} {{vm.bookingInfo.currencyCode}}<\/b><\/span><\/span><br><span ng-show="vm.priceRequested && vm.priceInfo.isFullyBooked"><span class="field-validation-error">We are fully booked. Please change dates and try again.<\/span><\/span><br><span ng-show="vm.priceRequested && vm.priceInfo.isPassedTime"><span class="field-validation-error">Booking date is in the past. Please change dates and try again.<\/span><\/span><\/span><\/h2><hr><div class="booking-form margin-bottom-30" name="bookingForm"><div class="row"><div class="col-md-12"><form class="passengerForm nomargin-bottom" name="vm.passengerForm" novalidate><div class="row nomargin-bottom"><div class="col-xs-12"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top margin-right-10"><input icheck type="radio" id="passengerDetailsMrSalutation" name="passengerDetailsSalutation" value="Mr." ng-data-value="Mr." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMrSalutation">Mr.<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input icheck type="radio" id="passengerDetailsMsSalutation" name="passengerDetailsSalutation" value="Ms." ng-data-value="Ms." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMsSalutation">Ms.<\/label><\/div><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasFirstNameError()}"><input type="text" name="firstName" class="form-control original-style nomargin-bottom" ng-model="vm.bookingInfo.passengerDetails.firstName" placeholder="First name"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasLastNameError()}"><input type="text" name="lastName" class="form-control nomargin-bottom original-style" ng-model="vm.bookingInfo.passengerDetails.lastName" placeholder="Last Name"><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasEmailRequiredError() || vm.hasEmailFormatError()}"><input type="email" class="form-control original-style" placeholder="E-Mail" name="email" ng-model="vm.bookingInfo.passengerDetails.email"><div class="help-block ng-hide" ng-show="vm.hasEmailFormatError()">Email has invalid format.<\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasPhoneError()}"><input type="tel" class="form-control original-style" placeholder="Telephone" name="telephone" ng-model="vm.bookingInfo.passengerDetails.phone"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header">Pickup info<\/h5><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.roomNumber" name="roomNumber" placeholder="Room number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.flightNumber" name="flightNumber" placeholder="Flight number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.comingFrom" name="arivingFrom" placeholder="Ariving from"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Additional Requirements<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.additionalRequirements" name="additionalRequirements" placeholder="Additional Requirements"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom" ng-hide="vm.bookingInfo.hideAdvancedBookingControls"><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Persons<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="adultsNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.adultsNumber" name="adultsNumber" placeholder="Adults number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="childrenNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.childrenNumber" name="childrenNumber" placeholder="Children number"><\/div><\/div><div class="col-sm-12 ng-hide" ng-show="vm.hasMaxPersonsError()" ng-class="{\'has-error\': vm.hasMaxPersonsError()}"><div class="help-block">Number of persons exceed vehicle capacity.<\/div><\/div><\/div><\/div><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Luggage<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="largeLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.largeLuggageNumber" name="largeLuggageNumber" placeholder="Large luggage number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="mediumLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.mediumLuggageNumber" name="mediumLuggageNumber" placeholder="Medium luggage number"><\/div><\/div><\/div><\/div><\/div><div class="row nomargin-bottom"><\/div><\/form><\/div><\/div><br><div class="row get-quote-button-container text-center"><button type="submit" ng-click="vm.updateBooking()" class="get-quote-button btn btn-primary button-action red-button">{{vm.actionButtonText}}<\/button><\/div><\/div><booking-map booking-info="vm.mapDetails" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map><style>\r\n    .price-value {\r\n        text-align: right;\r\n        min-width: 160px;\r\n        display: inline-block;\r\n    }\r\n\r\n    .price-label {\r\n        min-width: 180px;\r\n        display: inline-block;\r\n        text-align: right;\r\n        margin-right: 20px;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i){var r=this,e=3,u,f;for(r.$onInit=function(){r.actionButtonText||(r.actionButtonText="Check price");r.isFullPage||(r.isFullPage=!0);r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.testIfValid=function(){return r.testIfValid()};r.bookingInfo.selectedDuration="-1"},r.$onChanges=function(n){var t,u,f;if(n.showValidationErrors&&(r.submitted=n.showValidationErrors.currentValue),n.bookingInfo){if(t=n.bookingInfo.currentValue,!t)return;r.bookingInfo.guid=t.guid;r.bookingInfo.carClasses=r.bookingInfo.carClasses;r.bookingInfo.selectedCarType={id:t.carTypeId,name:t.carClass};r.bookingInfo.selectedPaymentOption=t.selectedPaymentOption;r.bookingInfo.paymentStatusString=t.paymentStatusString;r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.testIfValid=function(){return r.testIfValid()};r.bookingInfo.selectedDuration=t.durationInHours?t.durationInHours.toString():"-1";t.from&&(r.origin={name:t.from.addressName},u={formatted_address:t.from.address,geometry:{location:{lat:function(){return t.from.latLng.lat},lng:function(){return t.from.latLng.lng}}}},r.originChangedHandler(u));t.to&&(r.destination={name:t.to.addressName},f={formatted_address:t.to.address,geometry:{location:{lat:function(){return t.to.latLng.lat},lng:function(){return t.to.latLng.lng}}}},r.destinationChangedHandler(f));r.bookingInfo.pickupDateTimeMoment&&(r.pickupDate=moment(t.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.pickupDateTime=r.pickupDate,r.bookingInfo.pickupDateTime=r.pickupDate,r.selectedPickupMinute=r.pickupDate.format("mm"),r.selectedPickupHour=r.pickupDate.format("HH"),r.bookingInfo.returnPickupDateTimeMoment&&(r.returnPickupDate=moment(t.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.selectedReturnPickupMinute=r.returnPickupDate.format("mm"),r.selectedReturnPickupHour=r.returnPickupDate.format("HH")));t.countryCode&&r.locationOptions.country!==t.countryCode&&(r.locationOptions={country:t.countryCode,watchEnter:!0});t.hideAdvancedBookingControls===!0&&(this.pickupDateStart=(new Date).setHours(0,0,0,0),this.returnPickupDateStart=this.pickupDateStart)}},r.pickupDate=null,r.selectedPickupHour="Hour",r.selectedPickupMinute="Minute",r.selectedReturnPickupHour="Hour",r.selectedReturnPickupMinute="Minute",r.locationOptions={country:"",watchEnter:!0},r.hourItems=[{hour:"00",text:"00 - (12 AM)"},{hour:"01",text:"01 - (1 AM)"},{hour:"02",text:"02 - (2 AM)"},{hour:"03",text:"03 - (3 AM)"},{hour:"04",text:"04 - (4 AM)"},{hour:"05",text:"05 - (5 AM)"},{hour:"06",text:"06 - (6 AM)"},{hour:"07",text:"07 - (7 AM)"},{hour:"08",text:"08 - (8 AM)"},{hour:"09",text:"09 - (9 AM)"},{hour:"10",text:"10 - (10 AM)"},{hour:"11",text:"11 - (11 AM)"},{hour:"12",text:"12 - (12 PM)"},{hour:"13",text:"13 - (1 PM)"},{hour:"14",text:"14 - (2 PM)"},{hour:"15",text:"15 - (3 PM)"},{hour:"16",text:"16 - (4 PM)"},{hour:"17",text:"17 - (5 PM)"},{hour:"18",text:"18 - (6 PM)"},{hour:"19",text:"19 - (7 PM)"},{hour:"20",text:"20 - (8 PM)"},{hour:"21",text:"21 - (9 PM)"},{hour:"22",text:"22 - (10 PM)"},{hour:"23",text:"23 - (11 PM)"}],r.minuteItems=[{minute:"00",text:"00"},{minute:"05",text:"05"},{minute:"10",text:"10"},{minute:"15",text:"15"},{minute:"20",text:"20"},{minute:"25",text:"25"},{minute:"30",text:"30"},{minute:"35",text:"35"},{minute:"40",text:"40"},{minute:"45",text:"45"},{minute:"50",text:"50"},{minute:"55",text:"55"}],r.durationItems=[],u=3;u<=24;u=u+1)f=u*10,r.durationItems.push({hours:u,text:u+" hours (max. "+f+" miles)"});r.loaded=!0;r.originChangedHandler=function(n){console.log(n);console.log(r.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());r.bookingInfo.from={addressName:r.origin.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.from.address==="United Kingdom"&&(r.bookingInfo.from.address=r.origin.name);r.raiseEvent()};r.addNewViaAddress=function(){r.bookingInfo.viaPoints||(r.bookingInfo.viaPoints=[]);r.bookingInfo.viaPoints.push({hasData:!1})};r.removeViaPoint=function(n){r.bookingInfo.viaPoints.splice(n,1)};r.viaPointChangedHandler=function(n){console.log("via point changed",n);var t=r.bookingInfo.viaPoints.find(function(t){return t.details===n});t&&(t.hasData=!0,t.address=n.formatted_address,t.latLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()});console.log("via point found",t);r.raiseEvent()};r.destinationChangedHandler=function(n){r.bookingInfo.to={addressName:r.destination.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.to.address==="United Kingdom"&&(r.bookingInfo.to.address=r.destination.name);r.raiseEvent()};r.recomputePrice=function(){t(function(){r.raiseEvent()})};r.raiseEvent=function(){var n=r.bookingInfo;n.isValid=r.isValid();r.bookingInfo.isValid=n.isValid;r.bookingInfoChanged({bookingInfo:n})};r.pickupDateChangedHandler=function(){console.log(r.pickupDate);r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());r.updatePickupDate(r.pickupDate)};r.returnPickupDateChangedHandler=function(){console.log(r.returnPickupDate);r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());r.updateReturnPickupDate(r.returnPickupDate)};r.updatePickupDate=function(n){if(n){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());var t=moment(n);r.bookingInfo.pickupDateTime.year(t.year());r.bookingInfo.pickupDateTime.month(t.month());r.bookingInfo.pickupDateTime.date(t.date());r.bookingInfo.pickupDateDisplay=t.format("dddd, DD MMM YYYY");r.raiseEvent()}};r.updateReturnPickupDate=function(n){if(n){r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());var t=moment(n);r.bookingInfo.returnPickupDateTime.year(t.year());r.bookingInfo.returnPickupDateTime.month(t.month());r.bookingInfo.returnPickupDateTime.date(t.date());r.bookingInfo.returnPickupDateDisplay=t.format("dddd, DD MMM YYYY");r.raiseEvent()}};r.returnPickupTimeChanged=function(n,t){r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.returnPickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.returnPickupDateTime.minute(t);r.bookingInfo.returnPickupTimeDisplay=r.bookingInfo.returnPickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.returnPickupTimePeriod=r.bookingInfo.returnPickupDateTime.format("A");r.raiseEvent()};r.pickupTimeChanged=function(n,t){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.pickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.pickupDateTime.minute(t);r.bookingInfo.pickupTimeDisplay=r.bookingInfo.pickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.pickupPeriod=r.bookingInfo.pickupDateTime.format("A");r.raiseEvent()};r.hasOriginError=function(){return r.submitted&&(!r.origin||!r.origin.name||!r.bookingInfo.from||!r.bookingInfo.from.address)};r.hasBookingDurationError=function(){return r.submitted&&r.bookingInfo.bookingType===2&&(!r.bookingInfo.selectedDuration||r.bookingInfo.selectedDuration<=0)};this.hasDestinationError=function(){return r.submitted&&r.bookingInfo.bookingType!==2&&(!r.destination||!r.destination.name||!r.bookingInfo.to||!r.bookingInfo.to.address)};this.hasPickupDateError=function(){return r.submitted&&!r.pickupDate};this.hasPickupTimeError=function(){var n=r.submitted&&(!r.selectedPickupHour||r.selectedPickupHour==="Hour"),t=r.submitted&&(!r.selectedPickupMinute||r.selectedPickupMinute==="Minute");return n||t};this.hasReturnPickupDateError=function(){return r.submitted&&!r.returnPickupDate};this.hasReturnPickupTimeError=function(){var n=r.submitted&&(!r.selectedReturnPickupHour||r.selectedReturnPickupHour==="Hour"),t=r.submitted&&(!r.selectedReturnPickupMinute||r.selectedReturnPickupMinute==="Minute");return n||t};r.hasCarClassError=function(){return r.submitted&&r.bookingInfo.selectedCarType.id<0};r.canChangeBookingType=function(){return r.bookingInfo&&!r.bookingInfo.guid};r.getBookingTypeTitle=function(){return r.canChangeBookingType()?"":"Cannot change booking type.In order to edit please cancel this booking and create another."};r.testIfValid=function(){var n=!r.origin||!r.origin.name||!r.bookingInfo.from||!r.bookingInfo.from.address;return n=n||r.bookingInfo.bookingType!==2&&(!r.destination||!r.destination.name||!r.bookingInfo.to||!r.bookingInfo.to.address),n=n||!r.pickupDate,n=n||(!r.selectedPickupHour||r.selectedPickupHour==="Hour")&&(!r.selectedPickupMinute||r.selectedPickupMinute==="Minute"),n=n||r.bookingInfo.selectedCarType.id<0,n=n||r.bookingInfo.bookingType===2&&(!r.bookingInfo.selectedDuration||r.bookingInfo.selectedDuration<=0),!n};r.isValid=function(){var n=r.hasOriginError()||r.hasDestinationError()||r.hasPickupDateError()||r.hasPickupTimeError()||r.hasCarClassError()||r.hasBookingDurationError()||r.bookingInfo.bookingType===e&&(r.hasReturnPickupDateError()||r.hasReturnPickupTimeError());return!n}}var n=angular.module("bookingApp");n.component("clientCreateBookingInfo",{controller:["$rootScope","$timeout","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingInfo:"<",bookingInfoChanged:"&",showValidationErrors:"<",isFullPage:"<",actionButtonText:"<"},template:'<div class="booking-form" name="bookingForm"><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group bookingTypeCheckboxes text-left"><div title="{{vm.getBookingTypeTitle()}}" class="checkbox checkbox-inline checkbox-primary margin-right-10" ng-disabled="!vm.canChangeBookingType()"><input ng-disabled="!vm.canChangeBookingType()" type="radio" icheck id="bookingTypeOneWay" name="bookingType" value="1" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="1"> <label for="bookingTypeOneWay">One way<\/label><\/div><div title="{{vm.getBookingTypeTitle()}}" class="checkbox checkbox-inline checkbox-primary" ng-disabled="!vm.canChangeBookingType()"><input ng-disabled="!vm.canChangeBookingType()" type="radio" icheck id="bookingTypeHourly" name="bookingType" value="2" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="2"> <label for="bookingTypeHourly">Hourly<\/label><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="m-b form-group" ng-class="{\'has-error\': vm.hasCarClassError()}"><select class="form-control" ng-class="{default: vm.bookingInfo.selectedCarType.id < 0 }" ng-change="vm.recomputePrice()" ng-options="item as item.name for item in vm.bookingInfo.carClasses track by item.id" name="selectedCar" required ng-model="vm.bookingInfo.selectedCarType"><\/select><div class="help-block ng-hide" ng-show="vm.hasCarClassError()">Please select car class.<\/div><\/div><\/div><\/div><div class="row"><div class="colBookingOrigin" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-5\':vm.isFullPage}"><div class="form-group origin-form-group" ng-class="{\'has-error\': vm.hasOriginError()}"><input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.origin.name" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasOriginError()">Pick-up location is required.<\/div><\/div><\/div><div class="text-center" ng-hide="vm.bookingInfo.bookingType == 2" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-2\':vm.isFullPage}"><button class="btn btn-sm btn-primary" tabindex="-1" ng-click="vm.addNewViaAddress()"><i class="fa fa-plus"><\/i> Via<\/button><\/div><div class="colBookingDestinationOrDuration" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-5\':vm.isFullPage}"><div class="form-group ng-hide duration-form-group" ng-class="{\'has-error\': vm.hasBookingDurationError()}" ng-hide="vm.bookingInfo.bookingType != 2"><select class="form-control original-style" placeholder="Booking Duration" ng-model="vm.bookingInfo.selectedDuration" ng-class="{default: vm.bookingInfo.selectedDuration < 0 }" ng-change="vm.recomputePrice()"><option value="-1">Booking Duration<\/option><option ng-repeat="item in vm.durationItems" value="{{item.hours}}">{{item.text}}<\/option><\/select><div class="help-block ng-hide" ng-show="vm.hasBookingDurationError()">Please select booking duration.<\/div><\/div><div class="form-group destination-form-group" ng-hide="vm.bookingInfo.bookingType == 2" ng-class="{\'has-error\': vm.hasDestinationError()}"><input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Drop-off address or airport" ng-autocomplete ng-model="vm.destination.name" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasDestinationError()">Drop-off location is required.<\/div><\/div><\/div><\/div><div ng-show="vm.bookingInfo.viaPoints"><ul class="list-unstyled"><li class="m-b-sm" ng-repeat="viaPoint in vm.bookingInfo.viaPoints"><div class="input-group"><span class="input-group-addon">Via {{$index+1}}<\/span> <input type="text" class="form-control" placeholder="Via Address or airport" ng-autocomplete ng-model="viaPoint.addressName" details="viaPoint.details" options="vm.locationOptions" on-changed="vm.viaPointChangedHandler"> <span class="input-group-btn"><button class="btn btn-danger" ng-click="vm.removeViaPoint($index)"><i class="fa fa-remove"><\/i> Remove<\/button><\/span><\/div><\/li><\/ul><\/div><style>\r\n        .booking-form .checkbox label,\r\n        .booking-form .radio label {\r\n            padding-left: 0;\r\n        }\r\n\r\n        .booking-form .checkbox-inline, .booking-form .radio-inline {\r\n            padding-left: 0;\r\n        }\r\n\r\n        select.default {\r\n            color: darkgrey;\r\n        }\r\n\r\n        .booking-form .picker, .picker__holder {\r\n            position: fixed;\r\n        }\r\n    <\/style><div class="row pickup-datetime-row"><div class="form-group pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupDateError()}"><input type="text" class="form-control original-style" name="pickupDate" placeholder="Pickup date & time" autocomplete="off" pick-a-date="vm.pickupDate" min-date="vm.pickupDateStart" ng-model="vm.pickupDateText" update-model="vm.pickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasPickupDateError()">Please select pickup date.<\/div><\/div><div class="form-group pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupTimeError()}"><div class="row"><div class="col-xs-6 pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="pickupTimeHour" ng-model="vm.selectedPickupHour" ng-class="{default: vm.selectedPickupHour === \'Hour\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="pickupTimeMinute" ng-model="vm.selectedPickupMinute" ng-class="{default: vm.selectedPickupMinute === \'Minute\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><div class="row return-pickup-datetime-row" ng-hide="vm.bookingInfo.bookingType != 3"><div class="form-group return-pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupDateError()}"><input type="text" class="form-control original-style" name="returnPickupDate" placeholder="Return date & time" autocomplete="off" pick-a-date="vm.returnPickupDate" min-date="vm.returnPickupDateStart" ng-model="vm.returnPickupDateText" update-model="vm.returnPickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasReturnPickupDateError()">Please select return pickup date.<\/div><\/div><div class="form-group return-pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupTimeError()}"><div class="row nomargin-bottom"><div class="col-xs-6 return-pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="returnPickupTimeHour" ng-class="{default: vm.selectedReturnPickupHour === \'Hour\'}" ng-model="vm.selectedReturnPickupHour" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 return-pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="returnPickupTimeMinute" ng-class="{default: vm.selectedReturnPickupMinute === \'Minute\'}" ng-model="vm.selectedReturnPickupMinute" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasReturnPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><\/div>'})}(),function(){"use strict";function i(n,i,r,u,f){var e=this;e.mapDetails={visible:!1};e.isLoaded=!1;e.$onInit=function(){e.getBookingFromServer(e.bookingId)};e.getBookingFromServer=function(n){u.getAnonymousBookingDetails(n).then(function(n){e.bookingInfo=n.data;e.bookingInfo.pickupDateTimeMoment&&(e.pickupDate=moment(e.bookingInfo.pickupDateTimeMoment,r.Settings.ServerDateTimeFormat),e.bookingInfo.pickupDateTimeString=e.pickupDate.format("ddd, DD MMM YYYY")+" at "+e.pickupDate.format("HH:mm A"),e.pickupDateString=e.pickupDate.format("ddd, DD MMM YYYY"),e.pickupTimeString=e.pickupDate.format("HH:mm A"));e.bookingInfo.linkedBookingCustomerId&&(e.linkedBookingPickupDate=moment(e.bookingInfo.linkedBookingPickupTime,r.Settings.ServerDateTimeFormat),e.bookingInfo.linkedBookingPickupDateTimeString=e.linkedBookingPickupDate.format("ddd, DD MMM YYYY")+" at "+e.pickupDate.format("HH:mm A"));e.bookingInfo.freeCancellationTillMoment&&(e.freeCancellationDate=moment(e.bookingInfo.freeCancellationTillMoment,r.Settings.ServerDateTimeFormat),e.bookingInfo.freeCancellationDateString=e.freeCancellationDate.format("ddd, DD MMM YYYY")+" at "+e.freeCancellationDate.format("HH:mm A"));e.mapDetails=e.bookingInfo.driverLocation&&e.bookingInfo.driverStatus===3?{from:{latLng:{lat:e.bookingInfo.driverLocation.lat,lng:e.bookingInfo.driverLocation.lng}},markerLabel:"Your Chauffeur",bookingType:2,visible:!0}:{from:e.bookingInfo.from,to:e.bookingInfo.to,bookingType:e.bookingInfo.bookingType,visible:!0};e.isLoaded=!0})};e.isCancelled=function(){return e.bookingInfo&&e.bookingInfo.state===t};e.downloadInvoice=function(){i.location.href=e.bookingInfo.downloadInvoiceUrl};e.showTermsAndConditions=function(){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><terms-and-conditions website-guid='vm.websiteGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/terms-and-conditions><\/modal-component>",resolve:{websiteGuid:function(){return e.bookingInfo.websiteGuid},parentVm:function(){return e}},controller:["$uibModalInstance","websiteGuid","parentVm",function(n,t,i){var r=this;r.websiteGuid=t;r.parentVm=i;r.modalTitle="Terms And Conditions";r.$uibModalInstance=n;r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")};r.saved=function(){r.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.cancelBooking=function(){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><client-reject-booking booking-id='vm.bookingId' modal-instance='vm.$uibModalInstance' saved='vm.saved()' dismiss='vm.dismiss()' saved='vm.saved()'><\/client-reject-booking><\/modal-component>",resolve:{bookingId:function(){return e.bookingId},bookingInfo:function(){return e.bookingInfo},parentVm:function(){return e}},controller:["$uibModalInstance","bookingInfo","bookingId","parentVm",function(n,t,i,r){var u=this;u.bookingId=i;u.parentVm=r;u.modalTitle="Cancel booking - "+t.customerId;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){u.$uibModalInstance.dismiss("cancel");r.$onInit()}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp"),t=4;n.component("viewBookingUnauthenticated",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",i],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<"},template:'<div class="row" ng-show="!vm.isLoaded"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="ng-hide" ng-show="vm.isLoaded"><div class="row"><div class="item-row col-md-3"><div><b>Pickup point:<\/b> {{vm.bookingInfo.from.address}}<\/div><div ng-show="vm.bookingInfo.from.address != vm.bookingInfo.from.addressName"><b>Pickup address:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.viaPoints"><ul class="list-unstyled m-l-md m-b-none"><li ng-repeat="viaPoint in vm.bookingInfo.viaPoints">Via: {{viaPoint.addressName}}<\/li><\/ul><\/div><\/div><div class="item-row col-md-3"><div ng-show="vm.bookingInfo.bookingType === 2"><span class="item-details"><b>Booked for:<\/b> {{vm.bookingInfo.durationInHours}} hours<\/span><\/div><div ng-show="vm.bookingInfo.bookingType !== 2"><div><b>Drop-off point:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><div ng-show="vm.bookingInfo.to.addressName != vm.bookingInfo.to.address"><b>Drop-off address:<\/b> {{vm.bookingInfo.to.address}}<\/div><\/div><\/div><div class="item-row col-md-3"><div><b>Pickup date:<\/b> {{vm.pickupDateString}}<br><b>Pickup time:<\/b> {{vm.pickupTimeString}}<\/div><\/div><div class="item-row col-md-3"><div ng-show="vm.bookingInfo.bookingType !== 2"><div ng-show="vm.bookingInfo.metricUnit == \'Miles\'"><b>Distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div ng-show="vm.bookingInfo.metricUnit == \'Kilometers\'"><b>Distance:<\/b> {{vm.bookingInfo.distanceInKilometers}} kms<\/div><div><b>Duration:<\/b> {{vm.bookingInfo.durationInMinutes}} min estimated<\/div><\/div><div ng-show="c"><div ng-show="vm.bookingInfo.metricUnit == \'Miles\'"><b>Distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div ng-show="vm.bookingInfo.metricUnit == \'Kilometers\'"><b>Distance:<\/b> {{vm.bookingInfo.distanceInKilometers}} kms<\/div><div><b>Max duration:<\/b> {{vm.bookingInfo.durationInMinutes}} min<\/div><\/div><\/div><\/div><div class="row"><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.firstName || vm.bookingInfo.passengerDetails.lastName"><i class="fa fa-user" aria-hidden="true"><\/i> <span class="item-details">{{vm.bookingInfo.passengerDetails.salutation}} {{vm.bookingInfo.passengerDetails.firstName}} {{vm.bookingInfo.passengerDetails.lastName}}<\/span><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.adultsNumber || vm.bookingInfo.passengerDetails.childrenNumber"><i class="fa fa-user" aria-hidden="true"><\/i> <span class="item-details"><b>{{vm.bookingInfo.passengerDetails.adultsNumber}}<\/b> adults - <b>{{vm.bookingInfo.passengerDetails.childrenNumber}}<\/b> children<\/span><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.largeLuggageNumber || vm.bookingInfo.passengerDetails.mediumLuggageNumber"><i class="fa fa-suitcase" aria-hidden="true"><\/i> <span class="item-details"><b>{{vm.bookingInfo.passengerDetails.largeLuggageNumber}}<\/b> large - <b>{{vm.bookingInfo.passengerDetails.mediumLuggageNumber}}<\/b> medium<\/span><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.flightNumber || vm.bookingInfo.passengerDetails.comingFrom"><i class="fa fa-plane" aria-hidden="true"><\/i> <span class="item-details"><b>{{vm.bookingInfo.passengerDetails.flightNumber}}<\/b> <span ng-show="vm.bookingInfo.passengerDetails.comingFrom">arriving from <b>{{vm.bookingInfo.passengerDetails.comingFrom}}<\/b><\/span><\/span><\/div><\/div><div class="row"><div class="col-sm-12 text-center"><button class="btn btn-default" ng-click="vm.showTermsAndConditions()">View Terms & Conditions<\/button><\/div><\/div><div class="row ng-hide" ng-show="vm.bookingInfo.linkedBookingCustomerId"><div class="col-sm-12 text-center" style="font-size: 14px; font-weight: bold;"><span ng-show="vm.bookingInfo.linkedBookingType == \'return\'">This reservation has <a ng-href="{{vm.bookingInfo.linkedBookingDetails}}">Return Booking {{vm.bookingInfo.linkedBookingCustomerId}}<\/a> on {{vm.bookingInfo.linkedBookingPickupDateTimeString}}<\/span> <span ng-show="vm.bookingInfo.linkedBookingType == \'oneway\'">This reservation is return journey for <a ng-href="{{vm.bookingInfo.linkedBookingDetails}}">Booking {{vm.bookingInfo.linkedBookingCustomerId}}<\/a><\/span><\/div><\/div><div class="row ng-hide" ng-show="!vm.isCancelled() && ((vm.bookingInfo.paymnetStatus === 3 && vm.bookingInfo.paymentMethod == \'Card\') || (vm.bookingInfo.paymnetStatus === 5 && vm.bookingInfo.paymentMethod == \'Card\') || (vm.bookingInfo.paymnetStatus === 4 && vm.bookingInfo.paymentMethod == \'Account\'))"><div class="col-sm-12 text-center m-b-xs m-t-xs"><h2 class="text-green"><i class="fa fa-check"><\/i> Your booking is confirmed<\/h2><\/div><\/div><div class="row ng-hide" ng-show="!vm.bookingInfo.hidePriceFromCustomer && !vm.isCancelled() && (vm.bookingInfo.paymnetStatus === 1 || vm.bookingInfo.paymnetStatus === 5) && vm.bookingInfo.paymentMethod == \'Card\' && vm.bookingInfo.clientPaymentUrl"><div class="col-sm-12 text-center m-b-md m-t-lg"><a href="#" class="btn btn-green m-b-md" ng-href="{{vm.bookingInfo.clientPaymentUrl}}"><i class="fa fa-credit-card"><\/i> <span ng-show="vm.bookingInfo.paymnetStatus === 1">Confirm by Card<\/span> <span ng-show="vm.bookingInfo.paymnetStatus === 5">Pay remaining<\/span> - {{vm.bookingInfo.remainingToPay | number:2}} {{vm.bookingInfo.currency}}<\/a><\/div><\/div><div class="row"><div class="col-sm-12 text-center m-b-md ng-hide" ng-show="vm.isCancelled()"><h2 class="field-validation-error">This booking was canceled<\/h2><\/div><\/div><div class="row m-t-md" ng-show="vm.bookingInfo.hasInvoiceAvailable && !vm.isCancelled()"><div class="col-sm-12 text-center"><button class="btn btn-primary" ng-click="vm.downloadInvoice()">Download Invoice<\/button><\/div><\/div><div class="row m-t-md" ng-show="!vm.isCancelled() && vm.bookingInfo.canCancel && vm.bookingInfo.state < 2"><div class="col-sm-12 text-center m-b-md" ng-show="vm.bookingInfo.freeCancellationDateString">Free cancellation till {{vm.bookingInfo.freeCancellationDateString }}<\/div><div class="col-sm-12 text-center" ng-show="vm.bookingInfo.canCancel"><button class="btn btn-primary" ng-click="vm.cancelBooking()">Cancel Booking<\/button><\/div><\/div><div class="row"><div class="col-sm-12 text-center m-b-md ng-hide" ng-show="vm.bookingInfo.driverStatus === 3"><h2 class="text-success font-bold">Your chauffeur arrived at the meeting point.<\/h2><a href="tel:" class="btn btn-success"><i class="fa fa-phone"><\/i>{{vm.bookingInfo.driverPhone}}<\/a><br><h4 class="m-t-lg" ng-show="vm.bookingInfo.driverLocation">Your chauffeur\'s location is displayed on the map below<\/h4><\/div><\/div><div class="row"><div class="col-sm-12 text-center m-b-md ng-hide" ng-show="vm.bookingInfo.state === 3"><h2 class="text-success font-bold" ng-show="vm.bookingInfo.driverStatus === 5">Your booking is complete. Thank you for using our services!<\/h2><h2 class="text-warning font-bold" ng-show="vm.bookingInfo.driverStatus === 6">Your booking is complete. Your chauffeur did not meet.<\/h2><\/div><\/div><\/div><style>\r\n    .visibleMap {\r\n        min-height: 500px;\r\n        margin-bottom: 5px;\r\n        margin-top: 30px;\r\n    }\r\n<\/style><booking-map location-info="vm.mapDetails"><\/booking-map>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.loading=!0;e.$onInit=function(){e.getBookingFromServer(e.bookingId)};e.getBookingFromServer=function(n){r.getAnonymousBookingDetails(n).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);e.bookingInfo=n.data;e.bookingInfo.pickupDateTimeMoment&&(e.pickupDate=moment(e.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),e.bookingInfo.pickupDateTimeString=e.pickupDate.format("ddd, DD MMM YYYY")+" at "+e.pickupDate.format("HH:mm A"),e.pickupDateString=e.pickupDate.format("ddd, DD MMM YYYY"),e.pickupTimeString=e.pickupDate.format("HH:mm A"));e.bookingInfo.freeCancellationTillMoment&&(e.freeCancellationDate=moment(e.bookingInfo.freeCancellationTillMoment,i.Settings.ServerDateTimeFormat),e.bookingInfo.freeCancellationDateString=e.freeCancellationDate.format("ddd, DD MMM YYYY")+" at "+e.freeCancellationDate.format("HH:mm A"));e.loading=!1})};e.cancelBooking=function(){if(e.sent=!0,!e.sending&&u.rejectBookingForm.$valid){e.sending=!0;var n={hash:e.bookingId,reason:e.model.reason,reasonDescription:e.model.reasonDescription,sendConfirmationEmailToClient:!0,sendConfirmationEmailToDriver:!0};r.cancelAnonymousBooking(n).then(function(n){e.sending=!1;n.data.success?(f.showNotification("success","Booking canceled successfully."),e.saved()):f.showNotification("error",n.data.errors[0])})}};e.closeWindow=function(){e.dismiss&&e.dismiss()}}var n=angular.module("bookingApp");n.component("clientRejectBooking",{controller:["$timeout","$window","AppSettings","bookingApi","$scope","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="ng-hide" ng-hide="vm.loading"><div><b>Pickup:<\/b> {{vm.pickupDateString}} at {{vm.pickupTimeString}}<\/div><div><b>From:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.bookingType === 2"><b>Hourly booking:<\/b> {{vm.bookingInfo.durationInHours}} hours<\/div><div ng-hide="!vm.bookingInfo.to.addressName"><b>To:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><br ng-hide="!vm.bookingInfo.to.addressName"><div class="text-center" ng-show="vm.bookingInfo.freeCancellationDateString">Free cancellation till {{vm.bookingInfo.freeCancellationDateString}}<\/div><hr><form name="rejectBookingForm" novalidate><div class="form-group" ng-class="{\'has-error\': vm.sent && rejectBookingForm.reason.$error.required}"><select class="form-control" name="reason" ng-model="vm.model.reason" required><option selected><\/option><option>No longer traveling or change of plans<\/option><option>Flight / Boat was canceled<\/option><option>Found a better price elsewhere<\/option><option>This is a duplicate booking<\/option><\/select><p style="color:red;" ng-show="vm.sent && rejectBookingForm.reason.$error.required">Please select booking rejection reason.<\/p><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && rejectBookingForm.reasonDescription.$error.required}"><textarea class="form-control" rows="5" name="reasonDescription" ng-model="vm.model.reasonDescription" placeholder="Description ..." required><\/textarea><p style="color: red;" ng-show="vm.sent && rejectBookingForm.reasonDescription.$error.required">Please describe briefly cancellation reason.<\/p><\/div><\/form><div class="text-center"><button type="submit" class="btn btn-danger m-r-sm" ng-click="vm.cancelBooking()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Cancel booking<\/button> <button type="button" class="btn btn-primary m-l-sm" ng-click="vm.closeWindow()" data-dismiss="modal">Close<\/button><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){function e(n,t){$rootScope.$broadcast("bookingFormChanged",{isValid:n,wasChangedByUser:t,bookingInfo:f.bookingInfo})}var f=this;f.$onInit=function(){f.actionButtonText||(f.actionButtonText="Check price");f.isFullPage||(f.isFullPage=!0);var n=f.bookingId?f.bookingId:"website";f.getBookingFromServer(n)};f.submitted=!1;f.mapDetails={};f.bookingInfo={guid:null,bookingType:1,selectedDuration:"Booking Duration"};f.checkPrices=function(){f.submitted=!0;var n=f.isValid();if(n){e(!1,!0);return}f.bookingInfo.lastCheckPiceTimestamp=moment();e(!0,!0);console.log(f.bookingInfo)};f.updateBookingPrice=function(n){n.pickupDateTime&&n.showPriceEditor&&r.getBookingPrice(n).then(function(n){f.priceInfo=n.data.success?n.data:null},function(){f.priceInfo=null})};f.getBookingFromServer=function(n){r.getBookingDetails(n).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);f.bookingInfo=n.data;f.duplicateBooking==="duplicate"&&(f.bookingInfo.guid=null);f.bookingInfo.selectedCarType={id:f.bookingInfo.carTypeId,name:f.bookingInfo.carClass};f.bookingInfo.selectedDuration=n.data.durationInHours?n.data.durationInHours.toString():null;f.bookingInfo.pickupDateTimeMoment&&(f.pickupDate=moment(f.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.pickupDateTime=f.pickupDate,f.bookingInfo.pickupDateTime=f.pickupDate,f.selectedPickupMinute=f.pickupDate.format("mm"),f.selectedPickupHour=f.pickupDate.format("HH"),f.bookingInfo.returnPickupDateTimeMoment&&(f.returnPickupDate=moment(f.bookingInfo.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.bookingInfo.returnPickupDateTime=f.returnPickupDate,f.selectedReturnPickupMinute=f.returnPickupDate.format("mm"),f.selectedReturnPickupHour=f.returnPickupDate.format("HH")))})};f.hasFirstNameError=function(){return f.submitted&&f.passengerForm.firstName.$invalid||f.passengerForm.firstName.$invalid&&!f.passengerForm.firstName.$pristine};f.canChangeBookingType=function(){return!f.bookingInfo.guid};f.recomputePrice=function(){n(function(){f.updateBookingPrice(f.bookingInfo)})};f.bookingInfoChanged=function(n){f.mapDetails={from:n.from,to:n.to,bookingType:n.bookingType};f.updateBookingPrice(n)};f.mapChanged=function(n){f.bookingInfo.distanceInMiles=n.distanceInMiles;f.bookingInfo.durationInMinutes=n.timeInMinutes};f.hasLastNameError=function(){return f.submitted&&f.passengerForm.lastName.$invalid||f.passengerForm.lastName.$invalid&&!f.passengerForm.lastName.$pristine};f.hasEmailRequiredError=function(){return f.submitted&&f.passengerForm.email.$error.required||f.passengerForm.email.$error.required&&!f.passengerForm.email.$pristine};f.hasEmailFormatError=function(){return f.submitted&&f.passengerForm.email.$error.email||f.passengerForm.email.$error.email&&!f.passengerForm.email.$pristine};f.hasPhoneError=function(){return f.submitted&&f.passengerForm.telephone.$invalid||f.passengerForm.telephone.$invalid&&!f.passengerForm.telephone.$pristine};f.updateBooking=function(){f.submitted=!0;n(function(){var o=f.bookingInfo.validate()&&f.passengerForm.$valid,i,e;if(!o){u.scrollElement(".has-error");return}i=f.bookingInfo.guid==null;e=i?"Save booking?":"Update booking?";u.showConfirmation(e,"").then(function(){r.updateBooking(f.bookingInfo).then(function(i){if(console.log(i),i.data.success)u.showNotification("success","Booking saved."),n(function(){i.data.returnUrl&&(t.location.href=i.data.returnUrl)},2500);else{var r=i.data.errors[0];u.showNotification("error",r)}})})})}}var n=angular.module("bookingApp");n.component("bookingFormWithoutPriceSuggestion",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<"},template:'<booking-info booking-info="vm.bookingInfo" booking-info-changed="vm.bookingInfoChanged(bookingInfo)" show-validation-errors="vm.submitted" booking-type="vm.bookingInfo.bookingType" is-full-page="true"><\/booking-info><hr><div class="booking-form margin-bottom-30" name="bookingForm"><div ng-show="vm.bookingInfo.showPriceEditor"><div class="row"><div class="col-lg-3 col-md-3 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label">Price:<\/label> <span class="pull-right" ng-show="vm.bookingInfo.showHasVat">VAT incl: <input type="checkbox" icheck name="hasVat" ng-model="vm.bookingInfo.hasVat"><\/span><div class="input-group"><span class="input-group-addon">GBP<\/span> <input type="text" class="form-control" ng-model="vm.bookingInfo.price"><\/div><div class="m-t-xs"><span ng-show="vm.bookingInfo.bookingType !== 3" class="font-bold"><span ng-show="vm.priceInfo.price">{{vm.priceInfo.price}} GBP<\/span> <span ng-show="vm.priceInfo.discountPercentage">= {{vm.priceInfo.initialPrice}} x {{vm.priceInfo.discountPercentage}}% OFF<\/span><\/span> <span ng-show="vm.bookingInfo.bookingType === 3"><span ng-show="vm.priceInfo.price">{{vm.priceInfo.price * 2}} GBP = 2 x {{vm.priceInfo.price}}<\/span> <span ng-show="vm.priceInfo.discountPercentage">(2 x {{vm.priceInfo.initialPrice}} x {{vm.priceInfo.discountPercentage}}% OFF)<\/span><\/span><div ng-show="vm.priceInfo.description">{{vm.priceInfo.description}}<\/div><\/div><div ng-show="vm.priceInfo.price">{{vm.priceInfo.distanceInMiles }} miles & {{vm.priceInfo.timeInMinutes}} min<\/div><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-12 col-xs-12"><div class="m-b" ng-class="{\'has-error\': vm.submitted && !vm.bookingInfo.selectedClient}"><label class="control-label">Client account<\/label><select class="form-control" ng-options="item as item.name for item in vm.bookingInfo.clientsList track by item.id" name="selectedClient" required ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.selectedClient"><\/select><div class="help-block ng-hide" ng-show="vm.submitted && !vm.bookingInfo.selectedClient">Please select client.<\/div><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label">Commission<\/label><div class="input-group"><span class="input-group-addon">GBP<\/span> <input type="text" class="form-control" ng-model="vm.bookingInfo.platformPrice"><\/div><\/div><\/div><div class="col-lg-3 col-md-3 col-sm-12 col-xs-12"><div class="m-b"><label class="control-label">External Ref Number<\/label><div class="input-group full-width"><input type="text" class="form-control" ng-model="vm.bookingInfo.externalRefNumber"><\/div><\/div><\/div><\/div><hr><\/div><div class="row"><div class="col-md-12"><form class="passengerForm nomargin-bottom" name="vm.passengerForm" novalidate><div class="row nomargin-bottom"><div class="col-xs-12"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input type="radio" id="passengerDetailsMrSalutation" name="passengerDetailsSalutation" value="Mr." ng-data-value="Mr." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMrSalutation">Mr.<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input type="radio" id="passengerDetailsMsSalutation" name="passengerDetailsSalutation" value="Ms." ng-data-value="Ms." ng-model="vm.bookingInfo.passengerDetails.salutation"> <label for="passengerDetailsMsSalutation">Ms.<\/label><\/div><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasFirstNameError()}"><input type="text" name="firstName" class="form-control original-style nomargin-bottom" ng-model="vm.bookingInfo.passengerDetails.firstName" placeholder="First name"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasLastNameError()}"><input type="text" name="lastName" class="form-control nomargin-bottom original-style" ng-model="vm.bookingInfo.passengerDetails.lastName" placeholder="Last Name"><\/div><\/div><\/div><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasEmailRequiredError() || vm.hasEmailFormatError()}"><input type="email" class="form-control original-style" placeholder="E-Mail" name="email" ng-model="vm.bookingInfo.passengerDetails.email"><div class="help-block ng-hide" ng-show="vm.hasEmailFormatError()">Email has invalid format.<\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group" ng-class="{\'has-error\': vm.hasPhoneError()}"><input type="tel" class="form-control original-style" placeholder="Telephone" name="telephone" ng-model="vm.bookingInfo.passengerDetails.phone"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header">Pickup info<\/h5><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.roomNumber" name="roomNumber" placeholder="Room number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.flightNumber" name="flightNumber" placeholder="Flight number"><\/div><\/div><div class="col-lg-4 col-md-4 col-sm-4 col-xs-12"><div class="form-group"><input type="text" class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.comingFrom" name="arivingFrom" placeholder="Ariving from"><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Additional Requirements<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.additionalRequirements" name="additionalRequirements" placeholder="Additional Requirements"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom"><div class="col-sm-12"><h5 class="booking-field-header" style="margin-top: 0;">Driver Instructions<\/h5><\/div><div class="col-xs-12"><div class="form-group"><textarea class="form-control original-style" ng-model="vm.bookingInfo.passengerDetails.driverInstructions" name="driverInstructions" placeholder="Driver Instructions (only assigned driver will see this)"><\/textarea><\/div><\/div><\/div><div class="row nomargin-bottom" ng-hide="vm.bookingInfo.hideAdvancedBookingControls"><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Persons<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="adultsNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.adultsNumber" name="adultsNumber" placeholder="Adults number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="childrenNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.childrenNumber" name="childrenNumber" placeholder="Children number"><\/div><\/div><\/div><\/div><div class="col-md-6"><div class="row"><div class="col-sm-12"><h5 class="booking-field-header">Luggage<\/h5><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="largeLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.largeLuggageNumber" name="largeLuggageNumber" placeholder="Large luggage number"><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group"><input id="mediumLuggageNumber" type="text" min="0" max="1000" class="form-control original-style stepper" ng-model="vm.bookingInfo.passengerDetails.mediumLuggageNumber" name="mediumLuggageNumber" placeholder="Medium luggage number"><\/div><\/div><\/div><\/div><\/div><div class="row nomargin-bottom"><\/div><\/form><\/div><\/div><br><hr ng-show="vm.bookingInfo.showPriceEditor"><booking-extra-services ng-show="vm.bookingInfo.showPriceEditor" booking-info="vm.bookingInfo"><\/booking-extra-services><div class="row get-quote-button-container text-center"><button type="submit" ng-click="vm.updateBooking()" class="get-quote-button btn btn-primary button-action red-button">{{vm.actionButtonText }}<\/button><\/div><\/div><booking-map booking-info="vm.mapDetails" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map>'})}(),function(){"use strict";function t(n,t,i){var r=this,e=3,u,f;for(r.$onInit=function(){r.actionButtonText||(r.actionButtonText="Check price");r.isFullPage||(r.isFullPage=!0);r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.selectedDuration="-1"},r.$onChanges=function(n){var t,u,f;if(n.showValidationErrors&&(r.submitted=n.showValidationErrors.currentValue),n.bookingInfo){if(t=n.bookingInfo.currentValue,!t)return;r.bookingInfo.guid=t.guid;r.bookingInfo.carClasses=r.bookingInfo.carClasses;r.bookingInfo.selectedCarType={id:t.carTypeId,name:t.carClass};r.bookingInfo.selectedPaymentOption=t.selectedPaymentOption;r.bookingInfo.paymentStatusString=t.paymentStatusString;r.bookingInfo.validate=function(){return r.isValid()};r.bookingInfo.selectedDuration=t.durationInHours?t.durationInHours.toString():"-1";t.from&&(r.origin={name:t.from.addressName},u={formatted_address:t.from.address,geometry:{location:{lat:function(){return t.from.latLng.lat},lng:function(){return t.from.latLng.lng}}}},r.originChangedHandler(u));t.to&&(r.destination={name:t.to.addressName},f={formatted_address:t.to.address,geometry:{location:{lat:function(){return t.to.latLng.lat},lng:function(){return t.to.latLng.lng}}}},r.destinationChangedHandler(f));r.bookingInfo.pickupDateTimeMoment&&(r.pickupDate=moment(t.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.pickupDateTime=r.pickupDate,r.bookingInfo.pickupDateTime=r.pickupDate,r.selectedPickupMinute=r.pickupDate.format("mm"),r.selectedPickupHour=r.pickupDate.format("HH"),r.bookingInfo.returnPickupDateTimeMoment&&(r.returnPickupDate=moment(t.returnPickupDateTimeMoment,i.Settings.ServerDateTimeFormat),r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.bookingInfo.returnPickupDateTime=r.returnPickupDate,r.selectedReturnPickupMinute=r.returnPickupDate.format("mm"),r.selectedReturnPickupHour=r.returnPickupDate.format("HH")));t.hideAdvancedBookingControls===!0&&(this.pickupDateStart=(new Date).setHours(0,0,0,0),this.returnPickupDateStart=this.pickupDateStart)}},r.pickupDate=null,r.selectedPickupHour="Hour",r.selectedPickupMinute="Minute",r.selectedReturnPickupHour="Hour",r.selectedReturnPickupMinute="Minute",r.locationOptions={country:null,watchEnter:!0},r.hourItems=[{hour:"00",text:"00 - (12 AM)"},{hour:"01",text:"01 - (1 AM)"},{hour:"02",text:"02 - (2 AM)"},{hour:"03",text:"03 - (3 AM)"},{hour:"04",text:"04 - (4 AM)"},{hour:"05",text:"05 - (5 AM)"},{hour:"06",text:"06 - (6 AM)"},{hour:"07",text:"07 - (7 AM)"},{hour:"08",text:"08 - (8 AM)"},{hour:"09",text:"09 - (9 AM)"},{hour:"10",text:"10 - (10 AM)"},{hour:"11",text:"11 - (11 AM)"},{hour:"12",text:"12 - (12 PM)"},{hour:"13",text:"13 - (1 PM)"},{hour:"14",text:"14 - (2 PM)"},{hour:"15",text:"15 - (3 PM)"},{hour:"16",text:"16 - (4 PM)"},{hour:"17",text:"17 - (5 PM)"},{hour:"18",text:"18 - (6 PM)"},{hour:"19",text:"19 - (7 PM)"},{hour:"20",text:"20 - (8 PM)"},{hour:"21",text:"21 - (9 PM)"},{hour:"22",text:"22 - (10 PM)"},{hour:"23",text:"23 - (11 PM)"}],r.minuteItems=[{minute:"00",text:"00"},{minute:"05",text:"05"},{minute:"10",text:"10"},{minute:"15",text:"15"},{minute:"20",text:"20"},{minute:"25",text:"25"},{minute:"30",text:"30"},{minute:"35",text:"35"},{minute:"40",text:"40"},{minute:"45",text:"45"},{minute:"50",text:"50"},{minute:"55",text:"55"}],r.durationItems=[],u=3;u<=24;u=u+1)f=u*10,r.durationItems.push({hours:u,text:u+" hours (max. "+f+" miles)"});r.loaded=!0;r.originChangedHandler=function(n){console.log(n);console.log(r.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());r.bookingInfo.from={addressName:r.origin.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.from.address==="United Kingdom"&&(r.bookingInfo.from.address=r.origin.name);r.raiseEvent()};r.destinationChangedHandler=function(n){r.bookingInfo.to={addressName:r.destination.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};r.bookingInfo.to.address==="United Kingdom"&&(r.bookingInfo.to.address=r.destination.name);r.raiseEvent()};r.recomputePrice=function(){t(function(){r.raiseEvent()})};r.raiseEvent=function(){var n=r.bookingInfo;n.isValid=r.isValid();r.bookingInfo.isValid=n.isValid;r.bookingInfoChanged({bookingInfo:n})};r.pickupDateChangedHandler=function(){console.log(r.pickupDate);r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());r.updatePickupDate(r.pickupDate)};r.returnPickupDateChangedHandler=function(){console.log(r.returnPickupDate);r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());r.updateReturnPickupDate(r.returnPickupDate)};r.updatePickupDate=function(n){if(n){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());var t=moment(n);r.bookingInfo.pickupDateTime.year(t.year());r.bookingInfo.pickupDateTime.month(t.month());r.bookingInfo.pickupDateTime.date(t.date());r.bookingInfo.pickupDateDisplay=t.format("dddd, DD MMM YYYY");r.raiseEvent()}};r.updateReturnPickupDate=function(n){if(n){r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());var t=moment(n);r.bookingInfo.returnPickupDateTime.year(t.year());r.bookingInfo.returnPickupDateTime.month(t.month());r.bookingInfo.returnPickupDateTime.date(t.date());r.bookingInfo.returnPickupDateDisplay=t.format("dddd, DD MMM YYYY");r.raiseEvent()}};r.returnPickupTimeChanged=function(n,t){r.bookingInfo.returnPickupDateTime&&r.bookingInfo.returnPickupDateTime._isAMomentObject||(r.bookingInfo.returnPickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.returnPickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.returnPickupDateTime.minute(t);r.bookingInfo.returnPickupTimeDisplay=r.bookingInfo.returnPickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.returnPickupTimePeriod=r.bookingInfo.returnPickupDateTime.format("A");r.raiseEvent()};r.pickupTimeChanged=function(n,t){r.bookingInfo.pickupDateTime&&r.bookingInfo.pickupDateTime._isAMomentObject||(r.bookingInfo.pickupDateTime=moment());n&&!isNaN(n)&&r.bookingInfo.pickupDateTime.hour(n);t&&!isNaN(t)&&r.bookingInfo.pickupDateTime.minute(t);r.bookingInfo.pickupTimeDisplay=r.bookingInfo.pickupDateTime.format("HH:mm (hh:mm A)");r.bookingInfo.pickupPeriod=r.bookingInfo.pickupDateTime.format("A");r.raiseEvent()};r.hasOriginError=function(){return r.submitted&&(r.origin===null||!r.origin.name||!r.bookingInfo.from||!r.bookingInfo.from.address)};r.hasBookingDurationError=function(){return r.submitted&&r.bookingInfo.bookingType===2&&(!r.bookingInfo.selectedDuration||r.bookingInfo.selectedDuration<=0)};this.hasDestinationError=function(){return r.submitted&&r.bookingInfo.bookingType!==2&&(r.destination===null||!r.destination.name||!r.bookingInfo.to||!r.bookingInfo.to.address)};this.hasPickupDateError=function(){return r.submitted&&!r.pickupDate};this.hasPickupTimeError=function(){var n=r.submitted&&(!r.selectedPickupHour||r.selectedPickupHour==="Hour"),t=r.submitted&&(!r.selectedPickupMinute||r.selectedPickupMinute==="Minute");return n||t};this.hasReturnPickupDateError=function(){return r.submitted&&!r.returnPickupDate};this.hasReturnPickupTimeError=function(){var n=r.submitted&&(!r.selectedReturnPickupHour||r.selectedReturnPickupHour==="Hour"),t=r.submitted&&(!r.selectedReturnPickupMinute||r.selectedReturnPickupMinute==="Minute");return n||t};r.hasCarClassError=function(){return r.submitted&&r.bookingInfo.selectedCarType.id<0};r.canChangeBookingType=function(){return r.bookingInfo&&!r.bookingInfo.guid};r.isValid=function(){var n=r.hasOriginError()||r.hasDestinationError()||r.hasPickupDateError()||r.hasPickupTimeError()||r.hasCarClassError()||r.hasBookingDurationError()||r.bookingInfo.bookingType===e&&(r.hasReturnPickupDateError()||r.hasReturnPickupTimeError());return!n}}var n=angular.module("bookingApp");n.component("bookingInfo",{controller:["$rootScope","$timeout","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingInfo:"<",bookingInfoChanged:"&",showValidationErrors:"<",isFullPage:"<",actionButtonText:"<"},template:'<div class="booking-form" name="bookingForm"><div class="row"><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="form-group bookingTypeCheckboxes text-left"><div class="checkbox checkbox-inline checkbox-primary"><input ng-disabled="!vm.canChangeBookingType()" type="radio" id="bookingTypeOneWay" name="bookingType" value="1" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="1"> <label for="bookingTypeOneWay">One way<\/label><\/div><div class="checkbox checkbox-inline checkbox-primary"><input ng-disabled="!vm.canChangeBookingType()" type="radio" id="bookingTypeHourly" name="bookingType" value="2" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="2"> <label for="bookingTypeHourly">Hourly<\/label><\/div><div class="checkbox checkbox-inline checkbox-primary"><input ng-disabled="!vm.canChangeBookingType()" type="radio" id="bookingTypeReturn" name="bookingType" value="3" ng-change="vm.recomputePrice()" ng-model="vm.bookingInfo.bookingType" data-ng-value="3"> <label for="bookingTypeReturn">Return<\/label><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-6 col-xs-12"><div class="row"><div class="col-sm-6 col-md-4"><div class="m-b form-group" ng-class="{\'has-error\': vm.hasCarClassError()}"><select class="form-control" ng-class="{default: vm.bookingInfo.selectedCarType.id < 0 }" ng-change="vm.recomputePrice()" ng-options="item as item.name for item in vm.bookingInfo.carClasses track by item.id" name="selectedCar" required ng-model="vm.bookingInfo.selectedCarType"><\/select><div class="help-block ng-hide" ng-show="vm.hasCarClassError()">Please select car class.<\/div><\/div><\/div><div class="col-sm-6 col-md-4"><div class="m-b form-group"><select class="form-control" ng-options="i for i in vm.bookingInfo.paymentOptions" name="selectedPaymentOption" required ng-model="vm.bookingInfo.selectedPaymentOption"><\/select><\/div><\/div><div class="col-sm-6 col-md-4"><div class="m-b form-group"><select class="form-control" ng-class="{default: vm.bookingInfo.paymentStatusString == \'NotSet\' }" ng-options="item as item for item in vm.bookingInfo.paymnetStatusesList" name="paymentStatus" required ng-model="vm.bookingInfo.paymentStatusString"><\/select><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="colBookingOrigin" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-6\':vm.isFullPage}"><div class="form-group origin-form-group" ng-class="{\'has-error\': vm.hasOriginError()}"><input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.origin.name" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasOriginError()">Pick-up location is required.<\/div><\/div><\/div><div class="colBookingDestinationOrDuration" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-6\':vm.isFullPage}"><div class="form-group ng-hide duration-form-group" ng-class="{\'has-error\': vm.hasBookingDurationError()}" ng-hide="vm.bookingInfo.bookingType != 2"><select class="form-control original-style" placeholder="Booking Duration" ng-model="vm.bookingInfo.selectedDuration" ng-class="{default: vm.bookingInfo.selectedDuration < 0 }" ng-change="vm.recomputePrice()"><option value="-1">Booking Duration<\/option><option ng-repeat="item in vm.durationItems" value="{{item.hours}}">{{item.text}}<\/option><\/select><div class="help-block ng-hide" ng-show="vm.hasBookingDurationError()">Please select booking duration.<\/div><\/div><div class="form-group destination-form-group" ng-hide="vm.bookingInfo.bookingType == 2" ng-class="{\'has-error\': vm.hasDestinationError()}"><input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Drop-off address or airport" ng-autocomplete ng-model="vm.destination.name" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasDestinationError()">Drop-off location is required.<\/div><\/div><\/div><\/div><style>\r\n        select.default {\r\n            color: darkgrey;\r\n        }\r\n\r\n        .booking-form .picker, .picker__holder {\r\n            position: fixed;\r\n        }\r\n    <\/style><div class="row pickup-datetime-row"><div class="form-group pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupDateError()}"><input type="text" class="form-control original-style" name="pickupDate" placeholder="Pickup date & time" autocomplete="off" pick-a-date="vm.pickupDate" min-date="vm.pickupDateStart" ng-model="vm.pickupDateText" update-model="vm.pickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasPickupDateError()">Please select pickup date.<\/div><\/div><div class="form-group pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupTimeError()}"><div class="row"><div class="col-xs-6 pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="pickupTimeHour" ng-model="vm.selectedPickupHour" ng-class="{default: vm.selectedPickupHour === \'Hour\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="pickupTimeMinute" ng-model="vm.selectedPickupMinute" ng-class="{default: vm.selectedPickupMinute === \'Minute\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><div class="row return-pickup-datetime-row" ng-hide="vm.bookingInfo.bookingType != 3"><div class="form-group return-pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupDateError()}"><input type="text" class="form-control original-style" name="returnPickupDate" placeholder="Return date & time" autocomplete="off" pick-a-date="vm.returnPickupDate" min-date="vm.returnPickupDateStart" ng-model="vm.returnPickupDateText" update-model="vm.returnPickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasReturnPickupDateError()">Please select return pickup date.<\/div><\/div><div class="form-group return-pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupTimeError()}"><div class="row nomargin-bottom"><div class="col-xs-6 return-pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="returnPickupTimeHour" ng-class="{default: vm.selectedReturnPickupHour === \'Hour\'}" ng-model="vm.selectedReturnPickupHour" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 return-pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="returnPickupTimeMinute" ng-class="{default: vm.selectedReturnPickupMinute === \'Minute\'}" ng-model="vm.selectedReturnPickupMinute" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasReturnPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this,o=3,s=4;e.$onInit=function(){u.getQuoteInfo(e.quoteId).then(function(n){console.log(n);e.quoteInfo=n.data;e.quoteInfo.selectedDuration="Booking Duration"});e.quoteInfo={bookingType:1,selectedDuration:"Booking Duration"}};e.isFullPage=!0;e.pickupDate=null;e.selectedPickupHour="Hour";e.selectedPickupMinute="Minute";e.selectedReturnPickupHour="Hour";e.selectedReturnPickupMinute="Minute";e.locationOptions={country:"uk",watchEnter:!0};e.hourItems=[{hour:"00",text:"00 - (12 AM)"},{hour:"01",text:"01 - (1 AM)"},{hour:"02",text:"02 - (2 AM)"},{hour:"03",text:"03 - (3 AM)"},{hour:"04",text:"04 - (4 AM)"},{hour:"05",text:"05 - (5 AM)"},{hour:"06",text:"06 - (6 AM)"},{hour:"07",text:"07 - (7 AM)"},{hour:"08",text:"08 - (8 AM)"},{hour:"09",text:"09 - (9 AM)"},{hour:"10",text:"10 - (10 AM)"},{hour:"11",text:"11 - (11 AM)"},{hour:"12",text:"12 - (12 PM)"},{hour:"13",text:"13 - (1 PM)"},{hour:"14",text:"14 - (2 PM)"},{hour:"15",text:"15 - (3 PM)"},{hour:"16",text:"16 - (4 PM)"},{hour:"17",text:"17 - (5 PM)"},{hour:"18",text:"18 - (6 PM)"},{hour:"19",text:"19 - (7 PM)"},{hour:"20",text:"20 - (8 PM)"},{hour:"21",text:"21 - (9 PM)"},{hour:"22",text:"22 - (10 PM)"},{hour:"23",text:"23 - (11 PM)"}];e.minuteItems=[{minute:"00",text:"00"},{minute:"05",text:"05"},{minute:"10",text:"10"},{minute:"15",text:"15"},{minute:"20",text:"20"},{minute:"25",text:"25"},{minute:"30",text:"30"},{minute:"35",text:"35"},{minute:"40",text:"40"},{minute:"45",text:"45"},{minute:"50",text:"50"},{minute:"55",text:"55"}];e.durationItems=[{hours:4,text:"4 hours (max. 40 miles)"},{hours:5,text:"5 hours (max. 50 miles)"},{hours:6,text:"6 hours (max. 60 miles)"},{hours:7,text:"7 hours (max. 70 miles)"},{hours:8,text:"8 hours (max. 80 miles)"},{hours:9,text:"9 hours (max. 90 miles)"},{hours:10,text:"10 hours (max. 100 miles)"},{hours:11,text:"11 hours (max. 110 miles)"},{hours:12,text:"12 hours (max. 120 miles)"},{hours:13,text:"13 hours (max. 130 miles)"},{hours:14,text:"14 hours (max. 140 miles)"},{hours:15,text:"15 hours (max. 150 miles)"},{hours:16,text:"16 hours (max. 160 miles)"},{hours:17,text:"17 hours (max. 170 miles)"},{hours:18,text:"18 hours (max. 180 miles)"},{hours:19,text:"19 hours (max. 190 miles)"},{hours:20,text:"20 hours (max. 200 miles)"},{hours:21,text:"21 hours (max. 210 miles)"},{hours:22,text:"22 hours (max. 220 miles)"},{hours:23,text:"23 hours (max. 230 miles)"},{hours:24,text:"24 hours (max. 240 miles)"}];e.loaded=!0;e.originChangedHandler=function(n){console.log(n);console.log(e.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());e.quoteInfo.from={addressName:e.origin.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};e.mapInfo={from:e.quoteInfo.from,to:e.quoteInfo.to};e.quoteInfo.from.address==="United Kingdom"&&(e.quoteInfo.from.address=e.origin.name)};e.destinationChangedHandler=function(n){e.quoteInfo.to={addressName:e.destination.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};e.mapInfo={from:e.quoteInfo.from,to:e.quoteInfo.to};e.quoteInfo.to.address==="United Kingdom"&&(e.quoteInfo.to.address=e.destination.name)};e.pickupDateChangedHandler=function(){console.log(e.pickupDate);e.quoteInfo.pickupDateTime&&e.quoteInfo.pickupDateTime._isAMomentObject||(e.quoteInfo.pickupDateTime=moment());e.updatePickupDate(e.pickupDate)};e.returnPickupDateChangedHandler=function(){console.log(e.returnPickupDate);e.quoteInfo.returnPickupDateTime&&e.quoteInfo.returnPickupDateTime._isAMomentObject||(e.quoteInfo.returnPickupDateTime=moment());e.updateReturnPickupDate(e.returnPickupDate)};e.updatePickupDate=function(n){if(n){e.quoteInfo.pickupDateTime&&e.quoteInfo.pickupDateTime._isAMomentObject||(e.quoteInfo.pickupDateTime=moment());var t=moment(n);e.quoteInfo.pickupDateTime.year(t.year());e.quoteInfo.pickupDateTime.month(t.month());e.quoteInfo.pickupDateTime.date(t.date());e.quoteInfo.pickupDateDisplay=t.format("dddd, DD MMM YYYY")}};e.updateReturnPickupDate=function(n){if(n){e.quoteInfo.returnPickupDateTime._isAMomentObject||(e.quoteInfo.returnPickupDateTime=moment());var t=moment(n);e.quoteInfo.returnPickupDateTime.year(t.year());e.quoteInfo.returnPickupDateTime.month(t.month());e.quoteInfo.returnPickupDateTime.date(t.date());e.quoteInfo.returnPickupDateDisplay=t.format("dddd, DD MMM YYYY")}};e.returnPickupTimeChanged=function(n,t){e.quoteInfo.returnPickupDateTime&&e.quoteInfo.returnPickupDateTime._isAMomentObject||(e.quoteInfo.returnPickupDateTime=moment());n&&!isNaN(n)&&e.quoteInfo.returnPickupDateTime.hour(n);t&&!isNaN(t)&&e.quoteInfo.returnPickupDateTime.minute(t);e.quoteInfo.returnPickupTimeDisplay=e.quoteInfo.returnPickupDateTime.format("HH:mm (hh:mm A)");e.quoteInfo.returnPickupTimePeriod=e.quoteInfo.returnPickupDateTime.format("A")};e.pickupTimeChanged=function(n,t){e.quoteInfo.pickupDateTime&&e.quoteInfo.pickupDateTime._isAMomentObject||(e.quoteInfo.pickupDateTime=moment());n&&!isNaN(n)&&e.quoteInfo.pickupDateTime.hour(n);t&&!isNaN(t)&&e.quoteInfo.pickupDateTime.minute(t);e.quoteInfo.pickupTimeDisplay=e.quoteInfo.pickupDateTime.format("HH:mm (hh:mm A)");e.quoteInfo.pickupPeriod=e.quoteInfo.pickupDateTime.format("A")};e.hasOriginError=function(){return e.submitted&&(e.origin==null||!e.origin.name||!e.quoteInfo.from||!e.quoteInfo.from.address)};e.hasBookingDurationError=function(){return e.submitted&&e.quoteInfo.bookingType===2&&(!e.quoteInfo.selectedDuration||e.quoteInfo.selectedDuration.length>2||e.quoteInfo.selectedDuration<=0)};this.hasDestinationError=function(){return e.submitted&&e.quoteInfo.bookingType!==2&&(e.destination==null||!e.destination.name||!e.quoteInfo.to||!e.quoteInfo.to.address)};this.hasPickupDateError=function(){return e.submitted&&!e.pickupDate};this.hasPickupTimeError=function(){var n=e.submitted&&(!e.selectedPickupHour||e.selectedPickupHour==="Hour"),t=e.submitted&&(!e.selectedPickupMinute||e.selectedPickupMinute==="Minute");return n||t};this.hasReturnPickupDateError=function(){return e.submitted&&!e.returnPickupDate};this.hasReturnPickupTimeError=function(){var n=e.submitted&&(!e.selectedReturnPickupHour||e.selectedReturnPickupHour==="Hour"),t=e.submitted&&(!e.selectedReturnPickupMinute||e.selectedReturnPickupMinute==="Minute");return n||t};this.hasEmailError=function(){return e.showEmail!==!0?!1:e.submitted&&!e.quoteInfo.email};e.hasCarClassError=function(){if(!e.quoteInfo||!e.quoteInfo.carClasses)return e.submitted;var n=Enumerable.from(e.quoteInfo.carClasses).any(function(n){return n.checked===!0});return e.submitted&&!n};e.canChangeBookingType=function(){return e.quoteInfo&&!e.quoteInfo.guid};e.isValid=function(){var n=!1;return n=e.quoteInfo.bookingType===s?e.hasCarClassError():e.hasOriginError()||e.hasDestinationError()||e.hasPickupDateError()||e.hasPickupTimeError()||e.hasCarClassError()||e.hasBookingDurationError()||e.showEmail===!0&&e.hasEmailError()||e.quoteInfo.bookingType===o&&(e.hasReturnPickupDateError()||e.hasReturnPickupTimeError()),!n};e.mapChanged=function(n){e.quoteInfo.mapDistanceInMiles=n.distanceInMiles;e.quoteInfo.mapDurationInMinutes=n.timeInMinutes};e.sendQuoteRequest=function(){e.submitted=!0;e.quoteInfo.numberOfCars||(e.quoteInfo.numberOfCars=1);var n=e.isValid();n&&(e.quoteInfo.pickupDateTimeAsString=e.quoteInfo.pickupDateTime?e.quoteInfo.pickupDateTime.format(r.Settings.ServerDateTimeFormat):null,e.quoteInfo.returnPickupDateTimeAsString=e.quoteInfo.returnPickupDateTime?e.quoteInfo.returnPickupDateTime.format(r.Settings.ServerDateTimeFormat):null,u.saveQuotationInfo(e.quoteInfo).then(function(n){var r,u;console.log(n.data);r=n.data;r.success?(f.showNotificationList("success",r.successMessages),t(function(){r.redirectUrl&&(i.location.href=r.redirectUrl)},3500)):(u=r.errors[0],f.showNotification("error",u))}))}}var n=angular.module("bookingApp");n.component("newQuote",{controller:["$rootScope","$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{quoteId:"<",showEmail:"<"},template:'<style>\r\n    .booking-form .checkbox-inline {\r\n        padding-left: 5px;\r\n        margin-left: 5px;\r\n    }\r\n<\/style><div class="booking-form" name="quotingForm"><div class="row"><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="form-group bookingTypeCheckboxes text-left"><span class="booking-type-label hidden-xs">Booking type:<\/span><div class="checkbox-inline m-r-md"><label class="checkboxLabel weight-400"><input id="bookingTypeOneWay" class="weight-400" type="radio" icheck name="bookingType" value="1" ng-disabled="!vm.canChangeBookingType()" ng-model="vm.quoteInfo.bookingType" data-ng-value="1"> <span class="m-l-xs">One way<\/span><\/label><\/div><div class="checkbox-inline m-r-md"><label class="checkboxLabel weight-400"><input id="bookingTypeHourly" class="weight-400" type="radio" icheck name="bookingType" value="2" ng-disabled="!vm.canChangeBookingType()" ng-model="vm.quoteInfo.bookingType" data-ng-value="2"> <span class="m-l-xs">Hourly<\/span><\/label><\/div><div class="checkbox-inline m-r-md hidden"><label class="checkboxLabel weight-400"><input id="bookingTypeReturn" type="radio" icheck name="bookingType" value="3" ng-disabled="!vm.canChangeBookingType()" ng-model="vm.quoteInfo.bookingType" data-ng-value="3"> <span class="m-l-xs">Return<\/span><\/label><\/div><div class="checkbox-inline m-r-md"><label class="checkboxLabel weight-400"><input id="bookingTypeOther" type="radio" icheck name="bookingType" value="4" ng-disabled="!vm.canChangeBookingType()" ng-model="vm.quoteInfo.bookingType" data-ng-value="4"> <span class="m-l-xs">Other<\/span><\/label><\/div><\/div><\/div><div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"><div class="form-group"><input title="Number of cars" type="text" placeholder="Number of cars" ng-model="vm.quoteInfo.numberOfCars" class="form-control"><\/div><\/div><\/div><div class="row" ng-hide="vm.quoteInfo.bookingType == 4"><div class="colBookingOrigin" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-6\':vm.isFullPage}"><div class="form-group origin-form-group" ng-class="{\'has-error\': vm.hasOriginError()}"><input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.origin.name" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasOriginError()">Pick-up location is required.<\/div><\/div><\/div><div class="colBookingDestinationOrDuration" ng-class="{\'col-sm-12\':!vm.isFullPage, \'col-sm-6\':vm.isFullPage}"><div class="form-group ng-hide duration-form-group" ng-class="{\'has-error\': vm.hasBookingDurationError()}" ng-hide="vm.quoteInfo.bookingType != 2"><select class="form-control original-style" placeholder="Booking Duration" ng-model="vm.quoteInfo.selectedDuration" ng-class="{default: vm.quoteInfo.selectedDuration == \'Booking Duration\' }" ng-change="vm.durationChangedHandler()"><option>Booking Duration<\/option><option ng-repeat="item in vm.durationItems" value="{{item.hours}}">{{item.text}}<\/option><\/select><div class="help-block ng-hide" ng-show="vm.hasBookingDurationError()">Please select booking duration.<\/div><\/div><div class="form-group destination-form-group" ng-hide="vm.quoteInfo.bookingType == 2" ng-class="{\'has-error\': vm.hasDestinationError()}"><input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Drop-off address or airport" ng-autocomplete ng-model="vm.destination.name" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><div class="help-block ng-hide" ng-show="vm.hasDestinationError()">Drop-off location is required.<\/div><\/div><\/div><\/div><style>\r\n        select.default { color: darkgrey; }\r\n        .booking-form .picker, .picker__holder { position: fixed; }\r\n    <\/style><div class="row pickup-datetime-row" ng-hide="vm.quoteInfo.bookingType == 4"><div class="form-group pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupDateError()}"><input type="text" class="form-control original-style" name="pickupDate" placeholder="Pickup date & time" autocomplete="off" pick-a-date="vm.pickupDate" min-date="vm.pickupDateStart" ng-model="vm.pickupDateText" update-model="vm.pickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasPickupDateError()">Please select pickup date.<\/div><\/div><div class="form-group pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasPickupTimeError()}"><div class="row"><div class="col-xs-6 pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="pickupTimeHour" ng-model="vm.selectedPickupHour" ng-class="{default: vm.selectedPickupHour === \'Hour\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="pickupTimeMinute" ng-model="vm.selectedPickupMinute" ng-class="{default: vm.selectedPickupMinute === \'Minute\'}" ng-change="vm.pickupTimeChanged(vm.selectedPickupHour, vm.selectedPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><div class="row return-pickup-datetime-row" ng-hide="vm.quoteInfo.bookingType != 3"><div class="form-group return-pickup-date-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupDateError()}"><input type="text" class="form-control original-style" name="returnPickupDate" placeholder="Return date & time" autocomplete="off" pick-a-date="vm.returnPickupDate" min-date="vm.returnPickupDateStart" ng-model="vm.returnPickupDateText" update-model="vm.returnPickupDateChangedHandler()" ng-required="true"><div class="help-block ng-hide" ng-show="vm.hasReturnPickupDateError()">Please select return pickup date.<\/div><\/div><div class="form-group return-pickup-time-form-group col-md-6" ng-class="{\'has-error\': vm.hasReturnPickupTimeError()}"><div class="row nomargin-bottom"><div class="col-xs-6 return-pickup-time-hour-form-group"><select class="form-control original-style" placeholder="Hour" name="returnPickupTimeHour" ng-class="{default: vm.selectedReturnPickupHour === \'Hour\'}" ng-model="vm.selectedReturnPickupHour" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Hour<\/option><option ng-repeat="item in vm.hourItems" value="{{item.hour}}">{{item.text}}<\/option><\/select><\/div><div class="col-xs-6 return-pickup-time-minute-form-group"><select class="form-control original-style" placeholder="Minute" name="returnPickupTimeMinute" ng-class="{default: vm.selectedReturnPickupMinute === \'Minute\'}" ng-model="vm.selectedReturnPickupMinute" ng-change="vm.returnPickupTimeChanged(vm.selectedReturnPickupHour, vm.selectedReturnPickupMinute)" style="padding-left: 5px;"><option>Minute<\/option><option ng-repeat="item in vm.minuteItems" value="{{item.minute}}">{{item.text}}<\/option><\/select><\/div><\/div><div class="help-block ng-hide" ng-show="vm.hasReturnPickupTimeError()">Please select pickup time.<\/div><\/div><\/div><div class="row"><div class="col-sm-12"><booking-map booking-info="vm.mapInfo" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map><\/div><\/div><div class="row ng-hide" ng-show="vm.quoteInfo.bookingType == 4"><div class="col-md-12"><h3>Short description:<\/h3><div class="form-group"><textarea class="form-control" rows="3" ng-model="vm.quoteInfo.description"><\/textarea><\/div><\/div><\/div><hr><div><h3>I need quotes for:<\/h3><div class="m-l-md"><span ng-repeat="(key, value) in vm.quoteInfo.carClasses"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="value.checked"> <i><\/i> <span class="m-l-xs">{{value.name}}<\/span><\/label><\/div><\/span><\/div><div ng-class="{\'has-error\': vm.hasCarClassError()}"><div class="help-block ng-hide" ng-show="vm.hasCarClassError()">Please select at least one car class.<\/div><\/div><\/div><hr><div class="row"><div class="col-sm-12"><h3>Message:<\/h3><div class="form-group"><textarea class="form-control" rows="3" ng-model="vm.quoteInfo.comments"><\/textarea><\/div><\/div><\/div><div class="row"><div class="col-sm-12 text-center"><div class="form-group m-b-md" ng-show="vm.showEmail === true" ng-class="{\'has-error\': vm.hasEmailError()}"><input title="Email where to receive quotation" type="text" placeholder="Email where to receive quotation" ng-model="vm.quoteInfo.email" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasEmailError()">Please enter email where to receive quotation result.<\/div><\/div><button class="btn btn-primary m-r-sm" ng-click="vm.sendQuoteRequest()">Send request<\/button><\/div><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.sending=!1;e.$onInit=function(){u.getQuoteInfo(e.quoteId).then(function(n){console.log(n);e.quoteInfo=n.data;e.quoteInfo.selectedDuration="Booking Duration";e.quoteInfo.pickupDateTimeAsString&&(e.quoteInfo.pickupDate=moment(e.quoteInfo.pickupDateTimeAsString,r.Settings.ServerDateTimeFormat),e.quoteInfo.returnPickupDateTimeAsString&&(e.quoteInfo.returnPickupDate=moment(e.quoteInfo.returnPickupDateTimeAsString,r.Settings.ServerDateTimeFormat)));e.mapInfo={from:e.quoteInfo.from,to:e.quoteInfo.to}});e.quoteInfo={bookingType:1,selectedDuration:"Booking Duration"}};e.displayTotal=function(n){return console.log(n),e.quoteInfo.carClasses[n].price*e.quoteInfo.numberOfCars};e.sendQuoteRequest=function(){console.log(e.quoteInfo.carClasses);var n={guid:e.quoteInfo.guid,carClasses:e.quoteInfo.carClasses};e.sending||f.showConfirmation("Send pricing to client?","").then(function(){e.sending=!0;u.setQuotationPrice(n).then(function(n){var r,u;console.log(n.data);r=n.data;r.success?(f.showNotificationList("success",r.successMessages),t(function(){r.redirectUrl&&(i.location.href=r.redirectUrl)},r.redirectAfterMs)):(u=r.errors[0],f.showNotification("error",u));e.sending=!1},function(){e.sending=!1})})}}var n=angular.module("bookingApp");n.component("respondToQuote",{controller:["$rootScope","$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{quoteId:"<"},template:'<div class="booking-form" name="quotingForm"><div class="row m-b-md"><div class="col-sm-12"><div class="row"><div class="col-md-4"><b>From:<\/b><div class="item-row m-l-sm"><i class="fa fa-home" aria-hidden="true"><\/i><span class="item-details m-l-sm">{{vm.quoteInfo.from.address}} ({{vm.quoteInfo.from.addressName}})<\/span><\/div><div class="item-row m-l-sm" ng-show="vm.quoteInfo.bookingType == 2"><i class="fa fa-location-arrow" aria-hidden="true"><\/i> <span class="item-details m-l-sm">Hourly booking for <b>{{vm.quoteInfo.mapDurationInMinutes/60}}<\/b> hours<\/span><\/div><div class="item-row m-l-sm" ng-show="vm.quoteInfo.bookingType == 1 || vm.quoteInfo.bookingType == 3"><i class="fa fa-map-marker" aria-hidden="true"><\/i> <span class="item-details m-l-sm">{{vm.quoteInfo.to.address}} ({{vm.quoteInfo.to.addressName}})<\/span><\/div><div ng-show="vm.quoteInfo.description"><b>Description:<\/b><div class="item-row m-l-sm"><span class="item-details m-l-sm">{{vm.quoteInfo.description}}<\/span><\/div><\/div><\/div><div class="col-md-4"><div ng-show="vm.quoteInfo.pickupDateTimeAsString"><b>Pickup:<\/b><div class="item-row m-l-sm"><i class="fa fa-calendar" aria-hidden="true"><\/i><span class="item-details m-l-sm"><b>{{vm.quoteInfo.pickupDate.format("dddd, MMMM Do YYYY")}}<\/b><\/span><\/div><div class="item-row m-l-sm"><i class="fa fa-clock-o" aria-hidden="true"><\/i><span class="item-details m-l-sm"><b>{{vm.quoteInfo.pickupDate.format("hh:mm A")}}<\/b><\/span><\/div><\/div><div ng-show="vm.quoteInfo.returnPickupDateTimeAsString"><b>Return:<\/b><div class="item-row"><i class="fa fa-calendar" aria-hidden="true"><\/i><span class="item-details m-l-sm"><b>{{vm.quoteInfo.returnPickupDate.format("dddd, MMMM Do YYYY")}}<\/b><\/span><\/div><div class="item-row"><i class="fa fa-clock-o" aria-hidden="true"><\/i><span class="item-details m-l-sm"><b>{{vm.quoteInfo.returnPickupDate.format("hh:mm A")}}<\/b><\/span><\/div><\/div><\/div><div class="col-md-4"><b>Distance/Time:<\/b><div class="item-row m-l-sm"><i class="fa fa-road" aria-hidden="true"><\/i><span class="item-details m-l-sm">{{vm.quoteInfo.mapDistanceInMiles}} miles<\/span><\/div><div class="item-row m-l-sm"><i class="fa fa-calculator" aria-hidden="true"><\/i><span class="item-details m-l-sm">{{vm.quoteInfo.mapDurationInMinutes}} min estimated duration<\/span><\/div><\/div><\/div><\/div><\/div><div class="row m-b-md" ng-show="vm.quoteInfo.numberOfCars > 1"><div class="col-sm-12 text-center text-danger"><h4>Set price per car. This quote requested {{vm.quoteInfo.numberOfCars}} cars!<\/h4><\/div><\/div><hr><div class="row m-t-lg"><div class="col-sm-12 col-md-4" ng-repeat="(key, value) in vm.quoteInfo.carClasses"><div class="panel panel-default"><div class="panel-heading"><span>{{value.name}}<\/span> <span class="pull-right">(<b>{{value.suggestedPrice}}<\/b> GBP)<\/span><\/div><div class="panel-body"><div class="input-group"><input type="text" class="form-control" ng-model="value.price" ng- placeholder="Set value"> <span class="input-group-btn"><button type="button" class="btn btn-primary" tabindex="-1" ng-click="value.price = null"><i class="fa fa-ban" aria-hidden="true"><\/i> Clear<\/button><\/span><\/div><div class="font-bold" ng-show="vm.quoteInfo.numberOfCars > 1">{{vm.quoteInfo.numberOfCars}} cars X {{value.price}} = {{vm.displayTotal(key)}} GBP total<\/div><\/div><\/div><\/div><\/div><div class="row m-t-md m-b-lg"><div class="col-sm-12 text-center"><button class="btn btn-primary m-r-sm" ng-class="{\'show-loader\': vm.sending }" ng-click="vm.sendQuoteRequest()"><i class="fa fa-spinner fa-pulse fa-fw" ng-hide="!vm.sending"><\/i> <i class="fa fa-floppy-o" ng-hide="vm.sending" aria-hidden="true"><\/i> Set Prices<\/button><\/div><\/div><div class="row"><div class="col-md-12 m-t-md"><div><booking-map booking-info="vm.mapInfo" map-changed="vm.mapChanged(bookingInfo)"><\/booking-map><\/div><\/div><\/div><\/div>'})}(),function(){"use strict";var n="bookingMap.loaded",t=angular.module("bookingApp"),i=function(t,i,r){function e(n){u.bookingInfo&&u.bookingInfo.visible&&(u.mapInfo.map||(u.mapInfo.map=new google.maps.Map(s[0],{zoom:15,disableDefaultUI:!0,draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!0,center:n})))}function f(){var t,i;if(u.bookingInfo){if(t=u.bookingInfo.from.latLng!=null&&u.bookingInfo.from.latLng.lat!==0&&u.bookingInfo.from.latLng.lng!==0?u.bookingInfo.from.latLng:u.bookingInfo.from.address,e(t),u.bookingInfo.bookingType===2){u.mapInfo.directionsDisplay.setMap(null);u.mapInfo.map.setZoom(15);u.mapInfo.map.setCenter(t);i=new google.maps.Marker({position:t,map:u.mapInfo.map,label:u.bookingInfo.markerLabel});u.bookingInfo.markerLabel&&(u.mapInfo.map.zoomControl=!0,u.mapInfo.map.draggable=!0);o(n);u.visible=!0;r(function(){google.maps.event.trigger(u.mapInfo.map,"resize")},900);return}if(u.bookingInfo.to){var f=u.bookingInfo.to.latLng!=null&&u.bookingInfo.to.latLng.lat!==0&&u.bookingInfo.to.latLng.lng!==0?u.bookingInfo.to.latLng:u.bookingInfo.to.address,s=u.mapInfo.directionsService,l=u.mapInfo.directionsDisplay;u.visible=!0;s.route({origin:t,destination:f,travelMode:google.maps.TravelMode.DRIVING},function(t,i){i==="OK"?(u.currentPosition=t,u.mapInfo.directionsDisplay.setMap(u.mapInfo.map),o(n),r(function(){l.setDirections(t);google.maps.event.trigger(u.mapInfo.map,"resize");var n=t.routes[0].legs[0].distance.value,i=t.routes[0].legs[0].duration.value;u.bookingInfo.distanceInMiles=h(n);u.bookingInfo.timeInMinutes=c(i);u.mapChanged({bookingInfo:u.bookingInfo});r(function(){google.maps.event.trigger(u.mapInfo.map,"resize")},500)},500)):window.alert("Directions request failed due to "+i)})}}}function h(n){return Math.floor(n*.000621371192)}function c(n){return Math.floor(n/60)}function o(n){t.$broadcast(n,{})}var u=this,s=angular.element(i[0].childNodes[0]);u.visible=!1;u.$onInit=function(){(u.mapInfo={},u.mapInfo.directionsDisplay=new google.maps.DirectionsRenderer,u.mapInfo.directionsService=new google.maps.DirectionsService,e(),u.bookingInfo)&&u.bookingInfo.from&&f()};u.$onChanges=function(n){if(n.locationInfo){if(u.bookingInfo=n.locationInfo.currentValue,!u.bookingInfo||!u.bookingInfo.from)return;f();u.bookingInfo.bookingType===2&&r(function(){f()},1200)}}};t.component("bookingMap",{controller:["$rootScope","$element","$timeout",i],controllerAs:"vm",bindings:{locationInfo:"<",mapChanged:"&"},template:'<div ng-class="{visibleMap: vm.visible}" style="height: 100%;"><\/div>'})}(),function(){"use strict";function t(){var n=this;n.basicProfile={}}var n=angular.module("bookingApp");n.component("profile",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",template:'<basic-profile model="vm.basicProfile"><\/basic-profile><companyinvoiceinfo><\/companyinvoiceinfo>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getUserAccount("currentUser").then(function(n){f.initProfile(n.data)})};f.initProfile=function(n){f.profile={email:n.email,firstName:n.firstName,lastName:n.lastName,phoneNumber:n.phoneNumber,guid:n.guid,userGuid:n.userGuid,discountPercentage:n.discountPercentage};f.profileForm.$setPristine();f.profileForm.$setUntouched()};f.updateProfile=function(){r.updateUserAccount(f.profile).then(function(n){u.showNotification("success","Profile saved.");f.initProfile(n.data)})}}var n=angular.module("bookingApp");n.component("basicProfile",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{model:"<"},template:'<form name="vm.profileForm" class="form-horizontal"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.profileForm.email.$pristine }"><label class="col-sm-2 control-label">Email<\/label><div class="col-sm-10"><input name="email" ng-model="vm.profile.email" type="text" placeholder="john@company.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.profileForm.firstName.$pristine }"><label class="col-sm-2 control-label">First Name<\/label><div class="col-sm-10"><input name="firstName" ng-model="vm.profile.firstName" type="text" placeholder="John" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.profileForm.lastName.$pristine }"><label class="col-sm-2 control-label">Last Name<\/label><div class="col-sm-10"><input type="text" name="lastName" ng-model="vm.profile.lastName" placeholder="Smith" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.profileForm.phoneNumber.$pristine }"><label class="col-sm-2 control-label">Phone Number<\/label><div class="col-sm-10"><input type="text" name="phoneNumber" ng-model="vm.profile.phoneNumber" placeholder="+44749093345" class="form-control"><\/div><\/div><div class="form-group" ng-show="vm.profile.discountPercentage > 0"><label class="col-sm-2 control-label">Discount:<\/label><div class="col-sm-10 text-green" style="padding-top: 6px;">You have <b>{{vm.profile.discountPercentage}}% discount<\/b> from regular price.<\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.profileForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateProfile()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.initProfile()">Cancel<\/button><\/div><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t){var i=this;i.$onInit=function(){n.getUserAccountCompanyInvoiceInfo("currentUser").then(function(n){i.initCompanyInvoiceInfo(n.data)})};i.initCompanyInvoiceInfo=function(n){i.invoiceInfo={id:n.id,userGuid:n.userGuid,companyName:n.companyName,streetAddress:n.streetAddress,additionalAddress:n.additionalAddress,zipCode:n.zipCode,city:n.city,isCompanyInvoice:n.isCompanyInvoice.toString(),costCenter:n.costCenter};i.invoiceInfoForm.$setPristine();i.invoiceInfoForm.$setUntouched()};i.updateCompanyInvoiceInfo=function(){n.updateUserCompanyInvoiceInfo(i.invoiceInfo).then(function(n){t.showNotification("success","Invoice information saved.");i.initCompanyInvoiceInfo(n.data)})}}var n=angular.module("bookingApp");n.component("companyInvoiceInfo",{controller:["bookingApi","htmlPageService",t],controllerAs:"vm",template:'<form name="vm.invoiceInfoForm" class="form-horizontal"><div class="ibox-content profile-content"><div class="form-group"><label class="col-sm-2 control-label">Invoice Type<\/label><div class="col-sm-10"><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.invoiceInfo.isCompanyInvoice" value="false" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Use personal details<\/span><\/label><\/div><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.invoiceInfo.isCompanyInvoice" value="true" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Company details<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.companyName.$pristine }"><label class="col-sm-2 control-label">Company Name<\/label><div class="col-sm-10"><input name="companyName" ng-model="vm.invoiceInfo.companyName" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" type="text" placeholder="Private Company Ltd" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.streetAddress.$pristine }"><label class="col-sm-2 control-label">Street Address<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.invoiceInfo.streetAddress" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" type="text" placeholder="10 Oxford St" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.additionalAddress.$pristine }"><label class="col-sm-2 control-label">Additional address<\/label><div class="col-sm-10"><input type="text" name="additionalAddress" ng-model="vm.invoiceInfo.additionalAddress" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" placeholder="Hammersmith" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.zipCode.$pristine }"><label class="col-sm-2 control-label">Zip Code<\/label><div class="col-sm-10"><input type="text" name="zipCode" ng-model="vm.invoiceInfo.zipCode" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" placeholder="W1D 1BS" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.city.$pristine }"><label class="col-sm-2 control-label">City<\/label><div class="col-sm-10"><input type="text" name="city" ng-model="vm.invoiceInfo.city" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" placeholder="London" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceInfoForm.costCenter.$pristine }"><label class="col-sm-2 control-label">Cost Centre<\/label><div class="col-sm-10"><input type="text" name="costCenter" ng-model="vm.invoiceInfo.costCenter" ng-disabled="vm.invoiceInfo.isCompanyInvoice == \'false\'" placeholder="GB06C23MGTX" class="form-control"><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.invoiceInfoForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateCompanyInvoiceInfo()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.initCompanyInvoiceInfo()">Cancel<\/button><\/div><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t){var i=this;i.$onInit=function(){i.initUserPassword(i.userGuid)};i.initUserPassword=function(n){i.submitted=!1;i.passwordInfo={userGuid:n}};i.hasCurrentPasswordError=function(){return i.submitted&&!i.passwordInfo.currentPassword};i.hasNewPasswordError=function(){return i.submitted&&(!i.passwordInfo.newPassword||i.passwordInfo.newPassword.length<6)};i.hasConfirmPasswordError=function(){return i.submitted&&i.passwordInfo.newPassword!==i.passwordInfo.confirmNewPassword};i.changeUserPassword=function(){i.submitted=!0;var r=i.hasCurrentPasswordError()||i.hasNewPasswordError();r||n.changeUserPassword(i.passwordInfo).then(function(n){var u,f,r;if(console.log(n.data),n.data.success)t.showNotification("success","Password changed."),i.initUserPassword(i.userGuid);else{for(u="Password change failed.",f=n.data.errors.length,r=0;r<f;r++)u+="<br> - "+n.data.errors[r];t.showNotification("error",u)}})}}var n=angular.module("bookingApp");n.component("changePassword",{controller:["bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<"},template:'<form name="vm.changePasswordForm" class="form-horizontal"><div class="ibox-content changePassword-content"><div class="form-group" ng-class="{\'has-error\': vm.hasCurrentPasswordError()}"><label class="col-sm-2 control-label">Current Password<\/label><div class="col-sm-10"><input name="currentPassword" ng-model="vm.passwordInfo.currentPassword" type="password" placeholder="Current Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasCurrentPasswordError()">Current password is required<\/div><\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.hasNewPasswordError()}"><label class="col-sm-2 control-label">New Password<\/label><div class="col-sm-10"><input name="newPassword" ng-model="vm.passwordInfo.newPassword" type="password" placeholder="New Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasNewPasswordError()">New password must have at least 6 characters<\/div><\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.hasConfirmPasswordError()}"><label class="col-sm-2 control-label">Confirm New Password<\/label><div class="col-sm-10"><input name="confirmNewPassword" ng-model="vm.passwordInfo.confirmNewPassword" type="password" placeholder="Confirm New Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasConfirmPasswordError()">New password and confirm password do not match<\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.changePasswordForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.changeUserPassword()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.initUserPassword()">Cancel<\/button><\/div><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){u.getWebsiteUsers(f.websiteGuid).then(function(n){n.data.success&&(f.users=n.data.result)})};f.$onChanges=function(){};f.editUser=function(n){var t="/users/edit/";n&&(t=t+n);i.open(t,"_blank")};f.deleteUser=function(n){var t=n.guid;r.showConfirmation("Delete account?","").then(function(){u.deleteUser(n).then(function(n){n.data.success?(f.removeUser(t),r.showNotification("success","Client removed.")):r.showNotification("error",n.data.errors[0])})})};f.loginAsUser=function(n,t){r.showConfirmation("Login as user: "+t+" ?","").then(function(){u.loginAsUser(n).then(function(n){n.data.success?(r.showNotification("success","You are now logged in as "+t),i.location.href="/"):r.showNotification("error",n.data.errors[0])})})};f.removeUser=function(n){for(var t=0;t<f.users.length;t++)f.users[t].guid===n&&(f.users.splice(t,1),t--);return this}}var n=angular.module("bookingApp");n.component("applicationUsers",{controller:["$scope","$http","$window","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{searchText:"<",websiteGuid:"<"},template:'<div class="input-group m-b-lg"><input type="text" ng-model-options="{ debounce: 500 }" ng-model="searchText" placeholder="Search account" class="input form-control"> <span class="input-group-btn"><button type="button" class="btn btn btn-primary"><i class="fa fa-search"><\/i> Search<\/button><\/span><\/div><div class="table-responsive"><table class="table table-striped table-hover"><tbody><tr ng-repeat="user in vm.users | filter:searchText"><td>{{user.firstName}} {{user.lastName}}<\/td><td>{{user.companyName}}<\/td><td class="contact-type"><i class="fa fa-envelope"><\/i><\/td><td>{{user.email}}<\/td><td class="contact-type"><i class="fa fa-phone"><\/i><\/td><td>{{user.phoneNumber}}<\/td><td class="text-right"><button ng-show="user.canLogin" class="btn btn-primary m-r-xs" ng-click="vm.loginAsUser(user.guid, user.email)"><i class="fa fa-external-link" aria-hidden="true"><\/i> Login As<\/button> <button class="btn btn-primary m-r-xs" ng-click="vm.editUser(user.guid)"><i class="fa fa-pencil-square-o" aria-hidden="true"><\/i> Edit<\/button> <button ng-show="user.canRemove" class="btn btn-danger m-l-xs" ng-click="vm.deleteUser(user)"><i class="fa fa-trash-o" aria-hidden="true"><\/i> Remove<\/button><\/td><\/tr><\/tbody><\/table><\/div>'})}(),function(){"use strict";function u(t,u,f,e,o,s,h){var c=this;c.utcNow=moment.utc();c.showAll=!1;c.$onInit=function(){c.showAll=!1;c.sendDriverLocation();c.getBookingFromServer(c.bookingId)};c.getBookingFromServer=function(n){o.getAnonymousDriverBookingDetails(n).then(function(n){c.bookingInfo=n.data;c.bookingInfo.pickupDateTimeMoment&&(c.pickupDate=moment(c.bookingInfo.pickupDateTimeMoment,e.Settings.ServerDateTimeFormat),c.bookingInfo.pickupDateTimeString=c.pickupDate.format("ddd, DD MMM YYYY")+" at "+c.pickupDate.format("HH:mm A"),c.pickupDateString=c.pickupDate.format("ddd, DD MMM YYYY"),c.pickupTimeString=c.pickupDate.format("HH:mm A"));c.bookingInfo.gmtPickupDateTimeMoment&&(c.gmtPickupDate=moment.utc(c.bookingInfo.gmtPickupDateTimeMoment,e.Settings.ServerDateTimeFormat));c.bookingInfo.freeCancellationTillMoment&&(c.freeCancellationDate=moment(c.bookingInfo.freeCancellationTillMoment,e.Settings.ServerDateTimeFormat),c.bookingInfo.freeCancellationDateString=c.freeCancellationDate.format("ddd, DD MMM YYYY")+" at "+c.freeCancellationDate.format("HH:mm A"));c.mapDetails={from:c.bookingInfo.from,to:c.bookingInfo.to,bookingType:c.bookingInfo.bookingType}})};c.displayTimeLeft=function(){if(!c.gmtPickupDate)return"";var n=moment.duration(c.gmtPickupDate.diff(c.utcNow)),t="";return n.days()!==0&&(t+=n.days()+" day",n.days()>1&&(t+="s"),t+=" "),n.hours()!==0&&(t+=n.hours()+" hour",n.hours()>1&&(t+="s"),t+=" "),n.minutes()!==0&&(t+=n.minutes()+" minute",n.minutes()>1&&(t+="s")),t};c.isCancelled=function(){return c.bookingInfo&&c.bookingInfo.state===i&&!c.bookingInfo.bidLost};c.showMeetAndGreet=function(){return c.bookingInfo&&c.bookingInfo.acceptanceStatus===n&&!c.bookingInfo.bidLost};c.showTimeLeft=function(){return c.bookingInfo?(c.bookingInfo.acceptanceStatus===n||c.bookingInfo.acceptanceStatus===0)&&c.bookingInfo.onRouteStatus<=r:!1};c.downloadInvoice=function(){f.location.href=c.bookingInfo.downloadInvoiceUrl};c.acceptBooking=function(){var n={hash:c.bookingId},t;c.driverPosition&&(n.location=c.driverPosition);c.driverAddress&&(n.driverAddress=c.driverAddress);c.bookingInfo.isBid?(c.driverRequestedPriceError=!c.driverRequestedPrice,c.driverRequestedPriceExceededError=c.driverRequestedPrice&&c.driverRequestedPrice>c.bookingInfo.maxAcceptedPrice,c.driverRequestedPriceError||c.driverRequestedPriceExceededError||(n.price=c.driverRequestedPrice,c.sendDriverQuote(n))):(t=c.bookingInfo.driverPayment>0?"Please note that your payment will be "+c.bookingInfo.driverPayment+" "+c.bookingInfo.currencyCode:"",h.showConfirmation("Accept booking?",t).then(function(){o.driverAnonymousAcceptBooking(n).then(function(n){n.data.success?(h.showNotificationList("success",n.data.successMessages),c.$onInit()):h.showNotification("error",n.data.errors[0])})}))};c.sendDriverQuote=function(n){var t=n.price>0?"Please note that in case you win, your payment will be "+n.price+" "+c.bookingInfo.currencyCode:"";h.showConfirmation("Send requested price?",t).then(function(){o.driverAnonymousAcceptBooking(n).then(function(n){n.data.success?(h.showNotificationList("success",n.data.successMessages),c.$onInit()):h.showNotification("error",n.data.errors[0])})})};c.setOnRouteStatus=function(n){c.getDriverLocation().then(function(){c.setOnRouteStatusInner(n)})};c.sendDriverLocation=function(){c.getDriverLocation().then(function(){if(c.driverPosition){var n={hash:c.bookingId,status:0,location:c.driverPosition};o.setOnRouteStatus(n)}})};c.setOnRouteStatusInner=function(n){var t=null;n===2&&(t="New status will be - I am heading to pickup address");n===3&&(t="New status will be - I arrived at pickup address. \n Passenger will receive notification");n===4&&(t="New status will be - I got passenger on board.");n===5&&(t="New status will be - I dropped passenger. \n Booking will be complete.");h.showConfirmation("Change status?",t).then(function(){var t={hash:c.bookingId,status:n};c.driverPosition&&(t.location=c.driverPosition);c.driverAddress&&(t.driverAddress=c.driverAddress);o.setOnRouteStatus(t).then(function(n){n.data.success?(h.showNotificationList("success",n.data.successMessages),c.$onInit()):h.showNotification("error",n.data.errors[0])})})};c.navigateToLocation=function(n){s.open({template:'<modal-component dismiss=\'vm.dismiss()\' title-expr=\'vm.modalTitle\'><ul class="list-unstyled"><li class="m-b-lg text-center" style="list-style-type: none;"><a ng-href="{{vm.googleAddress}}" style="min-width: 200px;" href="#" target="_blank" class="btn btn-primary">Open in Google Maps<\/a><\/li><li class="text-center" style="list-style-type: none;"><a style="min-width: 200px;" ng-href="{{vm.wazeAddress}}" href="#" target="_blank" class="btn btn-primary">Open in Waze<\/a><\/li><\/ul><\/modal-component>',resolve:{modalTitle:function(){return"Navigate to address: "+n}},controller:["$uibModalInstance","modalTitle",function(t,i){var r=this;r.$uibModalInstance=t;r.modalTitle=i;r.googleAddress="https://www.google.com/maps/search/?api=1&query="+n;r.wazeAddress="https://waze.com/ul?q="+n;r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm",size:"sm",windowClass:"animated fadeIn"})};c.showHideAllStatuses=function(){c.showAll=!c.showAll};c.rejectBooking=function(){s.open({template:'<div class="modal-header"><button type="button" ng-click="vm.dismiss()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Reject booking - {{vm.bookingInfo.customerId}}<\/h4><\/div><div class="modal-body"><div><b>Pickup Date:<\/b> {{vm.bookingInfo.pickupDateTimeString}}<\/div><div><b>From:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.bookingType === 2"><b>Hourly booking:<\/b> {{vm.bookingInfo.durationInHours}} hours<\/div><div ng-hide="!vm.bookingInfo.to.addressName"><b>To:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><br ng-hide="!vm.bookingInfo.to.addressName"><hr><form name="rejectBookingForm" novalidate><div class="form-group" ng-class="{\'has-error\': vm.sent && rejectBookingForm.reason.$error.required}"><select class="form-control" name="reason" ng-model="vm.model.reason" required><option selected><\/option><option>I have another booking at this time<\/option><option>I need higher payment<\/option><option>Other reason<\/option><\/select><p style="color:red;" ng-show="vm.sent && rejectBookingForm.reason.$error.required">Please select booking rejection reason.<\/p><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && rejectBookingForm.reasonDescription.$error.required}"><textarea class="form-control" rows="5" name="reasonDescription" ng-model="vm.model.reasonDescription" placeholder="Description ..."><\/textarea><\/div><\/form><div class="text-center"><button type="submit" class="btn btn-danger m-r-sm" ng-click="vm.rejectBooking()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Reject booking<\/button> <button type="button" class="btn btn-primary m-l-sm" ng-click="vm.dismiss()" data-dismiss="modal">Close<\/button><\/div><\/div>',resolve:{bookingInfo:function(){return c.bookingInfo},parentVm:function(){return c}},controller:["$uibModalInstance","bookingInfo","parentVm",function(n,t,i){var r=this;r.bookingInfo=t;r.parentVm=i;r.$uibModalInstance=n;r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")};r.rejectBooking=function(){if(this.sent=!0,r.model.reason){var n={hash:i.bookingId};r.parentVm.driverPosition&&(n.location=r.parentVm.driverPosition);r.parentVm.driverAddress&&(n.driverAddress=r.parentVm.driverAddress);o.driverAnonymousRejectBooking(n).then(function(n){n.data.success?(h.showNotificationList("success",n.data.successMessages),i.$onInit()):h.showNotification("error",n.data.errors[0]);r.dismiss()})}}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};c.getDriverLocation=function(){var n=t.defer();return c.driverPosition=null,navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){if(!t.coords){n.resolve();return}c.driverPosition={lat:t.coords.latitude,lng:t.coords.longitude};var i=new google.maps.Geocoder;i||n.resolve();i.geocode({location:c.driverPosition},function(t,i){i==="OK"&&t[0]&&(c.driverAddress=t[0].formatted_address);n.resolve()})},function(t){console.log(t);n.resolve()}):(console.log("Geolocation is not supported by this browser."),n.resolve()),n.promise}}var t=angular.module("bookingApp"),i=4,r=3,n=3;t.component("driverViewBooking",{controller:["$q","$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",u],controllerAs:"vm",bindings:{bookingId:"<",duplicateBooking:"<",isFullPage:"<",actionButtonText:"<"},template:'<div class="row" style="position: relative;"><div class="hidden-xs" ng-show="vm.showMeetAndGreet()" style="position: absolute; top: 0; right: 10px; z-index: 10000;"><a ng-href="{{vm.bookingInfo.meetAndGreetUrl}}" class="btn btn-success margin-bottom-20">Show Meet & Greet<\/a><\/div><div class="col-sm-12"><h1 class="inline-block">{{vm.bookingInfo.carType}} - <span class="carDescription">{{vm.bookingInfo.carTypeEquivalent}}<\/span><\/h1><\/div><div class="col-lg-12 col-sm-12" ng-show="vm.bookingInfo.bidLost"><div class="text-center"><h3>Bid for this booking finished. It was assigned to another chauffeur.<br>Thank you!<\/h3><\/div><\/div><div class="col-lg-12 col-sm-12" ng-show="!vm.bookingInfo.bidLost && (vm.bookingInfo.isAssignedDriver || vm.bookingInfo.isBid || vm.bookingInfo.isInProgress)"><div class="text-center"><h3 style="color: rgb(249, 141, 8)" ng-show="vm.showTimeLeft()"><b>{{vm.displayTimeLeft()}} left<\/b><\/h3><h4 style="color: red" ng-show="vm.bookingInfo.acceptanceStatus === 2"><b>Your rejected this booking<\/b><\/h4><h4 style="color: green" ng-show="vm.bookingInfo.driverPayment > 0"><b>Your payment for this booking is {{vm.bookingInfo.driverPayment}} {{vm.bookingInfo.currencyCode}}<\/b><\/h4><\/div><\/div><div class="col-sm-12 col-md-4 col-md-offset-4 text-center" ng-show="vm.bookingInfo.isBid && !vm.bookingInfo.bidInProgress && !vm.bookingInfo.bidLost"><h3>You are invited to bid for this booking<\/h3><p>Please fill your given price below in <b>{{vm.bookingInfo.currencyCode}}<\/b>. Maximum bid price is: <b>{{vm.bookingInfo.maxAcceptedPrice}} {{vm.bookingInfo.currencyCode}}<\/b><\/p><div class="form-group text-center"><input class="form-control text-center" type="number" ng-model="vm.driverRequestedPrice" id="driverRequestedPrice" name="driverRequestedPrice" placeholder="Your given price for booking"><p class="m-t-sm text-danger font-bold" ng-show="vm.driverRequestedPriceError">Please enter your requested price for this booking.<\/p><p class="m-t-sm text-danger font-bold" ng-show="vm.driverRequestedPriceExceededError">Given price exceeds maximum accepted price for this booking.<\/p><div class="text-center m-t-md"><button ng-click="vm.acceptBooking()" class="btn btn-success margin-bottom-20">Send Quotation<\/button><\/div><\/div><\/div><div class="col-sm-12 text-center m-t-md text-green" ng-show="vm.bookingInfo.bidInProgress && !vm.bookingInfo.bidLost"><h3>Bid in progress. You asked for {{vm.bookingInfo.driverPrice}} {{vm.bookingInfo.currencyCode}}<\/h3><p>You will receive notification as soon as operator will select bid winner.<\/p><\/div><div class="col-sm-12 text-center m-t-md" ng-show="vm.bookingInfo.bookingState <= 2 && !vm.bookingInfo.isBid && !vm.bookingInfo.bidLost"><ul class="list-unstyled list-inline"><li ng-show="vm.bookingInfo.acceptanceStatus <= 2"><button ng-click="vm.acceptBooking()" class="btn btn-success margin-bottom-20">Accept booking<\/button><\/li><li ng-show="vm.bookingInfo.acceptanceStatus !== 2 && vm.bookingInfo.onRouteStatus <= 1"><button ng-click="vm.rejectBooking()" class="btn btn-danger margin-bottom-20">Reject booking<\/button><\/li><li ng-show="vm.showAll || (vm.bookingInfo.acceptanceStatus === 3 && vm.bookingInfo.onRouteStatus <= 1)"><button ng-click="vm.setOnRouteStatus(2)" class="btn btn-success margin-bottom-20">I am heading to pickup address<\/button><\/li><li ng-show="vm.showAll || (vm.bookingInfo.acceptanceStatus === 3 && vm.bookingInfo.onRouteStatus === 2)"><button ng-click="vm.setOnRouteStatus(3)" class="btn btn-success margin-bottom-20">I arrived at pickup address<\/button><\/li><li ng-show="vm.showAll || (vm.bookingInfo.acceptanceStatus === 3 && vm.bookingInfo.onRouteStatus === 3)"><button ng-click="vm.setOnRouteStatus(4)" class="btn btn-success margin-bottom-20">Passenger on board<\/button><\/li><li ng-show="vm.showAll || (vm.bookingInfo.acceptanceStatus === 3 && vm.bookingInfo.onRouteStatus === 3)"><button ng-click="vm.setOnRouteStatus(6)" class="btn btn-danger margin-bottom-20">Passenger no show<\/button><\/li><li ng-show="vm.showAll || (vm.bookingInfo.acceptanceStatus === 3 && vm.bookingInfo.onRouteStatus === 4)"><button ng-click="vm.setOnRouteStatus(5)" class="btn btn-success margin-bottom-20">I dropped the passenger<\/button><\/li><li ng-show="vm.bookingInfo.acceptanceStatus === 3"><button ng-click="vm.showHideAllStatuses()" class="btn btn-primary margin-bottom-20">Other<\/button><\/li><\/ul><\/div><div class="col-sm-12 text-center m-t-md" ng-show="vm.isCancelled() && !vm.bookingInfo.bidLost"><h3 class="text-danger">This booking was canceled by the customer.<\/h3><\/div><div class="col-sm-12"><hr class="m-b-lg"><\/div><\/div><div class="row" ng-show="vm.bookingInfo.hasMeetAndGreet"><div class="col-sm-12 text-center"><h3 class="fw-800 text-danger">Please note that client asked for Meet & Greet service<\/h3><\/div><\/div><div class="row"><div class="item-row col-md-3"><div ng-click="vm.navigateToLocation(vm.bookingInfo.from.address)" style="cursor: pointer"><b>Pickup point:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.from.address != vm.bookingInfo.from.addressName" ng-click="vm.navigateToLocation(vm.bookingInfo.from.address)" style="cursor: pointer"><b>Pickup address:<\/b> {{vm.bookingInfo.from.address}}<\/div><small ng-click="vm.navigateToLocation(vm.bookingInfo.from.address)" class="label label-primary" style="cursor: pointer"><i class="fa fa-map-marker"><\/i> Navigate<\/small><\/div><div class="item-row col-md-3"><div ng-show="vm.bookingInfo.bookingType === 2"><span class="item-details"><b>Booked for:<\/b> {{vm.bookingInfo.durationInHours}} hours<\/span><\/div><div ng-show="vm.bookingInfo.bookingType !== 2" style="cursor: pointer"><div ng-click="vm.navigateToLocation(vm.bookingInfo.to.address)"><b>Drop-off point:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><div ng-show="vm.bookingInfo.to.addressName != vm.bookingInfo.to.address" ng-click="vm.navigateToLocation(vm.bookingInfo.to.address)"><b>Drop-off address:<\/b> {{vm.bookingInfo.to.address}}<\/div><small ng-click="vm.navigateToLocation(vm.bookingInfo.to.address)" class="label label-primary" style="cursor: pointer"><i class="fa fa-map-marker"><\/i> Navigate<\/small><\/div><\/div><div class="item-row col-md-3"><div><b>Pickup date:<\/b> {{vm.pickupDateString}}<br><b>Pickup time:<\/b> {{vm.pickupTimeString}}<\/div><\/div><div class="item-row col-md-3"><div ng-show="vm.bookingInfo.bookingType !== 2"><div><b>Distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div><b>Duration:<\/b> {{vm.bookingInfo.durationInMinutes}} min estimated<\/div><\/div><div ng-show="c"><div><b>Max distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div><b>Max duration:<\/b> {{vm.bookingInfo.durationInMinutes}} min<\/div><\/div><\/div><\/div><div class="row"><div class="item-row col-md-3"><span class="item-details" ng-show="vm.bookingInfo.passengerDetails.firstName || vm.bookingInfo.passengerDetails.lastName"><i class="fa fa-user" aria-hidden="true"><\/i> {{vm.bookingInfo.passengerDetails.salutation}} {{vm.bookingInfo.passengerDetails.firstName}} {{vm.bookingInfo.passengerDetails.lastName}}<\/span><div ng-show="vm.bookingInfo.passengerDetails.phone"><a class="m-t-sm" ng-href="tel:{{vm.bookingInfo.passengerDetails.phone}}"><i class="fa fa-phone"><\/i> Call {{vm.bookingInfo.passengerDetails.phone}}<\/a><\/div><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.adultsNumber || vm.bookingInfo.passengerDetails.childrenNumber"><i class="fa fa-user" aria-hidden="true"><\/i> <span class="item-details"><b>{{vm.bookingInfo.passengerDetails.adultsNumber}}<\/b> adults - <b>{{vm.bookingInfo.passengerDetails.childrenNumber}}<\/b> children<\/span><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.largeLuggageNumber || vm.bookingInfo.passengerDetails.mediumLuggageNumber"><i class="fa fa-suitcase" aria-hidden="true"><\/i> <span class="item-details"><b>{{vm.bookingInfo.passengerDetails.largeLuggageNumber}}<\/b> large - <b>{{vm.bookingInfo.passengerDetails.mediumLuggageNumber}}<\/b> medium<\/span><\/div><div class="item-row col-md-3" ng-show="vm.bookingInfo.passengerDetails.flightNumber || vm.bookingInfo.passengerDetails.comingFrom"><i class="fa fa-plane" aria-hidden="true"><\/i> <span class="item-details"><span ng-show="vm.bookingInfo.passengerDetails.airline">Company <b>{{vm.bookingInfo.passengerDetails.airline }}<\/b><\/span> <b>{{vm.bookingInfo.passengerDetails.flightNumber}}<\/b> <span ng-show="vm.bookingInfo.passengerDetails.comingFrom">arriving from <b>{{vm.bookingInfo.passengerDetails.comingFrom}}<\/b><\/span><\/span><\/div><\/div><div class="row" ng-show="vm.bookingInfo.passengerDetails.driverInstructions"><div class="col-sm-12"><strong>Client requirements:<\/strong> {{vm.bookingInfo.comments}}<\/div><\/div><div class="row" ng-show="vm.bookingInfo.passengerDetails.driverInstructions"><div class="col-sm-12"><strong>Driver Instructions:<\/strong> {{vm.bookingInfo.passengerDetails.driverInstructions}}<\/div><\/div><style>\r\n    .visibleMap {\r\n        min-height: 500px;\r\n        margin-bottom: 5px;\r\n        margin-top: 30px;\r\n    }\r\n\r\n    .carDescription {\r\n        font-size: 20px;\r\n        vertical-align: middle;\r\n    }\r\n<\/style><booking-map location-info="vm.mapDetails"><\/booking-map>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.allowedRegions=[];e.loading=!0;e.selectedMonth=null;e.isAutoRefresh=!1;e.selectedStatus="all";e.dateOptions={datepickerMode:"day",minMode:"day",closeOnDateSelection:!0,showWeeks:!1,startingDay:1};e.dateRangeOptions={minDate:new Date(-864e13),maxDate:new Date(864e13),eventHandlers:{"apply.daterangepicker":function(){e.dateRangeFilterChanged()}},locale:{applyLabel:"Apply",cancelLabel:"Cancel",customRangeLabel:"Custom range",separator:" -> ",format:"DD-MMM-YY"}};e.$onInit=function(){var f,o,n;e.numberOfDays=3;let i=new Date(864e13),u=new Date(-864e13);f=e.isNext?new Date:null;o=e.isNext?null:new Date;e.isCancelled?(e.dateRangeOptions.minDate=u,e.dateRangeOptions.maxDate=i):(e.dateRangeOptions.minDate=e.isNext?moment():u,e.dateRangeOptions.maxDate=e.isNext?i:moment());e.dateOptions.maxDate=o;e.dateOptions.minDate=f;n=t.localStorage.dashboardDaysFilter;n&&(e.numberOfDays=n);e.getNextBookingFromServer();r.getAllDriversAllowedAreas(e.websiteGuid).then(function(n){if(n.data.success){var i=2,t=[];e.selectedRegion={id:0,value:"All regions"};t.push(e.selectedRegion);t.push({id:-1,value:"Bookings without region"});n.data.result.forEach(function(n){t.push({id:i,value:n});i=i+1});e.allowedRegions=t}});r.getClients(e.websiteGuid).then(function(n){if(n.data.success){e.clients=[];var t={id:0,value:"All clients"};e.selectedClient=t;e.clients.push(t);n.data.result.clients.forEach(function(n){e.clients.push({id:n.id,value:n.fullName})})}})};e.filterChanged=function(n){t.localStorage.dashboardDaysFilter=n;e.numberOfDays=n;e.filterMonth=null;e.selectedMonth=null;e.bookings.items=[];e.getNextBookingFromServer()};e.toggleAutoRefresh=function(){e.isAutoRefresh=!e.isAutoRefresh};e.dateRangeFilterChanged=function(){e.dateRange.startDate&&e.dateRange.endDate&&(e.startDate=e.dateRange.startDate.format(i.Settings.ServerDateTimeFormat),e.endDate=e.dateRange.endDate.format(i.Settings.ServerDateTimeFormat),e.numberOfDays=0,e.getNextBookingFromServer())};e.regionChanged=function(){e.getNextBookingFromServer()};e.sendSmsToClient=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><message-summary booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/message-summary ><\/modal-component>",resolve:{bookingId:function(){return n.guid},modalTitle:function(){return"Send SMS Message"},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(){u.dismiss();r.$onInit();r.onChanged&&r.onChanged()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm"})};e.sendEmailQuoteToClient=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><email-summary booking-guid='vm.bookingId' message-type='\"Email_QuoteResponse_ToClient\"' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/email-summary ><\/modal-component>",resolve:{bookingId:function(){return n.guid},modalTitle:function(){return"Send Email to Client"},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(){u.dismiss();r.$onInit();r.onChanged&&r.onChanged()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],size:"lg",controllerAs:"vm"})};e.updateBooking=function(n){r.getSingleBooking(n).then(function(n){var t=n.data.result,i=e.bookings.items.findIndex(function(n){return n.guid===t.guid});i>=0&&(e.fillBookingDetails(t),e.bookings.items[i]=t)})};e.editBooking=function(n,t){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><create-booking-form booking-id='vm.bookingInfo.guid' duplicate-booking='vm.duplicateBooking' is-full-page='true' cancel-button-text='\"Close dialog\"' on-save='vm.updateBooking(itemGuid)' on-cancel='vm.dismiss()' action-button-text='\"Save Booking\"'><\/create-booking-form><\/modal-component>",resolve:{bookingInfo:function(){return n},parentVm:function(){return e}},controller:["$uibModalInstance","bookingInfo","parentVm",function(n,i,r){var u=this;u.bookingInfo=i;u.duplicateBooking=t?"duplicate":null;u.parentVm=r;u.modalTitle=t?"Add new booking":"Edit booking - "+u.bookingInfo.customerId;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.updateBooking=function(n){u.dismiss();t?r.getNextBookingFromServer():r.updateBooking(n)}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.updateBookingDriverStatus=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><update-booking-state booking-guid='vm.bookingInfo.guid' modal-instance='vm.$uibModalInstance' saved='vm.saved()'><\/update-booking-state><\/modal-component>",resolve:{bookingInfo:function(){return n},parentVm:function(){return e}},controller:["$uibModalInstance","bookingInfo","parentVm",function(n,t,i){var r=this;r.bookingInfo=t;r.parentVm=i;r.modalTitle="Booking status - "+r.bookingInfo.customerId;r.$uibModalInstance=n;r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")};r.saved=function(){i.updateBooking(r.bookingInfo.guid);r.$uibModalInstance.dismiss("cancel")}}],backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.showExtraDetails=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><view-booking-details booking-id='vm.bookingInfo.guid' modal-instance='vm.$uibModalInstance' on-edit='vm.editBooking()' on-duplicate='vm.duplicateBooking()' on-changed='vm.reloadBooking()' dismiss='vm.dismiss()' saved='vm.saved()'><\/view-booking-details><\/modal-component>",resolve:{bookingInfo:function(){return n},parentVm:function(){return e}},controller:["$uibModalInstance","bookingInfo","parentVm",function(t,i,r){var u=this;u.bookingInfo=i;u.parentVm=r;u.modalTitle="Booking details - "+u.bookingInfo.customerId;u.$uibModalInstance=t;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){r.$onInit()};u.duplicateBooking=function(){u.dismiss();r.editBooking(n,!0)};u.editBooking=function(){u.$uibModalInstance.dismiss("cancel");r.editBooking(n)};u.reloadBooking=function(){r.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.assignDriver=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><assign-driver-to-booking booking-id='vm.guid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/assign-driver-to-booking><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return"Assign driver to booking"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){t.updateBooking(i)}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.removeSupplier=function(n){f.showConfirmation("Remove Supplier?","Booking will be removed from supplier dashboard.").then(function(){r.removeSupplier(n.guid).then(function(){f.showNotification("success","Supplier removed successfully.");e.updateBooking(n.guid)},function(){f.showNotification("error","Could not remove supplier. Please try again.")})})};e.dispatchBooking=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><dispatch-booking booking-guid='vm.guid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/dispatch-booking><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return"Start booking bid - "+n.customerId}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){t.updateBooking(i);u.$uibModalInstance.dismiss("cancel")}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.viewDispatchInfo=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><view-dispatch-status booking-guid='vm.guid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/view-dispatch-status><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return"Dispatch info - "+n.customerId+" - <b class='text-danger'>"+n.totalPrice+" "+n.currency+"<\/b>"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){t.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.viewLog=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><booking-log booking-guid='vm.guid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/booking-log><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return"Dispatch info"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(){t.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.showDeleteBookingModal=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><cancel-booking booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' save='vm.saved(item)'><\/cancel-booking><\/modal-component>",resolve:{bookingId:function(){return n.guid},modalTitle:function(){return"Cancel booking - "+n.customerId},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(n){const t=r.bookings.items.findIndex(function(t){return t.guid===n});t>=0&&r.bookings.items.splice(t,1);u.dismiss()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.showPaymentStatus=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><view-booking-payments booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/view-booking-payments><\/modal-component>",resolve:{bookingId:function(){return n.guid},modalTitle:function(){return"Booking payments - "+n.customerId},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(){u.dismiss();r.$onInit();r.onChanged&&r.onChanged()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm"})};e.restoreBooking=function(n){f.showConfirmation("Restore booking?","After restore, booking will be available in dispatch dashboard or finished bookings if pickup time is passed.").then(function(){r.restoreBooking(n.guid).then(function(){f.showNotification("success","Booking restore successfully.");e.getNextBookingFromServer()},function(){f.showNotification("error","Could not restore booking. Please try again.")})})};e.getNextBookingFromServer=function(){var n,t,u;e.loading=!0;n=e.numberOfDays;!e.isNext&&n>0&&(n=-1*n);t="";e.selectedRegion&&(t=e.selectedRegion.value);u=0;e.selectedClient&&(u=e.selectedClient.id);r.getNextBookings({isCancelled:e.isCancelled,numberOfDays:n,month:e.filterMonth,year:e.filterYear,region:t,clientId:u,status:e.selectedStatus,startDate:e.startDate,endDate:e.endDate}).then(function(n){var r,t,i;for(e.loading=!1,r=JSON.stringify(n.data,null,4),e.bookings=n.data,t=0;t<e.bookings.items.length;++t)i=e.bookings.items[t],e.fillBookingDetails(i)});e.fillBookingDetails=function(n){n.isPassed=!1;n.pickupDate=moment(n.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat);n.gmtPickupDate=moment.utc(n.gmtPickupDateTimeMoment,i.Settings.ServerDateTimeFormat);n.durationInMinutes>0&&(n.estArrivalDate=moment(n.pickupDate).add(n.durationInMinutes,"minutes").format("ddd, DD MMM YYYY @ HH:mm"));n.pickupDateDisplay=n.pickupDate.year()!==moment.utc().year()?n.pickupDate.format("ddd, DD MMM YYYY"):n.pickupDate.format("ddd, DD MMM");n.pickupTimeDisplay=n.pickupDate.format("HH:mm A");n.statusClass="badge-"+n.statusClass;n.utcNow=moment.utc();n.displayTimeLeft=function(){var i,t,r,u;if(n.gmtPickupDate.diff(moment.utc())<0&&(n.isPassed=!0),i=moment.duration(this.gmtPickupDate.diff(this.utcNow)),t="",i.asSeconds()>0){if(i.asDays()>1){let n=Math.floor(i.asDays());t+=n+" day";n>2&&(t+="s");t+=" "}i.hours()>0&&(t+=i.hours()+" hr",t+=" ");i.minutes()>0&&(t+=i.minutes()+" min")}else{t="";let n=-1*Math.floor(i.asDays());n>1&&(t+=n+" day",n>2&&(t+="s"),t+=" ");r=-1*i.hours();r>0&&(t+=r+" hr",r>1&&(t+="s"),t+=" ");u=-1*i.minutes();u>0&&(t+=u+" min",u>1&&(t+="s"));t+=" ago"}return t}}}}var n=angular.module("bookingApp");n.component("bookingsTableView",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",isNext:"<",isCancelled:"<",viewTitle:"<"},template:'<div class="ibox float-e-margins"><div class="ibox-title"><h5>{{vm.viewTitle}} - {{vm.bookings.items.length}}<\/h5><div class="ibox-tools" style="cursor: default" ng-click="vm.toggleAutoRefresh()"><\/div><\/div><div class="ibox-content"><div class="row"><div class="col-sm-10 m-b-xs form-inline"><div data-toggle="buttons" class="btn-group"><label class="btn btn-sm btn-white" ng-class="{active: vm.numberOfDays == 1 }" ng-click="vm.filterChanged(1)"><input type="radio" ng-model="vm.numberOfDays" ng-value="1" ng-change="vm.filterChanged()" id="option1" name="options"> 24h<\/label> <label class="btn btn-sm btn-white" ng-class="{active: vm.numberOfDays == 2 }" ng-click="vm.filterChanged(2)"><input type="radio" ng-model="vm.numberOfDays" ng-value="2" ng-change="vm.filterChanged()" id="option2" name="options"> 48h<\/label> <label class="btn btn-sm btn-white" ng-class="{active: vm.numberOfDays == 3 }" ng-click="vm.filterChanged(3)"><input type="radio" ng-model="vm.numberOfDays" ng-value="3" ng-change="vm.filterChanged()" id="option3" name="options"> 3d<\/label> <label class="btn btn-sm btn-white" ng-class="{active: vm.numberOfDays == 7 }" ng-click="vm.filterChanged(7)"><input type="radio" ng-model="vm.numberOfDays" ng-value="7" ng-change="vm.filterChanged()" id="option4" name="options"> 7d<\/label> <label class="btn btn-sm btn-white" ng-show="!vm.isNext || vm.isCancelled" ng-class="{active: vm.numberOfDays == 30 }" ng-click="vm.filterChanged(30)"><input type="radio" ng-model="vm.numberOfDays" ng-value="30" ng-change="vm.filterChanged" id="option5" name="options"> 30d<\/label> <label class="btn btn-sm btn-white" ng-show="vm.isNext && !vm.isCancelled" ng-class="{active: vm.numberOfDays == 1000 }" ng-click="vm.filterChanged(1000)"><input type="radio" ng-model="vm.numberOfDays" ng-value="30" ng-change="vm.filterChanged" id="option6" name="options"> All<\/label><\/div><div class="input-group date m-l-sm"><input date-range-picker name="dateRange" class="form-control date-picker" placeholder="From -> To Dates" type="text" ng-change="vm.monthFilterChanged()" min="vm.dateRangeOptions.minDate" max="vm.dateRangeOptions.maxDate" ng-model="vm.dateRange" options="vm.dateRangeOptions"><\/div><div class="input-group date m-l-sm" style="max-width: 150px;"><select class="form-control" ng-options="item as item.value for item in vm.allowedRegions track by item.id" ng-change="vm.regionChanged()" ng-model="vm.selectedRegion"><\/select><\/div><div class="input-group date m-l-sm" style="max-width: 150px;"><select class="form-control" ng-options="item as item.value for item in vm.clients track by item.id" ng-change="vm.regionChanged()" ng-model="vm.selectedClient"><\/select><\/div><div class="input-group date m-l-sm" style="max-width: 150px;"><select class="form-control" ng-change="vm.regionChanged()" ng-model="vm.selectedStatus"><option value="all">All Statuses<\/option><option value="Pending">Pending<\/option><option value="Driver Pending">Driver Pending<\/option><option value="Bid In Progress">Bid In Progress<\/option><option value="Driver Accepted">Driver Accepted<\/option><option value="Driver Rejected">Driver Rejected<\/option><option value="In Progress">In Progress<\/option><option value="Finished">Finished<\/option><\/select><\/div><\/div><div class="col-sm-2"><div class="input-group"><input type="text" placeholder="Search" ng-model="searchText" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!<\/button><\/span><\/div><\/div><\/div><div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="table-responsive bookings-table-view" ng-show="!vm.loading"><table class="table table-striped"><thead><tr><th style="max-width: 50px;">Status<\/th><th>Pickup<\/th><th>Trip<\/th><th>From / To<\/th><th style="min-width: 200px;">Driver<\/th><th>Value<\/th><th>Action<\/th><\/tr><\/thead><tbody><tr ng-repeat="booking in vm.bookings.items | filter:searchText"><td style="vertical-align: middle; text-align: center; min-width: 50px;"><div class="badge" ng-class="booking.statusClass" style="padding: 6px; cursor: pointer; text-transform: uppercase; word-break: normal; white-space: pre-wrap; overflow-wrap: break-word;" ng-click="vm.updateBookingDriverStatus(booking)">{{booking.status}}<\/div><div class="text-center"><button type="button" class="btn btn-link btn-xs m-t-sm" ng-click="vm.viewLog(booking)">View Log<\/button><\/div><\/td><td style="vertical-align: middle;"><div><b>{{booking.carClassName}}<\/b><\/div><div class="nowrap"><b>{{booking.customerId}}<\/b><\/div><div class="nowrap" ng-show="booking.externalRefNumber.length > 0 && booking.externalRefNumber != booking.customerId">E: {{booking.externalRefNumber}}<\/div><div ng-show="booking.accountName"><small><b>Acc: {{booking.accountName}}<\/b><\/small><\/div><small>{{booking.customerName}}<\/small><div ng-hide="booking.isSupplierBooking"><span ng-show="booking.passengerDetails.phone"><br><button class="btn btn-xs btn-success" title="Show client phone" ng-click="booking.showPhoneNumber = !booking.showPhoneNumber"><i class="fa fa-phone" aria-hidden="true"><\/i><\/button> <button class="btn btn-xs btn-success" title="Send sms to client" ng-click="vm.sendSmsToClient(booking)"><i class="fa fa-commenting-o" aria-hidden="true"><\/i><\/button> <button class="btn btn-xs btn-success" ng-show="booking.paymentStatusString == \'Pending\'" title="Send quotation" ng-click="vm.sendEmailQuoteToClient(booking)"><i class="fa fa-mail-reply" aria-hidden="true"><\/i><\/button><\/span><br><small ng-show="booking.passengerDetails.phone && booking.showPhoneNumber" style="font-size: 14px;">{{booking.passengerDetails.phone}}<\/small><\/div><\/td><td><div>{{booking.pickupDateDisplay}} at {{booking.pickupTimeDisplay}}<\/div><div class="m-t-sm text-warning" ng-class="{\'text-green\': booking.isPassed, \'font-bold\': booking.isPassed}">{{booking.displayTimeLeft()}}<\/div><div ng-show="booking.estArrivalDate" class="m-t-md"><b>Est Arrival:<\/b><br>{{booking.estArrivalDate}}<\/div><\/td><td><div class="m-b-sm"><i class="fa fa-map-pin from-pin"><\/i> {{booking.from.address}} <span ng-show="booking.from.addressName != booking.from.address"><br>{{booking.from.addressName}}<\/span><\/div><div ng-show="booking.viaPoints"><ul class="list-unstyled m-l-md"><li ng-repeat="viaPoint in booking.viaPoints">Via: {{viaPoint.addressName}}<\/li><\/ul><\/div><div ng-show="booking.to.addressName || booking.to.address"><i class="fa fa-map-pin to-pin"><\/i> {{booking.to.address}} <span ng-show="booking.to.addressName != booking.to.address"><br>{{booking.to.addressName}}<\/span><\/div><div class="font-bold" ng-show="booking.durationInHours">Hourly for {{booking.durationInHours}} hours<\/div><div class="m-t-sm"><span ng-show="booking.metricUnit === 0" class="pull-left">Dist. {{booking.distanceInMiles}} miles<\/span> <span ng-show="booking.metricUnit === 1" class="pull-left">Dist. {{booking.distanceInKilometers}} km<\/span> <span class="m-l-lg">Est. {{booking.durationInMinutes}} min<\/span><\/div><\/td><td><div ng-show="booking.supplierName"><div>Supplier: <b>{{booking.supplierName}}<\/b><\/div><div>Id: <b>{{booking.supplierBookingCustomerId}}<\/b><\/div><div><div ng-show="booking.supplierPayment">Payment: {{booking.supplierPayment | number:2}} <span ng-class="{differentCurrency: booking.currency !== booking.supplierPaymentCurrency }">{{booking.supplierPaymentCurrency}}<\/span><\/div><\/div><div ng-hide="booking.driver" class="m-t-sm">No driver assigned yet<\/div><div class="clear" ng-show="booking.driver && booking.supplierName"><img class="driver-img pull-left" ng-src="{{booking.driver.pictureUrl}}"><div class="driver-details pull-left"><div>{{booking.driver.firstName}} {{booking.driver.lastName}}<\/div><small ng-show="booking.driver.phoneNumber" style="font-size: 14px;">{{booking.driver.phoneNumber}}<\/small><\/div><\/div><div ng-show="booking.isAdmin || booking.isDispatcher"><button type="button" class="btn btn-danger btn-xs m-t-sm" ng-click="vm.removeSupplier(booking)">Remove Supplier<\/button><\/div><\/div><div ng-show="(booking.isAdmin || booking.isDispatcher) && (!booking.driver && !booking.supplierName)"><div>No driver assigned<\/div><div><button type="button" class="btn btn-success btn-xs m-t-sm m-r-sm" ng-click="vm.assignDriver(booking)">Assign<\/button> <button type="button" class="btn btn-success btn-xs m-t-sm" ng-hide="booking.isPassed || booking.isBidInProgress || booking.driverResponses > 0" ng-click="vm.dispatchBooking(booking)">Start Bid<\/button> <button type="button" class="btn btn-danger btn-xs m-t-sm" ng-show="booking.isBidInProgress || booking.driverResponses > 0" ng-click="vm.dispatchBooking(booking)">Update Bid<\/button><\/div><div><button type="button" class="btn btn-success position-relative btn-xs m-t-sm" ng-show="!booking.isPassed && (booking.isBidInProgress || booking.driverResponses > 0)" ng-click="vm.viewDispatchInfo(booking)">View Bid <span class="button-badge" ng-show="booking.driverResponses > 0">{{booking.driverResponses}}<\/span><\/button><\/div><\/div><div class="clear" ng-show="booking.driver && !booking.supplierName"><img class="driver-img pull-left" ng-src="{{booking.driver.pictureUrl}}"><div class="driver-details pull-left"><div>{{booking.driver.firstName}} {{booking.driver.lastName}}<\/div><small ng-show="booking.driver.phoneNumber" style="font-size: 14px;">{{booking.driver.phoneNumber}}<\/small><div style="padding: 5px 0"><div ng-show="booking.driverCashCollected">Initial: {{booking.driver.driverPaymentWithExtras | number:2}} {{booking.driverCurrency}}<\/div><div class="differentCurrency" ng-show="booking.driverCashCollected">Cash: -{{booking.driverCashCollected | number:2}} {{booking.driverCurrency}}<\/div><div ng-show="booking.driver.driverRemainingPayment > 0">To pay: <span ng-class="{differentCurrency: booking.driver.driverRemainingPayment < 0 }">{{booking.driver.driverRemainingPayment | number:2}}<\/span> <span ng-class="{differentCurrency: booking.currency !== booking.driverCurrency }">{{booking.driverCurrency}}<\/span><\/div><\/div><div ng-show="booking.currency === booking.driverCurrency">Profit: {{booking.profit | number:2}} {{booking.currency}}<\/div><div ng-show="booking.showProfitIgnoringTax">Profit (no tax): {{booking.profit + booking.totalTaxes | number:2 }} {{booking.currency}}<\/div><div ng-show="booking.driver.rating">Client Rating: {{booking.driver.rating | number:2}}<\/div><button type="button" ng-show="booking.isAdmin || booking.isDispatcher" class="btn btn-success btn-xs" ng-click="vm.assignDriver(booking)">Remove / Change<\/button><\/div><\/div><\/td><td class="error"><b>{{booking.totalPrice | number : 2 }} {{booking.currency}}<\/b><div ng-show="booking.numberOfExtras > 0">{{booking.numberOfExtras}} extra<span ng-show="booking.numberOfExtras > 1">s<\/span><\/div><div class="pointer" ng-click="vm.showPaymentStatus(booking)"><b ng-class="{\'field-validation-error\': booking.paymentStatusEnum < 3, \'text-green\': booking.paymentStatusEnum >= 3 && booking.paymentStatusEnum < 5, \'text-warning\' : booking.paymentStatusEnum == 5 || booking.paymentStatusEnum == 6}"><i class="fa" ng-class="{\'fa-check\': booking.paymentStatusEnum >= 3 && booking.paymentStatusEnum <= 5, \'fa-warning\': booking.paymentStatusEnum < 3 || booking.paymentStatusEnum == 6 }"><\/i> {{booking.paymentStatusString}}<\/b><\/div><div class="m-t-sm">Source: <b>{{booking.source}}<\/b><\/div><\/td><td class="bookings-dashboard-buttons"><button type="button" class="btn btn-success btn-xs" ng-click="vm.showExtraDetails(booking)"><i class="fa fa-info" aria-hidden="true"><\/i> Details<\/button><br><button type="button" class="btn btn-success btn-xs" ng-show="!booking.isSupplierBooking && (booking.isAdmin || booking.isDataEntry)" ng-click="vm.editBooking(booking)"><i class="fa fa-edit"><\/i> Edit<\/button><div ng-hide="booking.isCancelled"><button type="button" class="btn btn-danger btn-xs" ng-click="vm.showDeleteBookingModal(booking)"><i class="fa fa-times"><\/i> Cancel<\/button><\/div><div ng-show="booking.isCancelled"><button type="button" class="btn btn-green btn-xs" ng-click="vm.restoreBooking(booking)"><i class="fa fa-times"><\/i> Restore<\/button><\/div><\/td><\/tr><\/tbody><\/table><\/div><\/div><\/div><style>\r\n    .differentCurrency {\r\n        font-weight: bold;\r\n        color: rgb(201, 51, 51);\r\n    }\r\n\r\n    .position-relative {\r\n        position: relative !important;\r\n    }\r\n\r\n    .btn .button-badge {\r\n        font-weight: bold;\r\n        position: absolute;\r\n        top: -14px;\r\n        right: -8px;\r\n        background-color: #ff0000;\r\n        border-radius: 8px;\r\n        font-size: 13px;\r\n        display: inline-block;\r\n        padding: 1px 5px;\r\n    }\r\n\r\n    .float-e-margins .btn.btn-sm {\r\n        margin-bottom: 0px;\r\n    }\r\n\r\n    /* https://stackoverflow.com/questions/29548624/bootstrap-modal-stop-scrolling-on-chrome-41-with-mouse-scroll-touchpad-but-work */\r\n    /* Temporary fix for chrome */\r\n    .modal-open .modal {\r\n        -webkit-transform: translateZ(0);\r\n        transform: translateZ(0);\r\n    }\r\n\r\n    .checkbox.checkbox-inline {\r\n        margin-top: 0;\r\n    }\r\n\r\n    .bookings-dashboard-buttons .btn {\r\n        min-width: 65px;\r\n    }\r\n\r\n    /* wrap tables on mobile devices https://stackoverflow.com/questions/21587813/bootstrap-responsive-table-content-wrapping */\r\n    .table-responsive.bookings-table-view .table tbody tr td {\r\n        white-space: pre-wrap; /* css-3 */\r\n        white-space: -moz-pre-wrap; /* Mozilla, since 1999 */\r\n        white-space: -pre-wrap; /* Opera 4-6 */\r\n        white-space: -o-pre-wrap; /* Opera 7 */\r\n        word-wrap: break-word; /* Internet Explorer 5.5+ */\r\n    }\r\n    \r\n    /*.input-group-addon {\r\n        display: none;\r\n    }*/\r\n\r\n    /*.month-picker .btn-info.active,\r\n    .month-picker .btn-default.active {\r\n        background-color: #1c84c6;\r\n        border-color: #1c84c6;\r\n        color: #FFFFFF;\r\n    }\r\n        .month-picker .btn-default.active .text-info {\r\n            color: #FFFFFF;\r\n        }*/\r\n    @media screen and (max-width: 767px) {\r\n        .table-responsive.bookings-table-view {\r\n            border: none;\r\n        }\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.isLoading=!0;u.booking={};u.$onInit=function(){var n={bookingGuid:u.bookingId,city:u.cityFilter,car:u.carFilter};r.getBookingDriversByFilter(n).then(function(n){u.model=n.data;u.getBookingDetails()},function(){i.showNotification("error","Error when getting available drivers for this booking.")})};u.filtersChanged=function(){var n={bookingGuid:u.bookingId,city:u.cityFilter,car:u.carFilter};r.getBookingDriversByFilter(n).then(function(n){u.model=n.data},function(){i.showNotification("error","Error when getting available drivers for this booking.")})};u.getBookingDetails=function(){r.getBookingBasicDetailsWithDriver(u.bookingId).then(function(n){var t,i;u.booking=n.data;u.booking.driverGuid||u.booking.supplierGuid?(t=u.model.drivers.find(function(n){return u.booking.driverGuid?n.id.toUpperCase()===u.booking.driverGuid.toUpperCase():u.booking.supplierGuid?n.id.toUpperCase()===u.booking.supplierGuid.toUpperCase():!1}),t&&(u.model.drivers.unshift({guid:"00000000-0000-0000-0000-000000000000",displayName:"REMOVE"}),u.selectedDriver=t,u.model.payToDriver=u.booking.driverPayment,u.selectedDriverChanged())):u.booking.region&&(cm.cityFilter=u.booking.region);u.booking.companyCarId&&(i=u.model.companyCars.find(function(n){return n.id===u.booking.companyCarId}),i&&(u.selectedMainCar=i,u.selectedCarChanged()));u.isLoading=!1},function(){i.showNotification("error","Error when reading booking details.")})};u.selectedDriverChanged=function(){var n,t;console.log(u.selectedDriver);u.selectedDriver&&(u.model.driverGuid=u.selectedDriver.guid);u.model.companyCars&&(u.selectedMainCar=u.model.companyCars[0]);u.selectedDriver&&u.selectedDriver.isSupplier&&(n=u.selectedDriver.carTypes.find(function(n){return n.checked}),n&&(u.selectedCarType=n,u.model.carTypeId=n.id));u.selectedDriver&&u.selectedDriver.mainCarId&&u.model.companyCars&&(t=u.model.companyCars.find(function(n){return n.id===u.selectedDriver.mainCarId}),t?(u.selectedMainCar=t,u.model.carId=t.id):(u.model.carId=u.model.companyCars[0].id,u.selectedMainCar=u.model.companyCars[0]))};u.selectedCarChanged=function(){u.selectedMainCar&&(u.model.carId=u.selectedMainCar.id)};u.selectedCarTypeChanged=function(){u.selectedCarType&&(u.model.carTypeId=u.selectedCarType.id)};u.cancel=function(){u.modalInstance.dismiss("cancel")};u.ok=function(){(u.sent=!0,!u.sending&&n.assignDriverForm.$valid)&&(u.sending=!0,n.assignDriverForm.$valid&&r.assignDriverToBooking(u.model).then(function(n){var r,t;u.sending=!1;u.modalInstance.close();n.data.success?(t="Driver assigned successfully",n.data.result.emailSentToClient&&(t+="<br> - email sent to client"),n.data.result.emailSentToDriver&&(t+="<br> - email sent to driver"),n.data.result.smsSentToDriver&&(t+="<br> - SMS sent to driver"),i.showNotification("success",t),u.saved&&u.saved()):(r=n.data.errors[0],i.showNotification("error",r))},function(){i.showNotification("error","Could not assign driver. Error occurred.");u.sending=!1}))}}var n=angular.module("bookingApp");n.component("assignDriverToBooking",{controller:["$scope","$http","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{bookingId:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.isLoading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div ng-show="!vm.isLoading"><div class="row"><div class="col-md-6"><b>Booking Id:<\/b> {{vm.booking.customerId}}<\/div><div class="col-md-6"><b>Car Class:<\/b> {{vm.booking.carClass}}<\/div><\/div><div class="row"><div class="col-md-6"><b>From:<\/b> {{vm.booking.from.address}}<\/div><div class="col-md-6"><b>To:<\/b> {{vm.booking.to.address}}<\/div><\/div><div class="row"><div class="col-md-6"><b>Est. Duration:<\/b> {{vm.booking.durationInMinutes}} minutes<\/div><div class="col-md-6"><div ng-show="vm.booking.metricUnit == \'Miles\'"><b>Distance:<\/b> {{vm.booking.distanceInMiles}} miles<\/div><div ng-show="vm.booking.metricUnit == \'Kilometers\'"><b>Distance:<\/b> {{vm.booking.distanceInKilometers}} kms<\/div><\/div><\/div><div><b>Price:<\/b> {{vm.booking.price | number:2}} {{vm.booking.currencyCode}}<\/div><hr><form name="assignDriverForm" novalidate><div class="row m-b-sm"><div class="col-md-6"><label>City/Region:<\/label> <input class="form-control" type="text" ng-model="vm.cityFilter" ng-change="vm.filtersChanged()" ng-model-options="{ debounce: 400 }"><\/div><div class="col-md-6"><label>Car:<\/label> <input class="form-control" type="text" ng-model="vm.carFilter" ng-change="vm.filtersChanged()" ng-model-options="{ debounce: 400 }"><\/div><\/div><div class="row"><div class="form-group col-sm-12"><label>Select driver ({{vm.model.drivers.length}} available):<\/label><select class="form-control" ng-options="item as item.displayName group by item.carClass for item in vm.model.drivers track by item.id" name="selectedDriver" required ng-change="vm.selectedDriverChanged()" ng-model="vm.selectedDriver"><\/select><p style="color: red; font-weight: bold;" ng-show="(assignDriverForm.selectedDriver.$error.required && vm.sent) || (assignDriverForm.selectedDriver.$touched && assignDriverForm.selectedDriver.$error.required)">Please select driver.<\/p><\/div><\/div><div class="form-group" ng-show="vm.selectedDriver.isSupplier"><label>Supplier car type:<\/label><select class="form-control" ng-options="item as item.name for item in vm.selectedDriver.carTypes" ng-change="vm.selectedCarTypeChanged()" ng-required="vm.selectedDriver.isSupplier" name="selectedCarType" ng-model="vm.selectedCarType"><\/select><p style="color: red; font-weight: bold;" ng-show="(assignDriverForm.selectedCarType.$error.required && vm.sent) || (assignDriverForm.selectedCarType.$touched && assignDriverForm.selectedCarType.$error.required)">Please select supplier car type.<\/p><\/div><div class="form-group" ng-show="vm.selectedDriver.isHired && vm.model.companyCars.length > 0"><label>Booking car:<\/label><select class="form-control" ng-options="item as item.name for item in vm.model.companyCars" ng-change="vm.selectedCarChanged()" name="selectedMainCarId" ng-model="vm.selectedMainCar"><\/select><\/div><div class="form-group" ng-show="vm.model.driverGuid != \'00000000-0000-0000-0000-000000000000\'"><label for="payAmmountToDriver">Pay driver/supplier <span ng-show="vm.selectedDriver.currency !== vm.booking.currencyCode" style="color: red; font-weight: bold;">in currency {{vm.selectedDriver.currency}}<\/span><\/label> <input class="form-control" id="payAmmountToDriver" type="number" ng-model="vm.model.payToDriver" name="payAmmountToDriver" placeholder="Amount to pay"><p style="color: red; font-weight: bold;" ng-show="(assignDriverForm.payAmmountToDriver.$error.required && vm.sent) || (assignDriverForm.payAmmountToDriver.$touched && assignDriverForm.payAmmountToDriver.$error.required)">Please set amount to pay.<\/p><\/div><div ng-class="{\'text-danger\': vm.booking.price - vm.payToDriver < 0}" ng-show="vm.selectedDriver.currency === vm.booking.currencyCode && vm.model.driverGuid != \'00000000-0000-0000-0000-000000000000\'"><p>Profit: <b>{{vm.booking.price - vm.booking.totalTaxes - vm.booking.totalExtrasExpenses - vm.model.payToDriver - vm.payToPlatform | number:2}}<\/b> {{vm.booking.currencyCode}}<\/p><p ng-show="vm.booking.showProfitIgnoringTax">Profit If No Tax: <b>{{vm.booking.price - vm.booking.totalExtrasExpenses - vm.model.payToDriver - vm.payToPlatform | number:2}}<\/b> {{vm.booking.currencyCode}}<\/p><\/div><div class="form-group"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationEmailToDriver"> <i><\/i> <span class="m-l-xs">Send confirmation email to driver<\/span><\/label><\/div><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationSmsToDriver"> <i><\/i> <span class="m-l-xs">Send confirmation SMS to driver<\/span><\/label><\/div><hr ng-show="!vm.booking.isSupplierBooking"><div class="checkbox-inline i-checks m-r-lg" ng-show="!vm.booking.isSupplierBooking"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationEmailToClient"> <i><\/i> <span class="m-l-xs">Send driver details to client by email<\/span><\/label><\/div><\/div><\/form><br><button type="button" class="btn btn-default m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-primary m-l-sm" ng-click="vm.ok()"><i class="fa fa-spinner fa-spin" ng-show="vm.sending"><\/i> Save changes<\/button><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.loading=!0;e.hasChanges=!1;e.driverAcceptanceStatuses={0:{id:0,"enum":"NotSet",text:"Not Set"},1:{id:1,"enum":"Pending",text:"Pending"},2:{id:2,"enum":"Declined",text:"Declined"},3:{id:3,"enum":"Accepted",text:"Accepted"}};e.driverDataChanged=function(){e.hasChanges=!0};e.driverOnRouteStatuses={0:{id:0,"enum":"NotSet",text:"Not Set"},1:{id:1,"enum":"NotStarted",text:"Not started"},2:{id:2,"enum":"OnMyWay",text:"Driver On Route"},3:{id:3,"enum":"WaitingForPassenger",text:"Waiting For Passenger"},4:{id:4,"enum":"PassengerOnBoad",text:"Passenger On Boad"},5:{id:5,"enum":"DroppedPassenger",text:"Dropped Passenger"},6:{id:6,"enum":"PassengerNoShow",text:"Passenger No Show"},7:{id:7,"enum":"MissedBooking",text:"Missed Booking"}};e.$onInit=function(){r.getSingleBooking(e.bookingGuid).then(function(n){e.booking=n.data.result;e.driverAcceptanceStatusText=e.driverAcceptanceStatuses[e.booking.driverAcceptanceStatus].text;e.driverOnRouteStatusText=e.driverOnRouteStatuses[e.booking.driverOnRouteStatus].text;e.driverAcceptanceStatus=e.driverAcceptanceStatuses[e.booking.driverAcceptanceStatus].id;e.driverOnRouteStatus=e.driverOnRouteStatuses[e.booking.driverOnRouteStatus].id;e.hasChanges=!1;e.loading=!1})};e.updateBooking=function(){(e.showErrors=!0,!e.sending&&e.hasChanges)&&e.driverOnRouteStatus&&e.driverAcceptanceStatus&&f.showConfirmation("Update Booking?").then(function(){e.sending=!0;let n={guid:e.booking.guid,driverAcceptanceStatus:e.driverAcceptanceStatus,driverOnRouteStatus:e.driverOnRouteStatus};r.setBookingDriverStatuses(n).then(function(n){console.log(n);n.data.success?(f.showNotification("success","Booking updated successfully."),e.saved&&e.saved()):f.showNotificationList("error",n.data.errors);e.sending=!1},function(){f.showNotification("error","Could not update booking. Please try again.");e.sending=!1})})};e.cancel=function(){e.modalInstance.dismiss("cancel")}}var n=angular.module("bookingApp");n.component("updateBookingState",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="setDriverOnRouteForm" ng-show="!vm.loading"><div class="row form-inline"><div class="form-group col-sm-12"><label>Current status:<\/label> <span>{{vm.driverAcceptanceStatusText}} / {{vm.driverOnRouteStatusText}}<\/span><\/div><div class="form-group mt-2 col-sm-12"><label>Driver acceptance status:<\/label><select class="form-control" name="driverAcceptanceStatus" required ng-change="vm.driverDataChanged()" ng-model="vm.driverAcceptanceStatus"><option ng-repeat="option in vm.driverAcceptanceStatuses" ng-value="option.id">{{option.text}}<\/option><\/select><p style="color: red; font-weight: bold;" ng-show="vm.showErrors && !vm.driverAcceptanceStatus">Please select if driver accepted booking.<\/p><\/div><div class="form-group mt-2 col-sm-12"><label>Driver On-Route status:<\/label><select class="form-control" name="onRouteStatus" required ng-change="vm.driverDataChanged()" ng-model="vm.driverOnRouteStatus"><option ng-repeat="option in vm.driverOnRouteStatuses" ng-value="option.id">{{option.text}}<\/option><\/select><p style="color: red; font-weight: bold;" ng-show="vm.showErrors && !vm.driverOnRouteStatus">Please select driver on route status.<\/p><\/div><\/div><div class="row mt-2" ng-show="vm.showErrors && !vm.hasChanges"><div class="col-sm-12"><p style="color: red; font-weight: bold;">Nothing changed. Please change data in order to save.<\/p><\/div><\/div><div class="row mt-2"><div class="col-sm-12 text-center"><button type="button" class="btn btn-danger m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-success m-l-sm" ng-click="vm.updateBooking()"><i class="fa fa-spinner fa-spin" ng-show="vm.sending"><\/i> Update Booking<\/button><\/div><\/div><\/div><style>\r\n    .setDriverOnRouteForm label {\r\n        min-width: 185px;\r\n    }\r\n\r\n    .mt-1 {\r\n        margin-top: 1rem;\r\n    }\r\n\r\n    .mt-2 {\r\n        margin-top: 2rem;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.booking={};u.$onInit=function(){r.getBookingDriversToDispatch(u.bookingGuid).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);u.model=n.data.result;u.model.selectedDrivers=[];u.model.selectedDrivers=0;u.getBookingDetails()},function(){i.showNotification("error","Error when getting available drivers for this booking.")})};u.getBookingDetails=function(){r.getBookingDispatchInfo(u.bookingGuid).then(function(n){u.booking=n.data.result.booking;u.canStartAutomaticBid=n.data.result.canStartAutomaticBid;u.quotations=n.data.result.driverQuotations;u.quotations&&u.quotations[0]&&(u.model.maxPrice=u.quotations[0].maxPrice)},function(){i.showNotification("error","Error when reading booking details.")})};u.updateFilter=function(){var n=u.model.tags.filter(function(n){return n.checked}).map(function(n){return n.name}),t=u.model.carClasses.filter(function(n){return n.checked}).map(function(n){return n.name}),i=u.model.drivers.filter(function(i){var f,e,r,u;if(t.length>0){for(f in t)if(e=t[f],i.carClass&&i.carClass.indexOf(e)!==-1){if(n.length===0)return!0;for(r in n)if(u=n[r],i.region&&i.region===u)return!0}}else for(r in n)if(u=n[r],i.region&&i.region===u)return!0;return!1});u.model.selectedDrivers=i};u.deleteBid=function(){i.showConfirmation("Delete current bid?","Deleting bid will remove the offer for all drivers.","error").then(function(){r.closeCurrentBid(u.bookingGuid).then(function(n){if(console.log(n),n.data.success)i.showNotification("success","Current bid was closed."),u.saved&&u.saved();else{var t=n.data.errors[0];i.showNotification("error",t)}})})};u.cancel=function(){u.modalInstance.dismiss("cancel")};u.ok=function(){if((u.sent=!0,!(u.model.selectedDrivers<=0))&&!u.sending&&n.dispatchBookingForm.$valid){if(console.log("sending"),u.model.bidStartingPrice&&u.model.bidIncrementAmount&&u.model.bidIncrementTimeInMinutes){var t="System will send mobile notifications to each driver. Price will be automatically increased till first driver accept it.",r="Start AUTO bid?",f="error";i.showConfirmation(r,t,f).then(function(){u.startBidInternal()})}if(!u.model.bidStartingPrice&&!u.model.bidIncrementAmount&&!u.model.bidIncrementTimeInMinutes){var t="System will send email (or sms) notifications to each driver. Price will be visible in dashboard.",r="Start bid?",f="warning";i.showConfirmation(r,t,f).then(function(){u.startBidInternal()})}}};u.startBidInternal=function(){u.sending=!0;r.dispatchBooking(u.model).then(function(n){u.sending=!1;u.modalInstance.close();n.data.success?(i.showNotificationList("success",n.data.successMessages),u.saved&&u.saved()):i.showNotificationList("error",n.data.errors)},function(){i.showNotification("error","Could not dispatch booking to drivers.");u.sending=!1})}}var n=angular.module("bookingApp");n.component("dispatchBooking",{controller:["$scope","$http","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<form name="dispatchBookingForm" novalidate><div class="row"><div class="col-md-6"><div><b>Car Class:<\/b> {{vm.booking.carClassName}}<\/div><div><b>From:<\/b> {{vm.booking.from.address}}<\/div><div ng-show="vm.booking.bookingType == 1"><b>To:<\/b> {{vm.booking.to.address}}<\/div><div ng-show="vm.booking.bookingType == 2"><b>Hourly:<\/b> {{vm.booking.durationInHours}} hours<\/div><div><b>Duration:<\/b> {{vm.booking.durationInMinutes}} minutes<\/div><div><b>Distance:<\/b> {{vm.booking.distanceInMiles}} miles<\/div><div><b>Price:<\/b> {{vm.booking.totalPrice}} {{vm.booking.currency}}<\/div><\/div><div class="col-md-6"><div class="form-group"><label for="payAmmountToDriver">Maximum offered price<\/label> <input class="form-control" type="number" ng-model="vm.model.maxPrice" name="maxPrice" placeholder="Maximum offered price"><\/div><p class="text-warning" ng-show="vm.model.maxPrice == 0">Zero value means that Drivers can express their interest. They will not be required to send their ask price.<\/p><div ng-class="{\'text-danger\': vm.booking.price - vm.model.maxPrice < 0, \'text-green\': vm.booking.price - vm.model.maxPrice > 0}" ng-show="vm.model.maxPrice > 0"><p style="font-weight: bold;">Remaining: {{vm.booking.totalPrice - vm.model.maxPrice | number:2}}<\/p><\/div><div class="text-center" ng-show="vm.booking.status == \'Bid In Progress\'"><button class="btn btn-danger" ng-click="vm.deleteBid()"><i class="fa fa-remove"><\/i> Close Current Bid<\/button><\/div><\/div><\/div><hr><div ng-show="vm.canStartAutomaticBid"><h3>Auto bid options:<\/h3><div class="form-group"><label>Initial offered price<\/label> <input class="form-control" type="number" ng-model="vm.model.bidStartingPrice" name="bidStartingPrice" placeholder="Automatic bid initial offered price"><\/div><div class="form-group"><label>Automatically increase offered price by<\/label> <input class="form-control" type="number" ng-model="vm.model.bidIncrementAmount" name="bidIncrementAmount" placeholder="Automatically increase ofered price with (Ex: 5)"><\/div><div class="form-group"><label>Automatically increase offered price every (minutes)<\/label> <input class="form-control" type="number" ng-model="vm.model.bidIncrementTimeInMinutes" name="bidIncrementTimeInMinutes" placeholder="Automatically increase offered price every X minutes (Ex: 5)"><\/div><\/div><div class="form-group" ng-show="vm.model.tags"><label>Select Drivers Groups:<\/label><br><div style="display: inline-block;" ng-repeat="(key, value) in vm.model.tags"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-change="vm.updateFilter()" ng-model="value.checked"> <i><\/i> <span class="m-l-xs">{{value.name}}<\/span><\/label><\/div><\/div><\/div><div class="form-group"><label>Select Car Classes:<\/label><br><div style="display: inline-block;" ng-repeat="(key, value) in vm.model.carClasses"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-change="vm.updateFilter()" ng-model="value.checked"> <i><\/i> <span class="m-l-xs">{{value.name}}<\/span><\/label><\/div><\/div><\/div><p style="font-weight: bold" ng-show="true || dispatchBookingForm.maxPrice.$dirty" ng-class="{\'text-danger\': vm.model.selectedDrivers.length === 0, \'text-green\': vm.model.selectedDrivers.length > 0}">Bid invitations will be sent to {{vm.model.selectedDrivers.length}} drivers.<ui-select multiple tagging tagging-label="false" ng-model="vm.model.selectedDrivers" theme="bootstrap" style="width: 100%;" title="Choose drivers to dispatch to"><ui-select-match placeholder="Select drivers...">{{$item.fullName}} - {{$item.carClass}}<\/ui-select-match><ui-select-choices repeat="driver in vm.model.drivers | filter:$select.search">{{driver.fullName}} - {{driver.region}} - {{driver.carClass}}<\/ui-select-choices><\/ui-select><\/p><div><span ng-show="vm.quotations.length>0">Invitations were already sent to <b>{{vm.quotations.length}} drivers<\/b>. Drivers that already got invitations will not receive it again if max price wasn\'t changed.<\/span><\/div><\/form><br><div class="text-center"><button type="button" class="btn btn-danger m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-success m-l-sm" ng-click="vm.ok()"><i class="fa fa-spinner fa-spin" ng-show="vm.sending"><\/i> Start Bid<\/button><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.loading=!0;e.sending=!1;e.$onInit=function(){r.getBookingDispatchInfo(e.bookingGuid).then(function(n){var u=JSON.stringify(n.data,null,4),r,t;for(console.log(u),e.bookingInfo=n.data.result.booking,e.driverQuotations=n.data.result.driverQuotations,r=0;r<e.driverQuotations.length;++r)t=e.driverQuotations[r],t.driverViewAtTimestampMoment?(t.viewAt=moment(t.driverViewAtTimestampMoment,i.Settings.ServerDateTimeFormat),t.viewAtDisplay=b.viewAt.format("ddd, DD MMM HH:mm A")):t.viewAtDisplay=" - ";e.loading=!1},function(){f.showNotification("error","Error when getting driver quotations.")})};e.acceptQuote=function(n){if(!e.sending){var i=null,t=n.price;n.price||n.priceToPay||(i="Driver price will be set manually later.");!n.price&&n.priceToPay&&(t=n.priceToPay);t&&(i="Driver will receive "+t+" "+e.bookingInfo.currency);f.showConfirmation("Accept this offer?",i).then(function(){n.status=3;e.sending=!0;n.price=t;console.log(n);r.updateDriverQuoteStatus(n).then(function(t){t.data.success?(f.showNotificationList("success",t.data.successMessages),e.dismiss&&e.dismiss(),e.saved&&e.saved()):(f.showNotification("error",t.data.errors[0]),n.priceToPay=null,e.sending=!1)},function(){e.sending=!1;n.priceToPay=null})})}}}var n=angular.module("bookingApp");n.component("viewDispatchStatus",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="table-responsive bookings-table-view" ng-show="!vm.loading"><table class="table table-striped"><thead><tr><th>Img<\/th><th>Name<\/th><th>Car Class<\/th><th>Status<\/th><th>Comments<\/th><th>Price<\/th><th>Action<\/th><\/tr><\/thead><tbody><tr ng-repeat="quotation in vm.driverQuotations | filter:searchText"><td style="vertical-align: middle; text-align: center"><img class="driver-img text-center" ng-src="{{quotation.driverPictureUrl}}"><\/td><td style="vertical-align: middle;">{{quotation.driverName}}<\/td><td style="vertical-align: middle;">{{quotation.driverCarClass}}<\/td><td style="vertical-align: middle;"><p ng-show="quotation.status == 0">WAITING<\/p><span class="text-green" ng-show="quotation.status == 1">INTERESTED<\/span> <span class="text-danger" ng-show="quotation.status == 2">DECLINED<\/span><\/td><td style="vertical-align: middle;">{{quotation.comments}}<\/td><td style="vertical-align: middle;"><p ng-show="quotation.price == 0 && quotation.status == 1"><b>-<\/b><\/p><p ng-show="!quotation.price && quotation.status == 0">Waiting<\/p><span ng-show="quotation.price > 0">{{quotation.price | number:2 }}<\/span><\/td><td class="bookings-dashboard-buttons" style="vertical-align: middle;"><input type="text" class="form-control" ng-show="quotation.status == 1 && !quotation.price" style="display: inline-block; max-width:50px; padding-left: 2px; padding-right: 2px" ng-model="quotation.priceToPay"> <button type="button" class="btn btn-success btn-xs" ng-show="quotation.price > 0 || quotation.status == 1" ng-click="vm.acceptQuote(quotation)"><i class="fa fa-spinner fa-spin" aria-hidden="true" ng-show="vm.sending"><\/i> Accept<\/button><\/td><\/tr><\/tbody><\/table><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.loading=!0;f.isCardPayment=!1;f.booking={};f.$onInit=function(){f.getBookingDetails();f.buttonText=f.paymentGuid?"Charge Card":"Add Payment"};f.paymentOptionChange=function(){console.log(f.paymentOption);f.paymentOption==="Card"?(f.buttonText="Charge Card",f.isCardPayment=!0):(f.isCardPayment=!1,f.buttonText="Add Payment")};f.getBookingDetails=function(){r.getBookingPaymentInfo(f.bookingGuid).then(function(n){f.loading=!1;f.booking=n.data.result},function(){i.showNotification("error","Error when reading booking log.")})};f.paymentDateChangedHandler=function(){if(f.paymentDate){var n=moment(f.paymentDate);f.selectedPaymentDate=n.format(u.Settings.ServerDateTimeFormat);f.paymentDateText=n.format("dddd, DD MMM YYYY")}else f.paymentDateText=null};f.cancel=function(){f.modalInstance.dismiss("cancel")};f.ok=function(){if(f.sent=!0,f.addBookingPaymentForm.$valid){var n={guid:f.booking.guid,paymentGuid:f.paymentGuid,paymentMethod:f.paymentOption,amount:f.amount,description:f.paymentDescription,paymentDate:f.selectedPaymentDate};(f.selectedCard&&(n.selectedCard=f.selectedCard.id),f.sending)||(f.sending=!0,r.addBookingPayment(n).then(function(n){f.sending=!1;f.modalInstance.close();n.data.success?(i.showNotificationList("success",n.data.successMessages),f.saved&&f.saved()):i.showNotificationList("error",n.data.errors)},function(){i.showNotification("error","Could not add booking payment. Please try again.");f.sending=!1}))}}}var n=angular.module("bookingApp");n.component("updateBookingPaymentStatus",{controller:["$scope","$http","htmlPageService","bookingApi","AppSettings",t],controllerAs:"vm",bindings:{bookingGuid:"<",paymentGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div ng-show="!vm.loading"><div><b>Client Id:<\/b> {{vm.booking.customerId}}<\/div><div><b>Price:<\/b> {{vm.booking.totalPrice | number: 2}} {{vm.booking.currencyCode}} <span><b class="margin-left-30">Remaining:<\/b> {{vm.booking.remainingToPay | number :2 }} {{vm.booking.currencyCode}}<\/span><\/div><hr><form name="vm.addBookingPaymentForm" novalidate><div class="form-group" ng-hide="vm.paymentGuid"><label>Type:<\/label><select class="form-control" ng-options="item for item in vm.booking.paymentOptions" name="paymentOption" ng-model="vm.paymentOption" ng-required="!vm.paymentGuid" ng-change="vm.paymentOptionChange()"><\/select><p style="color: red; font-weight: bold;" ng-show="(vm.addBookingPaymentForm.paymentOption.$error.required && vm.sent) || (vm.addBookingPaymentForm.paymentOption.$touched && vm.addBookingPaymentForm.paymentOption.$error.required)">Please select payment type.<\/p><\/div><div class="form-group" ng-show="vm.isCardPayment"><label>Available cards:<\/label><select class="form-control" ng-options="(\'type: \' + item.brand + \' \' + item.country + \' - ends: \' + item.cardLast4 + \' exp: \' + item.cardExpirationMonth + \'/\' + item.cardExpirationYear) for item in vm.booking.availableCards track by item.id" name="selectedCard" ng-model="vm.selectedCard" ng-required="vm.isCardPayment"><\/select><p style="color: red; font-weight: bold;" ng-show="(vm.addBookingPaymentForm.selectedCard.$error.required && vm.sent) || (vm.addBookingPaymentForm.selectedCard.$touched && vm.addBookingPaymentForm.selectedCard.$error.required)">Please select card to charge.<\/p><\/div><div class="form-group"><label>Amount:<\/label> <input type="tel" class="form-control" name="amount" ng-model="vm.amount" required><p style="color: red; font-weight: bold;" ng-show="(vm.addBookingPaymentForm.amount.$error.required && vm.sent) || (vm.addBookingPaymentForm.amount.$touched && vm.addBookingPaymentForm.amount.$error.required)">Please enter payment amount.<\/p><\/div><div class="form-group"><label>Description:<\/label> <input class="form-control" name="paymentDescription" ng-model="vm.paymentDescription" required><p style="color: red; font-weight: bold;" ng-show="(vm.addBookingPaymentForm.paymentDescription.$error.required && vm.sent) || (vm.addBookingPaymentForm.paymentDescription.$touched && vm.addBookingPaymentForm.paymentDescription.$error.required)">Please add payment description.<\/p><\/div><div class="form-group" ng-hide="vm.paymentGuid || vm.isCardPayment"><label>Date:<\/label> <input type="text" class="form-control original-style" name="paymentDate" placeholder="Payment date" autocomplete="off" pick-a-date="vm.paymentDate" ng-model="vm.paymentDateText" update-model="vm.paymentDateChangedHandler()" ng-required="!vm.paymentGuid && !vm.isCardPayment"><p style="color: red; font-weight: bold;" ng-show="(vm.addBookingPaymentForm.paymentDate.$error.required && vm.sent) || (vm.addBookingPaymentForm.paymentDate.$touched && vm.addBookingPaymentForm.paymentDate.$error.required)">Please select payment date.<\/p><\/div><\/form><\/div><br><div class="text-center"><button type="button" class="btn btn-default m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-success m-l-sm" ng-click="vm.ok()"><i class="fa fa-spinner fa-spin" ng-show="vm.sending"><\/i> {{vm.buttonText}}<\/button><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.booking={};f.model={isAdmin:!1};f.$onInit=function(){f.getBookingFromServer(f.bookingGuid)};f.getBookingFromServer=function(n){r.getAnonymousBookingCancelationDetails(n).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);f.bookingInfo=n.data.result;f.model.hash=f.bookingInfo.hash;f.model.isAdmin=f.bookingInfo.isAdmin;f.bookingInfo.isAdmin&&r.getWebsiteCancellationSettings(f.bookingInfo.websiteGuid).then(function(n){f.model.sendConfirmationEmailToDriver=n.data.result.sendConfirmationEmailToDriver;f.model.sendConfirmationSmsToDriver=n.data.result.sendConfirmationSmsToDriver;f.model.sendConfirmationEmailToClient=n.data.result.sendConfirmationEmailToClient});f.bookingInfo.pickupDateTimeMoment&&(f.pickupDate=moment(f.bookingInfo.pickupDateTimeMoment,u.Settings.ServerDateTimeFormat),f.bookingInfo.pickupDateTimeString=f.pickupDate.format("ddd, DD MMM YYYY")+" at "+f.pickupDate.format("HH:mm A"),f.pickupDateString=f.pickupDate.format("ddd, DD MMM YYYY"),f.pickupTimeString=f.pickupDate.format("HH:mm A"));f.bookingInfo.freeCancellationTillMoment&&(f.freeCancellationDate=moment(f.bookingInfo.freeCancellationTillMoment,u.Settings.ServerDateTimeFormat),f.bookingInfo.freeCancellationDateString=f.freeCancellationDate.format("ddd, DD MMM YYYY")+" at "+f.freeCancellationDate.format("HH:mm A"))})};f.updatePassengerValue=function(){var n=f.model.reimbursePassengerPercentage/100*f.bookingInfo.clientPayment;f.model.reimburseClient=(Math.round(n*100)/100).toFixed(2)};f.updatePassengerPercentage=function(){var n=f.model.reimburseClient/f.bookingInfo.clientPayment*100;f.model.reimbursePassengerPercentage=(Math.round(n*100)/100).toFixed(2)};f.updatePayDriverValue=function(){var n=f.model.payDriverPercentage/100*f.bookingInfo.driverPayment;f.model.payDriver=(Math.round(n*100)/100).toFixed(2)};f.updatePayDriverPercentage=function(){var n=f.model.payDriver/f.bookingInfo.driverPayment*100;f.model.payDriverPercentage=(Math.round(n*100)/100).toFixed(2)};f.cancel=function(){f.modalInstance.dismiss("cancel")};f.cancelBooking=function(){(f.sent=!0,!f.sending&&n.cancelBookingForm.$valid)&&(f.sending=!0,f.model.clientReimbursementValue=f.model.reimburseClient,f.model.driverPaymentValue=f.model.payDriver,r.cancelAnonymousBooking(f.model).then(function(n){n.data.success?(i.showNotification("success","Booking canceled successfully."),f.save&&f.save({item:f.bookingGuid})):i.showNotification("error",n.data.errors[0])}))}}var n=angular.module("bookingApp");n.component("cancelBooking",{controller:["$scope","$http","htmlPageService","bookingApi","AppSettings",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",save:"&"},template:'<div class="cancel-booking-component"><div><b>Pickup Date:<\/b> {{vm.bookingInfo.pickupDateTimeString}}<\/div><div><b>From:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.bookingType === 2"><b>Hourly booking:<\/b> {{vm.bookingInfo.durationInHours}} hours<\/div><div ng-hide="!vm.bookingInfo.to.addressName"><b>To:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><div class="text-center" ng-show="vm.bookingInfo.hasFreeCancellation">Free cancellation till {{vm.bookingInfo.freeCancellationDateString}}<\/div><hr><form name="cancelBookingForm" novalidate><div class="form-group" ng-class="{\'has-error\': vm.sent && cancelBookingForm.reason.$error.required}"><select class="form-control" name="reason" ng-model="vm.model.reason" required><option selected><\/option><option>Client did not confirmed by card<\/option><option>Client called and canceled booking<\/option><option>No longer traveling or change of plans<\/option><option>Flight / Boat was canceled<\/option><option>Found a better price elsewhere<\/option><option>This is a duplicate booking<\/option><option>This is a test booking<\/option><\/select><p style="color: red;" ng-show="vm.sent && cancelBookingForm.reason.$error.required">Please select booking cancellation reason.<\/p><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && cancelBookingForm.reasonDescription.$error.required}"><textarea class="form-control" rows="5" name="reasonDescription" ng-model="vm.model.reasonDescription" placeholder="Description ..."><\/textarea><\/div><div class="row"><div class="col-md-6"><label>Reimburse Passenger - Total: {{vm.bookingInfo.clientPayment | number : 2}} {{vm.bookingInfo.currency}}<\/label><div class="row"><div class="col-md-12"><div class="inline-block"><div class="input-group text-right" style="max-width: 140px;"><input type="text" class="form-control" placeholder="Value" ng-change="vm.updatePassengerPercentage()" ng-model="vm.model.reimburseClient"> <span class="input-group-addon">$<\/span><\/div><\/div><div class="margin-left-20 margin-right-20 inline-block" style="vertical-align: super; position: relative; top: -7px;">Meaning As Value<\/div><div class="inline-block"><div class="input-group text-left" style="max-width: 140px;"><input type="text" class="form-control" placeholder="Percentage" ng-change="vm.updatePassengerValue()" ng-model="vm.model.reimbursePassengerPercentage"> <span class="input-group-addon">%<\/span><\/div><\/div><\/div><\/div><div><span ng-show="vm.model.reimburseClient > 0" style="color: red;">An extra item of <b>-{{ vm.model.reimburseClient | number : 2}}<\/b> will be added to the booking for reimbursement.<\/span><\/div><\/div><div class="col-md-6"><label>Pay Driver - {{vm.bookingInfo.driverPayment | number : 2}} {{vm.bookingInfo.currency}}<\/label><div class="row"><div class="col-md-12"><div class="inline-block"><div class="input-group text-right" style="max-width: 140px;"><input type="text" class="form-control" placeholder="Value" ng-change="vm.updatePayDriverPercentage()" ng-model="vm.model.payDriver"> <span class="input-group-addon">$<\/span><\/div><\/div><div class="margin-left-30 margin-right-30 inline-block" style="vertical-align: super; position: relative; top: -7px;">Equivalent Of<\/div><div class="inline-block"><div class="input-group text-left" style="max-width: 140px;"><input type="text" class="form-control" placeholder="Percentage" ng-change="vm.updatePayDriverValue()" ng-model="vm.model.payDriverPercentage"> <span class="input-group-addon">%<\/span><\/div><\/div><\/div><\/div><div><span ng-show="vm.model.payDriver > 0" style="color: red;">Driver will remain assigned and his payment will be <b>{{ vm.model.payDriver | number : 2}} {{vm.bookingInfo.currency}}<\/b><\/span><\/div><\/div><\/div><hr><div class="form-group text-center" ng-show="vm.model.isAdmin"><div class="row"><div class="col-md-6 text-left"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationEmailToDriver"> <i><\/i> <span class="m-l-xs">Send cancellation email to driver<\/span><\/label><\/div><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationSmsToDriver"> <i><\/i> <span class="m-l-xs">Send cancellation SMS to driver<\/span><\/label><\/div><\/div><div class="col-md-6 text-left"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="vm.model.sendConfirmationEmailToClient"> <i><\/i> <span class="m-l-xs">Send cancellation email to client<\/span><\/label><\/div><\/div><\/div><\/div><\/form><hr><br><div class="text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-danger m-l-sm" ng-click="vm.cancelBooking()"><i class="fa fa-spinner fa-spin" ng-show="vm.sending"><\/i> Cancel booking<\/button><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.mapDetails={visible:!1};e.isLoading=!0;e.$onInit=function(){e.getBookingFromServer(e.bookingId)};e.getBookingFromServer=function(n){r.getBookingDetailsForView(n).then(function(n){var t=JSON.stringify(n.data,null,4);console.log(t);e.bookingInfo=n.data;e.bookingInfo.pickupDateTimeMoment&&(e.pickupDate=moment(e.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),e.estArrivalDateTime=moment(e.bookingInfo.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat),e.estArrivalDateTime.add(e.bookingInfo.durationInMinutes,"minutes"),e.estArrivalDateTimeString=e.estArrivalDateTime.format("ddd, DD MMM YYYY")+" at "+e.estArrivalDateTime.format("HH:mm A"),e.bookingInfo.pickupDateTimeString=e.pickupDate.format("ddd, DD MMM YYYY")+" at "+e.pickupDate.format("HH:mm A"),e.pickupDateString=e.pickupDate.format("ddd, DD MMM YYYY"),e.pickupTimeString=e.pickupDate.format("HH:mm A"));e.bookingInfo.freeCancellationTillMoment&&(e.freeCancellationDate=moment(e.bookingInfo.freeCancellationTillMoment,i.Settings.ServerDateTimeFormat),e.bookingInfo.freeCancellationDateString=e.freeCancellationDate.format("ddd, DD MMM YYYY")+" at "+e.freeCancellationDate.format("HH:mm A"));e.isLoading=!1})};e.editBooking=function(){e.onEdit&&e.onEdit()};e.duplicateBooking=function(){e.onDuplicate&&e.onDuplicate()};e.sendBookingConfirmationToClient=function(){e.sendingBookingConfirmationToClient||(e.sendingBookingConfirmationToClient=!0,r.sendBookingConfirmationToClient(e.bookingInfo.guid).then(function(n){var t=n.data;t.success&&f.showNotificationList("success",t.successMessages);e.sendingBookingConfirmationToClient=!1}))};e.sendDriverInfoEmailToClient=function(){e.sendingDriverInfoToClient||(e.sendingDriverInfoToClient=!0,r.sendDriverInfoToClient(e.bookingInfo.guid).then(function(n){var t=n.data;t.success?f.showNotificationList("success",t.successMessages):f.showNotificationList("error",t.errors);e.sendingDriverInfoToClient=!1}))};e.sendDriverReviewRequestToClient=function(){e.sendingDriverReviewRequestToClient||(e.sendingDriverReviewRequestToClient=!0,r.sendDriverReviewRequestToClient(e.bookingInfo.guid).then(function(n){var t=n.data;t.success?f.showNotificationList("success",t.successMessages):f.showNotification("error","Could not send driver review request to client. Please try again.");e.sendingDriverReviewRequestToClient=!1},function(){f.showNotification("error","Could not send driver review request to client. Please try again.");e.sendingDriverReviewRequestToClient=!1}))};e.sendBookingInfoToDriver=function(){e.sendingBookingInfoToDriver||(e.sendingBookingInfoToDriver=!0,r.sendBookingConfirmationToDriver(e.bookingInfo.guid).then(function(n){var t=n.data;t.success&&f.showNotificationList("success",t.successMessages);e.sendingBookingInfoToDriver=!1}))};e.sendSmsConfirmationToDriver=function(){e.sendingBookingInfoSmsToDriver||(e.sendingBookingInfoSmsToDriver=!0,r.sendBookingConfirmationSmsToDriver(e.bookingInfo.guid).then(function(n){var t=n.data;t.success&&f.showNotificationList("success",t.successMessages);e.sendingBookingInfoSmsToDriver=!1}))};e.sendSmsConfirmationToClient=function(n){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><message-summary booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/message-summary ><\/modal-component>",resolve:{bookingId:function(){return e.bookingInfo.guid},messageType:function(){return n},modalTitle:function(){return"Send SMS Message"},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","messageType","modalTitle","parentVm",function(n,t,i,r,u){var f=this;f.bookingId=t;f.messageType=i;f.modalTitle=r;f.$uibModalInstance=n;f.saved=function(){f.dismiss();u.$onInit();u.onChanged&&u.onChanged()};f.dismiss=function(){f.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm",windowClass:"animated fadeIn"})};e.updatePaymentStatus=function(){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><view-booking-payments booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/view-booking-payments><\/modal-component>",resolve:{bookingId:function(){return e.bookingInfo.guid},modalTitle:function(){return"Booking payments - "+e.bookingInfo.customerId},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(){u.dismiss();r.$onInit();r.onChanged&&r.onChanged()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm",windowClass:"animated fadeIn"})};e.showBookingMap=function(){e.mapDetails&&e.mapDetails.visible||(e.mapDetails={from:e.bookingInfo.from,to:e.bookingInfo.to,bookingType:e.bookingInfo.bookingType,visible:!0})};e.updatePaymentStatus1=function(){u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><update-booking-payment-status booking-guid='vm.bookingId' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/update-booking-payment-status><\/modal-component>",resolve:{bookingId:function(){return e.bookingInfo.guid},modalTitle:function(){return"Update booking payment status - "+e.bookingInfo.customerId},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","modalTitle","parentVm",function(n,t,i,r){var u=this;u.bookingId=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(){u.dismiss();r.$onInit();r.onChanged&&r.onChanged()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("viewBookingDetails",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",onEdit:"&",onDuplicate:"&",onChanged:"&",dismiss:"&"},template:'<div class="row" ng-show="vm.isLoading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div ng-show="!vm.isLoading"><div class="row"><div class="col-md-4"><div><b>Date:<\/b> {{vm.pickupDateString}} at {{vm.pickupTimeString}}<\/div><div><b>Service:<\/b> {{vm.bookingInfo.carClassName}}<\/div><br><div><b>From:<\/b> {{vm.bookingInfo.from.addressName}}<\/div><div ng-show="vm.bookingInfo.from.address !== vm.bookingInfo.from.addressName"><b>From address:<\/b> {{vm.bookingInfo.from.address}}<\/div><div ng-show="vm.bookingInfo.viaPoints"><ul class="list-unstyled m-l-md m-b-none"><li ng-repeat="viaPoint in vm.bookingInfo.viaPoints">Via: {{viaPoint.addressName}}<\/li><\/ul><\/div><div ng-show="vm.bookingInfo.bookingType === 1"><div><b>To:<\/b> {{vm.bookingInfo.to.addressName}}<\/div><div ng-show="vm.bookingInfo.to.address !== vm.bookingInfo.to.addressName"><b>To address:<\/b> {{vm.bookingInfo.to.address}}<\/div><\/div><div ng-show="vm.bookingInfo.bookingType === 2"><div><b>Hourly booking for {{vm.bookingInfo.durationInHours}} hours<\/b><\/div><div><b>Total minutes {{vm.bookingInfo.durationInMinutes}}<\/b><\/div><br><\/div><div ng-show="vm.bookingInfo.dispatcherInstructions"><b>Dispatcher Instr.:<\/b><div class="text-danger" ng-bind-html="vm.bookingInfo.dispatcherInstructions"><\/div><br><\/div><div ng-show="vm.bookingInfo.bookingType !== 2"><div ng-show="vm.bookingInfo.metricUnit === 0"><b>Distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div ng-show="vm.bookingInfo.metricUnit === 1"><eb>Distance:<\/eb>{{vm.bookingInfo.distanceInKilometers}} km<\/div><div><b>Time Est:<\/b> {{vm.bookingInfo.durationInMinutes}} min<\/div><div><b>Est. Arrival:<\/b> {{vm.estArrivalDateTimeString}}<\/div><\/div><div ng-show="vm.bookingInfo.bookingType === 2"><div ng-show="vm.bookingInfo.metricUnit === 0"><b>Included distance:<\/b> {{vm.bookingInfo.distanceInMiles}} miles<\/div><div ng-show="vm.bookingInfo.metricUnit === 1"><b>Included distance:<\/b> {{vm.bookingInfo.distanceInKilometers}} km<\/div><div><b>Included duration:<\/b> {{vm.bookingInfo.durationInMinutes}} min<\/div><\/div><div ng-show="vm.bookingInfo.isAdmin || vm.bookingInfo.isDispatcher"><div><b>Price:<\/b> {{vm.bookingInfo.price | number: 2}} {{vm.bookingInfo.currencyCode}}<\/div><div ng-show="vm.bookingInfo.extras"><b>Extras:<\/b> {{vm.bookingInfo.priceForExtras | number: 2}} {{vm.bookingInfo.currencyCode}}<\/div><div ng-show="vm.bookingInfo.taxes > 0"><b>Taxes:<\/b> {{vm.bookingInfo.taxes | number: 2}} {{vm.bookingInfo.currencyCode}}<\/div><div><b>Total:<\/b> {{vm.bookingInfo.totalPrice | number: 2}} {{vm.bookingInfo.currencyCode}} <b ng-class="{\'text-green\': vm.bookingInfo.paymentStatus == 3}" class="text-warning">{{vm.bookingInfo.paymentStatusString}} / {{vm.bookingInfo.selectedPaymentOption}}<\/b><\/div><\/div><\/div><div class="col-md-4"><div><b>Name:<\/b> {{vm.bookingInfo.passengerDetails.salutation}} {{vm.bookingInfo.passengerDetails.firstName}} {{vm.bookingInfo.passengerDetails.lastName}}<\/div><div><b>Tel:<\/b> {{vm.bookingInfo.passengerDetails.phone}}<\/div><div><b>Email:<\/b> {{vm.bookingInfo.passengerDetails.email}}<\/div><div ng-show="vm.bookingInfo.extras"><b>Extras:<\/b><ul><li ng-repeat="ex in vm.bookingInfo.extras">{{ex.description}} <span>: &nbsp;&nbsp; <b>{{ex.companyAmount | number: 2}} {{vm.bookingInfo.currencyCode}}<\/b><\/span> <span ng-show="ex.driverAmount && ex.driverAmount > 0">({{ex.driverAmount | number: 2}} {{vm.bookingInfo.driver.driverCurrency}} driver) {{vm.bookingInfo.currencyCode}}<\/span><\/li><\/ul><\/div><br><div><b>Source:<\/b> {{vm.bookingInfo.source}}<\/div><div ng-show="vm.bookingInfo.hasClientCard && (vm.bookingInfo.isAdmin || vm.bookingInfo.isDispatcher)"><div class="text-green font-bold m-t-md">Client card available for later charges<\/div><div>We advise to take all extra charges before customer leave the car. Due to security/funds availability transactions may not always succeed.<\/div><\/div><div ng-show="vm.bookingInfo.passengerDetails.flightNumber || vm.bookingInfo.passengerDetails.comingFrom"><div><b>Flight No.:<\/b> {{vm.bookingInfo.passengerDetails.flightNumber}}<\/div><div><b>Arriving from:<\/b> {{vm.bookingInfo.passengerDetails.comingFrom}}<\/div><div><b>Airline:<\/b> {{vm.bookingInfo.passengerDetails.airline | ifEmpty: \'Not Set\'}}<\/div><br><\/div><div ng-show="vm.bookingInfo.passengerDetails.adultsNumber || vm.bookingInfo.passengerDetails.childrenNumber"><b>Adults:<\/b> {{vm.bookingInfo.passengerDetails.adultsNumber}} <b>Children:<\/b> {{vm.bookingInfo.passengerDetails.childrenNumber}}<\/div><div ng-show="vm.bookingInfo.passengerDetails.largeLuggageNumber || vm.bookingInfo.passengerDetails.mediumLuggageNumber"><b>Large:<\/b> {{vm.bookingInfo.passengerDetails.largeLuggageNumber}} <b>Medium:<\/b> {{vm.bookingInfo.passengerDetails.mediumLuggageNumber}}<\/div><div ng-show="vm.bookingInfo.passengerDetails.additionalRequirements"><b>Additional requirements:<\/b><br><span ng-bind-html="vm.bookingInfo.passengerDetails.additionalRequirements"><\/span><\/div><div ng-show="vm.bookingInfo.clientUrl && !vm.bookingInfo.isSupplierBooking && vm.bookingInfo.isAdmin"><a class="btn btn-success btn-xs" target="_blank" ng-href="{{vm.bookingInfo.clientUrl}}">View as Client<\/a><\/div><\/div><div class="col-md-4"><div ng-show="vm.bookingInfo.driver"><img class="img-responsive driver-image img-rounded pull-left" style="max-width: 75px; margin-right: 10px;" ng-src="{{vm.bookingInfo.driver.pictureUrl}}"><div><b class="margin-left-15">Driver:<\/b> {{vm.bookingInfo.driver.firstName}} {{vm.bookingInfo.driver.lastName}}<\/div><div><b class="margin-left-15">Email:<\/b> {{vm.bookingInfo.driver.email}}<\/div><div><b class="margin-left-15">Phone:<\/b> {{vm.bookingInfo.driver.phoneNumber}}<\/div><br><div ng-show="vm.bookingInfo.isAdmin || vm.bookingInfo.isDispatcher"><div><b class="margin-left-15">For Booking:<\/b> {{vm.bookingInfo.driver.driverPayment}} <span ng-class="{differentCurrency: vm.bookingInfo.currencyCode !== vm.bookingInfo.driver.driverCurrency}">{{vm.bookingInfo.driver.driverCurrency}}<\/span><\/div><div ng-show="vm.bookingInfo.driver.driverCashCollected > 0"><b class="margin-left-15">Cash collected:<\/b> {{vm.bookingInfo.driver.driverCashCollected}} <span ng-class="{differentCurrency: vm.bookingInfo.currencyCode !== vm.bookingInfo.driver.driverCurrency}">{{vm.bookingInfo.driver.driverCurrency}}<\/span><\/div><div ng-show="vm.bookingInfo.driver.driverPaymentExtras > 0"><b class="margin-left-15">Extras:<\/b> {{vm.bookingInfo.driver.driverPaymentExtras}} <span ng-class="{differentCurrency: vm.bookingInfo.currencyCode !== vm.bookingInfo.driver.driverCurrency}">{{vm.bookingInfo.driver.driverCurrency}}<\/span><\/div><div><b class="margin-left-15">Remaining:<\/b> <span ng-class="{differentCurrency: vm.bookingInfo.driver.driverRemainingPayment < 0}">{{vm.bookingInfo.driver.driverRemainingPayment}}<\/span> <span ng-class="{differentCurrency: vm.bookingInfo.currencyCode !== vm.bookingInfo.driver.driverCurrency}">{{vm.bookingInfo.driver.driverCurrency}}<\/span><\/div><\/div><div ng-show="vm.bookingInfo.driverComments"><b>Driver comments:<\/b> {{vm.bookingInfo.driverComments}}<\/div><div ng-show="vm.bookingInfo.driver.rating"><b>Client rating:<\/b> {{vm.bookingInfo.driver.rating | number:2}}<br><b>Client comments:<\/b> {{vm.bookingInfo.driver.ratingComments}}<\/div><div ng-show="vm.bookingInfo.driverUrl && !vm.bookingInfo.isProviderBooking && vm.bookingInfo.isAdmin" class="m-t-sm m-b-sm"><a class="btn btn-success btn-xs" ng-href="{{vm.bookingInfo.driverUrl}}" target="_blank">View as Driver<\/a><\/div><\/div><div ng-show="vm.bookingInfo.passengerDetails.driverInstructions"><b>Driver instructions:<\/b> {{vm.bookingInfo.passengerDetails.driverInstructions}}<\/div><\/div><\/div><div class="row m-t-sm"><div class="col-sm-12 text-center"><div class="btn-group m-r-md"><button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-spinner fa-spin" ng-show="vm.sendingBookingConfirmationToClient || vm.sendingDriverInfoToClient || vm.sendingBookingInfoToDriver || vm.sendingDriverReviewRequestToClient"><\/i> Emails <span class="caret"><\/span><\/button><ul class="dropdown-menu"><li><a href="#" ng-hide="vm.bookingInfo.isSupplierBooking" ng-click="vm.sendBookingConfirmationToClient()">Send Confirmation Email To <b>Client<\/b><\/a><\/li><li><a href="#" ng-hide="vm.bookingInfo.isSupplierBooking" ng-click="vm.sendDriverInfoEmailToClient()">Send Driver Info To <b>Client<\/b><\/a><\/li><li><a href="#" ng-hide="vm.bookingInfo.isSupplierBooking" ng-click="vm.sendDriverReviewRequestToClient()">Send Driver Review Request To <b>Client<\/b><\/a><\/li><li role="separator" ng-hide="vm.bookingInfo.isSupplierBooking" class="divider"><\/li><li><a href="#" ng-click="vm.sendBookingInfoToDriver()">Send Client Info To <b>Driver<\/b><\/a><\/li><\/ul><\/div><div class="btn-group m-r-md"><button type="button" class="btn btn-sm btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-spinner fa-spin" ng-show="vm.sendingBookingInfoSmsToDriver"><\/i> SMS <span class="caret"><\/span><\/button><ul class="dropdown-menu"><li><a href="#" ng-click="vm.sendSmsConfirmationToDriver()">Send Booking Confirmation SMS To <b>Driver<\/b><\/a><\/li><li><a href="#" ng-hide="vm.bookingInfo.isSupplierBooking" ng-click="vm.sendSmsConfirmationToClient()">Send Booking Confirmation SMS To <b>Passenger<\/b><\/a><\/li><\/ul><\/div><button type="button" class="btn btn-primary btn-sm m-r-md" ng-show="!vm.bookingInfo.isSupplierBooking && (vm.bookingInfo.isAdmin || vm.bookingInfo.isDataEntry)" ng-click="vm.editBooking()"><i class="fa fa-edit"><\/i> Edit<\/button> <button type="button" class="btn btn-primary btn-sm m-r-md" ng-show="!vm.bookingInfo.isSupplierBooking && vm.bookingInfo.isAdmin" ng-click="vm.updatePaymentStatus()"><i class="fa fa-dollar"><\/i> Payments<\/button> <button type="button" class="btn btn-primary btn-sm m-r-md" ng-show="!vm.bookingInfo.isSupplierBooking && (vm.bookingInfo.isAdmin || vm.bookingInfo.isDataEntry)" ng-click="vm.duplicateBooking()"><i class="fa fa-edit"><\/i> Duplicate<\/button> <button type="button" class="btn btn-primary btn-sm" ng-click="vm.showBookingMap()"><i class="fa fa-map-pin"><\/i> Show Map<\/button><\/div><\/div><style>\r\n        .visibleMap {\r\n            min-height: 350px;\r\n            margin-bottom: 5px;\r\n            margin-top: 30px;\r\n        }\r\n    <\/style><booking-map location-info="vm.mapDetails"><\/booking-map><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.loading=!0;e.$onInit=function(){r.getBookingLogInfo(e.bookingGuid).then(function(n){var u=JSON.stringify(n.data,null,4),t,r;for(console.log(u),e.loading=!1,r=0;r<n.data.result.length;++r)t=n.data.result[r],t.timestamp=moment(t.timestampString,i.Settings.ServerDateTimeFormat),t.timestampDisplay=t.timestamp.format("ddd, DD MMM HH:mm A");e.driverLogs=n.data.result;return},function(){f.showNotification("error","Error when reading booking log.")})};e.filterChanged=function(n){t.localStorage.dashboardDaysFilter=n;e.numberOfDays=n;e.bookings.items=[];e.getNextBookingFromServer()};e.getNextBookingFromServer=function(){e.loading=!0;r.getNextBookings({numberOfDays:e.numberOfDays}).then(function(n){var t,i;for(e.loading=!1,e.bookings=n.data,t=0;t<e.bookings.items.length;++t)i=e.bookings.items[t],e.fillBookingDetails(i)});e.fillBookingDetails=function(n){n.pickupDate=moment(n.pickupDateTimeMoment,i.Settings.ServerDateTimeFormat);n.gmtPickupDate=moment.utc(n.gmtPickupDateTimeMoment,i.Settings.ServerDateTimeFormat);n.pickupDateDisplay=n.pickupDate.format("ddd, DD MMM");n.pickupTimeDisplay=n.pickupDate.format("HH:mm A");n.utcNow=moment.utc();n.displayTimeLeft=function(){var n=moment.duration(this.gmtPickupDate.diff(this.utcNow)),t="";return n.days()>0&&(t+=n.days()+" day",n.days()>1&&(t+="s"),t+=" "),n.hours()>0&&(t+=n.hours()+" hr",t+=" "),n.minutes()>0&&(t+=n.minutes()+" min"),t}}}}var n=angular.module("bookingApp");n.component("bookingLog",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="table-responsive bookings-table-view" ng-show="!vm.loading"><table class="table table-striped"><thead><tr><th>Driver<\/th><th>Date Time<\/th><th>Status<\/th><th>Location<\/th><\/tr><\/thead><tbody><tr ng-repeat="log in vm.driverLogs | filter:searchText"><td style="vertical-align: middle;">{{log.driver.fullName}}<\/td><td style="vertical-align: middle;">{{log.timestampDisplay}}<\/td><td style="vertical-align: middle;">{{log.driverStatusDisplay}}<\/td><td style="vertical-align: middle;"><div><button ng-show="!log.logEntry.showMap && log.logEntry.driverLocationMapUrl" ng-click="log.logEntry.showMap = !log.logEntry.showMap;" type="button" class="m-l-md btn btn-primary btn-xs">View Map<\/button> <button ng-show="log.logEntry.showMap && log.logEntry.driverLocationMapUrl" ng-click="log.logEntry.showMap = !log.logEntry.showMap;" type="button" class="m-l-md btn btn-primary btn-xs">Hide Map<\/button><\/div><iframe width="650" ng-show="log.logEntry.showMap && log.logEntry.driverLocationMapUrl" height="350" frameborder="0" marginheight="0" marginwidth="0" ng-src="{{log.logEntry.driverLocationMapUrl | trusted}}"><\/iframe><\/td><\/tr><\/tbody><\/table><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.loading=!0;e.$onInit=function(){r.getBookingPaymentInfo(e.bookingGuid).then(function(n){var f=JSON.stringify(n.data,null,4),r,u,t;for(console.log(f),e.loading=!1,e.bookingInfo=n.data.result,r=n.data.result.payments,u=0;u<r.length;++u)t=r[u],t.timestamp=moment(t.timestampString,i.Settings.ServerDateTimeFormat),t.timestampDisplay=t.timestamp.format("ddd, DD MMM HH:mm A");e.payments=r},function(){f.showNotification("error","Error when reading booking log.")})};e.deleteBookingPayment=function(n){var t=n.isAuto?"Attention - Delete payment?":"Delete payment?",i=n.isAuto?"This payment was done using credit card. Make sure you REFUNDED this payment from card provider console. This will NOT REFUND payment to customer.":"Are you sure you want to delete this payment?",u=n.isAuto?"error":"warning";f.showConfirmation(t,i,u).then(function(){n.bookingGuid=e.bookingInfo.guid;r.deleteBookingPayment(n).then(function(n){if(n.data.success)f.showNotification("success","Payment deleted."),e.$onInit(),e.onChanged();else{var t=n.data.errors[0];f.showNotification("error",t)}})})};e.onChanged=function(){e.saved&&e.saved()};e.addPayment=function(n){var t=n!=null?n.guid:null;u.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><update-booking-payment-status booking-guid='vm.bookingId' payment-guid='vm.paymentGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' saved='vm.saved()'><\/update-booking-payment-status><\/modal-component>",resolve:{bookingId:function(){return e.bookingGuid},paymentGuid:function(){return t},modalTitle:function(){return"Add payment - "+e.bookingInfo.customerId},parentVm:function(){return e}},controller:["$uibModalInstance","bookingId","paymentGuid","modalTitle","parentVm",function(n,t,i,r,u){var f=this;f.bookingId=t;f.paymentGuid=i;f.modalTitle=r;f.$uibModalInstance=n;f.saved=function(){f.dismiss();u.$onInit();u.onChanged&&u.onChanged()};f.dismiss=function(){f.$uibModalInstance.dismiss("cancel")}}],controllerAs:"vm",windowClass:"animated fadeIn"})};e.copyClientPaymentLink=function(){f.copyToClipboard(e.bookingInfo.clientPaymentUrl).then(function(){f.showNotification("success","Link copied to clipboard.")})};e.openClientPaymentLink=function(){t.open(e.bookingInfo.clientPaymentUrl)};e.copyClientConfirmationPaymentLink=function(){f.copyToClipboard(e.bookingInfo.confirmationClientPaymentUrl).then(function(){f.showNotification("success","Link copied to clipboard.")})};e.openClientConfirmationPaymentLink=function(){t.open(e.bookingInfo.confirmationClientPaymentUrl)}}var n=angular.module("bookingApp");n.component("viewBookingPayments",{controller:["$timeout","$window","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",modalInstance:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.loading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div class="table-responsive bookings-table-view" ng-show="!vm.loading"><table class="table table-striped"><thead><tr><th>Date Time<\/th><th>Method<\/th><th>Status<\/th><th>Amount<\/th><th>Card<\/th><th>Action<\/th><\/tr><\/thead><tbody><tr ng-repeat="payment in vm.payments | filter:searchText"><td style="vertical-align: middle;">{{payment.timestampDisplay}}<\/td><td style="vertical-align: middle;">{{payment.method}}<\/td><td style="vertical-align: middle;">{{payment.statusName}}<\/td><td style="vertical-align: middle;">{{payment.amount | number : 2}}<\/td><td style="vertical-align: middle;"><span ng-show="payment.cardLast4">{{payment.cardLast4}} &nbsp;&nbsp;&nbsp; {{payment.cardExpirationMonth}}/{{payment.cardExpirationYear}}<\/span> <span ng-hide="payment.cardLast4">NO<\/span><\/td><td style="vertical-align: middle;"><button class="btn btn-xs btn-danger" ng-click="vm.deleteBookingPayment(payment)">Remove<\/button><\/td><\/tr><\/tbody><\/table><\/div><div class="row" ng-show="!vm.loading"><div class="col-sm-12 col-md-8 text-left"><b>Client payment Link:<\/b><br><div><a href="#" ng-click="vm.copyClientPaymentLink()">Pay remaining amount ({{vm.bookingInfo.remainingToPay | number : 2 }} {{vm.bookingInfo.currencyCode}})<\/a> <i class="fa fa-clipboard m-l-sm m-r-sm" ng-click="vm.copyClientPaymentLink()"><\/i> <i class="fa fa-external-link" ng-click="vm.openClientPaymentLink()" aria-hidden="true"><\/i><\/div><div ng-show="vm.bookingInfo.confirmationClientPaymentUrl"><a href="#" ng-click="vm.copyClientConfirmationPaymentLink()">Pay for confirmation {{vm.bookingInfo.confirmationPercentage}} %<\/a> <i class="fa fa-clipboard m-l-sm m-r-sm" ng-click="vm.copyClientConfirmationPaymentLink()"><\/i> <i class="fa fa-external-link" ng-click="vm.openClientConfirmationPaymentLink()" aria-hidden="true"><\/i><\/div><\/div><div class="col-sm-12 col-md-4 text-right"><div class="row"><div class="col-sm-12 text-right"><span class="payments-price-container">Total: <span class="payments-price">{{vm.bookingInfo.totalPrice | number : 2}}<\/span><\/span><\/div><div class="col-sm-12 text-right"><span class="payments-price-container">Paid: <span class="payments-price">{{vm.bookingInfo.totalPaid | number : 2 }}<\/span><\/span><\/div><div class="col-sm-12 text-right"><span class="payments-price-container">Remaining: <span class="payments-price">{{vm.bookingInfo.remainingToPay | number : 2 }}<\/span><\/span><\/div><\/div><\/div><\/div><div class="row" ng-show="!vm.loading"><div class="col-sm-12 text-center"><button class="btn btn-primary" ng-click="vm.addPayment()">Add Payment<\/button><\/div><\/div><style>\r\n    .payments-price-container {\r\n        font-size: 14px;\r\n        font-weight: bold;\r\n    }\r\n    .payments-price {\r\n        min-width: 60px;\r\n        display: inline-block;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.handleStripe=function(n,t){t.error?console.log(t.error):e.token=t.id};i.handleStripe=function(n,t){if(!e.isSaveInProgress)if(t.error)console.log(t.error);else{e.token=t.id;e.isSaveInProgress=!0;var i={bookingGuid:e.bookingId,token:e.token,source:e.source};t.card&&(i.cardId=t.card.id,i.cardLast4=t.card.last4,i.cardExpirationMonth=t.card.exp_month,i.cardExpirationYear=t.card.exp_year);u.payBookingWithStripe(i).then(function(n){if(console.log(n),n.data.success){if(f.showNotification("success","Booking confirmed."),e.isSuccess=!0,e.returnUrl=n.data.returnUrl,e.onSave&&e.cancelButtonText)e.onSave({itemGuid:n.data.guid})}else{e.isSaveInProgress=!1;var t=n.data.errors[0];f.showNotification("error",t)}},function(){e.isSaveInProgress=!1;f.showNotification("error","An error occurred when confirming booking. Please tray again.")})}}}var n=angular.module("bookingApp");n.component("stripePaymentForm",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingId:"<",amount:"<",currency:"<",source:"<",onCancel:"&",onSave:"&"},template:'<div class="row" ng-show="!vm.isSuccess"><div class="col-lg-6 col-lg-offset-3 col-md-12 col-sm-12 col-xs-12"><h1 class="text-center font-bold">Confirm with Stripe<\/h1><form stripe-form="handleStripe" name="myForm"><div class="row"><div class="field"><input id="nameOnCard" type="text" class="input empty" ng-model="vm.nameOnCard"> <label for="nameOnCard">Name on card<\/label><div class="baseline"><\/div><\/div><\/div><div class="row"><div class="field"><input id="cardNumber" type="text" class="input empty" ng-model="number" payments-format="card" payments-type-model="type" ng-class="vm.number.$card.type"> <label for="cardNumber">Card number<\/label><div class="baseline"><\/div><\/div><\/div><div class="row"><div class="field half-width"><input id="expiryDate" type="text" class="input empty" ng-model="expiry" payments-format="expiry"> <label for="expiryDate" data-tid="elements_examples.form.card_expiry_label">Expiration<\/label><div class="baseline"><\/div><\/div><div class="field half-width"><input id="cvcNumber" type="text" class="input empty" ng-model="cvc" payments-format="cvc" payments-type-model="type"> <label for="cvcNumber" data-tid="elements_examples.form.card_cvc_label">CVC<\/label><div class="baseline"><\/div><\/div><\/div><div class="span4"><button type="submit" class="btn btn-primary btn-large"><i class="fa fa-spinner fa-spin" ng-show="vm.isSaveInProgress"><\/i> Confirm - {{vm.amount | number:2}} {{vm.currency}}<\/button><\/div><\/form><\/div><\/div><div class="ng-hide" ng-show="vm.isSuccess"><div class="cbs-booking-confirmation"><div class="success"><div class="icon"><svg width="84px" height="84px" viewBox="0 0 84 84" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink"><circle class="border" cx="42" cy="42" r="40" stroke-linecap="round" stroke-width="4" stroke="#000" fill="none"><\/circle><path class="checkmark" stroke-linecap="round" stroke-linejoin="round" d="M23.375 42.5488281 36.8840688 56.0578969 64.891932 28.0500338" stroke-width="4" stroke="#000" fill="none"><\/path><\/svg><\/div><h3 class="title" data-tid="elements_examples.success.title">Your booking is confirmed. Thank you for using our services!<br>You will receive a confirmation email shortly with your booking details.<\/h3><div class="text-center m-t-xl" ng-show="vm.returnUrl"><a href="#" ng-href="{{vm.returnUrl}}" class="btn btn-green">Done<\/a><\/div><\/div><\/div><\/div><style>\r\n    .cbs-booking-confirmation {\r\n        text-align: center;\r\n        background-color: #fff;\r\n        padding: 50px;\r\n    }\r\n\r\n        .cbs-booking-confirmation .success .icon .border {\r\n            stroke: #abe9d2;\r\n        }\r\n\r\n        .cbs-booking-confirmation .success .icon .checkmark {\r\n            stroke: #24b47e;\r\n        }\r\n\r\n        .cbs-booking-confirmation .success .title {\r\n            margin-top: 45px;\r\n            margin-bottom: 5px;\r\n            color: #32325d;\r\n            font-size: 16px !important;\r\n        }\r\n\r\n        .cbs-booking-confirmation .success .message {\r\n            color: #8898aa;\r\n            font-size: 13px !important;\r\n            text-align: center;\r\n        }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.sendingSms=!1;f.$onInit=function(){r.getMessagePreview(f.bookingGuid,f.messageType).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result))})};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.initForm=function(n){f.model=n;f.messageSummaryForm.$setPristine();f.messageSummaryForm.$setUntouched()};f.sendMessage=function(){(console.log(f.websiteModel),f.sendingSms)||(f.sendingSms=!0,r.sendSmsMessage(f.model).then(function(n){n.data.success?(console.log(n.data.result),u.showNotificationList("success",n.data.successMessages),u.scrollElement("body"),f.dismiss&&f.dismiss()):u.showNotificationList("error",n.data.errors);f.sendingSms=!1},function(){f.sendingSms=!1}))}}var n=angular.module("bookingApp");n.component("messageSummary",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",messageType:"<",dismiss:"&",saved:"&"},template:'<form name="vm.messageSummaryForm" class="form-horizontal"><div class="row"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.messageSummaryForm.message.$pristine }"><label class="col-sm-2 control-label">Message<\/label><div class="col-sm-10"><textarea name="message" ng-model="vm.model.message" rows="6" class="form-control"><\/textarea><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.messageSummaryForm.sendTo.$pristine }"><label class="col-sm-2 control-label">SendTo<\/label><div class="col-sm-10"><input name="sendTo" ng-model="vm.model.toNumbers" type="text" class="form-control"> <span>Separate multiple numbers by comma (,)<\/span><\/div><\/div><\/div><\/div><div class="row text-center"><div class="col-sm-12"><button class="btn btn-white m-r-sm" ng-click="vm.cancel()">Close<\/button> <button class="btn btn-primary m-l-sm" ng-click="vm.sendMessage()">Send Message<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.sendingSms=!1;f.$onInit=function(){r.getMessagePreview(f.bookingGuid,f.messageType).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result))})};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.initForm=function(n){f.model=n;f.messageSummaryForm.$setPristine();f.messageSummaryForm.$setUntouched()};f.sendMessage=function(){(console.log(f.websiteModel),f.sendingSms)||(f.sendingSms=!0,f.model.type=f.messageType,r.sendMessage(f.model).then(function(n){n.data.success?(console.log(n.data.result),u.showNotificationList("success",n.data.successMessages),u.scrollElement("body"),f.dismiss&&f.dismiss()):u.showNotificationList("error",n.data.errors);f.sendingSms=!1},function(){f.sendingSms=!1}))}}var n=angular.module("bookingApp");n.component("emailSummary",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingGuid:"<",messageType:"<",dismiss:"&",saved:"&"},template:'<form name="vm.messageSummaryForm" class="form-horizontal"><div class="row"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.messageSummaryForm.to.$pristine }"><label class="col-sm-2 control-label">To<\/label><div class="col-sm-10"><input name="to" ng-model="vm.model.to" type="text" class="form-control"> <span>Separate multiple emails by comma (,)<\/span><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.messageSummaryForm.subject.$pristine }"><label class="col-sm-2 control-label">Title<\/label><div class="col-sm-10"><input name="subject" ng-model="vm.model.subject" type="text" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.messageSummaryForm.content.$pristine }"><label class="col-sm-2 control-label">Message<\/label><div class="col-sm-10"><summernote name="content" height="300" ng-model="vm.model.content"><\/summernote><\/div><\/div><\/div><\/div><div class="row text-center"><div class="col-sm-12"><button class="btn btn-white m-r-sm" ng-click="vm.cancel()">Close<\/button> <button class="btn btn-primary m-l-sm" ng-click="vm.sendMessage()">Send Message<\/button><\/div><\/div><\/form><style>\r\n    .note-popover {\r\n        z-index: 10000;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getClients(e.websiteGuid,e.searchText).then(function(n){n.data.success&&(e.websiteGuid=n.data.result.websiteGuid,e.users=n.data.result.clients)})};e.searchClient=function(){e.$onInit()};e.changePassword=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><set-user-password user-guid='vm.userGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' save='vm.saved(item)'><\/set-user-password><\/modal-component>",resolve:{userGuid:function(){return n.guid},modalTitle:function(){return"Change client password: "+n.firstName+" "+n.lastName},parentVm:function(){return e}},controller:["$uibModalInstance","userGuid","modalTitle","parentVm",function(n,t,i,r){var u=this;u.userGuid=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(n){const t=r.bookings.items.findIndex(function(t){return t.guid===n});t>=0&&r.bookings.items.splice(t,1);u.dismiss()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.editClient=function(n){r.open({template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Edit client<\/h4><\/div><div class="modal-body"><edit-client user-guid=\'vm.guid\' website-guid=\'vm.websiteGuid\' on-finish=\'vm.onComponentFinished(result);\'><\/edit-client><\/div>',resolve:{clients:function(){return e.users},parentVm:function(){return e}},controller:["$uibModalInstance","parentVm","clients",function(t,i,r){var u=this;u.users=r;u.guid=n?n.guid:"";u.websiteGuid=i.websiteGuid;u.$uibModalInstance=t;u.cancel=function(){u.$uibModalInstance.dismiss("cancel")};u.onComponentFinished=function(n){if(console.log(n),u.cancel(),n){var t=u.users.findIndex(function(t){return t.guid===n.guid});t>=0?(n.fullName=n.firstName+" "+n.lastName,u.users[t]=n):u.users.push(n)}}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};n.$on("add-new-client",function(n,t){console.log(t);e.editClient()});e.editUser=function(n){e.editClient(n)};e.deleteUser=function(n){var t=n.guid;u.showConfirmation("Delete client?","").then(function(){f.deleteUser(n).then(function(n){n.data.success?(e.removeUser(t),u.showNotification("success","Client removed.")):u.showNotification("error",n.data.errors[0])})})};e.loginAsUser=function(n,t){u.showConfirmation("Login as user: "+t+" ?","").then(function(){f.loginAsUser(n).then(function(n){n.data.success?(u.showNotification("success","You are now logged in as "+t),i.location.href="/"):u.showNotification("error",n.data.errors[0])})})};e.removeUser=function(n){for(var t=0;t<e.users.length;t++)e.users[t].guid===n&&(e.users.splice(t,1),t--);return this};e.editClientPrices=function(n){var t="/prices/editclientprices/?websiteguid="+e.websiteGuid+"&clientguid="+n.guid;i.open(t,"_blank");return}}var n=angular.module("bookingApp");n.component("applicationClients",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{searchText:"<",websiteGuid:"<"},template:'<div class="input-group"><input type="text" placeholder="Search" ng-model-options="{ debounce: 1000 }" ng-model="vm.searchText" ng-change="vm.searchClient()" class="input form-control"> <span class="input-group-btn"><button type="button" class="btn btn btn-primary"><i class="fa fa-search"><\/i> Search<\/button><\/span><\/div><div class="clients-list"><div class="table-responsive"><table class="table table-striped table-hover"><tbody><tr ng-repeat="user in vm.users track by user.id"><td>{{user.fullName}}<\/td><td>{{user.companyName}}<\/td><td class="contact-type"><i class="fa fa-envelope"><\/i><\/td><td>{{user.email}}<\/td><td class="contact-type"><i class="fa fa-phone"><\/i><\/td><td>{{user.phoneNumber}}<\/td><td class="text-right"><button class="btn btn-primary m-r-xs" ng-click="vm.editClientPrices(user)" title="Custom prices"><i class="fa fa-dollar" aria-hidden="true"><\/i><\/button> <button class="btn btn-primary m-r-xs" ng-click="vm.editUser(user)" title="Edit client"><i class="fa fa-pencil-square-o" aria-hidden="true"><\/i><\/button> <button class="btn btn-primary m-r-xs" ng-click="vm.changePassword(user)" title="Change password"><i class="fa fa-key" aria-hidden="true"><\/i><\/button> <button class="btn btn-danger m-l-xs" ng-click="vm.deleteUser(user)" title="Remove client"><i class="fa fa-trash-o" aria-hidden="true"><\/i><\/button><\/td><\/tr><\/tbody><\/table><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){r.getUserInfo(e.websiteGuid,e.userGuid).then(function(n){n.data.success&&(e.userModel=n.data.result)})};e.initForm=function(n){e.userModel=n;e.userDetailsForm.$setPristine();e.userDetailsForm.$setUntouched()};e.cancel=function(){e.onFinish&&e.onFinish()};e.updateUser=function(){e.sending||(e.sending=!0,e.userModel.roles="Client",r.updateUserInfo(e.userModel).then(function(n){if(n.data.success){if(u.showNotification("success","Client saved"),e.initForm(n.data.result),e.onFinish)e.onFinish({result:n.data.result})}else u.showNotificationList("error",n.data.errors),e.sending=!1},function(){e.sending=!1;u.showNotification("error","Something went wrong. Please try again.")}))};e.showCredit=function(){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><update-client-credit user-guid='vm.userGuid' website-guid='vm.websiteGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' on-finish='vm.dismiss()'><\/update-client-credit><\/modal-component>",resolve:{userGuid:function(){return e.userGuid},websiteGuid:function(){return e.websiteGuid},modalTitle:function(){return"View Credit Log"},parentVm:function(){return e}},controller:["$uibModalInstance","userGuid","websiteGuid","modalTitle","parentVm",function(n,t,i,r){var u=this;u.userGuid=t;u.websiteGuid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],size:"lg",controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("editClient",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","$uibModal",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<",onFinish:"&"},template:'<form name="vm.userDetailsForm" class="form-horizontal"><div class="row"><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.email.$pristine }"><label class="col-sm-2 control-label">Email<\/label><div class="col-sm-10"><input name="email" ng-model="vm.userModel.email" type="text" placeholder="john@company.com" class="form-control"><\/div><\/div><\/div><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.phoneNumber.$pristine }"><label class="col-sm-2 control-label">Phone No.<\/label><div class="col-sm-10"><input type="text" name="phoneNumber" ng-model="vm.userModel.phoneNumber" placeholder="+44749093345" class="form-control"><\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.firstName.$pristine }"><label class="col-sm-2 control-label">First Name<\/label><div class="col-sm-10"><input name="firstName" ng-model="vm.userModel.firstName" type="text" placeholder="John" class="form-control"><\/div><\/div><\/div><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.lastName.$pristine }"><label class="col-sm-2 control-label">Last Name<\/label><div class="col-sm-10"><input type="text" name="lastName" ng-model="vm.userModel.lastName" placeholder="Smith" class="form-control"><\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.discountPercentage.$pristine }"><label class="col-sm-2 control-label">Discount (%)<\/label><div class="col-sm-10"><input type="text" name="discountPercentage" ng-model="vm.userModel.discountPercentage" placeholder="Ex: 10" class="form-control"><div class="m-t-sm" ng-show="vm.userModel.discountPercentage > 0 && vm.userModel.isAdmin">This client will get <b>{{vm.userModel.discountPercentage}}% discount<\/b> at each booking made in admin dashboard.<\/div><\/div><\/div><\/div><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.credit.$pristine }"><label class="col-sm-2 control-label">Credit<\/label><div class="col-sm-10"><span class="m-r-md">{{vm.userModel.credit}} {{vm.userModel.currency}}<\/span> <button class="btn btn-sm btn-success" ng-click="vm.showCredit()"><i class="fa fa-edit"><\/i> Edit<\/button><\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.salutation.$pristine }"><label class="col-sm-2 control-label">Salutation<\/label><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top margin-right-10"><input icheck type="radio" id="userDetailsMrSalutation" name="userDetailsSalutation" value="Mr." ng-data-value="Mr." ng-model="vm.userModel.salutation"> <label for="userDetailsMrSalutation">Mr.<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input icheck type="radio" id="userDetailsMsSalutation" name="userDetailsSalutation" value="Ms." ng-data-value="Ms." ng-model="vm.userModel.salutation"> <label for="userDetailsMsSalutation">Ms.<\/label><\/div><\/div><\/div><div class="col-md-6"><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.culture.$pristine }"><label class="col-sm-2 control-label">Language<\/label><div class="col-sm-10"><select name="culture" ng-model="vm.userModel.culture" class="form-control"><option value="en-GB">English<\/option><option value="pl">Polish<\/option><option value="de-CH">German - Switzerland<\/option><\/select><\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><label class="control-label text-left">Ask client to pay by card<\/label><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.creditCardSetting" data-ng-value="2" value="2" name="creditCardSetting"> <i><\/i> <span class="m-l-sm">When booking is created<\/span><\/label><\/div><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.creditCardSetting" data-ng-value="3" value="3" name="creditCardSetting"> <i><\/i> <span class="m-l-sm">After driver is assigned<\/span><\/label><\/div><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.creditCardSetting" data-ng-value="1" value="1" name="creditCardSetting"> <i><\/i> <span class="m-l-sm">Never. Client will pay by account<\/span><\/label><\/div><\/div><div class="col-md-6"><div class="row"><div class="col-sm-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.currency.$pristine }"><label>Default Currency<\/label><select name="currency" ng-model="vm.userModel.currency" class="form-control"><option value="EUR">EUR - &euro;<\/option><option value="USD">USD - &dollar;<\/option><option value="CAD">CAD - &dollar;<\/option><option value="CHF">CHF<\/option><option value="PLN">PLN - zł<\/option><option value="GBP">GBP - &pound;<\/option><option value="AUD">AUD - &dollar;<\/option><option value="NZD">NZD - &dollar;<\/option><option value="SGD">SGD - &dollar;<\/option><option value="THB">THB - &#x0E3F;<\/option><option value="MYR">MYR - RM (Malaysia ringgit)<\/option><option value="IDR">IDR (Indonesian rupiah) - Rp<\/option><option value="VND">VND - &#8363;<\/option><\/select><\/div><\/div><\/div><div class="row"><div class="col-sm-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.showInstantPriceWhenBooking.$pristine }"><label class="control-label">Booking Price<\/label><div class="checkbox i-checks"><label class="checkboxLabel"><input type="checkbox" icheck ng-model="vm.userModel.showInstantPriceWhenBooking" name="showInstantPriceWhenBooking"> <i><\/i> <span class="m-l-sm">Show instant price when client is booking.<\/span><\/label><\/div><\/div><div class="row"><div class="col-sm-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.hidePriceFromCustomer.$pristine }"><div class="checkbox i-checks"><label class="checkboxLabel weight-400"><input name="hidePriceFromCustomer" type="checkbox" icheck ng-model="vm.userModel.hidePriceFromCustomer"> <i><\/i> <span class="m-l-xs">Never show booking price to the customer in booking detail page & emails<\/span><\/label><\/div><\/div><\/div><\/div><\/div><\/div><\/div><\/div><div class="row m-t-md"><div class="col-md-6"><div class="checkbox-inline i-checks"><label class="checkboxLabel weight-400"><input name="overwriteDriverAssigned" type="checkbox" icheck ng-model="vm.userModel.overwriteDriverAssigned"> <i><\/i> <label class="control-label">Overwrite website settings - When driver is assigned:<\/label><\/label><\/div><br><div class="checkbox i-checks"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverInfoToCustomerByEmail" type="checkbox" icheck ng-disabled="!vm.userModel.overwriteDriverAssigned" ng-model="vm.userModel.automaticallySendDriverInfoToCustomerByEmail"> <i><\/i> <span class="m-l-xs">Automatically send driver details to the client by Email<\/span><\/label><\/div><div class="checkbox i-checks"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverInfoToCustomerBySms" type="checkbox" icheck ng-disabled="!vm.userModel.overwriteDriverAssigned" ng-model="vm.userModel.automaticallySendDriverInfoToCustomerBySms"> <i><\/i> <span class="m-l-xs">Automatically send driver details to the client by SMS<\/span><\/label><\/div><\/div><div class="col-md-6"><div class="checkbox-inline i-checks"><label class="checkboxLabel weight-400"><input name="overwriteDriverArrived" type="checkbox" icheck ng-model="vm.userModel.overwriteDriverArrived"> <i><\/i> <label class="control-label">Overwrite website settings - When driver arrived at pickup location:<\/label><\/label><\/div><br><div class="checkbox i-checks"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverArrivedEmail" type="checkbox" icheck ng-disabled="!vm.userModel.overwriteDriverArrived" ng-model="vm.userModel.automaticallySendDriverArrivedEmail"> <i><\/i> <span class="m-l-xs">Automatically send driver GPS location to the client by Email<\/span><\/label><\/div><div class="checkbox i-checks"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverArrivedSms" type="checkbox" icheck ng-disabled="!vm.userModel.overwriteDriverArrived" ng-model="vm.userModel.automaticallySendDriverArrivedSms"> <i><\/i> <span class="m-l-xs">Automatically send driver GPS location to the client by SMS<\/span><\/label><\/div><\/div><\/div><hr><div class="form-group row"><label class="col-sm-2 control-label">Invoice Details<\/label><div class="col-sm-10"><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.isCompany" data-ng-value="false" value="false" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Personal account<\/span><\/label><\/div><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.isCompany" data-ng-value="true" value="true" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Company details (for invoice)<\/span><\/label><\/div><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyName.$pristine }"><label class="col-sm-2 control-label">Company Name<\/label><div class="col-sm-10"><input name="companyName" ng-model="vm.userModel.companyName" ng-disabled="vm.userModel.isCompany == false" type="text" placeholder="Private Company Ltd" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.vatNumber.$pristine }"><label class="col-sm-2 control-label">Vat Number<\/label><div class="col-sm-10"><input type="text" name="vatNumber" ng-model="vm.userModel.vatNumber" ng-disabled="vm.userModel.isCompany == false" placeholder="GB999 9999 73" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyStreetAddress.$pristine }"><label class="col-sm-2 control-label">Street Address<\/label><div class="col-sm-10"><input name="companyStreetAddress" ng-model="vm.userModel.companyStreetAddress" ng-disabled="vm.userModel.isCompany == false" type="text" placeholder="10 Oxford St" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyAdditionalAddress.$pristine }"><label class="col-sm-2 control-label">Additional address<\/label><div class="col-sm-10"><input type="text" name="companyAdditionalAddress" ng-model="vm.userModel.companyAdditionalAddress" ng-disabled="vm.userModel.isCompany == false" placeholder="Hammersmith" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyZipCode.$pristine }"><label class="col-sm-2 control-label">Zip Code<\/label><div class="col-sm-10"><input type="text" name="companyZipCode" ng-model="vm.userModel.companyZipCode" ng-disabled="vm.userModel.isCompany == false" placeholder="W1D 1BS" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyCity.$pristine }"><label class="col-sm-2 control-label">City<\/label><div class="col-sm-10"><input type="text" name="companyCity" ng-model="vm.userModel.companyCity" ng-disabled="vm.userModel.isCompany == false" placeholder="London" class="form-control"><\/div><\/div><div class="form-group row" ng-class="{\'field-changed\' : !vm.userDetailsForm.costCenter.$pristine }"><label class="col-sm-2 control-label">Cost Centre<\/label><div class="col-sm-10"><input type="text" name="costCenter" ng-model="vm.userModel.costCenter" ng-disabled="vm.userModel.isCompany == false" placeholder="GB06C23MGTX" class="form-control"><\/div><\/div><br><div class="row text-center"><div class="col-sm-12"><button class="btn btn-primary m-r-md" ng-class="{disabled : vm.userDetailsForm.$pristine}" ng-click="vm.updateUser()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> <i class="fa fa-save" ng-show="!vm.sending"><\/i> Save<\/button> <button class="btn btn-danger m-l-md" ng-click="vm.cancel()"><i class="fa fa-times"><\/i> Cancel<\/button><\/div><\/div><\/form><style>\r\n    .pl-0 {\r\n        padding-left: 0 !important;\r\n    }\r\n\r\n     .checkbox label {\r\n         padding-left: 5px !important;\r\n     }\r\n\r\n    .text-left {\r\n        text-align: left;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getUserCreditInfo(f.websiteGuid,f.userGuid).then(function(n){n.data.success&&(n.data.result.logEntries.forEach(function(n){var t=moment(n.timestamp);n.parsedDate=t.format("DD-MM-YYYY HH:mm")}),f.model=n.data.result)})};f.cancel=function(){f.onFinish&&f.onFinish()};f.changeCredit=function(){f.sending||(f.sending=!0,f.userModel.roles="Client",r.updateUserInfo(f.userModel).then(function(n){if(n.data.success){if(u.showNotification("success","Client saved"),f.initForm(n.data.result),f.onFinish)f.onFinish({result:n.data.result})}else u.showNotificationList("error",n.data.errors),f.sending=!1},function(){f.sending=!1;u.showNotification("error","Something went wrong. Please try again.")}))}}var n=angular.module("bookingApp");n.component("updateClientCredit",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<",onFinish:"&"},template:'<form name="vm.userCreditsForm" class="form-horizontal"><div class="row"><div class="col-sm-12"><table class="table table-hover"><thead><tr><th>Op<\/th><th>Date<\/th><th>Description<\/th><th>Amount<\/th><th>Value<\/th><\/tr><\/thead><tbody><tr ng-repeat="logEntry in vm.model.logEntries track by logEntry.guid"><td><span ng-show="logEntry.operation == 10 || logEntry.operation == 20">Add<\/span> <span ng-show="logEntry.operation == 30">Remove<\/span><\/td><td>{{logEntry.parsedDate}}<\/td><td>{{logEntry.description}}<\/td><td>{{logEntry.delta}}<\/td><td>{{logEntry.newValue}} {{invoice.currencyCode}}<\/td><\/tr><\/tbody><\/table><\/div><\/div><div class="row text-center"><div class="col-sm-12"><button class="btn btn-danger m-l-md" ng-click="vm.cancel()"><i class="fa fa-times"><\/i> Close<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getClientPrices(f.userGuid).then(function(n){n.data.success&&(f.model=n.data.result)})};f.cancel=function(){f.onFinish&&f.onFinish()};f.updatePrices=function(){f.sending||(f.sending=!0,r.saveClientPrices(f.model).then(function(n){if(n.data.success){if(u.showNotification("success","Client prices saved."),f.sending=!1,f.onFinish)f.onFinish({result:n.data.result})}else u.showNotificationList("error",n.data.errors),f.sending=!1},function(){f.sending=!1;u.showNotification("error","Something went wrong. Please try again.")}))}}var n=angular.module("bookingApp");n.component("editClientPrices",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",onFinish:"&"},template:'<form name="vm.editClientPricesForm" class="form-horizontal"><div ng-repeat="customPrice in vm.model.prices track by customPrice.carClassGuid"><h3>{{customPrice.carClassName}} rates<\/h3><div class="form-group"><label class="col-sm-2 control-label">Hourly:<\/label><div class="col-sm-10"><input name="hourlyRate" ng-model="customPrice.hourly" type="text" class="form-control"><\/div><\/div><div class="form-group"><label class="col-sm-2 control-label">Per minute:<\/label><div class="col-sm-10"><input name="hourlyRate" ng-model="customPrice.perMinute" type="text" class="form-control"><\/div><\/div><div class="form-group"><label class="col-sm-2 control-label">Min trip value:<\/label><div class="col-sm-10"><input name="hourlyRate" ng-model="customPrice.minTripPrice" type="text" class="form-control"><\/div><\/div><div class="form-group"><label class="col-sm-2 control-label">Per mile:<\/label><div class="col-sm-10"><input name="hourlyRate" ng-model="customPrice.perMile" type="text" class="form-control"><\/div><\/div><div class="form-group"><label class="col-sm-2 control-label">Discount (%):<\/label><div class="col-sm-10"><input name="hourlyRate" ng-model="customPrice.discountPercentage" type="text" class="form-control"><\/div><\/div><hr><\/div><br><div class="row text-center"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-class="{disabled : vm.editClientPricesForm.$pristine}" ng-click="vm.updatePrices()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Save<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.cancel()">Cancel<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.isLoading=!0;f.isSaving=!1;f.carPrice={unitsEnhancements:[]};f.addUnitEnhancement=function(){f.carPrice.unitsEnhancements.push({units:10,price:1})};f.$onInit=function(){r.getPricePlanConfiguration(f.websiteGuid,f.pricePlanGuid,f.regionGuid).then(function(n){console.log(n.data.success);n.data.success&&(f.model=n.data.result);f.isLoading=!1;f.pricePlanEditForm.$setPristine();f.pricePlanEditForm.$setUntouched()})};f.saveChanges=function(){f.isSaving||(f.isSaving=!0,r.savePricePlanConfiguration(f.model).then(function(n){n.data.success?(u.showNotification("success","Price plan saved successfully."),f.isSaving=!1,f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():t.location.reload()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Error. Price plan was not saved.");f.isSaving=!1},function(){u.showNotification("error","Error. Price plan was not saved.");f.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("pricePlanEdit",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<",regionGuid:"<",clientGuid:"<"},template:'<form name="vm.pricePlanEditForm" class="form-horizontal" ng-show="!vm.isLoading"><h2 class="m-b-md"><b>General<\/b><\/h2><div class="row"><div class="col-md-6 price-plan-form"><div class="form-inline"><label class="control-label">Base unit:<\/label> <label class="m-r-sm"><input type="radio" icheck value="0" data-ng-value="0" ng-model="vm.model.metricUnits"> Mile<\/label> <label class="m-l-sm"><input type="radio" icheck value="1" data-ng-value="1" ng-model="vm.model.metricUnits"> Kilometer<\/label><\/div><\/div><div class="col-md-6"><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .price-plan-form .control-label {\r\n        min-width: 100px;\r\n        text-align: left;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.isLoading=!0;e.$onInit=function(){f.getWebsiteRegions(e.websiteGuid).then(function(n){console.log(n.data.result);e.model=n.data.result;e.isLoading=!1})};e.editWebsiteRegion=function(n,t){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-website-region guid='vm.guid' website-guid='vm.websiteGuid' client-guid='vm.parentVm.clientGuid' duplicate='vm.duplicate' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-website-region><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},websiteGuid:function(){return e.websiteGuid},modalTitle:function(){return n?"Edit Region "+n.name:"Create New Region"}},controller:["$uibModalInstance","parentVm","guid","websiteGuid","modalTitle",function(n,i,r,u,f){var e=this;e.parentVm=i;e.guid=r;e.websiteGuid=u;e.modalTitle=f;e.duplicate=t;e.$uibModalInstance=n;e.dismiss=function(){e.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removeWebsiteRegion=function(n){u.showConfirmation("Warning","Delete region "+n.name+"?").then(function(){f.deleteWebsiteRegion(e.websiteGuid,n.guid).then(function(t){if(t.data.success){u.showNotification("success","Region was removed.");var i=e.model.regions.findIndex(function(t){return t.guid===n.guid});i>-1&&e.model.regions.splice(i,1)}else u.showNotificationList("error",t.data.errors)})})};e.removePricePlan=function(n){u.showConfirmation("Warning","Delete region '"+n.name+"' prices? Region will use default website prices.").then(function(){f.deleteWebsiteRegionPricePlan(e.websiteGuid,n.guid).then(function(n){n.data.success?(u.showNotification("success","Region was removed."),e.$onInit()):u.showNotificationList("error",n.data.errors)})})}}var n=angular.module("bookingApp");n.component("manageWebsiteRegions",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<div class="row"><div class="col-sm-5 m-b-xs"><\/div><div class="col-sm-4"><\/div><div class="col-sm-3 m-b-xs"><div class="input-group"><input type="text" ng-model="vm.searchText" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary m-r-lg">Go!<\/button> <button type="button" class="btn btn-sm btn-primary" ng-click="vm.editWebsiteRegion(null)"><i class="fa fa-plus"><\/i> Add Region<\/button><\/span><\/div><\/div><\/div><table class="table table-hover"><thead><tr><td><b>Region Name<\/b><\/td><td style="max-width: 60px; text-align: center"><b>Address<\/b><\/td><td style="max-width: 60px; text-align: center"><b>Price plan<\/b><\/td><td><\/td><\/tr><\/thead><tbody ng-repeat="region in vm.model.regions | filter:vm.searchText"><tr><td class="align-middle">{{region.name}}<\/td><td class="text-center align-middle">{{region.address}} (and <span ng-show="vm.model.metricUnit == 0">{{region.radiusInMiles}} miles<\/span> <span ng-show="vm.model.metricUnit == 1">{{region.radiusInkilometers}} km<\/span> around)<\/td><td class="align-middle" style="text-align: center"><a ng-show="region.hasPricePlan" ng-href="/prices/EditWebsiteRegionPricePlan/?websiteguid=ff075f5b-1a21-493c-9b03-3c08c5dbf223&regionGuid={{region.guid}}"><p class="text-warning">Is Using Custom Prices<\/p><\/a><p ng-show="!region.hasPricePlan">Is Using Website Prices<\/p><\/td><td class="text-right align-middle"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editWebsiteRegion(region)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <a class="btn btn-success btn-sm m-r-xs m-l-xs" ng-show="!region.hasPricePlan" ng-href="/prices/EditWebsiteRegionPricePlan/?websiteguid={{vm.websiteGuid}}&regionGuid={{region.guid}}"><i class="fa fa-dollar" aria-hidden="true"><\/i> Set Prices<\/a> <a class="btn btn-success btn-sm m-r-xs m-l-xs" ng-show="region.hasPricePlan" ng-href="/prices/EditWebsiteRegionPricePlan/?websiteguid={{vm.websiteGuid}}&regionGuid={{region.guid}}"><i class="fa fa-dollar" aria-hidden="true"><\/i> View Prices<\/a> <button class="btn btn-danger btn-sm m-r-xs m-l-xs" ng-show="region.hasPricePlan" ng-click="vm.removePricePlan(region)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete Prices<\/button> <button class="btn btn-danger btn-sm m-l-xl" ng-click="vm.removeWebsiteRegion(region)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete Region<\/button><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.loading=!0;console.log("test");f.$onInit=function(){r.getWebsiteRegionInfo(f.websiteGuid,f.guid,f.duplicate).then(function(n){console.log(n.data.result);f.model=n.data.result;f.model.displayName=f.model.address?f.model.address:f.model.name;f.latLng={lat:f.model.lat,lng:f.model.lng}})};f.originChangedHandler=function(n){console.log(n);console.log(f.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());f.model.displayName=n.formatted_address;f.model.name=n.name;f.model.address=n.formatted_address;f.model.lat=n.geometry.location.lat();f.model.lng=n.geometry.location.lng();f.latLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}};f.saveChanges=function(){r.saveWebsiteRegion(f.model).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website region saved"),f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Error: Website region could not be saved.")},function(){u.showNotification("error","Error: Website region could not be saved.")})}}var n=angular.module("bookingApp");n.component("editWebsiteRegion",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",websiteGuid:"<",name:"<",duplicate:"<",dismiss:"&",saved:"&"},template:'<form class="editFixedPricesForm" name="vm.editRegionForm"><div class="row"><div class="col-sm-12"><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>Address:<\/label> <input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Region center address" ng-autocomplete ng-model="vm.model.displayName" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="originRadius" type="text" class="form-control original-style" name="originRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.radiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Region name:<\/label> <input id="originName" type="text" class="form-control original-style" name="originDisplayName" placeholder="Ex: Heathrow airport" ng-model="vm.model.name"><\/div><\/div><div class="row" ng-show="vm.model.timezoneInfoId"><div class="col-sm-12"><label>Timezone:<\/label> <span>{{vm.model.timezoneInfoId}}<\/span><\/div><\/div><\/div><div class="col-sm-12"><location-selector-map location-info="vm.latLng" radius="vm.model.radiusInMeters" id="origin-map"><\/location-selector-map><\/div><div class="row text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()">Save<\/button> <button type="button" class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/div><\/form><style>\r\n    .editFixedPricesForm .row {\r\n        margin-bottom: 15px;\r\n    }\r\n\r\n    .visibleMap {\r\n        min-height: 350px;\r\n        margin-bottom: 5px;\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .pac-container {\r\n        z-index: 9000;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u){function e(n){return Math.floor(n*.000621371192)}var f=this;f.$onInit=function(){f.pricePlanGuid&&f.getWebsiteFixedPriceInfo();f.clientGuid&&f.getClientFixedPriceInfo();r.getCarClasses().then(function(n){console.log(n.data.result);f.availableCarClasses=n.data.result})};f.getWebsiteFixedPriceInfo=function(){r.getWebsiteFixedPriceInfo(f.websiteGuid,f.pricePlanGuid,f.guid,f.duplicate).then(function(n){console.log(n.data.result);f.model=n.data.result;f.model.fromDisplayName=f.model.fromAddress?f.model.fromAddress:f.model.fromName;f.fromLatLng={lat:f.model.fromLat,lng:f.model.fromLng};f.model.toDisplayName=f.model.toAddress?f.model.toAddress:f.model.toName;f.toLatLng={lat:f.model.toLat,lng:f.model.toLng};f.updateDistanceAndTime()})};f.getClientFixedPriceInfo=function(){r.getClientFixedPriceInfo(f.websiteGuid,f.clientGuid,f.guid,f.duplicate).then(function(n){console.log(n.data.result);f.model=n.data.result;f.model.fromDisplayName=f.model.fromAddress?f.model.fromAddress:f.model.fromName;f.fromLatLng={lat:f.model.fromLat,lng:f.model.fromLng};f.model.toDisplayName=f.model.toAddress?f.model.toAddress:f.model.toName;f.toLatLng={lat:f.model.toLat,lng:f.model.toLng};f.updateDistanceAndTime()})};f.dupliacateCarType=function(n,t){var i={carTypeGuid:n.carTypeGuid,carTypeName:n.carTypeName};f.model.carFixedPrices.splice(t+1,0,i)};f.removeCarType=function(n,t){f.model.carFixedPrices.splice(t,1)};f.originChangedHandler=function(n){console.log(n);console.log(f.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());f.model.fromDisplayName=n.formatted_address;f.model.fromName=n.name;f.model.fromAddress=n.formatted_address;f.model.fromLat=n.geometry.location.lat();f.model.fromLng=n.geometry.location.lng();f.fromLatLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};f.updateDistanceAndTime()};f.destinationChangedHandler=function(n){console.log(n);console.log(f.destination.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());f.model.toDisplayName=n.formatted_address;f.model.toName=n.name;f.model.toAddress=n.formatted_address;f.model.toLat=n.geometry.location.lat();f.model.toLng=n.geometry.location.lng();f.toLatLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};f.updateDistanceAndTime()};f.updateDistanceAndTime=function(){function t(n,t){var i,r;console.log(n);console.log(t);t==="OK"&&(i=n.rows[0].elements[0].distance,f.distanceDisplay=e(i.value),r=n.rows[0].elements[0].duration,f.durationDisplay=r.text,console.log(i))}if(f.model.fromDisplayName&&f.model.toDisplayName&&f.fromLatLng.lat!==0&&f.fromLatLng.lng!==0&&f.toLatLng.lat!==0&&f.toLatLng.lng!==0){var n=new google.maps.DistanceMatrixService;n.getDistanceMatrix({origins:[f.model.fromDisplayName],destinations:[f.model.toDisplayName],travelMode:"DRIVING"},t)}};f.saveChanges=function(){f.pricePlanGuid&&r.saveWebsiteFixedPrice(f.model).then(function(n){f.priceSaved(n)},function(){u.showNotification("error","Fixed price could not be saved.")});f.clientGuid&&r.saveClientFixedPrice(f.model).then(function(n){f.priceSaved(n)},function(){u.showNotification("error","Fixed price could not be saved.")})};f.priceSaved=function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Fixed price saved"),f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Fixed could not be saved.")}}var n=angular.module("bookingApp");n.component("editCarFixedPrices",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",websiteGuid:"<",pricePlanGuid:"<",clientGuid:"<",duplicate:"<",dismiss:"&",saved:"&"},template:'<form class="editFixedPricesForm" name="vm.editFixedPricesForm"><div class="row"><div class="col-sm-6"><h2>From:<\/h2><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>From address:<\/label> <input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.model.fromDisplayName" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="originRadius" type="text" class="form-control original-style" name="originRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.fromRadiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Display name:<\/label> <input id="originName" type="text" class="form-control original-style" name="originDisplayName" placeholder="Ex: Heathrow airport" ng-model="vm.model.fromName"><\/div><\/div><\/div><div class="col-sm-6"><h2>To:<\/h2><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>To address:<\/label> <input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.model.toDisplayName" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="destinationRadius" type="text" class="form-control original-style" name="destinationRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.toRadiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Display name:<\/label> <input id="destinationName" type="text" class="form-control original-style" name="destinationDisplayName" placeholder="Ex: Heathrow airport" ng-model="vm.model.toName"><\/div><\/div><\/div><\/div><div class="row"><div class="col-sm-6"><table class="table table-hover"><tbody><tr ng-repeat="item in vm.model.carFixedPrices"><td>{{item.carTypeName}}<\/td><td><i class="fa fa-user"><\/i> <input style="display: inline-block; max-width: 50px" ng-model="item.numberOfPassengers" type="text" class="form-control"><\/td><td><i class="fa fa-suitcase"><\/i> <input style="display: inline-block; max-width: 50px" ng-model="item.numberOfLuggages" type="text" class="form-control"><\/td><td><i class="fa fa-dollar"><\/i> <input style="display: inline-block; max-width: 70px" ng-model="item.price" type="text" class="form-control"><\/td><td><button class="btn btn-success btn-xs" ng-click="vm.dupliacateCarType(item, $index)"><i class="fa fa-copy" aria-hidden="true"><\/i> Duplicate<\/button> <button class="btn btn-danger btn-xs m-l-xs" ng-hide="item.hideRemove" ng-click="vm.removeCarType(item, $index)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table><\/div><div class="col-sm-6"><label>Offer fixed price for both ways:<\/label><div class="check i-checks"><label class="checkboxLabel" style="margin-top: 5px;"><input type="checkbox" icheck ng-model="vm.model.allowBothWays" data-ng-value="true" value="true" name="allowBothWays"> <i><\/i> <span class="m-l-sm">Both From/To can be used as pick-up point<\/span><\/label><\/div><div ng-show="vm.distanceDisplay"><b>Distance info:<\/b> {{vm.distanceDisplay}} miles will take {{vm.durationDisplay}}<\/div><\/div><\/div><div class="row"><div class="col-sm-6"><location-selector-map location-info="vm.fromLatLng" radius="vm.model.fromRadiusInMeters" id="origin-map"><\/location-selector-map><\/div><div class="col-sm-6"><location-selector-map location-info="vm.toLatLng" radius="vm.model.toRadiusInMeters" id="destination-map"><\/location-selector-map><\/div><\/div><div class="row text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()">Save<\/button> <button type="button" class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .editFixedPricesForm .row {\r\n        margin-bottom: 15px;\r\n    }\r\n\r\n    .visibleMap {\r\n        min-height: 350px;\r\n        margin-bottom: 5px;\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .pac-container {\r\n        z-index: 9000;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){e.pricePlanGuid&&f.getWebsiteFixedPrices(e.websiteGuid,e.pricePlanGuid).then(function(n){console.log(n.data.result);e.fixedPrices=n.data.result});e.clientGuid&&f.getClientFixedPrices(e.websiteGuid,e.clientGuid).then(function(n){console.log(n.data.result);e.fixedPrices=n.data.result})};e.editFixedPrice=function(n,t){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-car-fixed-prices guid='vm.guid' website-guid='vm.websiteGuid' client-guid='vm.parentVm.clientGuid' price-plan-guid='vm.pricePlanGuid'duplicate='vm.duplicate' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-fixed-prices><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},websiteGuid:function(){return e.websiteGuid},pricePlanGuid:function(){return e.pricePlanGuid},modalTitle:function(){return n?"Edit fixed price":"Add fixed price"}},controller:["$uibModalInstance","parentVm","guid","websiteGuid","pricePlanGuid","modalTitle",function(n,i,r,u,f,e){var o=this;o.parentVm=i;o.guid=r;o.websiteGuid=u;o.pricePlanGuid=f;o.modalTitle=e;o.duplicate=t;o.$uibModalInstance=n;o.dismiss=function(){o.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removeFixedPrice=function(n){u.showConfirmation("Warning","Delete fixed price "+n.fromName+" -> "+n.toName+"?").then(function(){f.deleteWebsiteFixedPrice(e.websiteGuid,n.guid).then(function(t){if(t.data.success){u.showNotification("success","Fixed price removed.");var i=e.fixedPrices.findIndex(function(t){return t.guid===n.guid});i>-1&&e.fixedPrices.splice(i,1)}else u.showNotificationList("error",t.data.errors)})})}}var n=angular.module("bookingApp");n.component("carFixedPricesList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<",c:"<",clientGuid:"<"},template:'<div class="row"><div class="col-sm-5 m-b-xs"><\/div><div class="col-sm-4"><\/div><div class="col-sm-3 m-b-xs"><div class="input-group"><input type="text" ng-model="vm.searchText" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary m-r-lg">Go!<\/button> <button type="button" class="btn btn-sm btn-primary" ng-click="vm.editFixedPrice(null, true)"><i class="fa fa-plus"><\/i> Add New<\/button><\/span><\/div><\/div><\/div><div ng-repeat="fixedPrice in vm.fixedPrices | filter:vm.searchText"><\/div><table class="table table-hover"><thead><tr><td><b>From -> To<\/b><\/td><td style="max-width: 60px; text-align: center"><b>Both Ways<\/b><\/td><td><\/td><\/tr><\/thead><tbody ng-repeat="fixedPrice in vm.fixedPrices | filter:vm.searchText"><tr><td>{{fixedPrice.fromName}} ({{fixedPrice.fromRadiusInMeters}} ml) -> {{fixedPrice.toName}} ({{fixedPrice.toRadiusInMeters}} ml)<\/td><td style="max-width: 60px; text-align: center"><i class="fa fa-check" ng-show="fixedPrice.allowBothWays"><\/i><\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editFixedPrice(fixedPrice, false)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <button class="btn btn-primary btn-sm m-r-xs m-l-xs" ng-click="vm.editFixedPrice(fixedPrice, true)"><i class="fa fa-edit" aria-hidden="true"><\/i> Duplicate<\/button> <button class="btn btn-danger btn-sm m-l-xs" ng-click="vm.removeFixedPrice(fixedPrice)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button><\/td><\/tr><tr ng-repeat="fp in fixedPrice.carFixedPrices"><td colspan="2"><table><tbody><tr><td style="min-width: 300px; padding-left: 25px; border-top: none;">{{fp.carTypeName}}<\/td><td style="min-width: 80px; padding-left: 5px; border-top: none;"><i class="fa fa-user"><\/i> {{fp.numberOfPassengers}}<\/td><td style="min-width: 80px; padding-left: 5px; border-top: none;"><i class="fa fa-suitcase"><\/i> {{fp.numberOfLuggages}}<\/td><td style="min-width: 50px; padding-left: 5px; border-top: none; text-align: right">{{fp.price | number: 2 }}<\/td><td style="border-top: none;"><\/td><\/tr><\/tbody><\/table><\/td><td><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.isLoading=!0;f.isSaving=!1;f.carPrice={unitsEnhancements:[]};f.addUnitEnhancement=function(){f.carPrice.unitsEnhancements.push({units:10,price:1})};f.removeUnitEnhancement=function(n){f.carPrice.unitsEnhancements.splice(n,1)};f.printUnits=function(n){var t="";return t=f.carPrice.metricUnits===0?"mile":"km",n>1&&(t+="s"),t};f.$onInit=function(){r.getPricesForCarType(f.websiteGuid,f.pricePlanGuid,f.carTypeGuid).then(function(n){n.data.success&&(f.carPrice=n.data.result);f.isLoading=!1;f.carPricesForm.$setPristine();f.carPricesForm.$setUntouched()})};f.saveChanges=function(){f.isSaving||(f.isSaving=!0,r.savePricesForCarType(f.carPrice).then(function(n){n.data.success?(u.showNotification("success","Car prices saved successfully."),f.isSaving=!1,f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Error. Car prices were not saved.");f.isSaving=!1},function(){u.showNotification("error","Error. Car prices were not saved.");f.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("carClassPrices",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<",carTypeGuid:"<"},template:'<form name="vm.carPricesForm" class="form-horizontal" ng-show="!vm.isLoading"><h2 class="m-b-md text-underline">{{vm.carPrice.carTypeName}} prices<\/h2><div class="row"><div class="col-md-4"><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.minimumTripPrice.$pristine }"><label>Min Trip Price<\/label> <input class="form-control" name="minimumTripPrice" ng-model="vm.carPrice.minimumTripPrice" type="text" required><\/div><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.hourlyRate.$pristine }"><label>Hourly Price<\/label> <input name="hourlyRate" ng-model="vm.carPrice.hourlyRate" type="text" class="form-control" required><\/div><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.minHourlyBookingTime.$pristine }"><label class="m-t-sm">Min Hours To Book<\/label> <input name="minHourlyBookingTime" ng-model="vm.carPrice.minHourlyBookingTime" type="text" class="form-control" required><\/div><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.maxHourlyBookingTime.$pristine }"><label class="m-t-sm">Max Hours To Book<\/label> <input name="maxHourlyBookingTime" ng-model="vm.carPrice.maxHourlyBookingTime" type="text" class="form-control" required><\/div><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.meetAndGreetRate.$pristine }"><label class="m-t-sm">Meet And Greet Price<\/label> <input name="meetAndGreetRate" ng-model="vm.carPrice.meetAndGreetRate" type="text" class="form-control"><\/div><div class="col-sm-6 col-md-6" ng-class="{\'field-changed\' : !vm.carPricesForm.childSeatRate.$pristine }"><label class="m-t-sm">Child Seat Price<\/label> <input name="childSeatRate" ng-model="vm.carPrice.childSeatRate" type="text" class="form-control"><\/div><\/div><div class="col-md-8 m-b-sm"><h3>Mileage price<\/h3><div><label class="m-r-sm">Pickup rate<\/label> <input name="pickupRate" ng-model="vm.carPrice.pickupRate" type="text" ng-class="{\'field-changed\' : !vm.carPricesForm.pickupRate.$pristine }" style="display: inline-block; max-width: 70px" class="form-control" required> <label class="m-l-sm">then ... <button type="button" class="btn btn-green btn-xs m-l-xl" ng-click="vm.addUnitEnhancement()">+ Add Next<\/button><\/label><\/div><ul class="mileage-prices-list"><li ng-repeat="item in vm.carPrice.unitsEnhancements"><span ng-show="$index == 0">First<\/span> <span ng-show="$index !== 0">Next<\/span> <input style="display: inline-block; max-width: 50px" ng-model="item.units" type="text" class="form-control"> <span style="margin-left: 5px; margin-right: 5px">{{vm.printUnits(item.units)}}, pickup rate<\/span> <input style="display: inline-block; max-width: 60px" ng-model="item.pickupRate" type="text" class="form-control"> <span style="margin-left: 10px; margin-right: 10px">and<\/span> <input style="display: inline-block; max-width: 60px" ng-model="item.price" type="text" class="form-control"> <span style="margin-left: 10px; margin-right: 10px">per {{vm.printUnits(0)}}<\/span> <button class="btn btn-xs btn-danger m-l-xl" ng-click="vm.removeUnitEnhancement($index)"><i class="fa fa-remove"><\/i><\/button><\/li><li><span>Remaining {{vm.printUnits(10)}} at<\/span> <input style="display: inline-block; max-width: 70px" ng-model="vm.carPrice.perUnitRate" type="text" class="form-control"> <span style="margin-left: 10px; margin-right: 10px">per {{vm.printUnits(0)}}<\/span><\/li><\/ul><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this,s,o;for(e.model={hourlySurcharges:[]},e.hours=[{id:-1,label:""},{id:0,label:"00"}],s=1;s<24;s++)s<10?e.hours.push({id:s,label:"0"+s}):e.hours.push({id:s,label:s.toString()});for(e.minutes=[],o=0;o<60;o=o+1)o<10?e.minutes.push({id:o,label:"0"+o}):e.minutes.push({id:o,label:o.toString()});e.addHourlySurcharge=function(){e.model.hourlySurcharges.push({})};e.$onInit=function(){u.getHourlySurcharges(e.websiteGuid,e.pricePlanGuid).then(function(n){n.data.success&&(e.model=n.data.result);e.isLoading=!1})};e.removeHourlySurcharge=function(n){e.model.hourlySurcharges.splice(n,1)};e.saveChanges=function(){e.isSaving||(e.isSaving=!0,u.saveHourlySurcharges(e.model).then(function(n){n.data.success?(f.showNotification("success","Hourly surcharges saved successfully."),e.isSaving=!1,e.saved&&e.saved({item:n.data.result}),e.dismiss?e.dismiss():e.$onInit()):n.data.errors?f.showNotificationList("error",n.data.errors):f.showNotification("error","Error. Hourly surcharges were not saved.");e.isSaving=!1},function(){f.showNotification("error","Error. Hourly surcharges were not saved.");e.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("hourlySurcharges",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<",carTypeGuid:"<"},template:'<form name="vm.carPricesForm" class="form-horizontal" ng-show="!vm.isLoading"><div class="row"><div class="col-md-10"><h2 class="text-underline inline-block">Hourly surcharges<\/h2><button type="button" class="btn btn-sm btn-primary m-l-xl" style="margin-top: -8px;" ng-click="vm.addHourlySurcharge()"><i class="fa fa-plus"><\/i> Add New<\/button><\/div><\/div><div class="row" ng-repeat="item in vm.model.hourlySurcharges"><div class="col-md-12" ng-class="{\'m-t-xl\': $index > 0, \'m-t-sm\': $index == 0}"><span style="margin-right: 10px;">Starting from:<\/span><select style="min-width: 40px; padding: 3px 5px;" ng-options="item.id as item.label for item in vm.hours" ng-model="item.startHour"><\/select><span style="font-weight: bold; padding: 0 5px;">:<\/span><select style="min-width: 40px; padding: 3px 5px;" ng-options="item.id as item.label for item in vm.minutes" ng-model="item.startMinute"><\/select><span style="font-weight: bold; padding: 0 25px;">-><\/span><select style="min-width: 40px; padding: 3px 5px;" ng-options="item.id as item.label for item in vm.hours" ng-model="item.endHour"><\/select><span style="font-weight: bold; padding: 0 5px;">:<\/span><select style="min-width: 40px; padding: 3px 5px;" ng-options="item.id as item.label for item in vm.minutes" ng-model="item.endMinute"><\/select><label style="margin-left: 50px;"><input type="checkbox" icheck ng-model="item.showFullyBooked"> Show fully booked<\/label> <span style="margin-left: 60px;">Add <input type="text" style="padding: 3px 5px; margin-left: 10px; margin-right: 10px; width: 30px;" ng-model="item.surcharge">% to booking value<\/span> <span style="margin-left: 60px;">Add <input type="text" style="padding: 3px 5px; margin-left: 10px; margin-right: 10px; width: 30px;" ng-model="item.surchargeAmount"> to booking value<\/span> <button class="btn btn-xs btn-danger" ng-click="vm.removeHourlySurcharge($index)"><i class="fa fa-remove"><\/i><\/button><\/div><div class="col-md-12 m-t-md"><span style="margin-right: 10px;">Apply on:<\/span> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.monday"> Monday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.tuesday"> Tuesday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.wednesday"> Wednesday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.thursday"> Thursday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.friday"> Friday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.saturday"> Saturday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.sunday"> Sunday<\/label><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .surchargeDay {\r\n        margin-left: 15px;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.model={timeLeftSurcharges:[]};e.addTimeLeftSurcharge=function(){e.model.timeLeftSurcharges.push({})};e.showPlural=function(n){if(!n)return!0;var t=parseInt(n);return!(t===1)};e.$onInit=function(){u.getTimeLeftSurcharges(e.websiteGuid,e.pricePlanGuid).then(function(n){n.data.success&&(e.model.timeLeftSurcharges=n.data.result);e.isLoading=!1})};e.removeSurcharge=function(n){e.model.timeLeftSurcharges.splice(n,1)};e.saveChanges=function(){e.isSaving||(e.isSaving=!0,u.saveTimeLeftSurcharges(e.websiteGuid,e.pricePlanGuid,e.model.timeLeftSurcharges).then(function(n){n.data.success?(f.showNotification("success","Hourly surcharges saved successfully."),e.isSaving=!1,e.saved&&e.saved({item:n.data.result}),e.dismiss?e.dismiss():e.$onInit()):n.data.errors?f.showNotificationList("error",n.data.errors):f.showNotification("error","Error. Hourly surcharges were not saved.");e.isSaving=!1},function(){f.showNotification("error","Error. Hourly surcharges were not saved.");e.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("timeLeftSurcharges",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<",carTypeGuid:"<"},template:'<form name="vm.carPricesForm" class="form-horizontal" ng-show="!vm.isLoading"><div class="row"><div class="col-md-10"><h2 class="text-underline inline-block">Time left before pickup surcharges<\/h2><button type="button" class="btn btn-sm btn-primary m-l-xl" style="margin-top: -8px;" ng-click="vm.addTimeLeftSurcharge()"><i class="fa fa-plus"><\/i> Add New<\/button><\/div><\/div><div class="row" ng-repeat="item in vm.model.timeLeftSurcharges"><div class="col-md-12" ng-class="{\'m-t-xl\': $index > 0, \'m-t-sm\': $index == 0}"><span style="margin-right: 0px;">Booking time is less than<\/span> <input type="text" class="form-control inline-block text-center" style="padding: 3px 5px; margin-left: 0px; margin-right: 0px; width: 40px;" ng-model="item.hoursLeft"> <span><b>Hour<span ng-show="vm.showPlural(item.hoursLeft)">s<\/span><\/b> before pickup time<\/span> <label style="margin-left: 50px;"><input type="checkbox" icheck ng-model="item.showFullyBooked"> Show fully booked<\/label> <span style="margin-left: 60px;">Add <input type="text" style="padding: 3px 5px; margin-left: 10px; margin-right: 10px; width: 30px;" ng-model="item.surcharge">% to booking value<\/span> <span style="margin-left: 60px;">Add <input type="text" style="padding: 3px 5px; margin-left: 10px; margin-right: 10px; width: 30px;" ng-model="item.surchargeAmount"> to booking value<\/span> <button class="btn btn-xs btn-danger" ng-click="vm.removeSurcharge($index)"><i class="fa fa-remove"><\/i><\/button><\/div><div class="col-md-12 m-t-md"><span style="margin-right: 10px;">Apply on:<\/span> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.monday"> Monday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.tuesday"> Tuesday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.wednesday"> Wednesday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.thursday"> Thursday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.friday"> Friday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.saturday"> Saturday<\/label> <label class="surchargeDay"><input type="checkbox" icheck ng-model="item.sunday"> Sunday<\/label><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .surchargeDay {\r\n        margin-left: 15px;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.isLoading=!0;o.model={cardExtraItemName:{}};o.$onInit=function(){u.getPaymentMethodsSurcharges(o.websiteGuid,o.pricePlanGuid).then(function(n){console.log("getPaymentMethodsSurcharges: ",n.data);n.data.success&&(o.model=n.data.result);o.isLoading=!1})};o.editItemName=function(){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><i18n-string i18n-model='vm.i18nModel' on-dismiss='vm.dismiss()' on-save='vm.saved(item)'><\/i18n-string><\/modal-component>",resolve:{parentVm:function(){return o},i18nModel:o.model.cardExtraItemName,modalTitle:function(){return"Define item in multiple languages"}},controller:["$uibModalInstance","parentVm","i18nModel","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.modalTitle=r;u.i18nModel=i;u.$uibModalInstance=n;u.saved=function(n){u.parentVm.model.surchargeExtraItemText=n.value;u.$uibModalInstance.dismiss("cancel")};u.dismiss=function(){console.log("dismiss parent");u.$uibModalInstance.dismiss("cancel")}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};o.saveChanges=function(){o.isSaving||(o.isSaving=!0,u.savePaymentMethodsSurcharges(o.websiteGuid,o.pricePlanGuid,o.model).then(function(n){n.data.success?(e.showNotification("success","Hourly surcharges saved successfully."),o.isSaving=!1,o.saved&&o.saved({item:n.data.result}),o.dismiss?o.dismiss():o.$onInit()):n.data.errors?e.showNotificationList("error",n.data.errors):e.showNotification("error","Error. Hourly surcharges were not saved.");o.isSaving=!1},function(){e.showNotification("error","Error. Hourly surcharges were not saved.");o.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("paymentMethodSurcharges",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<"},template:'<form class="form-horizontal" ng-show="!vm.isLoading"><div class="row"><div class="col-md-10"><h2 class="inline-block">Pay by <b>Card<\/b> surcharges:<\/h2><\/div><\/div><div class="row"><div class="col-md-12"><span style="margin-right: 0px;">When paying by credit card<\/span> <span style="margin-left: 20px;">Add percentage <input type="text" class="surcharge-inline-input" ng-model="vm.model.cardSurchargePercentage">% to booking value<\/span> <span style="margin-left: 0px;">, add fixed value of <input type="text" class="surcharge-inline-input" ng-model="vm.model.cardSurchargeFixedValue"> to booking value<\/span><\/div><div class="col-md-12 m-t-sm form-inline"><span class="m-r-md">Show it as an extra item (or leave empty to add it to booking value):<\/span> <input type="text" class="form-control" readonly style="width: 350px;" ng-click="vm.editItemName()" ng-model="vm.model.cardExtraItemName.summary" placeholder="Credit card fee"> <button class="btn btn-sm btn-default" ng-click="vm.editItemName()"><i class="fa fa-globe" aria-hidden="true"><\/i><\/button><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .surchargeDay {\r\n        margin-left: 15px;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .surcharge-inline-input {\r\n        padding: 3px 5px;\r\n        margin-left: 10px;\r\n        margin-right: 10px;\r\n        width: 60px;\r\n        text-align: right;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.isLoading=!0;o.model={itemName:{}};o.$onInit=function(){u.getTaxSurcharges(o.websiteGuid,o.pricePlanGuid).then(function(n){console.log("getPaymentMethodsSurcharges: ",n.data);n.data.success&&(o.model=n.data.result);o.isLoading=!1})};o.editItemName=function(){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><i18n-string i18n-model='vm.i18nModel' on-dismiss='vm.dismiss()' on-save='vm.saved(item)'><\/i18n-string><\/modal-component>",resolve:{parentVm:function(){return o},i18nModel:o.model.itemName,modalTitle:function(){return"Define item in multiple languages"}},controller:["$uibModalInstance","parentVm","i18nModel","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.modalTitle=r;u.i18nModel=i;u.$uibModalInstance=n;u.saved=function(n){u.parentVm.model.surchargeExtraItemText=n.value;u.$uibModalInstance.dismiss("cancel")};u.dismiss=function(){console.log("dismiss parent");u.$uibModalInstance.dismiss("cancel")}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};o.saveChanges=function(){o.isSaving||(o.isSaving=!0,u.saveTaxSurcharges(o.websiteGuid,o.pricePlanGuid,o.model).then(function(n){n.data.success?(e.showNotification("success","Hourly surcharges saved successfully."),o.isSaving=!1,o.saved&&o.saved({item:n.data.result}),o.dismiss?o.dismiss():o.$onInit()):n.data.errors?e.showNotificationList("error",n.data.errors):e.showNotification("error","Error. Hourly surcharges were not saved.");o.isSaving=!1},function(){e.showNotification("error","Error. Hourly surcharges were not saved.");o.isSaving=!1}))}}var n=angular.module("bookingApp");n.component("taxSurcharges",{controller:["$timeout","$window","$scope","AppSettings","bookingApi","$uibModal","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",pricePlanGuid:"<"},template:'<form class="form-horizontal" ng-show="!vm.isLoading"><div class="row"><div class="col-md-10"><h2 class="inline-block">Add State/Government TAX to booking:<\/h2><p>This will add the specified amount or percentage to booking total value. This include car value + any other extras like (e.g. meet & greet)<\/p><\/div><\/div><div class="row"><div class="col-md-12"><span style="margin-right: 0px;">Add to booking value<\/span> <span style="margin-left: 0px;">a percentage of <input type="text" class="surcharge-inline-input" ng-model="vm.model.percentage">%<\/span> <span style="margin-left: 20px;">add fixed value of <input type="text" class="surcharge-inline-input" ng-model="vm.model.fixedValue"><\/span><\/div><div class="col-md-12 m-t-sm form-inline"><span class="m-r-md">Show it as an extra item named:<\/span> <input type="text" class="form-control" readonly style="width: 350px;" ng-click="vm.editItemName()" ng-model="vm.model.itemName.summary" placeholder="State tax / VAT"> <button class="btn btn-sm btn-default" ng-click="vm.editItemName()"><i class="fa fa-globe" aria-hidden="true"><\/i><\/button><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .surchargeDay {\r\n        margin-left: 15px;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        margin: 10px 0;\r\n    }\r\n\r\n    .mileage-prices-list li {\r\n        font-size: 13px;\r\n        font-weight: bold;\r\n    }\r\n\r\n    .surcharge-inline-input {\r\n        padding: 3px 5px;\r\n        margin-left: 10px;\r\n        margin-right: 10px;\r\n        width: 60px;\r\n        text-align: right;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.isLoading=!0;u.$onInit=function(){r.getWebsiteIFrameSettings(u.websiteGuid).then(function(n){n.data.success&&(console.log(n.data.result),n.data.result.termsAndCondHtml&&(u.termsAndCondHtml=n.data.result.termsAndCondHtml));u.isLoading=!1},function(){u.isLoading=!1})};u.cancel=function(){u.dismiss?u.dismiss():u.$onInit()}}var n=angular.module("bookingApp");n.component("termsAndConditions",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",dismiss:"&",saved:"&"},template:'<div class="row" ng-show="vm.isLoading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><div ng-show="!vm.isLoading"><div ng-show="vm.termsAndCondHtml" ng-bind-html="vm.termsAndCondHtml | trustAsHtml"><\/div><div ng-show="!vm.termsAndCondHtml"><h2>No Terms & Conditions available<\/h2><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.mainLanguage="en";f.allowedLanguages=[{code:"en",name:"English"},{code:"de",name:"German (Standard)"},{code:"es",name:"Spanish (Spain)"},{code:"fr",name:"French (Standard)"},{code:"it",name:"Italian (Standard)"},{code:"pl",name:"Polish"},{code:"ru",name:"Russian"},{code:"ja",name:"Japanese"},{code:"ko",name:"Korean"},{code:"hi",name:"Hindi"},{code:"ta",name:"Tamil"},{code:"th",name:"Thai"}];f.$onInit=function(){console.log("vm.$onInit")};f.saveChanges=function(){var n,t;if(console.log("vm.saveChanges",f.i18nModel),!f.i18nModel.translations[f.mainLanguage]){u.showNotification("error","Default language cannot be empty. Please fill English version.");return}for(n in f.i18nModel.translations)f.i18nModel.translations[n]||delete f.i18nModel.translations[n];if(t=Object.keys(f.i18nModel.translations).length,f.i18nModel.defaultValue=f.i18nModel.translations[f.mainLanguage],f.i18nModel.summary=f.i18nModel.translations[f.mainLanguage]+" (translated in "+t+" languages)",f.onSave)f.onSave({item:f.i18nModel})};f.dismissChanges=function(){console.log("vm.dismiss");f.onDismiss&&f.onDismiss()}}var n=angular.module("bookingApp");n.component("i18nString",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{i18nModel:"<",onDismiss:"&",onSave:"&"},template:'<div><div class="row"><div class="col-md-6" ng-repeat="language in vm.allowedLanguages"><label class="m-r-md m-t-md">{{language.name}}<\/label> <input type="text" class="form-control inline-block" ng-model="vm.i18nModel.translations[language.code]"><\/div><\/div><div class="row text-center m-t-lg"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.isSaving"><\/i> Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismissChanges()">Dismiss<\/button><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getAllowedPickupRegions(e.websiteGuid).then(function(n){console.log(n.data.result);e.pickupRegions=n.data.result})};e.editPickupRegion=function(n,t){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-pickup-region guid='vm.guid' website-guid='vm.websiteGuid' client-guid='vm.parentVm.clientGuid' duplicate='vm.duplicate' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-pickup-region><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},websiteGuid:function(){return e.websiteGuid},modalTitle:function(){return n?"Edit pickup region":"Add new pickup region"}},controller:["$uibModalInstance","parentVm","guid","websiteGuid","modalTitle",function(n,i,r,u,f){var e=this;e.parentVm=i;e.guid=r;e.websiteGuid=u;e.modalTitle=f;e.duplicate=t;e.$uibModalInstance=n;e.dismiss=function(){e.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removePickupRegion=function(n){u.showConfirmation("Warning","Delete pickup region "+n.name+"?").then(function(){f.deletePickupRegion(n.guid).then(function(t){if(t.data.success){u.showNotificationList("success",t.data.successMessages);var i=e.pickupRegions.findIndex(function(t){return t.guid===n.guid});i>-1&&e.pickupRegions.splice(i,1)}else u.showNotificationList("error",t.data.errors)})})}}var n=angular.module("bookingApp");n.component("pickupRegionsList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<",clientGuid:"<"},template:'<div class="row"><div class="col-sm-6 col-md-8"><h2 class="pickup-regions-header m-t-none">Configure allowed pickup regions<\/h2><\/div><div class="col-sm-6 col-md-4"><div class="input-group"><input type="text" ng-model="vm.searchText" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary m-r-lg">Go!<\/button> <button type="button" class="btn btn-sm btn-primary" ng-click="vm.editPickupRegion(null, true)"><i class="fa fa-plus"><\/i> Add New<\/button><\/span><\/div><\/div><\/div><div class="row"><div class="col-sm-12"><table class="table table-hover"><thead><tr><td><b>Name<\/b><\/td><td><b>Address & Radius<\/b><\/td><\/tr><\/thead><tbody><tr ng-repeat="pickupRegion in vm.pickupRegions | filter:vm.searchText"><td>{{pickupRegion.name}}<\/td><td>{{pickupRegion.address}} <b>and<\/b> {{pickupRegion.radiusInMiles}} miles around<\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editPickupRegion(pickupRegion, false)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <button class="btn btn-primary btn-sm m-r-xs m-l-xs" ng-click="vm.editPickupRegion(pickupRegion, true)"><i class="fa fa-edit" aria-hidden="true"><\/i> Duplicate<\/button> <button class="btn btn-danger btn-sm m-l-xs" ng-click="vm.removePickupRegion(pickupRegion)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getPickupRegionDetails(f.websiteGuid,f.guid,f.duplicate).then(function(n){f.model=n.data.result;f.model.displayName=f.model.address?f.model.address:f.model.name;f.latLng={lat:f.model.lat,lng:f.model.lng};f.updateDistanceAndTime()})};f.originChangedHandler=function(n){f.model.displayName=n.formatted_address;f.model.name=n.name;f.model.address=n.formatted_address;f.model.lat=n.geometry.location.lat();f.model.lng=n.geometry.location.lng();f.latLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};f.updateDistanceAndTime()};f.saveChanges=function(){r.savePickupRegion(f.model).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Pickup region saved successful"),f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Pickup region could not be saved.")},function(){u.showNotification("error","Pickup region could not be saved.")})}}var n=angular.module("bookingApp");n.component("editPickupRegion",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",duplicate:"<",websiteGuid:"<",dismiss:"&",saved:"&"},template:'<form class="editPickupRegionForm" name="vm.editPickupRegionForm"><div class="row"><div class="col-sm-12"><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>Pickup region center:<\/label> <input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Address or airport" ng-autocomplete ng-model="vm.model.displayName" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="originRadius" type="text" class="form-control original-style" name="originRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.radiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Display name:<\/label> <input id="originName" type="text" class="form-control original-style" name="originDisplayName" placeholder="Ex: Central London" ng-model="vm.model.name"><\/div><\/div><\/div><div class="col-sm-12"><location-selector-map location-info="vm.latLng" radius="vm.model.radiusInMeters" id="origin-map"><\/location-selector-map><\/div><\/div><div class="row text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()">Save<\/button> <button type="button" class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .visibleMap {\r\n        min-height: 350px;\r\n        margin-bottom: 5px;\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .pac-container {\r\n        z-index: 19000;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getFixedPrices(e.websiteGuid,e.clientGuid).then(function(n){console.log(n.data.result);e.fixedPrices=n.data.result})};e.editFixedPrice=function(n,t){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-fixed-prices guid='vm.guid' website-guid='vm.websiteGuid' client-guid='vm.parentVm.clientGuid' duplicate='vm.duplicate' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-fixed-prices><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},websiteGuid:function(){return e.websiteGuid},modalTitle:function(){return n?"Edit fixed price":"Add fixed price"}},controller:["$uibModalInstance","parentVm","guid","websiteGuid","modalTitle",function(n,i,r,u,f){var e=this;e.parentVm=i;e.guid=r;e.websiteGuid=u;e.modalTitle=f;e.duplicate=t;e.$uibModalInstance=n;e.dismiss=function(){e.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removeFixedPrice=function(n){u.showConfirmation("Warning","Delete fixed price "+n.fromName+" -> "+n.toName+"?").then(function(){f.deleteFixedPrice(n.guid).then(function(t){if(t.data.success){u.showNotification("success","Fixed price removed.");var i=e.fixedPrices.findIndex(function(t){return t.guid===n.guid});i>-1&&e.fixedPrices.splice(i,1)}else u.showNotificationList("error",t.data.errors)})})}}var n=angular.module("bookingApp");n.component("fixedPricesList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<",clientGuid:"<"},template:'<div class="row"><div class="col-sm-5 m-b-xs"><\/div><div class="col-sm-4"><\/div><div class="col-sm-3 m-b-xs"><div class="input-group"><input type="text" ng-model="vm.searchText" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary m-r-lg">Go!<\/button> <button type="button" class="btn btn-sm btn-primary" ng-click="vm.editFixedPrice(null, true)"><i class="fa fa-plus"><\/i> Add New<\/button><\/span><\/div><\/div><\/div><table class="table table-hover"><thead><tr><td><b>Car Type<\/b><\/td><td><b>From -> To<\/b><\/td><td style="max-width: 60px; text-align: center"><b>Both Ways<\/b><\/td><td><b>Price<\/b><\/td><\/tr><\/thead><tbody><tr ng-repeat="fixedPrice in vm.fixedPrices | filter:vm.searchText"><td>{{fixedPrice.carTypeName}}<\/td><td>{{fixedPrice.fromName}} ({{fixedPrice.fromRadiusInMeters}} ml) -> {{fixedPrice.toName}} ({{fixedPrice.toRadiusInMeters}} ml)<\/td><td style="max-width: 60px; text-align: center"><i class="fa fa-check" ng-show="fixedPrice.allowBothWays"><\/i><\/td><td>{{fixedPrice.price}}<\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editFixedPrice(fixedPrice, false)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <button class="btn btn-primary btn-sm m-r-xs m-l-xs" ng-click="vm.editFixedPrice(fixedPrice, true)"><i class="fa fa-edit" aria-hidden="true"><\/i> Duplicate<\/button> <button class="btn btn-danger btn-sm m-l-xs" ng-click="vm.removeFixedPrice(fixedPrice)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r,u){function e(n){return Math.floor(n*.000621371192)}var f=this;f.$onInit=function(){r.getFixedPriceInfo(f.websiteGuid,f.clientGuid,f.guid,f.duplicate).then(function(n){console.log(n.data.result);f.model=n.data.result;f.model.fromDisplayName=f.model.fromAddress?f.model.fromAddress:f.model.fromName;f.fromLatLng={lat:f.model.fromLat,lng:f.model.fromLng};f.model.toDisplayName=f.model.toAddress?f.model.toAddress:f.model.toName;f.toLatLng={lat:f.model.toLat,lng:f.model.toLng};f.updateDistanceAndTime()});r.getCarClasses().then(function(n){console.log(n.data.result);f.availableCarClasses=n.data.result})};f.originChangedHandler=function(n){console.log(n);console.log(f.origin.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());f.model.fromDisplayName=n.formatted_address;f.model.fromName=n.name;f.model.fromAddress=n.formatted_address;f.model.fromLat=n.geometry.location.lat();f.model.fromLng=n.geometry.location.lng();f.fromLatLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};f.updateDistanceAndTime()};f.destinationChangedHandler=function(n){console.log(n);console.log(f.destination.name+", "+n.formatted_address+", "+n.geometry.location.lat()+", "+n.geometry.location.lng());f.model.toDisplayName=n.formatted_address;f.model.toName=n.name;f.model.toAddress=n.formatted_address;f.model.toLat=n.geometry.location.lat();f.model.toLng=n.geometry.location.lng();f.toLatLng={lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};f.updateDistanceAndTime()};f.updateDistanceAndTime=function(){function t(n,t){var i,r;console.log(n);console.log(t);t==="OK"&&(i=n.rows[0].elements[0].distance,f.distanceDisplay=e(i.value),r=n.rows[0].elements[0].duration,f.durationDisplay=r.text,console.log(i))}if(f.model.fromDisplayName&&f.model.toDisplayName&&f.fromLatLng.lat!==0&&f.fromLatLng.lng!==0&&f.toLatLng.lat!==0&&f.toLatLng.lng!==0){var n=new google.maps.DistanceMatrixService;n.getDistanceMatrix({origins:[f.model.fromDisplayName],destinations:[f.model.toDisplayName],travelMode:"DRIVING"},t)}};f.saveChanges=function(){r.saveFixedPrice(f.model).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Fixed price saved"),f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Account roles could not be saved.")},function(){u.showNotification("error","Account roles could not be saved.")})}}var n=angular.module("bookingApp");n.component("editFixedPrices",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",clientGuid:"<",duplicate:"<",websiteGuid:"<",dismiss:"&",saved:"&"},template:'<form class="editFixedPricesForm" name="vm.editFixedPricesForm"><div class="row"><div class="col-sm-6"><h2>From:<\/h2><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>From address:<\/label> <input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.model.fromDisplayName" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.originChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="originRadius" type="text" class="form-control original-style" name="originRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.fromRadiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Display name:<\/label> <input id="originName" type="text" class="form-control original-style" name="originDisplayName" placeholder="Ex: Heathrow airport" ng-model="vm.model.fromName"><\/div><\/div><\/div><div class="col-sm-6"><h2>To:<\/h2><div class="row mb-20"><div class="col-sm-12 col-md-9"><label>To address:<\/label> <input id="destination" type="text" class="form-control original-style" name="destination" placeholder="Pickup address or airport" ng-autocomplete ng-model="vm.model.toDisplayName" details="vm.destination.details" options="vm.locationOptions" on-changed="vm.destinationChangedHandler"><\/div><div class="col-sm-12 col-md-3"><label>Radius (meters):<\/label> <input id="destinationRadius" type="text" class="form-control original-style" name="destinationRadius" placeholder="Ex: 3500" ng-model-options="{ allowInvalid: true, debounce: 1000 }" ng-model="vm.model.toRadiusInMeters"><\/div><\/div><div class="row"><div class="col-sm-12"><label>Display name:<\/label> <input id="destinationName" type="text" class="form-control original-style" name="destinationDisplayName" placeholder="Ex: Heathrow airport" ng-model="vm.model.toName"><\/div><\/div><\/div><\/div><div class="row"><div class="col-sm-2"><label>Fixed price:<\/label> <input type="text" class="form-control original-style" name="fixedProce" ng-model="vm.model.price"><\/div><div class="col-sm-2"><label>Car type:<\/label><select class="form-control" ng-options="item.guid as item.name for item in vm.availableCarClasses" name="selectedCarType" required ng-model="vm.model.carTypeGuid"><\/select><\/div><div class="col-sm-2"><label>Allow Both Ways:<\/label><div class="check i-checks"><label class="checkboxLabel" style="margin-top: 5px;"><input type="checkbox" icheck ng-model="vm.model.allowBothWays" data-ng-value="true" value="true" name="allowBothWays"> <i><\/i> <span class="m-l-sm">Both can be used as pick-up point<\/span><\/label><\/div><\/div><div class="col-sm-6"><div ng-show="vm.distanceDisplay"><b>Distance info:<\/b> {{vm.distanceDisplay}} miles will take {{vm.durationDisplay}}<\/div><\/div><\/div><div class="row"><div class="col-sm-6"><location-selector-map location-info="vm.fromLatLng" radius="vm.model.fromRadiusInMeters" id="origin-map"><\/location-selector-map><\/div><div class="col-sm-6"><location-selector-map location-info="vm.toLatLng" radius="vm.model.toRadiusInMeters" id="destination-map"><\/location-selector-map><\/div><\/div><div class="row text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()">Save<\/button> <button type="button" class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form><style>\r\n    .editFixedPricesForm .row {\r\n        margin-bottom: 15px;\r\n    }\r\n\r\n    .visibleMap {\r\n        min-height: 350px;\r\n        margin-bottom: 5px;\r\n        margin-top: 10px;\r\n    }\r\n\r\n    .pac-container {\r\n        z-index: 9000;\r\n    }\r\n<\/style>'})}(),function(){"use strict";var n=angular.module("bookingApp"),t=function(n,t,i){function u(){var n=r.locationInfo,t=r.radius?r.radius:1;f(n);r.mapInfo.directionsDisplay.setMap(null);r.mapInfo.map.setCenter(n);r.mapInfo.mapMarkerCircle&&r.mapInfo.mapMarkerCircle.setMap(null);r.mapInfo.mapMarkerCircle=new google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:1,fillColor:"#FF0000",fillOpacity:.15,map:r.mapInfo.map,center:n,radius:t});r.visible=!0;i(function(){google.maps.event.trigger(r.mapInfo.map,"resize")},900)}function f(n){r.mapInfo.map||(r.mapInfo.map=new google.maps.Map(e[0],{zoom:10,disableDefaultUI:!0,draggable:!0,zoomControl:!0,scrollwheel:!1,disableDoubleClickZoom:!0,center:n}))}var r=this,e=angular.element(t[0].childNodes[0]);r.visible=!1;r.$onInit=function(){r.mapInfo={};r.mapInfo.directionsDisplay=new google.maps.DirectionsRenderer;r.mapInfo.directionsService=new google.maps.DirectionsService;f()};r.$onChanges=function(n){if(n.locationInfo&&n.locationInfo.currentValue&&(r.locationInfo=n.locationInfo.currentValue,r.locationInfo&&r.locationInfo.lat!==0&&r.locationInfo.lng!==0&&u()),n.radius&&n.radius.currentValue){var t=parseInt(n.radius.currentValue);t&&r.mapInfo&&r.mapInfo.map&&(r.radius=t,u())}}};n.component("locationSelectorMap",{controller:["$rootScope","$element","$timeout",t],controllerAs:"vm",bindings:{locationInfo:"<",radius:"<",mapChanged:"&"},template:'<div ng-class="{visibleMap: vm.visible}" style="height: 100%;"><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){f.initUserPassword(f.userGuid)};f.initUserPassword=function(n){f.submitted=!1;f.passwordInfo={userGuid:n};f.setAccountPasswordForm.$setPristine();f.setAccountPasswordForm.$setUntouched()};f.hasNewPasswordError=function(){return f.submitted&&(!f.passwordInfo.newPassword||f.passwordInfo.newPassword.length<6)};f.hasConfirmPasswordError=function(){return f.submitted&&f.passwordInfo.newPassword!==f.passwordInfo.confirmNewPassword};f.changeUserPassword=function(){f.submitted=!0;var n=f.hasNewPasswordError()||f.hasConfirmPasswordError();n||(f.passwordInfo.isReset=!1,r.setUserPassword(f.passwordInfo).then(function(n){console.log(n.data);n.data.success?(u.showNotificationList("success",n.data.successMessages),f.cancelChanges()):(u.showNotificationList("error",n.data.errors),f.cancelChanges())}))};f.cancelChanges=function(){f.sending||(f.onFinish||f.dismiss?(f.onFinish&&f.onFinish(),f.dismiss&&f.dismiss()):f.$onInit())}}var n=angular.module("bookingApp");n.component("setUserPassword",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<",dismiss:"&",onFinish:"&"},template:'<form name="vm.setAccountPasswordForm" novalidate><div class="row"><div class="form-group" ng-class="{\'has-error\': vm.hasNewPasswordError()}"><label>New Password<\/label> <input name="newPassword" ng-model="vm.passwordInfo.newPassword" type="password" placeholder="New Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasNewPasswordError()">New password must have at least 6 characters<\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.hasConfirmPasswordError()}"><label>Confirm New Password<\/label> <input name="confirmNewPassword" ng-model="vm.passwordInfo.confirmNewPassword" type="password" placeholder="Confirm New Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasConfirmPasswordError()">New password and confirm password do not match<\/div><\/div><\/div><div class="row text-center m-t-lg"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.changeUserPassword()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.cancelChanges()">Cancel<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getUserInfo(f.websiteGuid,f.userGuid).then(function(n){n.data.success&&(f.userModel=n.data.result)})};f.initForm=function(n){f.userModel=n;f.userDetailsForm.$setPristine();f.userDetailsForm.$setUntouched()};f.updateUser=function(){console.log(f.userModel);r.updateUserInfo(f.userModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Account saved"),u.scrollElement("body"),n.data.result.redirectTo&&(t.location.href=n.data.result.redirectTo),f.initForm(n.data.result)):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editUser",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<"},template:'<form name="vm.userDetailsForm" class="form-horizontal"><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Basic Detail<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.email.$pristine }"><label class="col-sm-2 control-label">Email<\/label><div class="col-sm-10"><input name="email" ng-model="vm.userModel.email" type="text" placeholder="john@company.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.firstName.$pristine }"><label class="col-sm-2 control-label">First Name<\/label><div class="col-sm-10"><input name="firstName" ng-model="vm.userModel.firstName" type="text" placeholder="John" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.lastName.$pristine }"><label class="col-sm-2 control-label">Last Name<\/label><div class="col-sm-10"><input type="text" name="lastName" ng-model="vm.userModel.lastName" placeholder="Smith" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.phoneNumber.$pristine }"><label class="col-sm-2 control-label">Phone Number<\/label><div class="col-sm-10"><input type="text" name="phoneNumber" ng-model="vm.userModel.phoneNumber" placeholder="+44749093345" class="form-control"><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Company Details<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content profile-content"><div class="form-group"><label class="col-sm-2 control-label">Invoice Type<\/label><div class="col-sm-10"><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.isCompany" data-ng-value="false" value="false" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Use personal details<\/span><\/label><\/div><div class="radio i-checks"><label class="checkboxLabel"><input type="radio" icheck ng-model="vm.userModel.isCompany" data-ng-value="true" value="true" name="isCompanyInvoice"> <i><\/i> <span class="m-l-sm">Company details<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyName.$pristine }"><label class="col-sm-2 control-label">Company Name<\/label><div class="col-sm-10"><input name="companyName" ng-model="vm.userModel.companyName" ng-disabled="vm.userModel.isCompany == false" type="text" placeholder="Private Company Ltd" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyStreetAddress.$pristine }"><label class="col-sm-2 control-label">Street Address<\/label><div class="col-sm-10"><input name="companyStreetAddress" ng-model="vm.userModel.companyStreetAddress" ng-disabled="vm.userModel.isCompany == false" type="text" placeholder="10 Oxford St" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyAdditionalAddress.$pristine }"><label class="col-sm-2 control-label">Additional address<\/label><div class="col-sm-10"><input type="text" name="companyAdditionalAddress" ng-model="vm.userModel.companyAdditionalAddress" ng-disabled="vm.userModel.isCompany == false" placeholder="Hammersmith" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyZipCode.$pristine }"><label class="col-sm-2 control-label">Zip Code<\/label><div class="col-sm-10"><input type="text" name="companyZipCode" ng-model="vm.userModel.companyZipCode" ng-disabled="vm.userModel.isCompany == false" placeholder="W1D 1BS" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.companyCity.$pristine }"><label class="col-sm-2 control-label">City<\/label><div class="col-sm-10"><input type="text" name="companyCity" ng-model="vm.userModel.companyCity" ng-disabled="vm.userModel.isCompany == false" placeholder="London" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.userDetailsForm.costCenter.$pristine }"><label class="col-sm-2 control-label">Cost Centre<\/label><div class="col-sm-10"><input type="text" name="costCenter" ng-model="vm.userModel.costCenter" ng-disabled="vm.userModel.isCompany == false" placeholder="GB06C23MGTX" class="form-control"><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Password<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content changePassword-content"><div class="form-group" ng-class="{\'has-error\': vm.hasNewPasswordError()}"><label class="col-sm-2 control-label">Password<\/label><div class="col-sm-10"><input name="newPassword" ng-model="vm.userModel.password" type="password" placeholder="Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasNewPasswordError()">Password must have at least 6 characters<\/div><\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.hasConfirmPasswordError()}"><label class="col-sm-2 control-label">Confirm Password<\/label><div class="col-sm-10"><input name="confirmNewPassword" ng-model="vm.userModel.confirmPassword" type="password" placeholder="Confirm Password" class="form-control"><div class="help-block ng-hide" ng-show="vm.hasConfirmPasswordError()">Password and confirm password do not match<\/div><\/div><\/div><\/div><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateUser()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.initUserData()">Cancel<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getUserRoles(f.websiteGuid,f.userGuid).then(function(n){n.data.success&&f.initForm(n.data.data)})};f.initForm=function(n){f.userRolesModel=n;f.userRolesForm.$setUntouched();f.userRolesForm.$setPristine()};f.initUserData=function(){f.$onInit()};f.updateUser=function(){console.log(f.userModel);r.updateUserRoles(f.userRolesModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","User roles saved"),u.scrollElement("body"),f.initForm(n.data.result)):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Account roles could not be saved.")},function(){u.showNotification("error","Account roles could not be saved.")})}}var n=angular.module("bookingApp");n.component("editUserRoles",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<"},template:'<form name="vm.userRolesForm" class="form-horizontal"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Account Roles<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content profile-content"><div class="m-l-md"><div style="display: inline-block;" ng-repeat="(key, value) in vm.userRolesModel.roles"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="value.hasRole"> <i><\/i> <span class="m-l-xs">{{value.name}}<\/span><\/label><\/div><\/div><\/div><div class="row"><div class="col-md-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.userRolesForm.allowedRegions.$pristine }"><label>Allowed regions:<\/label><ui-select multiple tagging ng-model="vm.userRolesModel.allowedRegions" theme="bootstrap" title="Choose allowed regions"><ui-select-match placeholder="Select allowed regions...">{{$item.name}}<\/ui-select-match><ui-select-choices repeat="region in vm.userRolesModel.regions | propsFilter: {name: $select.search}"><div ng-if="region.isTag" ng-bind-html="(region.name | highlight: $select.search) +\' (new)\'"><\/div><div ng-if="!region.isTag" ng-bind-html="region.name + region.isTag| highlight: $select.search"><\/div><small>{{region.radiusInMeters | number}} meters around <b>{{region.address}}<\/b><\/small><\/ui-select-choices><\/ui-select><\/div><\/div><\/div><div class="row text-center ng-hide m-t-md" ng-hide="vm.userRolesForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateUser()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.initUserData()">Cancel<\/button><\/div><\/div><\/div><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this,s;o.submitted=!1;o.isLoading=!0;o.allowedAreas=[];o.allowedLanguages=[];o.allLanguages=[{code:"ab",name:"Abkhazian"},{code:"aa",name:"Afar"},{code:"af",name:"Afrikaans"},{code:"ak",name:"Akan"},{code:"sq",name:"Albanian"},{code:"am",name:"Amharic"},{code:"ar",name:"Arabic"},{code:"an",name:"Aragonese"},{code:"hy",name:"Armenian"},{code:"as",name:"Assamese"},{code:"av",name:"Avaric"},{code:"ae",name:"Avestan"},{code:"ay",name:"Aymara"},{code:"az",name:"Azerbaijani"},{code:"bm",name:"Bambara"},{code:"ba",name:"Bashkir"},{code:"eu",name:"Basque"},{code:"be",name:"Belarusian"},{code:"bn",name:"Bengali"},{code:"bh",name:"Bihari languages"},{code:"bi",name:"Bislama"},{code:"bs",name:"Bosnian"},{code:"br",name:"Breton"},{code:"bg",name:"Bulgarian"},{code:"my",name:"Burmese"},{code:"ca",name:"Catalan, Valencian"},{code:"km",name:"Central Khmer"},{code:"ch",name:"Chamorro"},{code:"ce",name:"Chechen"},{code:"ny",name:"Chichewa, Chewa, Nyanja"},{code:"zh",name:"Chinese"},{code:"cu",name:"Church Slavonic, Old Bulgarian, Old Church Slavonic"},{code:"cv",name:"Chuvash"},{code:"kw",name:"Cornish"},{code:"co",name:"Corsican"},{code:"cr",name:"Cree"},{code:"hr",name:"Croatian"},{code:"cs",name:"Czech"},{code:"da",name:"Danish"},{code:"dv",name:"Divehi, Dhivehi, Maldivian"},{code:"nl",name:"Dutch, Flemish"},{code:"dz",name:"Dzongkha"},{code:"en",name:"English"},{code:"eo",name:"Esperanto"},{code:"et",name:"Estonian"},{code:"ee",name:"Ewe"},{code:"fo",name:"Faroese"},{code:"fj",name:"Fijian"},{code:"fi",name:"Finnish"},{code:"fr",name:"French"},{code:"ff",name:"Fulah"},{code:"gd",name:"Gaelic, Scottish Gaelic"},{code:"gl",name:"Galician"},{code:"lg",name:"Ganda"},{code:"ka",name:"Georgian"},{code:"de",name:"German"},{code:"ki",name:"Gikuyu, Kikuyu"},{code:"el",name:"Greek (Modern)"},{code:"kl",name:"Greenlandic, Kalaallisut"},{code:"gn",name:"Guarani"},{code:"gu",name:"Gujarati"},{code:"ht",name:"Haitian, Haitian Creole"},{code:"ha",name:"Hausa"},{code:"he",name:"Hebrew"},{code:"hz",name:"Herero"},{code:"hi",name:"Hindi"},{code:"ho",name:"Hiri Motu"},{code:"hu",name:"Hungarian"},{code:"is",name:"Icelandic"},{code:"io",name:"Ido"},{code:"ig",name:"Igbo"},{code:"id",name:"Indonesian"},{code:"ia",name:"Interlingua (International Auxiliary Language Association)"},{code:"ie",name:"Interlingue"},{code:"iu",name:"Inuktitut"},{code:"ik",name:"Inupiaq"},{code:"ga",name:"Irish"},{code:"it",name:"Italian"},{code:"ja",name:"Japanese"},{code:"jv",name:"Javanese"},{code:"kn",name:"Kannada"},{code:"kr",name:"Kanuri"},{code:"ks",name:"Kashmiri"},{code:"kk",name:"Kazakh"},{code:"rw",name:"Kinyarwanda"},{code:"kv",name:"Komi"},{code:"kg",name:"Kongo"},{code:"ko",name:"Korean"},{code:"kj",name:"Kwanyama, Kuanyama"},{code:"ku",name:"Kurdish"},{code:"ky",name:"Kyrgyz"},{code:"lo",name:"Lao"},{code:"la",name:"Latin"},{code:"lv",name:"Latvian"},{code:"lb",name:"Letzeburgesch, Luxembourgish"},{code:"li",name:"Limburgish, Limburgan, Limburger"},{code:"ln",name:"Lingala"},{code:"lt",name:"Lithuanian"},{code:"lu",name:"Luba-Katanga"},{code:"mk",name:"Macedonian"},{code:"mg",name:"Malagasy"},{code:"ms",name:"Malay"},{code:"ml",name:"Malayalam"},{code:"mt",name:"Maltese"},{code:"gv",name:"Manx"},{code:"mi",name:"Maori"},{code:"mr",name:"Marathi"},{code:"mh",name:"Marshallese"},{code:"ro",name:"Moldovan, Moldavian, Romanian"},{code:"mn",name:"Mongolian"},{code:"na",name:"Nauru"},{code:"nv",name:"Navajo, Navaho"},{code:"nd",name:"Northern Ndebele"},{code:"ng",name:"Ndonga"},{code:"ne",name:"Nepali"},{code:"se",name:"Northern Sami"},{code:"no",name:"Norwegian"},{code:"nb",name:"Norwegian Bokmål"},{code:"nn",name:"Norwegian Nynorsk"},{code:"ii",name:"Nuosu, Sichuan Yi"},{code:"oc",name:"Occitan (post 1500)"},{code:"oj",name:"Ojibwa"},{code:"or",name:"Oriya"},{code:"om",name:"Oromo"},{code:"os",name:"Ossetian, Ossetic"},{code:"pi",name:"Pali"},{code:"pa",name:"Panjabi, Punjabi"},{code:"ps",name:"Pashto, Pushto"},{code:"fa",name:"Persian"},{code:"pl",name:"Polish"},{code:"pt",name:"Portuguese"},{code:"qu",name:"Quechua"},{code:"rm",name:"Romansh"},{code:"rn",name:"Rundi"},{code:"ru",name:"Russian"},{code:"sm",name:"Samoan"},{code:"sg",name:"Sango"},{code:"sa",name:"Sanskrit"},{code:"sc",name:"Sardinian"},{code:"sr",name:"Serbian"},{code:"sn",name:"Shona"},{code:"sd",name:"Sindhi"},{code:"si",name:"Sinhala, Sinhalese"},{code:"sk",name:"Slovak"},{code:"sl",name:"Slovenian"},{code:"so",name:"Somali"},{code:"st",name:"Sotho, Southern"},{code:"nr",name:"South Ndebele"},{code:"es",name:"Spanish, Castilian"},{code:"su",name:"Sundanese"},{code:"sw",name:"Swahili"},{code:"ss",name:"Swati"},{code:"sv",name:"Swedish"},{code:"tl",name:"Tagalog"},{code:"ty",name:"Tahitian"},{code:"tg",name:"Tajik"},{code:"ta",name:"Tamil"},{code:"tt",name:"Tatar"},{code:"te",name:"Telugu"},{code:"th",name:"Thai"},{code:"bo",name:"Tibetan"},{code:"ti",name:"Tigrinya"},{code:"to",name:"Tonga (Tonga Islands)"},{code:"ts",name:"Tsonga"},{code:"tn",name:"Tswana"},{code:"tr",name:"Turkish"},{code:"tk",name:"Turkmen"},{code:"tw",name:"Twi"},{code:"ug",name:"Uighur, Uyghur"},{code:"uk",name:"Ukrainian"},{code:"ur",name:"Urdu"},{code:"uz",name:"Uzbek"},{code:"ve",name:"Venda"},{code:"vi",name:"Vietnamese"},{code:"vo",name:"Volap_k"},{code:"wa",name:"Walloon"},{code:"cy",name:"Welsh"},{code:"fy",name:"Western Frisian"},{code:"wo",name:"Wolof"},{code:"xh",name:"Xhosa"},{code:"yi",name:"Yiddish"},{code:"yo",name:"Yoruba"},{code:"za",name:"Zhuang, Chuang"},{code:"zu",name:"Zulu"}];s=[];i.StaticData.Timezones.forEach(function(n){n.zones.forEach(function(t){s.push({group:n.group,name:t.name,value:t.value})})});o.availableTimezones=s;o.allowedLanguages.push({group:"Favorites",name:"French",code:"fr"});o.allowedLanguages.push({group:"Favorites",name:"German",code:"de"});o.allowedLanguages.push({group:"Favorites",name:"English",code:"en"});o.allowedLanguages.push({group:"Favorites",name:"Italian",code:"it"});o.allLanguages.forEach(function(n){var t=o.allowedLanguages.find(function(t){return t.code===n.code});t||o.allowedLanguages.push({group:"Other",name:n.name,code:n.code})});o.$onInit=function(){o.driverModel={primaryAddress:{}};o.driverGuid||(o.driverGuid="new");r.getDriverInfo(o.websiteGuid,o.driverGuid).then(function(n){n.data.success&&o.initForm(n.data.result)});r.getAllowedAreas(o.websiteGuid).then(function(n){n.data.success&&(o.allowedAreas=n.data.result)})};o.changePassword=function(n){e.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><set-user-password user-guid='vm.userGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' save='vm.saved(item)'><\/set-user-password><\/modal-component>",resolve:{userGuid:function(){return n.userGuid},modalTitle:function(){return"Change driver password: "+n.firstName+" "+n.lastName},parentVm:function(){return o}},controller:["$uibModalInstance","userGuid","modalTitle","parentVm",function(n,t,i,r){var u=this;u.userGuid=t;u.modalTitle=i;u.$uibModalInstance=n;u.saved=function(n){const t=r.bookings.items.findIndex(function(t){return t.guid===n});t>=0&&r.bookings.items.splice(t,1);u.dismiss()};u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")}}],backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};o.initForm=function(n){console.log(n);o.driverModel=n;o.driverModel.dateOfBirth&&(o.driverModel.dateOfBirthDateTime=moment.utc(o.driverModel.dateOfBirth,i.Settings.ServerDateFormat));o.driverModel.knownLanguages||(o.driverModel.knownLanguages=[]);o.driverModel.primaryAddress||(o.driverModel.primaryAddress={});o.driverModel.primaryAddress.addressName&&(o.driverModel.primaryAddress.addressText=o.driverModel.primaryAddress.addressName);o.driverModel.knownLanguages&&o.driverModel.knownLanguages.forEach(function(n){n.level=n.level.toString()});o.selectedTimezone=o.availableTimezones.find(function(n){return n.value===o.driverModel.timezone});o.submitted=!1;o.driverModel.selectedCarType=o.driverModel.carTypes.find(function(n){return console.log(n),n.checked===!0});o.driverModel.selectedMainCarId=o.driverModel.cars.find(function(n){return console.log(n),n.checked===!0});o.driverDetailsForm.$setPristine();o.driverDetailsForm.$setUntouched();o.isLoading=!1};o.addLanguage=function(){if(o.driverModel.knownLanguages||(o.driverModel.knownLanguages=[]),o.languageToAdd){var n=o.driverModel.knownLanguages.find(function(n){return n.name===o.languageToAdd.name});if(n){o.languageToAdd=null;return}o.driverModel.knownLanguages.push({name:o.languageToAdd.name,level:0});o.languageToAdd=null}};o.removeLanguage=function(n){o.driverModel.knownLanguages.splice(n,1)};o.saveDriver=function(){u.showConfirmation("Save Driver?","").then(function(){console.log(o.userModel);o.submitted=!0;var n=!0,t=o.driverModel.knownLanguages.find(function(n){return!n.level});if(t&&(n=!1),n=!o.driverDetailsForm.$invalid&&n,n=o.driverModel.driverLicence.validate()&&n,n=o.driverModel.driverLicenceBack.validate()&&n,n=o.driverModel.driverPcoLicence.validate()&&n,n=o.driverModel.driverInsurance.validate()&&n,n=o.driverModel.driverPassport.validate()&&n,o.driverModel.carLogBook.validate&&(n=o.driverModel.carLogBook.validate()&&n),o.driverModel.carPhvLicence.validate&&(n=o.driverModel.carPhvLicence.validate()&&n),o.driverModel.carMotLicence.validate&&(n=o.driverModel.carMotLicence.validate()&&n),o.driverModel.carInsurance.validate&&(n=o.driverModel.carInsurance.validate()&&n),!n){u.scrollElement(".has-error");return}o.driverModel.timezone=o.selectedTimezone?o.selectedTimezone.value:null;o.driverModel.carTypeId=null;o.driverModel.selectedCarType.id>0&&(o.driverModel.carTypeId=o.driverModel.selectedCarType.id);o.driverModel.mainCarId=null;o.driverModel.selectedMainCarId&&(o.driverModel.mainCarId=o.driverModel.selectedMainCarId.id);o.driverModel.dateOfBirth=moment(o.driverModel.dateOfBirthDateTime).format(i.Settings.ServerDateFormat);r.saveDriver(o.driverModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Driver information saved"),o.initForm(n.data.result)):u.showNotificationList("error",n.data.errors)},function(){u.showNotification("error","Something went wrong. Please try again.")})})};o.upload=function(n){n&&f.upload({url:"/Files/UploadFile/",file:n}).then(function(n){o.driverModel.driverImage=n.data.result},function(n){u.showNotification("error","Could not upload file. Please try again.");console.log("Error status: "+n.status)})}}var n=angular.module("bookingApp");n.component("editDriver",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","Upload","$uibModal",t],controllerAs:"vm",bindings:{driverGuid:"<",websiteGuid:"<"},template:'<div class="row" ng-show="vm.isLoading"><div class="col-sm-12 text-center"><h1><i class="fa fa-spinner fa-spin"><\/i> Loading<\/h1><\/div><\/div><form name="vm.driverDetailsForm" ng-show="!vm.isLoading" novalidate><div class="row"><div class="col-md-2 col-xs-12"><img src="/Content/images/image-not-available.png" ng-src="{{vm.driverModel.driverImage.url}}" class="img-responsive m-b-xs" alt="profile"><div class="text-center"><button type="button" class="btn btn-success" ngf-select="vm.upload($file)">Upload image<\/button><\/div><\/div><div class="col-md-10 col-xs-12"><div class="text-right" ng-show="vm.driverModel.isAdmin && vm.driverModel.userGuid"><button type="button" class="btn btn-success" ng-click="vm.changePassword(vm.driverModel)"><i class="fa fa-key"><\/i> Set Password<\/button><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.firstName.$pristine, \'has-error\': vm.submitted && vm.driverDetailsForm.firstName.$error.required }"><label>First Name<\/label> <input name="firstName" ng-model="vm.driverModel.firstName" type="text" placeholder="John" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.driverDetailsForm.firstName.$error.required">First name is required.<\/div><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.lastName.$pristine, \'has-error\': vm.submitted && vm.driverDetailsForm.lastName.$error.required }"><label>Last Name<\/label> <input type="text" name="lastName" ng-model="vm.driverModel.lastName" placeholder="Smith" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.driverDetailsForm.lastName.$error.required">Last name is required.<\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.phoneNumber.$pristine, \'has-error\': vm.submitted && vm.driverDetailsForm.phoneNumber.$error.required }"><label>Phone Number<\/label> <input type="text" name="phoneNumber" ng-model="vm.driverModel.phoneNumber" placeholder="+44749093345" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.driverDetailsForm.phoneNumber.$error.required">Phone number is required.<\/div><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.email.$pristine, \'has-error\': vm.submitted && vm.driverDetailsForm.email.$error.required }"><label>Email<\/label> <input name="email" ng-model="vm.driverModel.email" type="text" placeholder="john@company.com" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.driverDetailsForm.email.$error.required">Email is required.<\/div><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.dateOfBirth.$pristine}"><label>Date of Birth<\/label><div datepicker ng-model="vm.driverModel.dateOfBirthDateTime" name="dateOfBirth" dp-options="{format: \'dd MM yyyy\', todayHighlight: true, autoclose: true}"><input type="text" class="form-control"><\/div><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.timezone.$pristine }"><label>Timezone:<\/label><ui-select ng-model="vm.selectedTimezone" theme="bootstrap" sortable="true" name="timezone" title="Select timezone"><ui-select-match placeholder="Select timezone">{{$select.selected.name}}<\/ui-select-match><ui-select-choices group-by="\'group\'" repeat="timezone in vm.availableTimezones | filter:$select.search">{{timezone.name}}<\/ui-select-choices><\/ui-select><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.nationality.$pristine }"><label>Nationality<\/label> <input name="nationality" ng-model="vm.driverModel.nationality" type="text" placeholder="ex: German" class="form-control"><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.gender.$pristine }"><label>Gender<\/label><select name="gender" ng-model="vm.driverModel.gender" class="form-control"><option value="female">Female<\/option><option value="male">Male<\/option><\/select><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.selectedCarType.$pristine}"><label>Preferred Service<\/label><select class="form-control" ng-options="item as item.name for item in vm.driverModel.carTypes" name="selectedCarType" required ng-model="vm.driverModel.selectedCarType"><\/select><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.driverLicenceType.$pristine }"><label>Driver Licence Types (comma separated)<\/label> <input name="driverLicenceType" ng-model="vm.driverModel.driverLicenceType" type="text" placeholder="ex: B, C" class="form-control"><\/div><\/div><\/div><\/div><\/div><div class="row m-b-md"><div class="col-sm-12"><h4>Additional Info (visible to Dispatcher)<\/h4><textarea class="form-control original-style" ng-model="vm.driverModel.additionalInfo" name="additionalInfo" placeholder="Additional info for dispatcher"><\/textarea><\/div><\/div><div class="row m-b-md"><div class="col-sm-12"><h4>Additional Info (visible to Client)<\/h4><textarea class="form-control original-style" ng-model="vm.driverModel.additionalInfoForClient" name="additionalInfo" placeholder="Additional info for client"><\/textarea><\/div><\/div><div class="row"><div class="col-md-12"><h3>Primary Address<\/h3><div class="m-l-md"><edit-address address-model="vm.driverModel.primaryAddress"><\/edit-address><\/div><\/div><\/div><hr><div class="row"><div class="col-md-12"><h3><span style="font-size: 15px; font-weight: 600; padding-right: 30px;">Languages:<\/span> <span style="vertical-align: middle;"><ui-select ng-model="vm.languageToAdd" theme="bootstrap" sortable="true" style="display: inline-block; min-width: 200px" title="Add language"><ui-select-match placeholder="Select language to add">{{$select.selected.name}}<\/ui-select-match><ui-select-choices group-by="\'group\'" repeat="lang in vm.allowedLanguages | filter:$select.search">{{lang.name}}<\/ui-select-choices><\/ui-select><button type="button" class="btn btn-xs btn-primary" style="margin-top: -22px; margin-left: 10px;" ng-click="vm.addLanguage()"><i class="fa fa-plus"><\/i> Add<\/button><\/span><\/h3><ul class="list-unstyled" style="padding-left: 25px;"><li class="form-group" ng-repeat="(key, value) in vm.driverModel.knownLanguages" style="margin: 5px 0" ng-class="{\'has-error\': vm.submitted && !value.level }"><b>{{value.name}}<\/b> - Level:<select ng-model="value.level" style="display: inline-block; width: 150px; margin-left: 15px" class="form-control"><option value="1">Low<\/option><option value="2">Intermediate<\/option><option value="3">Good<\/option><option value="4">Fluent<\/option><option value="5">Native Speaker<\/option><\/select><button type="button" class="btn btn-sm btn-danger" style="display: inline-block; margin-left: 15px; margin-bottom: 5px;" ng-click="vm.removeLanguage($index)"><i class="fa fa-remove"><\/i><\/button><div class="help-block" ng-show="vm.submitted && !value.level">Language level is required is required.<\/div><\/li><\/ul><\/div><\/div><div class="row m-t-md"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.carBrand.$pristine }"><label>Car Brand<\/label> <input name="carBrand" ng-model="vm.driverModel.carBrand" type="text" placeholder="ex: Mercedes-Benz" class="form-control"><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.carModel.$pristine }"><label>Car Model<\/label> <input name="carModel" ng-model="vm.driverModel.carModel" type="text" placeholder="ex: S Class Lux" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.carColor.$pristine }"><label>Car Color<\/label> <input name="carColor" ng-model="vm.driverModel.carColor" type="text" placeholder="ex: Black" class="form-control"><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.carRegNo.$pristine }"><label>Car plate no.<\/label> <input name="carRegNo" ng-model="vm.driverModel.registrationNumber" type="text" placeholder="ex: YD16DHA" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.driverLicenseNumber.$pristine }"><label>Driver Licence<\/label> <input name="driverLicenseNumber" ng-model="vm.driverModel.driverLicenseNumber" type="text" placeholder="ex: 1897230101" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-md-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.region.$pristine }"><label>Covered areas<\/label><ui-select ng-model="vm.driverModel.region" theme="bootstrap" sortable="true" style="width: 100%;" title="Covered cities"><ui-select-match placeholder="Select covered area...">{{$select.selected}}<\/ui-select-match><ui-select-choices repeat="city in vm.allowedAreas | filter:$select.search">{{city}}<\/ui-select-choices><\/ui-select><\/div><\/div><\/div><hr><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.currency.$pristine }"><label>Currency<\/label><select name="currency" ng-model="vm.driverModel.currency" class="form-control"><option value="EUR">EUR - &euro;<\/option><option value="USD">USD - &dollar;<\/option><option value="CAD">CAD - &dollar;<\/option><option value="CHF">CHF<\/option><option value="PLN">PLN - zł<\/option><option value="GBP">GBP - &pound;<\/option><option value="AUD">AUD - &dollar;<\/option><option value="NZD">NZD - &dollar;<\/option><option value="SGD">SGD - &dollar;<\/option><option value="THB">THB - &#x0E3F;<\/option><option value="MYR">MYR - RM (Malaysia ringgit)<\/option><option value="IDR">IDR (Indonesian rupiah) - Rp<\/option><option value="VND">VND - &#8363;<\/option><\/select><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.paymentMethod.$pristine }"><label>Payment method<\/label><select name="paymentMethod" ng-model="vm.driverModel.paymentMethod" class="form-control" ng-readonly="!vm.driverModel.isAdmin"><option value="PayPal">PayPal<\/option><option value="WeChat">WeChat<\/option><option value="BankTransfer">Bank Transfer<\/option><option value="Other">Other<\/option><\/select><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.paymentAccount.$pristine }"><label>Payment account<\/label> <input name="paymentAccount" ng-model="vm.driverModel.paymentAccount" type="text" placeholder="ex: john@gmail.com or 1897230101" class="form-control"><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.driverDetailsForm.paymentPeriod.$pristine }"><label>Payment period<\/label> <input name="paymentPeriod" ng-model="vm.driverModel.paymentPeriod" type="text" placeholder="ex: Every 2 weeks, on 15\'th each month" class="form-control"><\/div><\/div><\/div><div class="row" ng-class="{\'hidden\' : !vm.driverModel.isAdmin }"><div class="col-md-6"><div class="check i-checks" style="margin-top: 29px;"><label class="checkboxLabel"><input type="checkbox" icheck ng-model="vm.driverModel.isHired" data-ng-value="false" value="false" name="isHired"> <i><\/i> <span class="m-l-sm">Is company driver<\/span><\/label><\/div><\/div><div class="col-md-6"><div class="form-group" ng-show="vm.driverModel.isHired" ng-class="{\'field-changed\' : !vm.driverDetailsForm.selectedMainCarId.$pristine}"><label>Assigned car<\/label><select class="form-control" ng-options="item as item.name for item in vm.driverModel.cars" name="selectedMainCarId" ng-model="vm.driverModel.selectedMainCarId"><\/select><\/div><\/div><\/div><hr><style>\r\n        .picker__holder {\r\n            bottom: 35px;\r\n        }\r\n\r\n        .document-container {\r\n            border: 1px solid gray;\r\n        }\r\n    <\/style><h2>Driver documents:<\/h2><div class="row"><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-md" document-name="\'Driver licence\'" document-model="vm.driverModel.driverLicence"><\/edit-driver-document><\/div><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-md" document-name="\'Driver licence back\'" document-model="vm.driverModel.driverLicenceBack"><\/edit-driver-document><\/div><\/div><div class="row"><div class="col-md-6"><edit-driver-document class="m-t-sm" document-name="\'PCO licence\'" document-model="vm.driverModel.driverPcoLicence"><\/edit-driver-document><\/div><div class="col-md-6"><edit-driver-document class="m-t-sm" document-name="\'Insurance\'" document-model="vm.driverModel.driverInsurance"><\/edit-driver-document><\/div><\/div><div class="row"><div class="col-md-6"><edit-driver-document class="m-t-sm" document-name="\'Passport\'" document-model="vm.driverModel.driverPassport"><\/edit-driver-document><\/div><\/div><hr><div class="row text-center m-t-lg"><button type="button" class="btn btn-primary" ng-click="vm.saveDriver()">Save changes<\/button><\/div><\/form><style>\r\n    .ui-select-choices-group-label.dropdown-header {\r\n        padding-left: 10px;\r\n        font-weight: bold;\r\n        font-size: 16px;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.submitted=!1;e.$onInit=function(){e.addressModel||(e.addressModel={latLng:null})};e.addressChangedHandler=function(){for(var r,t=e.addressModel.addressDetails,n={},i=0;i<t.address_components.length;i++)r=t.address_components[i],n[r.types[0]]=r;e.addressModel.streetNumber="";e.addressModel.streetName="";e.addressModel.locality="";e.addressModel.country="";e.addressModel.postalCode="";n.street_number&&(e.addressModel.streetNumber=n.street_number.short_name);n.premise&&(e.addressModel.streetName+=n.premise.long_name+", ");n.route&&(e.addressModel.streetName+=n.route.long_name+", ");n.neighborhood&&(e.addressModel.streetName+=n.neighborhood.long_name+", ");e.addressModel.streetName.endsWith(", ")&&(e.addressModel.streetName=e.addressModel.streetName.slice(0,-2));n.locality&&(e.addressModel.locality=n.locality.short_name+", ");n.postal_town&&(e.addressModel.locality=n.postal_town.short_name+", ");e.addressModel.locality.endsWith(", ")&&(e.addressModel.locality=e.addressModel.locality.slice(0,-2));n.country&&(e.addressModel.country=n.country.long_name);n.postal_code&&(e.addressModel.postalCode=n.postal_code.short_name);e.addressModel.addressName=t.name;e.addressModel.address=t.formatted_address;e.addressModel.latLng={lat:t.geometry.location.lat(),lng:t.geometry.location.lng()}};e.sendNotification=function(n){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><send-device-notification device-guid='vm.deviceGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' save='vm.saved(item)'><\/send-device-notification><\/modal-component>",resolve:{deviceGuid:function(){return n.guid},modalTitle:function(){return"Send driver "+e.driverModel.email+" notification"},parentVm:function(){return e}},controller:["$uibModalInstance","deviceGuid","modalTitle","parentVm",function(n,t,i){var r=this;r.deviceGuid=t;r.modalTitle=i;r.$uibModalInstance=n;r.saved=function(){r.dismiss()};r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")}}],backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("editAddress",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","$uibModal",t],controllerAs:"vm",bindings:{addressModel:"<"},template:'<form name="vm.driverAddressForm" novalidate><div class="pl-lg-4"><div class="row"><div class="col-md-6"><div class="form-group focused"><label class="form-control-label" for="address">Address:<\/label> <input type="text" class="form-control original-style" name="origin" placeholder="Address" ng-autocomplete ng-model="vm.addressModel.addressText" details="vm.addressModel.addressDetails" on-changed="vm.addressChangedHandler"><\/div><\/div><div class="col-md-6" ng-show="vm.addressModel.latLng"><div class="form-group"><label class="form-control-label" for="streetNumber">Street Number & Name<\/label><div class="d-flex"><input type="text" class="form-control form-control-alternative" style="max-width: 90px; margin-right: 10px;" ng-model="vm.addressModel.streetNumber" placeholder="Number"> <input type="text" readonly class="form-control form-control-alternative flex-grow-1" ng-model="vm.addressModel.streetName" placeholder="Street Name"><\/div><\/div><\/div><\/div><div class="row" ng-show="vm.addressModel.latLng"><div class="col-lg-4"><div class="form-group focused"><label class="form-control-label">City<\/label> <input type="text" readonly class="form-control form-control-alternative" ng-model="vm.addressModel.locality" placeholder="City"><\/div><\/div><div class="col-lg-4"><div class="form-group focused"><label class="form-control-label">Country<\/label> <input type="text" readonly class="form-control form-control-alternative" ng-model="vm.addressModel.country" placeholder="Country"><\/div><\/div><div class="col-lg-4"><div class="form-group"><label class="form-control-label">Zip Code<\/label> <input type="text" class="form-control form-control-alternative" ng-model="vm.addressModel.postalCode"><\/div><\/div><\/div><div class="row"><div class="col-sm-12"><label class="form-control-label">Address Description<\/label> <input type="text" class="form-control form-control-alternative" ng-model="vm.addressModel.comments" placeholder="Any other usefull infromation for primary address"><\/div><\/div><\/div><\/form><style>\r\n    .d-flex { display: flex; }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.submitted=!1;e.$onInit=function(){e.driverModel={};console.log("test driver ");r.getDriverInfo(e.websiteGuid,e.driverGuid).then(function(n){n.data.success&&(e.driverModel=n.data.result)})};e.sendNotification=function(n){f.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><send-device-notification device-guid='vm.deviceGuid' modal-instance='vm.$uibModalInstance' dismiss='vm.dismiss()' save='vm.saved(item)'><\/send-device-notification><\/modal-component>",resolve:{deviceGuid:function(){return n.guid},modalTitle:function(){return"Send driver "+e.driverModel.email+" notification"},parentVm:function(){return e}},controller:["$uibModalInstance","deviceGuid","modalTitle","parentVm",function(n,t,i){var r=this;r.deviceGuid=t;r.modalTitle=i;r.$uibModalInstance=n;r.saved=function(){r.dismiss()};r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")}}],backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("driverDevices",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","$uibModal",t],controllerAs:"vm",bindings:{driverGuid:"<",websiteGuid:"<"},template:'<form name="vm.driverNotificationsForm" novalidate><div class="row"><div class="col-sm-12"><table class="table table-striped table-hover"><thead><tr><th>Name<\/th><th>App Name<\/th><th>App Version<\/th><th>OS<\/th><th>OS Version<\/th><th>Notifications<\/th><th>Location<\/th><th><\/th><\/tr><\/thead><tbody><tr ng-repeat="device in vm.driverModel.devices track by device.guid"><td>{{device.deviceName}}<\/td><td>{{device.appName}}<\/td><td>{{device.buildNumber}}<\/td><td>{{device.osName}}<\/td><td>{{device.osVersion}}<\/td><td>{{device.notificationsStatus}}<\/td><td>{{device.locationStatus}}<\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.sendNotification(device)" title="Send notification"><i class="fa fa-paper-plane" aria-hidden="true"><\/i> Send Notification<\/button><\/td><\/tr><\/tbody><\/table><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.sending=!1;f.notificationInfo={};f.sendNotification=function(){f.sending||(f.sending=!0,f.notificationInfo.deviceGuid=f.deviceGuid,r.sendDriverNotification(f.notificationInfo).then(function(n){console.log(n.data);n.data.success?(u.showNotificationList("success",n.data.successMessages),f.cancelChanges()):u.showNotificationList("error",n.data.errors);f.sending=!1},function(){f.sending=!1;u.showNotification("error","Could not send push notification. Please try again")}))};f.cancelChanges=function(){(f.onFinish||f.dismiss)&&(f.onFinish&&f.onFinish(),f.dismiss&&f.dismiss())}}var n=angular.module("bookingApp");n.component("sendDeviceNotification",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{deviceGuid:"<",websiteGuid:"<",dismiss:"&",onFinish:"&"},template:'<form name="vm.sendNotificationForm" novalidate><div class="row"><div class="form-group"><label>Title<\/label> <input name="title" ng-model="vm.notificationInfo.title" type="text" placeholder="Notification title" class="form-control"><\/div><div class="form-group"><label>Body<\/label> <input name="body" ng-model="vm.notificationInfo.body" type="text" placeholder="Notification body" class="form-control"><\/div><\/div><div class="row text-center m-t-lg"><div class="col-sm-12"><button class="btn btn-white m-l-sm" ng-click="vm.cancelChanges()">Cancel<\/button> <button class="btn btn-green m-r-sm" ng-click="vm.sendNotification()">Send notification<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.$onInit=function(){f.getCars(o.websiteGuid).then(function(n){n.data.success&&o.initForm(n.data.result)})};o.initForm=function(n){o.cars=n};o.deleteCar=function(n){var t="Delete car '"+n.registrationNumber+"'?";e.showConfirmation(t,"").then(function(){f.deleteCar(n.guid).then(function(t){if(t.data.success){var i=o.cars.indexOf(n);o.cars.splice(i,1);e.showNotification("success","Car '"+n.registrationNumber+"' removed.")}else e.showNotification("error",t.data.errors[0])},function(){e.showNotification("error","Something went wrong. Car was not deleted.")})})};o.editCar=function(n){r.open({template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Edit Service<\/h4><\/div><div class="modal-body"><edit-car guid=\'vm.guid\' website-guid=\'vm.websiteGuid\' on-finish=\'vm.onComponentFinished(result);\'><\/edit-car><\/div>',resolve:{cars:function(){return o.cars},parentVm:function(){return o}},controller:["$uibModalInstance","parentVm","cars",function(t,i,r){var u=this;u.cars=r;u.guid=n?n.guid:null;u.websiteGuid=i.websiteGuid;u.$uibModalInstance=t;u.cancel=function(){u.$uibModalInstance.dismiss("cancel")};u.onComponentFinished=function(n){if(u.cancel(),n){var t=u.cars.findIndex(function(t){return t.guid===n.guid});t>=0?u.cars[t]=n:u.cars.push(n)}}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};t.$on("add-new-car",function(){o.editCar({guid:""})})}var n=angular.module("bookingApp");n.component("fleet",{controller:["$timeout","$scope","$window","$uibModal","AppSettings","bookingApi","htmlPageService","Upload",t],controllerAs:"vm",template:'<div class="row ng-hide" ng-show="vm.cars.length <= 0"><div class="col-sm-12 text-center"><h1>No cars available. Use top right button to add.<\/h1><\/div><\/div><div class="row drivers-grid"><div class="col-lg-4" ng-repeat="car in vm.cars track by car.id"><div class="contact-box"><div class="col-sm-4"><div class="text-center"><img src="/Content/images/image-not-available.png" alt="image" style="margin: 10px auto;" class="m-t-xs img-responsive driver-image" ng-src="{{car.carType.image.url}}"><h3 class="bold m-t-none">{{car.carType.name}}<\/h3><\/div><\/div><div class="col-sm-8"><h3 class="nomargin-bottom"><strong>{{car.registrationNumber}}<\/strong><\/h3><p class="driver-summary"><div>Brand: {{car.carBrand}}<\/div><div>Model: {{car.carModel}}<\/div><div>Color: {{car.carColor}}<\/div><div class="m-t-sm"><span class="m-r-md"><i class="fa fa-user" style="padding-right: 5px;"><\/i> {{car.carType.numberOfPassengers}}<\/span> <span class="m-l-md"><i class="fa fa-suitcase" style="padding-right: 5px;"><\/i> {{car.carType.numberOfLuggages}}<\/span><\/div><\/p><\/div><div class="col-md-12 text-right"><button ng-click="vm.editCar(car)" class="btn btn-primary m-r-sm"><i class="fa fa-edit"><\/i> Edit<\/button> <button ng-click="vm.deleteCar(car)" class="btn btn-danger m-l-sm"><i class="fa fa-trash"><\/i> Delete<\/button><\/div><div class="clearfix"><\/div><\/div><\/div><\/div>',bindings:{websiteGuid:"<"}})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.submitted=!1;f.$onInit=function(){f.carModel={};r.getCarDetails(f.websiteGuid,f.guid).then(function(n){n.data.success&&f.initForm(n.data.result)})};f.initForm=function(n){f.carModel=n;f.carModel.selectedCarClass=f.carModel.carClasses.find(function(n){return console.log(n),n.selected===!0});f.submitted=!1;f.carModelForm.$setPristine();f.carModelForm.$setUntouched()};f.cancelChanges=function(){f.sending||f.onFinish&&f.onFinish()};f.saveCarClass=function(){if(!f.sending){f.submitted=!0;var n=!0;(n=!f.carModelForm.$invalid&&n,n=f.carModel.carLogBook.validate()&&n,n=f.carModel.carPhvLicence.validate()&&n,n=f.carModel.carMotLicence.validate()&&n,n=f.carModel.carInsurance.validate()&&n,n)&&(f.carModel.carTypeId=f.carModel.selectedCarClass.value,f.sending=!0,r.saveCarDeatails(f.carModel).then(function(n){if(n.data.success){if(f.sending=!1,u.showNotification("success","Car saved successfully."),f.initForm(n.data.result),f.onFinish)f.onFinish({result:n.data.result})}else f.sending=!1,u.showNotificationList("error",n.data.errors)},function(){f.sending=!1;u.showNotification("error","Something went wrong. Car was not saved.")}))}}}var n=angular.module("bookingApp");n.component("editCar",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","Upload",t],controllerAs:"vm",bindings:{guid:"<",websiteGuid:"<",onFinish:"&"},template:'<form name="vm.carModelForm" novalidate><div class="row"><div class="col-md-12 col-xs-12"><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carModelForm.selectedCarClass.$pristine, \'has-error\': vm.hasCarTypeError()}"><label>Car class<\/label><select class="form-control" ng-options="item as item.text for item in vm.carModel.carClasses" name="selectedCarClass" required ng-model="vm.carModel.selectedCarClass"><\/select><div class="help-block ng-hide" ng-show="vm.hasCarClassError()">Please select car class.<\/div><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carModelForm.carBrand.$pristine }"><label>Car Brand<\/label> <input name="carBrand" ng-model="vm.carModel.carBrand" type="text" placeholder="ex: Mercedes-Benz" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carModelForm.carModel.$pristine }"><label>Car Model<\/label> <input name="carModel" ng-model="vm.carModel.carModel" type="text" placeholder="ex: S Class Lux" class="form-control"><\/div><\/div><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carModelForm.carColor.$pristine }"><label>Car Color<\/label> <input name="carColor" ng-model="vm.carModel.carColor" type="text" placeholder="ex: Black" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-md-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carModelForm.carRegNo.$pristine }"><label>Car reg no.<\/label> <input name="carRegNo" ng-model="vm.carModel.registrationNumber" type="text" placeholder="ex: YD16DHA" class="form-control"><\/div><\/div><\/div><\/div><\/div><h2>Car documents:<\/h2><div class="row"><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-sm" document-name="\'Log book\'" document-model="vm.carModel.carLogBook"><\/edit-driver-document><\/div><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-sm" document-name="\'PHV Licence\'" document-model="vm.carModel.carPhvLicence"><\/edit-driver-document><\/div><\/div><div class="row m-t-md"><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-sm" document-name="\'MOT Licence\'" document-model="vm.carModel.carMotLicence"><\/edit-driver-document><\/div><div class="col-md-6 col-lg-6"><edit-driver-document class="m-t-sm" document-name="\'Car insurance\'" document-model="vm.carModel.carInsurance"><\/edit-driver-document><\/div><\/div><div class="row text-center m-t-lg"><button type="submit" class="btn btn-primary m-r-sm" ng-click="vm.saveCarClass()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> <i class="fa fa-save" ng-show="!vm.sending"><\/i> Save<\/button> <button type="submit" class="btn btn-danger m-l-sm" ng-click="vm.cancelChanges()"><i class="fa fa-times"><\/i> Cancel<\/button><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.$onInit=function(){f.getCarClasses().then(function(n){n.data.success&&o.initForm(n.data.result)})};o.initForm=function(n){o.carTypes=n};o.deleteCarType=function(n){var t="Delete service '"+n.name+"'?";e.showConfirmation(t,"").then(function(){f.deleteCarType(n.guid).then(function(t){if(t.data.success){var i=o.carTypes.indexOf(n);o.carTypes.splice(i,1);e.showNotification("success","Service removed.")}else e.showNotification("error",t.data.errors[0])},function(){e.showNotification("error","Something went wrong. Please try again.")})})};o.editCarType=function(n){r.open({template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Edit service<\/h4><\/div><div class="modal-body"><edit-car-class guid=\'vm.guid\' website-guid=\'vm.websiteGuid\' on-finish=\'vm.onComponentFinished(result);\'><\/edit-car-class><\/div>',resolve:{carTypes:function(){return o.carTypes},parentVm:function(){return o}},controller:["$uibModalInstance","parentVm","carTypes",function(t,i,r){var u=this;u.carTypes=r;u.websiteGuid=i.websiteGuid;u.guid=n?n.guid:"";u.$uibModalInstance=t;u.cancel=function(){u.$uibModalInstance.dismiss("cancel")};u.onComponentFinished=function(n){if(console.log(n),u.cancel(),n){var t=u.carTypes.find(function(t){return t.guid===n.guid});t?(t.name=n.name,t.numberOfPassengers=n.numberOfPassengers,t.numberOfLuggages=n.numberOfLuggages,t.equivalent=n.equivalent,t.image=n.image):u.carTypes.push(n)}}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};t.$on("add-new-car-class",function(n,t){console.log(t);o.editCarType({guid:"new"})})}var n=angular.module("bookingApp");n.component("carClasses",{controller:["$timeout","$scope","$window","$uibModal","AppSettings","bookingApi","htmlPageService","Upload",t],controllerAs:"vm",template:'<div class="row ng-hide" ng-show="vm.carTypes.length <= 0"><div class="col-sm-12 text-center"><h1>No cars classes available. Use top right button to add.<\/h1><\/div><\/div><div class="row drivers-grid"><div class="col-lg-4" ng-repeat="cartype in vm.carTypes track by cartype.guid"><div class="contact-box"><div class="col-sm-4"><div class="text-center"><img alt="image" class="m-t-xs img-responsive driver-image" ng-src="{{cartype.image.url}}"><\/div><\/div><div class="col-sm-8"><h3 class="nomargin-bottom"><strong>{{cartype.name}}<\/strong><\/h3><p class="driver-summary"><div class="m-t-md"><span class="m-r-md"><i class="fa fa-user" style="padding-right: 5px;"><\/i> {{cartype.numberOfPassengers}}<\/span> <span class="m-l-md"><i class="fa fa-suitcase" style="padding-right: 5px;"><\/i> {{cartype.numberOfLuggages}}<\/span><\/div><br><i class="fa fa-car" style="padding-right: 5px;"><\/i> {{cartype.equivalent}}<\/p><\/div><div class="col-md-12 text-right"><button ng-click="vm.editCarType(cartype)" class="btn btn-primary m-r-sm"><i class="fa fa-edit"><\/i> Edit<\/button> <button ng-click="vm.deleteCarType(cartype)" class="btn btn-danger m-l-sm"><i class="fa fa-trash"><\/i> Delete<\/button><\/div><div class="clearfix"><\/div><\/div><\/div><\/div>',bindings:{websiteGuid:"<"}})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.submitted=!1;o.$onInit=function(){o.carTypeModel={};r.getCarClassInfo(o.websiteGuid,o.guid).then(function(n){n.data.success&&o.initForm(n.data.result)})};o.showI18NForCarName=function(){e.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><i18n-string i18n-model='vm.i18nModel' on-dismiss='vm.dismiss()' on-save='vm.saved(item)'><\/i18n-string><\/modal-component>",resolve:{parentVm:function(){return o},i18nModel:function(){return o.carTypeModel.nameI18N},modalTitle:function(){return"Define item in multiple languages"}},controller:["$uibModalInstance","parentVm","i18nModel","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.modalTitle=r;u.i18nModel=i;u.$uibModalInstance=n;u.saved=function(n){u.parentVm.carTypeModel.name=n.defaultValue;u.parentVm.carTypeModel.nameI18N=n;u.$uibModalInstance.dismiss("cancel")};u.dismiss=function(){console.log("dismiss parent");u.$uibModalInstance.dismiss("cancel")}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};o.showI18NForCarEquivalent=function(){e.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><i18n-string i18n-model='vm.i18nModel' on-dismiss='vm.dismiss()' on-save='vm.saved(item)'><\/i18n-string><\/modal-component>",resolve:{parentVm:function(){return o},i18nModel:function(){return o.carTypeModel.equivalentI18N},modalTitle:function(){return"Define item in multiple languages"}},controller:["$uibModalInstance","parentVm","i18nModel","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.modalTitle=r;u.i18nModel=i;u.$uibModalInstance=n;u.saved=function(n){u.parentVm.carTypeModel.equivalent=n.defaultValue;u.parentVm.carTypeModel.equivalentI18N=n;u.$uibModalInstance.dismiss("cancel")};u.dismiss=function(){console.log("dismiss parent");u.$uibModalInstance.dismiss("cancel")}}],size:"md",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};o.initForm=function(n){console.log(n);o.carTypeModel=n;o.submitted=!1;o.carTypeDetailsForm.$setPristine();o.carTypeDetailsForm.$setUntouched()};o.cancelChanges=function(){o.sending||o.onFinish&&o.onFinish()};o.saveCarClass=function(){if(!o.sending){o.submitted=!0;var n=!0;(n=!o.carTypeDetailsForm.$invalid&&n,n)&&(o.sending=!0,r.saveCarClassInfo(o.carTypeModel).then(function(n){if(n.data.success){if(u.showNotification("success","Car type saved successfully."),u.scrollElement("body"),o.initForm(n.data.result),o.sending=!1,o.onFinish)o.onFinish({result:n.data.result})}else u.showNotificationList("error",n.data.errors),o.sending=!1}))}};o.upload=function(n){n&&f.upload({url:"/Files/UploadFile/",file:n}).then(function(n){o.carTypeModel.image=n.data.result},function(n){u.showNotification("error","Could not upload image. Please try again.");console.log("Error status: "+n.status)})}}var n=angular.module("bookingApp");n.component("editCarClass",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","Upload","$uibModal",t],controllerAs:"vm",bindings:{guid:"<",websiteGuid:"<",onFinish:"&"},template:'<form name="vm.carTypeDetailsForm" novalidate><div class="row"><div class="col-md-2 col-xs-12"><img src="/Content/images/image-not-available.png" ng-src="{{vm.carTypeModel.image.url}}" class="img-responsive m-b-xs" style="max-height: 180px; margin: 0 auto;" alt="profile"><div class="text-center"><button class="btn btn-success" ngf-select="vm.upload($file)">Upload image<\/button><\/div><\/div><div class="col-md-10 col-xs-12"><div class="row"><div class="col-sm-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.name.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.name.$error.required }"><label>Name<\/label><div class="input-group"><input name="name" ng-model="vm.carTypeModel.name" type="text" placeholder="Economy Class" class="form-control" required> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="vm.showI18NForCarName()"><i class="fa fa-globe" aria-hidden="true"><\/i><\/button><\/span><\/div><div class="help-block" ng-show="vm.submitted && vm.carTypeDetailsForm.name.$error.required">Car class name is required.<\/div><\/div><\/div><div class="col-sm-3"><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.sortIndex.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.sortIndex.$error.required }"><label>Sort Index<\/label> <input name="sortIndex" ng-model="vm.carTypeModel.sortIndex" type="text" placeholder="Car type index for sorting" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.carTypeDetailsForm.sortIndex.$error.required">Car class sort index is required.<\/div><\/div><\/div><div class="col-sm-3"><div class="form-group hidden" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.i18Id.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.i18Id.$error.required }"><label>I18 Id<\/label> <input name="i18Id" ng-model="vm.carTypeModel.i18Id" type="text" placeholder="Internationalize id" class="form-control"><\/div><\/div><\/div><div class="row"><div class="col-sm-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.numberOfPassengers.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.numberOfPassengers.$error.required }"><label>Max passenger count:<\/label> <input type="text" name="numberOfPassengers" ng-model="vm.carTypeModel.numberOfPassengers" placeholder="3" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.carTypeDetailsForm.numberOfPassengers.$error.required">Number of passengers is required.<\/div><\/div><\/div><div class="col-sm-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.numberOfLuggages.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.numberOfLuggages.$error.required }"><label>Max luggage count<\/label> <input type="text" name="numberOfLuggages" ng-model="vm.carTypeModel.numberOfLuggages" placeholder="3" class="form-control" required><div class="help-block" ng-show="vm.submitted && vm.carTypeDetailsForm.numberOfLuggages.$error.required">Max luggage count is required.<\/div><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.equivalent.$pristine, \'has-error\': vm.submitted && vm.carTypeDetailsForm.equivalent.$error.required }"><label>Description<\/label><div class="input-group"><input name="equivalent" ng-model="vm.carTypeModel.equivalent" type="text" placeholder="BMW seria 3, Audi A4 or equivalent" class="form-control" required> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-click="vm.showI18NForCarEquivalent()"><i class="fa fa-globe" aria-hidden="true"><\/i><\/button><\/span><\/div><div class="help-block" ng-show="vm.submitted && vm.carTypeDetailsForm.equivalent.$error.required">Equivalent cars description is required.<\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.carTypeDetailsForm.bookingDotComCategory.$pristine}"><label>Booking.com Category<\/label><select name="bookingDotComCategory" ng-model="vm.carTypeModel.bookingDotComCategory" class="form-control"><option value="null">Not Mapped<\/option><option value="STANDARD">Standard - Standard class saloon/sedan with space for 4 passengers and 2 luggage<\/option><option value="EXECUTIVE">Executive - Executive class saloon/sedan with space for 4 passengers and 3 luggage<\/option><option value="EXECUTIVE_PEOPLE_CARRIER">Executive People Carrier - Carrier/minivan with space for 8 passengers and 5 luggage<\/option><option value="LUXURY">Luxury - Luxury class saloon/sedan with space for 4 passengers and 3 luggage<\/option><option value="PEOPLE_CARRIER">People Carrier - Standard class people carrier/minivan with space for 6 passengers and 3 luggage<\/option><option value="LARGE_PEOPLE_CARRIER">Large People Carrier - Standard class people carrier/minivan with space for 8 passengers and 5 luggage<\/option><option value="MINIBUS">Minibus - Standard class people carrier/minivan with space for 16 passengers and 5 luggage<\/option><\/select><a href="https://taxisuppliers-support.booking.com/hc/en-us/articles/4403664677393-What-types-of-vehicles-do-you-support-" target="_blank">More Info<\/a><\/div><\/div><\/div><div class="row text-center m-t-lg"><button type="submit" class="btn btn-primary m-r-md" ng-click="vm.saveCarClass()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> <i class="fa fa-save" ng-show="!vm.sending"><\/i> Save<\/button> <button type="submit" class="btn btn-danger m-l-md" ng-click="vm.cancelChanges()"><i class="fa fa-times"><\/i> Cancel<\/button><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getWebsites().then(function(n){e.websites=n.data.result.websites;console.log(e.websites)})};n.$on("add-new-website",function(){e.editWebsite()});e.editWebsite=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><website-admin-edit-website guid='vm.guid' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/website-admin-edit-website><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return n?n.name+" website settings":"Add new website"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel");t.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.editUsers=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><website-users guid='vm.guid' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/website-users><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return n.name+" users"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(n){console.log(n);var i=t.websites.findIndex(function(t){return t.guid===n.guid});i>=0?t.websites[i]=n:t.websites.push(n)}}],size:"lg",appendTo:angular.element(document.body),backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.makeDefaultWebsite=function(n){f.setDefaultWebsite(n.guid).then(function(){i.location.reload()})};e.removeWebsite=function(n){u.showConfirmation("Warning","Delete website "+n.name+"?").then(function(){f.deleteWebsite(n.guid).then(function(){e.$onInit()})})};e.restoreWebsite=function(n){u.showConfirmation("Warning","Restore website "+n.name+"?").then(function(){f.restoreWebsite(n.guid).then(function(){e.$onInit()})})}}var n=angular.module("bookingApp");n.component("websitesList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{searchText:"<"},template:'<div class="input-group m-b-md"><input type="text" placeholder="Search" ng-model="vm.searchText" class="input form-control"> <span class="input-group-btn"><button type="button" class="btn btn btn-danger" ng-click="vm.searchText = \'\'"><i class="fa fa-remove"><\/i> Clear<\/button><\/span><\/div><table class="table table-hover"><tbody><tr ng-repeat="website in vm.websites | filter:vm.searchText track by website.guid"><td><img ng-src="{{website.invoiceLogo.url}}" style="max-width: 70px; max-height: 70px;"><\/td><td>{{website.name}}<\/td><td>{{website.bookingsCount}} bookings<\/td><td>{{website.driversCount}} drivers<\/td><td>{{website.clientsCount}} clients<\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editWebsite(website)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <button class="btn btn-primary btn-sm m-r-xs m-l-xs" ng-click="vm.editUsers(website)"><i class="fa fa-edit" aria-hidden="true"><\/i> Users<\/button> <button class="btn btn-primary btn-sm m-r-xs m-l-xs" ng-click="vm.makeDefaultWebsite(website)"><i class="fa fa-star" aria-hidden="true"><\/i> Default<\/button> <button class="btn btn-danger btn-sm m-l-xs" ng-hide="website.removed" ng-click="vm.removeWebsite(website)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button> <button class="btn btn-success btn-sm m-l-xs" ng-show="website.removed" ng-click="vm.restoreWebsite(website)"><i class="fa fa-refresh" aria-hidden="true"><\/i> Restore<\/button><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r){var u=this;u.$onInit=function(){u.errors=[];u.websiteModel={hasWebsite:!0,currency:"-1",unit:"-1"};u.sending=!1};u.addressChangedHandler=function(n){if(!n){u.websiteModel.companyAddress=null;return}u.websiteModel.companyAddress={addressName:n.name,address:n.formatted_address,latLng:{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()}}};u.registerWebsite=function(){if(u.errors=[],u.sent=!0,!u.sending){let i=!1;(u.websiteModel.companyAddress||(i=!0,u.websiteModel.address&&(u.websiteModel.address=null,i=!0)),(u.websiteModel.currency==="-1"||u.websiteModel.unit==="-1")&&(i=!0),u.websiteRegistrationForm.$valid||(i=!0),i)||(u.sending=!0,r.registerWebsite(u.websiteModel).then(function(i){console.log(i);i.data.success?(u.isRegistered=!0,n(function(){t.location.href="https://account.chauffeurbookingsoftware.com/websites/editdefaultwebsite/"},7e3)):u.errors=i.data.errors;u.sending=!1}))}}}var n=angular.module("bookingApp");n.component("registerWebsite",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{email:"<",dismiss:"&",saved:"&"},template:'<form name="vm.websiteRegistrationForm" novalidate class="m-t" role="form" autocomplete="off"><div class="row"><div class="form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.firstName}"><input type="text" name="firstName" ng-model="vm.websiteModel.firstName" class="form-control" placeholder="First Name" required><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.firstName">Please enter administrator first name<\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.lastName}"><input type="text" name="lastName" ng-model="vm.websiteModel.lastName" class="form-control" placeholder="Last Name" required><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.lastName">Please enter administrator last name<\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.email}"><input type="email" name="email" ng-model="vm.websiteModel.email" class="form-control" placeholder="Email" required><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.email">Please enter administrator email<\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.phone}"><input type="text" name="phone" ng-model="vm.websiteModel.phone" class="form-control" placeholder="Phone" required><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.phone">Please enter company phone number<\/div><\/div><hr><div class="form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.websiteName}"><input type="text" name="comapanyName" ng-model="vm.websiteModel.websiteName" class="form-control" placeholder="Company Name" required><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.websiteName">Please enter company name<\/div><\/div><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey" style="padding-top: 0; padding-left: 0;"><input icheck type="checkbox" id="hasWebsite" name="hasWebsite" value="true" ng-data-value="true" ng-model="vm.websiteModel.hasWebsite"> <label for="hasWebsite" style="padding-left: 0px; font-weight: bold; line-height: 21px;">I have a website for my company<\/label><\/div><\/div><div class="form-group" ng-class="{\'has-error\': vm.sent && vm.websiteRegistrationForm.websiteUrl.$invalid}"><input type="url" name="websiteUrl" ng-model="vm.websiteModel.websiteUrl" class="form-control" ng-required="vm.websiteModel.hasWebsite" placeholder="Company Website"><div class="help-block ng-hide" ng-show="vm.sent && vm.websiteRegistrationForm.websiteUrl.$error.required">Please enter company website.<\/div><div class="help-block ng-hide" ng-show="vm.sent && vm.websiteRegistrationForm.websiteUrl.$error.url">Company website does not have correct format. It should start with http:// or https://. Example: http://google.com<\/div><\/div><div class="form-group origin-form-group" ng-class="{\'has-error\': vm.sent && !vm.websiteModel.companyAddress}"><input id="origin" type="text" class="form-control original-style" name="origin" placeholder="Company Address" ng-autocomplete ng-model="vm.websiteModel.address" details="vm.origin.details" options="vm.locationOptions" on-changed="vm.addressChangedHandler"><div class="help-block ng-hide" ng-show="vm.sent && !vm.websiteModel.companyAddress">Please enter company location<\/div><\/div><div class="row"><div class="col-sm-6"><div class="form-group" ng-class="{\'has-error\': vm.sent && vm.websiteModel.currency < 0}"><select name="currency" ng-model="vm.websiteModel.currency" class="form-control"><option selected value="-1">Main Currency<\/option><option value="USD">USD - &dollar;<\/option><option value="EUR">EUR - &euro;<\/option><option value="CAD">CAD - &dollar;<\/option><option value="CHF">CHF<\/option><option value="PLN">PLN - zł<\/option><option value="GBP">GBP - &pound;<\/option><option value="AUD">AUD - &dollar;<\/option><option value="NZD">NZD - &dollar;<\/option><option value="SGD">SGD - &dollar;<\/option><option value="THB">THB - &#x0E3F;<\/option><option value="MYR">MYR - RM<\/option><option value="IDR">IDR - Rp<\/option><option value="VND">VND - &#8363;<\/option><\/select><div class="help-block ng-hide" ng-show="vm.sent && vm.websiteModel.currency < 0">Select your main currency<\/div><\/div><\/div><div class="col-sm-6"><div class="form-group" ng-class="{\'has-error\': vm.sent && vm.websiteModel.unit < 0}"><select name="currency" ng-model="vm.websiteModel.unit" class="form-control"><option value="-1">Distance Unit<\/option><option value="mile">Miles<\/option><option value="km">Kilometers<\/option><\/select><div class="help-block ng-hide" ng-show="vm.sent && vm.websiteModel.unit < 0">Select preferred distance unit<\/div><\/div><\/div><\/div><div class="row text-center errorListRow" ng-show="vm.errors.length > 0"><div class="col-sm-12"><ul class="list-unstyled mb-10 text-danger"><li ng-repeat="error in vm.errors">{{error}}<\/li><\/ul><\/div><\/div><button type="submit" ng-show="!vm.isRegistered" ng-click="vm.registerWebsite()" class="btn btn-success block full-width m-b"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> START FREE<\/button><div ng-show="vm.isRegistered"><h3 style="color: #45cb45; text-align: center;">Registration succeeded. Thank you!<\/h3><a href="https://account.chauffeurbookingsoftware.com/" type="submit" class="btn btn-success block full-width m-b">Go To Dashboard<\/a><\/div><\/div><\/form><style>\r\n    .btn-success {\r\n        background-color: #00be8d;\r\n        border-color: #12d8a5;\r\n    }\r\n     .upload-image img {\r\n         max-width: 250px;\r\n         max-height: 250px;\r\n     }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.wasSaved=!1;f.$onInit=function(){r.getWebsiteInfo(f.guid).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result),f.dismissIfSaved(n.data.result),f.wasSaved=!1)})};f.dismissIfSaved=function(n){f.wasSaved&&f.saved&&(f.saved({item:n}),f.dismiss&&f.dismiss())};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.initForm=function(n){f.websiteModel=n};f.updateWebsite=function(){console.log(f.websiteModel);r.updateWebsiteInfo(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),u.scrollElement("body"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("websiteAdminEditWebsite",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",dismiss:"&",saved:"&"},template:'<div><uib-tabset><uib-tab heading="General"><div class="panel-body"><edit-website-general-settings website-guid="vm.guid"><\/edit-website-general-settings><\/div><\/uib-tab><uib-tab heading="Notifications"><div class="panel-body"><edit-website-notifications-settings website-guid="vm.guid"><\/edit-website-notifications-settings><\/div><\/uib-tab><uib-tab heading="Operations"><div class="panel-body"><edit-website-operations-settings website-guid="vm.guid"><\/edit-website-operations-settings><\/div><\/uib-tab><uib-tab heading="Files"><div class="panel-body"><edit-website-files-settings website-guid="vm.guid"><\/edit-website-files-settings><\/div><\/uib-tab><\/uib-tabset><\/div><style>\r\n    .upload-image img {\r\n        max-width: 250px;\r\n        max-height: 250px;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getWebsiteInfo(f.websiteGuid).then(function(n){n.data.success&&f.initForm(n.data.result)})};f.initForm=function(n){f.websiteModel=n;f.websiteDetailsForm.$setPristine();f.websiteDetailsForm.$setUntouched()};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){console.log(f.websiteModel);r.saveWebsiteGeneralDetails(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),u.scrollElement("body"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsiteGeneralSettings",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<form name="vm.websiteDetailsForm" class="form-horizontal"><div class="row"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.domain.$pristine }"><label class="col-sm-2 control-label">Domains<\/label><div class="col-sm-10"><input name="domain" ng-model="vm.websiteModel.allowedDomains" type="text" placeholder="https://executivechauffeur.com" class="form-control"> <small>List of comma separated allowed domains for this website.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.name.$pristine }"><label class="col-sm-2 control-label">Name<\/label><div class="col-sm-10"><input name="name" ng-model="vm.websiteModel.name" type="text" placeholder="My Chauffeur Executive" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.description.$pristine }"><label class="col-sm-2 control-label">Description<\/label><div class="col-sm-10"><textarea name="description" ng-model="vm.websiteModel.description" type="text" placeholder="My Chauffeur Executive transfer services..." class="form-control">\r\n                <\/textarea><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.timeZone.$pristine }"><label class="col-sm-2 control-label">Timezone<\/label><div class="col-sm-10"><select name="timeZone" ng-model="vm.websiteModel.timeZone" class="form-control"><option value="Morocco Standard Time">(GMT) Casablanca<\/option><option value="GMT Standard Time">(GMT) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London<\/option><option value="Greenwich Standard Time">(GMT) Monrovia, Reykjavik<\/option><option value="W. Europe Standard Time">(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna<\/option><option value="Central Europe Standard Time">(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague<\/option><option value="Romance Standard Time">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris<\/option><option value="Central European Standard Time">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb<\/option><option value="W. Central Africa Standard Time">(GMT+01:00) West Central Africa<\/option><option value="Jordan Standard Time">(GMT+02:00) Amman<\/option><option value="GTB Standard Time">(GMT+02:00) Athens, Bucharest, Istanbul<\/option><option value="Middle East Standard Time">(GMT+02:00) Beirut<\/option><option value="Egypt Standard Time">(GMT+02:00) Cairo<\/option><option value="South Africa Standard Time">(GMT+02:00) Harare, Pretoria<\/option><option value="FLE Standard Time">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius<\/option><option value="Israel Standard Time">(GMT+02:00) Jerusalem<\/option><option value="E. Europe Standard Time">(GMT+02:00) Minsk<\/option><option value="Namibia Standard Time">(GMT+02:00) Windhoek<\/option><option value="Arabic Standard Time">(GMT+03:00) Baghdad<\/option><option value="Arab Standard Time">(GMT+03:00) Kuwait, Riyadh<\/option><option value="Russian Standard Time">(GMT+03:00) Moscow, St. Petersburg, Volgograd<\/option><option value="E. Africa Standard Time">(GMT+03:00) Nairobi<\/option><option value="Georgian Standard Time">(GMT+03:00) Tbilisi<\/option><option value="Iran Standard Time">(GMT+03:30) Tehran<\/option><option value="Arabian Standard Time">(GMT+04:00) Abu Dhabi, Muscat<\/option><option value="Azerbaijan Standard Time">(GMT+04:00) Baku<\/option><option value="Mauritius Standard Time">(GMT+04:00) Port Louis<\/option><option value="Caucasus Standard Time">(GMT+04:00) Yerevan<\/option><option value="Afghanistan Standard Time">(GMT+04:30) Kabul<\/option><option value="Ekaterinburg Standard Time">(GMT+05:00) Ekaterinburg<\/option><option value="Pakistan Standard Time">(GMT+05:00) Islamabad, Karachi<\/option><option value="West Asia Standard Time">(GMT+05:00) Tashkent<\/option><option value="India Standard Time">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi<\/option><option value="Sri Lanka Standard Time">(GMT+05:30) Sri Jayawardenepura<\/option><option value="Nepal Standard Time">(GMT+05:45) Kathmandu<\/option><option value="N. Central Asia Standard Time">(GMT+06:00) Almaty, Novosibirsk<\/option><option value="Central Asia Standard Time">(GMT+06:00) Astana, Dhaka<\/option><option value="Myanmar Standard Time">(GMT+06:30) Yangon (Rangoon)<\/option><option value="SE Asia Standard Time">(GMT+07:00) Bangkok, Hanoi, Jakarta<\/option><option value="North Asia Standard Time">(GMT+07:00) Krasnoyarsk<\/option><option value="China Standard Time">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi<\/option><option value="North Asia East Standard Time">(GMT+08:00) Irkutsk, Ulaan Bataar<\/option><option value="Singapore Standard Time">(GMT+08:00) Kuala Lumpur, Singapore<\/option><option value="W. Australia Standard Time">(GMT+08:00) Perth<\/option><option value="Taipei Standard Time">(GMT+08:00) Taipei<\/option><option value="Tokyo Standard Time">(GMT+09:00) Osaka, Sapporo, Tokyo<\/option><option value="Korea Standard Time">(GMT+09:00) Seoul<\/option><option value="Yakutsk Standard Time">(GMT+09:00) Yakutsk<\/option><option value="Cen. Australia Standard Time">(GMT+09:30) Adelaide<\/option><option value="AUS Central Standard Time">(GMT+09:30) Darwin<\/option><option value="E. Australia Standard Time">(GMT+10:00) Brisbane<\/option><option value="AUS Eastern Standard Time">(GMT+10:00) Canberra, Melbourne, Sydney<\/option><option value="West Pacific Standard Time">(GMT+10:00) Guam, Port Moresby<\/option><option value="Tasmania Standard Time">(GMT+10:00) Hobart<\/option><option value="Vladivostok Standard Time">(GMT+10:00) Vladivostok<\/option><option value="Central Pacific Standard Time">(GMT+11:00) Magadan, Solomon Is., New Caledonia<\/option><option value="New Zealand Standard Time">(GMT+12:00) Auckland, Wellington<\/option><option value="Fiji Standard Time">(GMT+12:00) Fiji, Kamchatka, Marshall Is.<\/option><option value="Tonga Standard Time">(GMT+13:00) Nuku\'alofa<\/option><option value="Azores Standard Time">(GMT-01:00) Azores<\/option><option value="Cape Verde Standard Time">(GMT-01:00) Cape Verde Is.<\/option><option value="Mid-Atlantic Standard Time">(GMT-02:00) Mid-Atlantic<\/option><option value="E. South America Standard Time">(GMT-03:00) Brasilia<\/option><option value="Argentina Standard Time">(GMT-03:00) Buenos Aires<\/option><option value="SA Eastern Standard Time">(GMT-03:00) Georgetown<\/option><option value="Greenland Standard Time">(GMT-03:00) Greenland<\/option><option value="Montevideo Standard Time">(GMT-03:00) Montevideo<\/option><option value="Newfoundland Standard Time">(GMT-03:30) Newfoundland<\/option><option value="Atlantic Standard Time">(GMT-04:00) Atlantic Time (Canada)<\/option><option value="SA Western Standard Time">(GMT-04:00) La Paz<\/option><option value="Central Brazilian Standard Time">(GMT-04:00) Manaus<\/option><option value="Pacific SA Standard Time">(GMT-04:00) Santiago<\/option><option value="Venezuela Standard Time">(GMT-04:30) Caracas<\/option><option value="SA Pacific Standard Time">(GMT-05:00) Bogota, Lima, Quito, Rio Branco<\/option><option value="Eastern Standard Time">(GMT-05:00) Eastern Time (US & Canada)<\/option><option value="US Eastern Standard Time">(GMT-05:00) Indiana (East)<\/option><option value="Central America Standard Time">(GMT-06:00) Central America<\/option><option value="Central Standard Time">(GMT-06:00) Central Time (US & Canada)<\/option><option value="Central Standard Time (Mexico)">(GMT-06:00) Guadalajara, Mexico City, Monterrey<\/option><option value="Canada Central Standard Time">(GMT-06:00) Saskatchewan<\/option><option value="US Mountain Standard Time">(GMT-07:00) Arizona<\/option><option value="Mountain Standard Time (Mexico)">(GMT-07:00) Chihuahua, La Paz, Mazatlan<\/option><option value="Mountain Standard Time">(GMT-07:00) Mountain Time (US & Canada)<\/option><option value="Pacific Standard Time">(GMT-08:00) Pacific Time (US & Canada)<\/option><option value="Pacific Standard Time (Mexico)">(GMT-08:00) Tijuana, Baja California<\/option><option value="Alaskan Standard Time">(GMT-09:00) Alaska<\/option><option value="Hawaiian Standard Time">(GMT-10:00) Hawaii<\/option><option value="Samoa Standard Time">(GMT-11:00) Midway Island, Samoa<\/option><option value="Dateline Standard Time">(GMT-12:00) International Date Line West<\/option><\/select><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Reset changes<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.checked=!0;f.$onInit=function(){r.getWebsiteNotificationSettings(f.websiteGuid).then(function(n){n.data.success&&(console.log("notifications: ",n.data.result),f.initForm(n.data.result))})};f.initForm=function(n){f.websiteModel=n;f.websiteDetailsForm.$setPristine();f.websiteDetailsForm.$setUntouched()};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){r.updateWebsiteNotificationSettings(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),u.scrollElement("body"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsiteNotificationsSettings",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<form name="vm.websiteDetailsForm" class="form-horizontal"><div class="row"><div class="col-sm-12"><h3>When a user make a new booking:<\/h3><\/div><div class="form-group"><label class="col-sm-2 control-label">Save card:<\/label><div class="col-sm-10" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.saveCustomerCardForLaterCharges.$pristine }"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="saveCustomerCardForLaterCharges" type="checkbox" icheck ng-model="vm.websiteModel.saveCustomerCardForLaterCharges"> <i><\/i> <span class="m-l-xs">Save customer card for later charges<\/span><\/label><\/div><\/div><\/div><div class="col-sm-offset-2 col-sm-10" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.percentageToChargeAtBookingTime.$pristine }" ng-show="vm.websiteModel.saveCustomerCardForLaterCharges"><div class="form-group">Charge client <input class="form-control" style="max-width: 50px; display: inline-block; margin: 0 10px;" type="text" name="percentageToChargeAtBookingTime" ng-model="vm.websiteModel.percentageToChargeAtBookingTime"> percent (%) of booking value when he book from website. Remaining value will charged manually at a later time.<p class="text-danger" ng-show="vm.websiteModel.percentageToChargeAtBookingTime && (vm.websiteModel.percentageToChargeAtBookingTime < 0 || vm.websiteModel.percentageToChargeAtBookingTime > 100)">Value should be between 0 and 100.<\/p><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.newBookingEmail.$pristine }"><label class="col-sm-2 control-label">Send email to:<\/label><div class="col-sm-10"><input name="newBookingEmail" ng-model="vm.websiteModel.newBookingEmail" type="text" placeholder="newbooking@executivechauffeur.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.newBookingSmsNumber.$pristine }"><label class="col-sm-2 control-label">Send SMS to:<\/label><div class="col-sm-10"><input name="newBookingSmsNumber" ng-model="vm.websiteModel.newBookingSmsNumber" type="text" placeholder="44754235..." class="form-control"> <small>Should be in international format without +. Ex Uk: 447542312565 Ex Us: 15536456885<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendClientConfiramtionEmail.$pristine }"><label class="col-sm-2 control-label">Confirmation Email:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendClientConfiramtionEmail" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendClientConfiramtionEmail"> <i><\/i> <span class="m-l-xs">Automatically send a confirmation email to the customer.<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendClientConfiramtionSms.$pristine }"><label class="col-sm-2 control-label">Confirmation SMS:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendClientConfiramtionSms" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendClientConfiramtionSms"> <i><\/i> <span class="m-l-xs">Automatically send a confirmation SMS to the customer.<\/span><\/label><\/div><\/div><\/div><hr><div class="col-sm-12"><h3>When user send contact form:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerContactFormEmail.$pristine }"><label class="col-sm-2 control-label">Send message to:<\/label><div class="col-sm-10"><input name="customerContactFormEmail" ng-model="vm.websiteModel.customerContactFormEmail" type="text" placeholder="contact@executivechauffeur.com" class="form-control"><\/div><\/div><hr><div class="col-sm-12"><h3>When system send an email to a user:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.custommerCommunicationEmail.$pristine }"><label class="col-sm-2 control-label">Source email:<\/label><div class="col-sm-10"><input name="custommerCommunicationEmail" ng-model="vm.websiteModel.custommerCommunicationEmail" type="text" placeholder="booking@executivechauffeur.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerEmailCompanyName.$pristine }"><label class="col-sm-2 control-label">Company name:<\/label><div class="col-sm-10"><input name="customerEmailCompanyName" ng-model="vm.websiteModel.customerEmailCompanyName" type="text" placeholder="Executive Chauffeur" class="form-control"> <small>This company name will be used in email templates.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerEmailCompanyAddress.$pristine }"><label class="col-sm-2 control-label">Company address:<\/label><div class="col-sm-10"><input name="customerEmailCompanyAddress" ng-model="vm.websiteModel.customerEmailCompanyAddress" type="text" placeholder="566 Chiswick Highroad Building 3 Office 129" class="form-control"> <small>Will be used in email templates to comply with anti spam regulations.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerEmailCompanyAdditionalAddress.$pristine }"><label class="col-sm-2 control-label">Additional address:<\/label><div class="col-sm-10"><input name="customerEmailCompanyAdditionalAddress" ng-model="vm.websiteModel.customerEmailCompanyAdditionalAddress" type="text" placeholder="566 Chiswick Highroad Building 3 Office 129" class="form-control"> <small>Will be used in email templates to comply with anti spam regulations.<\/small><\/div><\/div><hr><div class="col-sm-12"><h3>When driver is assigned to a booking:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverConfiramtionEmail.$pristine }"><label class="col-sm-2 control-label">Driver Email:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverConfiramtionEmail" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendDriverConfiramtionEmail"> <i><\/i> <span class="m-l-xs">Automatically send driver confirmation by email<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverConfiramtionSms.$pristine }"><label class="col-sm-2 control-label">Driver SMS:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverConfiramtionSms" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendDriverConfiramtionSms"> <i><\/i> <span class="m-l-xs">Automatically send driver confirmation by SMS<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverInfoToCustomerByEmail.$pristine }"><label class="col-sm-2 control-label">Client Email:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverInfoToCustomerByEmail" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendDriverInfoToCustomerByEmail"> <i><\/i> <span class="m-l-xs">Automatically send driver & car details to client by email<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverInfoToCustomerBySms.$pristine }"><label class="col-sm-2 control-label">Client SMS:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverInfoToCustomerBySms" type="checkbox" icheck ng-model="vm.websiteModel.automaticallySendDriverInfoToCustomerBySms"> <i><\/i> <span class="m-l-xs">Automatically send driver & car details to client by SMS<\/span><\/label><\/div><\/div><\/div><hr><div class="col-sm-12"><h3>When booking bid is started:<\/h3><\/div><div class="form-group"><label class="col-sm-2 control-label">Email:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" readonly icheck disabled checked ng-model="vm.checked"> <i><\/i> <span class="m-l-xs">Automatically send each driver an invitation email.<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverBidInvitationSms.$pristine }"><label class="col-sm-2 control-label">SMS:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverBidInvitationSms" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallySendDriverBidInvitationSms"> <i><\/i> <span class="m-l-xs">Automatically send each driver an invitation SMS.<\/span><\/label><\/div><\/div><\/div><hr><div class="col-sm-12"><h4 ng-class="{\'field-changed\' : !vm.websiteDetailsForm.minutesBeforeBookingClientReminder.$pristine }">Automatically send a reminder to the <b>Customer<\/b> <input name="minutesBeforeBookingClientReminder" style="display: inline-block; margin: 0 10px; max-width: 60px" ng-model="vm.websiteModel.minutesBeforeBookingClientReminder" type="text" placeholder="120" class="form-control"> (minutes) before booking time. Check the below options to send.<\/h4><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendClientReminderEmail.$pristine }"><label class="col-sm-2 control-label">Email reminder:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendClientReminderEmail" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallySendClientReminderEmail"> <i><\/i> <span class="m-l-xs">Automatically send client <b>Email<\/b> reminder {{vm.websiteModel.minutesBeforeBookingClientReminder}} minutes before booking time.<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendClientReminderSms.$pristine }"><label class="col-sm-2 control-label">SMS reminder:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendClientReminderSms" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallySendClientReminderSms"> <i><\/i> <span class="m-l-xs">Automatically send client <b>SMS<\/b> reminder {{vm.websiteModel.minutesBeforeBookingClientReminder}} minutes before booking time.<\/span><\/label><\/div><\/div><\/div><\/div><div class="col-sm-12"><h4 ng-class="{\'field-changed\' : !vm.websiteDetailsForm.minutesBeforeBookingDriverReminder.$pristine }">Automatically send a reminder to the <b>Driver<\/b> <input name="minutesBeforeBookingDriverReminder" style="display: inline-block; margin: 0 10px; max-width: 60px" ng-model="vm.websiteModel.minutesBeforeBookingDriverReminder" type="text" placeholder="120" class="form-control"> (minutes) before booking time. Check below options to send.<\/h4><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverReminderEmail.$pristine }"><label class="col-sm-2 control-label">Email reminder:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverReminderEmail" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallySendDriverReminderEmail"> <i><\/i> <span class="m-l-xs">System will automatically send client <b>Email<\/b> reminder {{vm.websiteModel.minutesBeforeBookingDriverReminder}} minutes before booking time.<\/span><\/label><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallySendDriverReminderSms.$pristine }"><label class="col-sm-2 control-label">SMS reminder:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallySendDriverReminderSms" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallySendDriverReminderSms"> <i><\/i> <span class="m-l-xs">Automatically send client <b>SMS<\/b> reminder {{vm.websiteModel.minutesBeforeBookingDriverReminder}} minutes before booking time.<\/span><\/label><\/div><\/div><\/div><\/div><div class="col-sm-12"><h3>When the booking is finished:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.automaticallyAskForDriverReview.$pristine }"><label class="col-sm-2 control-label">Driver Review:<\/label><div class="col-sm-10"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input name="automaticallyAskForDriverReview" type="checkbox" readonly icheck ng-model="vm.websiteModel.automaticallyAskForDriverReview"> <i><\/i> <span class="m-l-xs">The system should automatically send an email to the <b>Customer<\/b> asking to review the <b>Driver<\/b>.<\/span><\/label><div class="m-t-sm">You can enable/disable this option when you edit each booking.<\/div><\/div><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Reset changes<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.allowedRegions=[];f.$onInit=function(){r.getWebsiteOperationsSettings(f.websiteGuid).then(function(n){n.data.success&&f.initForm(n.data.result)});r.getAllDriversAllowedAreas(f.websiteGuid).then(function(n){n.data.success&&(f.allowedRegions=n.data.result)})};f.initForm=function(n){f.websiteModel=n;f.websiteModel.restrictWebBookingToRegions=n.restrictWebBookingToRegions.toString();f.websiteModel.allowedDriverRegions&&f.websiteModel.allowedDriverRegions.length>0&&(f.websiteModel.selectedAllowedDriverRegions=f.websiteModel.allowedDriverRegions.split(","));f.websiteDetailsForm.$setPristine();f.websiteDetailsForm.$setUntouched()};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){f.websiteModel.allowedDriverRegions=f.websiteModel.selectedAllowedDriverRegions&&f.websiteModel.selectedAllowedDriverRegions.length>0?f.websiteModel.selectedAllowedDriverRegions.join(","):"";r.updateWebsiteOperationsSettings(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsiteOperationsSettings",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<form name="vm.websiteDetailsForm" class="form-horizontal"><div class="row"><div class="col-sm-12"><h3 ng-class="{\'field-changed\' : !vm.websiteDetailsForm.minimumFreeCancelTimeInMinutes.$pristine }">Client can cancel booking without any charges with <input name="minimumFreeCancelTimeInMinutes" style="display: inline-block; max-width: 80px" ng-model="vm.websiteModel.minimumFreeCancelTimeInMinutes" type="text" placeholder="360" class="form-control"> (minutes) before booking time.<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.allowBookingOnlyOnDefinedRegions.$pristine }"><label class="col-sm-2 control-label">Booking address <span style="color: rgb(201, 9, 9); font-weight: bold;">MUST<\/span> be:<\/label><div class="col-sm-10"><div class="form-group"><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top margin-right-10"><input icheck type="radio" id="bookOnlyOnDefinedRegions" name="allowBookingOnlyOnDefinedRegions" value="true" ng-data-value="true" ng-model="vm.websiteModel.restrictWebBookingToRegions"> <label for="bookOnlyOnDefinedRegions">Within a defined region<\/label><\/div><div class="checkbox checkbox-inline checkbox-grey nomargin-bottom nomargin-top"><input icheck type="radio" id="bookOnAnyRegion" name="allowBookingOnlyOnDefinedRegions" value="false" ng-data-value="false" ng-model="vm.websiteModel.restrictWebBookingToRegions"> <label for="bookOnAnyRegion">Anywhere (worldwide)<\/label><\/div><\/div><p ng-show="vm.websiteModel.restrictWebBookingToRegions == \'true\'" class="text-warning">Online booking will show message:<br>\'<i>At the moment we do not cover this pickup location. Please CALL or ASK FOR QUOTE so we can help with this pickup location<\/i>\'<br>and will prevent booking is From or To locations are not is a defined region.<\/p><\/div><\/div><div class="col-sm-12"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.selectedAllowedDriverRegions.$pristine }"><label class="col-sm-2 control-label">Allowed driver regions:<\/label><div class="col-sm-10"><ui-select multiple tagging tagging-tokens="," tagging-label ng-model="vm.websiteModel.selectedAllowedDriverRegions" theme="bootstrap" sortable="true" style="width: 100%;" title="Covered regions"><ui-select-match placeholder="Allowed regions that drivers can cover">{{$item}}<\/ui-select-match><ui-select-choices repeat="city in vm.allowedRegions | filter:$select.search">{{city}}<\/ui-select-choices><\/ui-select><\/div><\/div><\/div><hr><div class="col-sm-12"><h3>TxtToLocal SMS Gateway:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.txtToLocalUsername.$pristine }"><label class="col-sm-2 control-label">Sms TxtToLocal username:<\/label><div class="col-sm-10"><input name="txtToLocalUsername" ng-model="vm.websiteModel.txtToLocalUsername" type="text" placeholder="Ex: office@executivechauffeur.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.txtToLocalApiKey.$pristine }"><label class="col-sm-2 control-label">Sms TxtToLocal key:<\/label><div class="col-sm-10"><input name="txtToLocalApiKey" ng-model="vm.websiteModel.txtToLocalApiKey" type="text" placeholder="Ex: GWhknp2YCo-zCiouGBA6VhtyhnPtGkb3XTq8loa17" class="form-control"><\/div><\/div><div class="col-sm-12"><h3>Twilio SMS Gateway:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.twilioAccount.$pristine }"><label class="col-sm-2 control-label">Twilio account:<\/label><div class="col-sm-10"><input name="twilioAccount" ng-model="vm.websiteModel.twilioAccount" type="text" placeholder="Ex: AC4aefaaa9226d7352a5d79c8a73e015d5" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.twilioToken.$pristine }"><label class="col-sm-2 control-label">Twilio token:<\/label><div class="col-sm-10"><input name="twilioToken" ng-model="vm.websiteModel.twilioToken" type="text" placeholder="Ex: 91c5d2404edc4d5d8901ceea8d2f677c" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.fromSmsNumber.$pristine }"><label class="col-sm-2 control-label">From number:<\/label><div class="col-sm-10"><input name="fromSmsNumber" ng-model="vm.websiteModel.fromSmsNumber" type="text" placeholder="Ex: +447400410953" class="form-control"><\/div><\/div><div class="col-sm-12"><h3 style="display: inline-block">Google Maps Api keys:<\/h3><div class="checkbox checkbox-inline checkbox-grey" style="padding-top: 0px;"><input icheck type="checkbox" id="useClientGoogleApiKeys" name="useClientGoogleApiKeys" value="true" ng-data-value="true" ng-model="vm.websiteModel.useClientGoogleApiKeys"> <label for="useClientGoogleApiKeys" style="padding-left: 10px; font-weight: bold; line-height: 21px;">Use my own Google API key<\/label><\/div><\/div><div ng-show="vm.websiteModel.useClientGoogleApiKeys"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.googleMapsKey.$pristine }"><label class="col-sm-2 control-label">Google Maps website key:<\/label><div class="col-sm-10"><input name="googleMapsKey" ng-model="vm.websiteModel.googleMapsKey" type="text" placeholder="Ex: AIzTY7AQ3Ikkpa29e3mU8BnCiF-7URCIBMagefM" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.googleServerMapsApiKey.$pristine }"><label class="col-sm-2 control-label">Google maps server key:<\/label><div class="col-sm-10"><input name="googleServerMapsApiKey" ng-model="vm.websiteModel.googleServerMapsApiKey" type="text" placeholder="Ex: AIzTY7AQ3Ikkpa29e3mU8BnCiF-7URCIBMagefM" class="form-control"><\/div><\/div><\/div><div ng-show="vm.websiteModel.isSystemAdmin"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.systemGoogleMapsKey.$pristine }"><label class="col-sm-2 control-label">Google Maps system website key:<\/label><div class="col-sm-10"><input name="systemGoogleMapsKey" ng-model="vm.websiteModel.systemGoogleMapsKey" type="text" placeholder="Ex: AI2TY7AQ3Ikkpa29e3mU8BnCiF-7URCIBMagefM" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.systemGoogleServerMapsApiKey.$pristine }"><label class="col-sm-2 control-label">Google maps system server key:<\/label><div class="col-sm-10"><input name="systemGoogleServerMapsApiKey" ng-model="vm.websiteModel.systemGoogleServerMapsApiKey" type="text" placeholder="Ex: AIzTY7AQ3Ikkpa29e3mU8BnCiF-7URCIBMagefM" class="form-control"><\/div><\/div><\/div><div class="col-sm-12"><h3>Payment Info:<\/h3><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.currency.$pristine }"><label class="col-sm-2 control-label">Currency<\/label><div class="col-sm-10"><select name="currency" ng-model="vm.websiteModel.currency" class="form-control"><option value="EUR">EUR - &euro;<\/option><option value="CAD">CAD - &dollar;<\/option><option value="CHF">CHF<\/option><option value="PLN">PLN - zł<\/option><option value="GBP">GBP - &pound;<\/option><option value="USD">USD - &dollar;<\/option><option value="AUD">AUD - &dollar;<\/option><option value="NZD">NZD - &dollar;<\/option><option value="SGD">SGD - &dollar;<\/option><option value="THB">THB - &#x0E3F;<\/option><option value="MYR">MYR - RM<\/option><option value="IDR">IDR - Rp<\/option><option value="VND">VND - &#8363;<\/option><\/select><\/div><\/div><div class="col-sm-12"><h3 style="display: inline-block; padding-left: 38px;">Payment method:<\/h3><div class="checkbox checkbox-inline checkbox-grey" style="padding-top: 0px;"><input icheck type="checkbox" id="allowCashAsPaymentMethod" name="allowCashAsPaymentMethod" value="true" ng-data-value="true" ng-model="vm.websiteModel.allowCashAsPaymentMethod"> <label for="allowCashAsPaymentMethod" style="padding-left: 10px; font-weight: bold; line-height: 21px;">Allow Cash Payments<\/label><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.stripeWebsiteKey.$pristine }"><label class="col-sm-2 control-label">Stripe public key:<\/label><div class="col-sm-10"><input name="stripeWebsiteKey" ng-model="vm.websiteModel.stripeWebsiteKey" type="text" placeholder="Ex: pk_live_ONerdf23nWVZSOENc8TUmS25qopSD" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.stripeServerKey.$pristine }"><label class="col-sm-2 control-label">Stripe server key:<\/label><div class="col-sm-10"><input name="stripeServerKey" ng-model="vm.websiteModel.stripeServerKey" type="text" placeholder="Ex: sk_live_ikGsaRbvf8qQQxg78Xrm6W2r" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.paypalClientId.$pristine }"><label class="col-sm-2 control-label">PayPal Client ID:<\/label><div class="col-sm-10"><input name="paypalClientId" ng-model="vm.websiteModel.paypalClientId" type="text" placeholder="Ex: ASgVZGisLTTHG82smXIoBKUkHxEW8XQ5WQK2nmmmys_UTrmeb8BCegSTByu27EzXqQepj_ZlqoNuZI39" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.paypalClientSecret.$pristine }"><label class="col-sm-2 control-label">PayPal Client Secret:<\/label><div class="col-sm-10"><input name="paypalClientSecret" ng-model="vm.websiteModel.paypalClientSecret" type="text" placeholder="Ex: EEuhVzwMY2NsBhlriB8lAAShI6A6MeQXy-z5nD78jbBcJ7A8BuXUdntsr6tMsyVpdVo0FCJkLCD74iWR" class="form-control"><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Reset changes<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getWebsiteFilesSettings(f.websiteGuid).then(function(n){n.data.success&&f.initForm(n.data.result)})};f.initForm=function(n){f.websiteModel=n;f.websiteDetailsForm.$setPristine();f.websiteDetailsForm.$setUntouched()};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){r.updateWebsiteFilesSettings(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),u.scrollElement("body"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsiteFilesSettings",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<form name="vm.websiteDetailsForm" class="form-horizontal"><div class="row"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.adminLogo.$pristine }"><label class="col-sm-2 control-label">Admin Logo<\/label><div class="col-sm-10"><p>Will be shown on admin navigation panel. Should be larger than 300 x 160 px<\/p><upload-image class="upload-image" image="vm.websiteModel.adminLogo"><\/upload-image><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.mainLogo.$pristine }"><label class="col-sm-2 control-label">Login & Register Logo<\/label><div class="col-sm-10"><p>Will be shown on Login and Register pages. Should be larger than 300 x 160 px<\/p><upload-image class="upload-image" image="vm.websiteModel.mainLogo"><\/upload-image><\/div><\/div><hr><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.invoiceLogo.$pristine }"><label class="col-sm-2 control-label">Invoice Logo<\/label><div class="col-sm-10"><p>Will be shown on invoice pages. Should be larger then 300 x 160 px<\/p><upload-image class="upload-image" image="vm.websiteModel.invoiceLogo"><\/upload-image><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Reset changes<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getWebsiteIFrameSettings(f.websiteGuid).then(function(n){n.data.success&&f.initForm(n.data.result)})};f.initForm=function(t){f.websiteModel=t;f.websiteModel.pattern="/^[-+]?[0-9]{1,7}(.[0-9]+)?$/";f.websiteIframeForm.$setPristine();f.websiteIframeForm.$setUntouched();n(function(){hljs.configure({tabReplace:"  "});document.querySelectorAll("pre code").forEach(n=>{hljs.highlightBlock(n)})},1e3)};f.copyToClipboard=function(n){u.copyToClipboard(n).then(function(){u.showNotification("success","Copied to Clipboard")})};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){console.log(f.websiteModel);r.saveWebsiteIFrameSettings(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website IFrame settings saved"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsiteIframeSettings",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<h2>Take online bookings<\/h2><form name="vm.websiteIframeForm" class="form-horizontal"><div class="row m-b-md"><label class="col-sm-2 control-label">Direct booking<\/label><div class="col-sm-10"><div><a style="line-height: 33px; font-size: 17px;" target="_blank" ng-href="{{vm.websiteModel.directBookingUrl}}">{{vm.websiteModel.directBookingUrl}}<\/a> <button class="btn btn-xs btn-success" ng-click="vm.copyToClipboard(vm.websiteModel.directBookingUrl)"><i class="fa fa-copy"><\/i>Copy<\/button><\/div><\/div><\/div><div class="row m-b-xl"><label class="col-sm-2 control-label">IFrame Integration<\/label><div class="col-sm-10"><pre><code class="html">{{vm.websiteModel.embedScript}}<\/code><\/pre><\/div><\/div><div class="row"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteIframeForm.phone.$pristine }"><label class="col-sm-2 control-label">Phone<\/label><div class="col-sm-10"><input name="phone" ng-model="vm.websiteModel.phone" type="text" placeholder="+44 7400 419356" class="form-control"> <small>Phone number where clients can call if booking time is too close or pickup/dropoff areas are not covered.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteIframeForm.gpsCoordinates.$pristine }"><label class="col-sm-2 control-label">Initial GPS Coordinates<\/label><div class="col-sm-10"><input name="gpsCoordinates" ng-model="vm.websiteModel.gpsCoordinates" type="text" placeholder="Lat, Lng (ex: 33.749099, -84.390185)" class="form-control"> <small>New booking map initial GPS coordinates to display before FROM location is selected.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteIframeForm.termsAndCondHtml.$pristine }"><label class="col-sm-2 control-label">Terms & Cond<\/label><div class="col-sm-10"><summernote height="300" ng-model="vm.websiteModel.termsAndCondHtml"><\/summernote><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteIframeForm.customCss.$pristine }"><label class="col-sm-2 control-label">Custom CSS<\/label><div class="col-sm-10"><textarea name="customCss" rows="8" ng-model="vm.websiteModel.customCss" type="text" placeholder="Any custom css for better styling..." class="form-control">\r\n                <\/textarea><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.websiteIframeForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Reset changes<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.wasSaved=!1;f.$onInit=function(){r.getWebsiteInfo(f.guid).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result),f.dismissIfSaved(n.data.result),f.wasSaved=!1)})};f.dismissIfSaved=function(n){f.wasSaved&&f.saved&&(f.saved({item:n}),f.dismiss&&f.dismiss())};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.initForm=function(n){f.websiteModel=n;f.websiteDetailsForm.$setPristine();f.websiteDetailsForm.$setUntouched()};f.updateWebsite=function(){console.log(f.websiteModel);r.updateWebsiteInfo(f.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Website details saved"),u.scrollElement("body"),f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editWebsite",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<",dismiss:"&",saved:"&"},template:'<form name="vm.websiteDetailsForm" class="form-horizontal"><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Basic Detail<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.domain.$pristine }"><label class="col-sm-2 control-label">Domains<\/label><div class="col-sm-10"><input name="domain" ng-model="vm.websiteModel.allowedDomains" type="text" placeholder="https://executivechauffeur.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.name.$pristine }"><label class="col-sm-2 control-label">Name<\/label><div class="col-sm-10"><input name="name" ng-model="vm.websiteModel.name" type="text" placeholder="My Chauffeur Executive" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.description.$pristine }"><label class="col-sm-2 control-label">Description<\/label><div class="col-sm-10"><input name="description" ng-model="vm.websiteModel.description" type="text" placeholder="My Chauffeur Executive transfer services..." class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.currency.$pristine }"><label class="col-sm-2 control-label">Currency<\/label><div class="col-sm-10"><select name="currency" ng-model="vm.websiteModel.currency" class="form-control"><option>GBP<\/option><\/select><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Notifications<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content profile-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.newBookingEmail.$pristine }"><label class="col-sm-2 control-label">New Booking Email<\/label><div class="col-sm-10"><input name="newBookingEmail" ng-model="vm.websiteModel.newBookingEmail" type="text" placeholder="notification@chauffeurcompany.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.newBookingSmsNumber.$pristine }"><label class="col-sm-2 control-label">New Booking SMS No.<\/label><div class="col-sm-10"><input name="newBookingSmsNumber" ng-model="vm.websiteModel.newBookingSmsNumber" type="text" placeholder="+4474002352365" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerCommunicationEmail.$pristine }"><label class="col-sm-2 control-label">Customer Facing Email<\/label><div class="col-sm-10"><input name="customerCommunicationEmail" ng-model="vm.websiteModel.customerCommunicationEmail" type="text" placeholder="contact@chauffeurcompany.com" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerContactFormEmail.$pristine }"><label class="col-sm-2 control-label">Contact Form To<\/label><div class="col-sm-10"><input name="customerContactFormEmail" ng-model="vm.websiteModel.customerContactFormEmail" type="text" placeholder="contact@chauffeurcompany.com" class="form-control"><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="ibox float-e-margins"><div class="ibox-title"><h5>Logos<\/h5><\/div><div class="ibox-content no-padding border-left-right"><div class="ibox-content changePassword-content"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerCommunicationEmail.$pristine }"><label class="col-sm-2 control-label">Business Logo<\/label><div class="col-sm-10"><p>Will be shown on Login and Register pages. Should be larger than 300 x 160 px<\/p><upload-image class="upload-image" image="vm.websiteModel.mainLogo"><\/upload-image><\/div><\/div><hr><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.customerCommunicationEmail.$pristine }"><label class="col-sm-2 control-label">Invoice Logo<\/label><div class="col-sm-10"><p>Will be shown on invoice pages. Should be larger then 300 x 160 px<\/p><upload-image class="upload-image" image="vm.websiteModel.invoiceLogo"><\/upload-image><\/div><\/div><\/div><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-white m-l-sm" ng-click="vm.cancel()">Cancel<\/button><\/div><\/div><\/form><style>\r\n    .upload-image img {\r\n        max-width: 250px;\r\n        max-height: 250px;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.submitted=!1;e.$onInit=function(){console.log(e.documentModel)};e.uploadImage=function(n){n&&f.upload({url:"/Files/UploadFile/",file:n}).then(function(n){e.image||(e.image={});e.image.guid=n.data.result.guid;e.image.id=n.data.result.id;e.image.contentLength=n.data.result.contentLength;e.image.contentType=n.data.result.contentType;e.image.fileName=n.data.result.fileName;e.image.url=n.data.result.url;e.image.isTemporary=n.data.result.isTemporary},function(n){u.showNotification("error","Could not upload file. Please try again.");console.log("Error status: "+n.status)})}}var n=angular.module("bookingApp");n.component("uploadImage",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","Upload",t],controllerAs:"vm",bindings:{image:"<"},template:'<div class="row m-b-xl"><div class="col-sm-12"><div class="row"><div class="col-md-4"><button class="btn btn-success" ngf-select="vm.uploadImage($file)">Upload<\/button><\/div><\/div><div class="row"><div class="col-sm-12 m-t-xs" ng-show="vm.image.url != null"><div class="m-t-md" style="display: inline-block; position: relative;"><img class="img-responsive" ng-src="{{vm.image.url}}"> <button ng-click="vm.image = null" style="position: absolute; width: 25px; height: 25px; background-color: #f90808; opacity: 1; color: #fff; z-index: 999; right: -5px; top: -5px; border-radius: 50%; font-size: 20px; border: 2px solid #fff; line-height: 18px; -webkit-box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.35); box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.35);" type="button" class="close"><span aria-hidden="true">×<\/span><\/button><\/div><\/div><\/div><\/div><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){u.getWebsiteUsers(e.guid).then(function(n){n.data.success&&(console.log(n.data.result),e.websiteGuid=e.guid,e.websiteUsers=n.data.result)})};e.updateWebsite=function(){console.log(e.websiteModel);u.updateWebsiteInfo(e.websiteModel).then(function(n){n.data.success?(console.log(n.data.result),f.showNotification("success","Website details saved"),f.scrollElement("body"),e.$onInit()):f.showNotificationList("error",n.data.errors)})};e.editUser=function(n){i.open({template:"<modal-component dismiss='vm.dismiss()' title='User roles'><edit-website-user user-guid='vm.guid' website-guid='vm.parentVm.websiteGuid' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-website-user><\/modal-component>",resolve:{parentVm:function(){return e}},controller:["$uibModalInstance","parentVm",function(t,i){var r=this;r.parentVm=i;r.guid=n?n.guid:null;r.modalTitle=n?n.email+" roles":"Add new user";r.$uibModalInstance=t;r.dismiss=function(){r.$uibModalInstance.dismiss("cancel")};r.saved=function(n){var i=n.roles.some(function(n){return n.hasRole===!0}),t;i?(t=r.parentVm.websiteUsers.findIndex(function(t){return t.guid===n.guid}),t<0&&r.parentVm.$onInit()):r.parentVm.websiteUsers=r.parentVm.websiteUsers.filter(function(t){return t.guid!==n.guid})}}],size:"lg",appendTo:angular.element(document.body),backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})}}var n=angular.module("bookingApp");n.component("websiteUsers",{controller:["$timeout","$window","$uibModal","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{guid:"<"},template:'<div class="row"><div class="col-sm-5 m-b-xs"><div class="input-group"><input type="text" ng-model="vm.searchText" placeholder="Search" class="input-sm form-control"> <span class="input-group-btn"><button type="button" class="btn btn-sm btn-primary">Go!<\/button><\/span><\/div><\/div><div class="col-sm-4 m-b-xs"><\/div><div class="col-sm-3 text-right"><button class="btn btn-primary btn-sm" ng-click="vm.editUser(null)"><i class="fa fa-plus">Add<\/i><\/button><\/div><\/div><div class="row"><table class="table table-hover"><thead><tr><th>#<\/th><th>Email<\/th><th>Roles<\/th><th>Actions<\/th><\/tr><\/thead><tbody><tr ng-repeat="user in vm.websiteUsers | filter:vm.searchText"><td>{{user.id}}<\/td><td>{{user.email}}<\/td><td>{{user.roles}}<\/td><td><button class="btn btn-xs btn-primary" ng-click="vm.editUser(user)">Edit<\/button><\/td><\/tr><\/tbody><\/table><\/div>'})}(),function(){"use strict";function t(){var n=this;n.$onInit=function(){n.titleExpr&&(n.title=n.titleExpr)}}var n=angular.module("bookingApp");n.component("modalComponent",{transclude:!0,controller:["$timeout","$window","AppSettings","htmlPageService",t],controllerAs:"vm",bindings:{title:"@",titleExpr:"<",dismiss:"&"},template:'<div class="modal-header"><button type="button" ng-click="vm.dismiss()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title" ng-bind-html="vm.title"><\/h4><\/div><div class="modal-body"><ng-transclude><\/ng-transclude><\/div>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){f.userGuid?r.getWebsiteUserRoles(f.userGuid,f.websiteGuid).then(function(n){n.data.success&&(console.log(n.data.result),f.websiteUser=n.data.result)}):r.getUsers().then(function(n){n.data.success&&(f.users=n.data.users)})};f.userSelected=function(n,t){console.log(n,t);f.userGuid=n.guid;f.$onInit()};f.saveChanges=function(){r.updateUserRoles(f.websiteUser).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","User roles saved"),u.scrollElement("body"),f.saved&&f.saved({item:n.data.result}),f.dismiss?f.dismiss():f.$onInit()):n.data.errors?u.showNotificationList("error",n.data.errors):u.showNotification("error","Account roles could not be saved.")},function(){u.showNotification("error","Account roles could not be saved.")})}}var n=angular.module("bookingApp");n.component("editWebsiteUser",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{userGuid:"<",websiteGuid:"<",dismiss:"&",saved:"&"},template:'<form name="vm.editUserRolesForm" class="form-horizontal"><div class="row"><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.domain.$pristine }"><label class="col-sm-2 control-label">User<\/label><div class="col-sm-10"><ui-select ng-model="vm.selectedUser" on-select="vm.userSelected($item, $model)" theme="select2" style="min-width: 300px;" title="Select user" append-to-body="true"><ui-select-match placeholder="Select platform user">{{$select.selected.email}}<\/ui-select-match><ui-select-choices repeat="user in vm.users | filter: $select.search"><div ng-bind-html="user.email | highlight: $select.search"><\/div><small>name: <span ng-bind-html="\'\'+user.firstName + \' \' + user.lastName | highlight: $select.search"><\/span><\/small><\/ui-select-choices><\/ui-select><\/div><\/div><div class="form-group"><label class="col-sm-2 control-label">Email<\/label><div class="col-sm-10"><div style="padding-top: 7px;">{{vm.websiteUser.email}}<\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.websiteDetailsForm.currency.$pristine }"><label class="col-sm-2 control-label">Roles<\/label><div class="col-sm-10"><div style="display: inline-block;" ng-repeat="(key, value) in vm.websiteUser.roles"><div class="checkbox-inline i-checks m-r-lg"><label class="checkboxLabel weight-400"><input type="checkbox" icheck ng-model="value.hasRole"> <i><\/i> <span class="m-l-xs">{{value.name}}<\/span><\/label><\/div><\/div><\/div><\/div><\/div><div class="row text-center"><button class="btn btn-primary m-r-sm" ng-click="vm.saveChanges()">Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Dismiss<\/button><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getCompanies(e.websiteGuid).then(function(n){e.companies=n.data.result;console.log(e.companies)})};n.$on("add-new-company",function(){e.editCompany()});e.editCompany=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-company website-guid='vm.websiteGuid' company-guid='vm.companyGuid' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-company><\/modal-component>",resolve:{parentVm:function(){return e},websiteGuid:function(){return e.websiteGuid},companyGuid:function(){return!n||!n.guid?"new":n.guid},modalTitle:function(){return n?n.name+" - invoice details":"Add new company for invoicing"}},controller:["$uibModalInstance","parentVm","websiteGuid","companyGuid","modalTitle",function(n,t,i,r,u){var f=this;f.parentVm=t;f.websiteGuid=i;f.companyGuid=r;f.modalTitle=u;f.$uibModalInstance=n;f.dismiss=function(){f.$uibModalInstance.dismiss("cancel");t.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.editUsers=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><website-users guid='vm.guid' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/website-users><\/modal-component>",resolve:{parentVm:function(){return e},guid:function(){return n?n.guid:"new"},modalTitle:function(){return n.name+" users"}},controller:["$uibModalInstance","parentVm","guid","modalTitle",function(n,t,i,r){var u=this;u.parentVm=t;u.guid=i;u.modalTitle=r;u.$uibModalInstance=n;u.dismiss=function(){u.$uibModalInstance.dismiss("cancel")};u.saved=function(n){console.log(n);var i=t.companies.findIndex(function(t){return t.guid===n.guid});i>=0?t.companies[i]=n:t.companies.push(n)}}],size:"lg",appendTo:angular.element(document.body),backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removeWebsite=function(n){u.showConfirmation("Warning","Delete website "+n.name+"?").then(function(){console.log(n)})}}var n=angular.module("bookingApp");n.component("companiesList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<table class="table table-hover"><tbody><tr ng-repeat="company in vm.companies track by company.guid"><td>{{company.name}}<\/td><td class="text-right"><button class="btn btn-primary btn-sm m-r-xs" ng-click="vm.editCompany(company)"><i class="fa fa-edit" aria-hidden="true"><\/i> Edit<\/button> <button class="btn btn-danger btn-sm m-l-xs" ng-click="vm.removeCompany(company)"><i class="fa fa-remove" aria-hidden="true"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.$onInit=function(){r.getCompanyInfo(f.websiteGuid,f.companyGuid).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result))})};f.initForm=function(t){f.companyModel=t;n(function(){f.companyDetailsForm.$setPristine();f.companyDetailsForm.$setUntouched()})};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.updateWebsite=function(){console.log(f.companyModel);r.saveCompanyDetails(f.companyModel).then(function(n){n.data.success?(console.log(n.data.result),u.showNotification("success","Company details saved"),u.scrollElement("body"),f.companyGuid=n.data.result.guid,f.wasSaved=!0,f.$onInit()):u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editCompany",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",companyGuid:"<",dismiss:"&"},template:'<form name="vm.companyDetailsForm" class="form-horizontal" novalidate><div class="row"><h3>Company details:<\/h3><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.name.$pristine }"><label class="col-sm-2 control-label">Name<\/label><div class="col-sm-10"><input name="name" ng-model="vm.companyModel.name" type="text" placeholder="Ex: FRANK CAR HIRE LIMITED or Exec Chauffeur Ltd." class="form-control"> <small>This will be company name displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.streetAddress.$pristine }"><label class="col-sm-2 control-label">Street Address<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.companyModel.streetAddress" type="text" placeholder="Ex: 566 CHISWICK HIGH ROAD, CHISWICK PARK" class="form-control"> <small>This will be street address displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.additionalAddress.$pristine }"><label class="col-sm-2 control-label">Additional Address<\/label><div class="col-sm-10"><input name="additionalAddress" ng-model="vm.companyModel.additionalAddress" type="text" placeholder="Ex: OFFICE 129, BUILDING 3" class="form-control"> <small>This will be street address line 2 displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.city.$pristine }"><label class="col-sm-2 control-label">City<\/label><div class="col-sm-10"><input name="city" ng-model="vm.companyModel.city" type="text" placeholder="Ex: London" class="form-control"> <small>This will be city name displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.zipCode.$pristine }"><label class="col-sm-2 control-label">Zip Code<\/label><div class="col-sm-10"><input name="zipCode" ng-model="vm.companyModel.zipCode" type="text" placeholder="Ex: UB 100 DH" class="form-control"> <small>This will be zip code address part displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.country.$pristine }"><label class="col-sm-2 control-label">Country<\/label><div class="col-sm-10"><input name="country" ng-model="vm.companyModel.country" type="text" placeholder="Ex: OFFICE 129, BUILDING 3" class="form-control"> <small>This will be country name displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.phone.$pristine }"><label class="col-sm-2 control-label">Company phone<\/label><div class="col-sm-10"><input name="phone" ng-model="vm.companyModel.phone" type="text" placeholder="Ex: +44 (0) 189 585 0230" class="form-control"> <small>Company contact phone number displayed on invoice.<\/small><\/div><\/div><hr><h3>VAT details:<\/h3><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.vatNumber.$pristine }"><label class="col-sm-2 control-label">Vat number<\/label><div class="col-sm-10"><input name="vatNumber" ng-model="vm.companyModel.vatNumber" type="text" placeholder="Ex: GB 282547262" class="form-control"> <small>Your company vat number displayed on customer invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.vatPercentage.$pristine }"><label class="col-sm-2 control-label">VAT Percentage<\/label><div class="col-sm-10"><input name="vatPercentage" ng-model="vm.companyModel.vatPercentage" type="text" placeholder="Ex: 20 for GB" class="form-control"> <small>Vat percentage in your country used to compute invoice.<\/small><\/div><\/div><hr><h3>Bank payment details:<\/h3><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.accountName.$pristine }"><label class="col-sm-2 control-label">Bank Account Name<\/label><div class="col-sm-10"><input name="accountName" ng-model="vm.companyModel.accountName" type="text" placeholder="Ex: Exec Chauffeur Ltd." class="form-control"> <small>Company bank account name for allowing bank payments displayed on invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.bankName.$pristine }"><label class="col-sm-2 control-label">Bank Name<\/label><div class="col-sm-10"><input name="bankName" ng-model="vm.companyModel.bankName" type="text" placeholder="Ex: HSBC London" class="form-control"> <small>Company bank name for allowing bank payments displayed on invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.iban.$pristine }"><label class="col-sm-2 control-label">Account IBAN<\/label><div class="col-sm-10"><input name="iban" ng-model="vm.companyModel.iban" type="text" placeholder="Ex: GB92 NWBK 0000 0861 3640 90" class="form-control"> <small>Company account IBAN number for allowing bank payments displayed on invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.accountNo.$pristine }"><label class="col-sm-2 control-label">Account Number<\/label><div class="col-sm-10"><input name="accountNo" ng-model="vm.companyModel.accountNo" type="text" placeholder="Ex: 4130000 (for UK use only)" class="form-control"> <small>Company account number for allowing bank payments displayed on invoice.<\/small><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.companyDetailsForm.shortCode.$pristine }"><label class="col-sm-2 control-label">Account Short Code<\/label><div class="col-sm-10"><input name="shortCode" ng-model="vm.companyModel.shortCode" type="text" placeholder="Ex: 60-70-80 (for UK use only)" class="form-control"> <small>Company account short code for allowing bank payments displayed on invoice.<\/small><\/div><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.updateWebsite()">Save changes<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Close dialog<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.$onInit=function(){f.getSoftwareInvoices({showPaid:!0}).then(function(n){e.invoicesModel=n.data.result})};n.$on("add-new-invoice",function(){e.editInvoice()});e.editInvoice=function(n,t){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><edit-software-invoice website-guid='vm.websiteGuid' invoice-guid='vm.companyGuid' duplicate='vm.duplicate' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/edit-software-invoice><\/modal-component>",resolve:{parentVm:function(){return e},websiteGuid:function(){return e.websiteGuid},companyGuid:function(){return!n||!n.guid?"new":n.guid},modalTitle:function(){return n?n.name+" - invoice details":"Add new company for invoicing"}},controller:["$uibModalInstance","parentVm","websiteGuid","companyGuid","modalTitle",function(n,i,r,u,f){var e=this;e.parentVm=i;e.websiteGuid=r;e.companyGuid=u;e.modalTitle=f;e.duplicate=t;e.$uibModalInstance=n;e.dismiss=function(){e.$uibModalInstance.dismiss("cancel");i.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.payInvoice=function(n){r.open({template:"<modal-component dismiss='vm.dismiss()' title-expr='vm.modalTitle'><braintree-payment website-guid='vm.websiteGuid' invoices-guids='vm.invoicesGuids' dismiss='vm.dismiss()' saved='vm.saved(item)'><\/braintree-payment><\/modal-component>",resolve:{parentVm:function(){return e},websiteGuid:function(){return e.websiteGuid},invoiceGuid:function(){return n.guid},modalTitle:function(){return"Pay invoice "+n.invoiceNumber}},controller:["$uibModalInstance","parentVm","websiteGuid","invoiceGuid","modalTitle",function(n,t,i,r,u){var f=this;f.parentVm=t;f.websiteGuid=i;f.invoicesGuids=r;f.modalTitle=u;f.$uibModalInstance=n;f.dismiss=function(){f.$uibModalInstance.dismiss("cancel");t.$onInit()}}],size:"lg",backdrop:"static",keyboard:!1,controllerAs:"vm",windowClass:"animated fadeIn"})};e.removeInvoice=function(n){u.showConfirmation("Warning","Delete invoice "+n.invoiceNumber+"?").then(function(){f.removeSoftwareInvoice(n.guid).then(function(){e.$onInit()})})}}var n=angular.module("bookingApp");n.component("softwareInvoicesList",{controller:["$scope","$http","$window","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<"},template:'<table class="table table-hover"><thead><tr><th>Inv. Number<\/th><th>Website<\/th><th>Description<\/th><th>Inv. Date<\/th><th>Amount<\/th><th>Due Date<\/th><th class="text-center">Paid<\/th><th class="text-center">Actions<\/th><\/tr><\/thead><tbody><tr ng-repeat="invoice in vm.invoicesModel.invoices track by invoice.guid"><td>{{invoice.invoiceNumber}}<\/td><td>{{invoice.websiteName}}<\/td><td>{{invoice.description}}<\/td><td>{{invoice.issueDateString}}<\/td><td>{{invoice.total | number : 2 }} {{invoice.currencyCode}}<\/td><td>{{invoice.dueDateString}}<\/td><td class="text-center"><a href="#" ng-show="invoice.isPaid"><i class="fa fa-check text-navy"><\/i><\/a><\/td><td class="text-right"><button class="btn btn-sm btn-success m-r-md ng-hide" ng-show="invoice.canEdit"><i class="fa fa-external-link"><\/i> View<\/button> <a ng-href="/invoice/downloadsoftwareinvoicepdf/{{invoice.guid}}" class="btn btn-sm btn-success m-r-md"><i class="fa fa-print"><\/i>Print<\/a> <button class="btn btn-sm btn-success m-r-md" ng-show="!invoice.isPaid" ng-click="vm.payInvoice(invoice)"><i class="fa fa-credit-card"><\/i> Pay<\/button><div class="btn-group m-r-md" ng-show="invoice.canEdit"><button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Action <span class="caret"><\/span><\/button><ul class="dropdown-menu"><li><a ng-show="invoice.canEdit" ng-click="vm.editInvoice(invoice, false)"><i class="fa fa-edit"><\/i> Edit<\/a><\/li><li><a ng-show="invoice.canEdit" ng-click="vm.editInvoice(invoice, true)"><i class="fa fa-copy"><\/i> Duplicate<\/a><\/li><li><a ng-show="invoice.canEdit" ng-click="vm.removeInvoice(invoice)"><i class="fa fa-trash"><\/i> Delete<\/a><\/li><\/ul><\/div><\/td><\/tr><\/tbody><\/table>'})}(),function(){"use strict";function t(n,t,i,r,u){var f=this;f.invoiceModel={vatPercentage:0,items:[]};f.$onInit=function(){var n="new";f.invoiceGuid&&(n=f.invoiceGuid);r.getSoftwareInvoice(n,f.duplicate).then(function(n){n.data.success&&(console.log(n.data.result),f.initForm(n.data.result))})};f.dateChangedHandler=function(){if(f.invoiceModel.issueDateString=f.dateText,f.dateText){var n=moment(f.dateText);f.invoiceModel.issueDateString=n.format(i.Settings.ServerDateFormat)}};f.dueDateChangedHandler=function(){if(f.invoiceModel.dueDateString=f.dueDateText,f.dueDateText){var n=moment(f.dueDateText);f.invoiceModel.dueDateString=n.format(i.Settings.ServerDateFormat)}};f.paymentDateChangedHandler=function(){if(f.invoiceModel.paymentDateString=f.paymentDateText,f.paymentDateText){var n=moment(f.paymentDateText);f.invoiceModel.paymentDateString=n.format(i.Settings.ServerDateFormat)}};f.initForm=function(t){f.invoiceModel=t;f.invoiceModel.paymentStatus=f.invoiceModel.paymentStatus.toString();t.issueDateString&&(f.dateText=moment(t.issueDateString,i.Settings.ServerDateFormat));t.dueDateString&&(f.dueDateText=moment(t.dueDateString,i.Settings.ServerDateFormat));t.paymentDateString&&(f.paymentDateText=moment(t.paymentDateString,i.Settings.ServerDateFormat));n(function(){f.invoiceDetailsForm.$setPristine();f.invoiceDetailsForm.$setUntouched()})};f.cancel=function(){f.dismiss?f.dismiss():f.$onInit()};f.addNewItem=function(){f.invoiceModel.items.push({guid:f.guid(),description:"",value:""})};f.removeInvoiceItem=function(n){f.invoiceModel.items.splice(n,1)};f.guid=function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()};f.saveInvoice=function(){console.log(f.companyModel);r.saveSoftwareInvoice(f.invoiceModel).then(function(n){if(n.data.success){if(console.log(n.data.result),u.showNotification("success","Invoice saved"),u.scrollElement("body"),f.companyGuid=n.data.result.guid,f.wasSaved=!0,f.dismiss){f.dismiss();return}f.$onInit()}else u.showNotificationList("error",n.data.errors)})}}var n=angular.module("bookingApp");n.component("editSoftwareInvoice",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{websiteGuid:"<",invoiceGuid:"<",duplicate:"<",dismiss:"&",saved:"&"},template:'<form name="vm.invoiceDetailsForm" class="form-horizontal" novalidate><div class="row"><div class="col-sm-6"><h3>Supplier details:<\/h3><div class="col-sm-12 m-b-sm"><div class="col-sm-6"><label class="col-sm-3 control-label">Prefix<\/label><div class="col-sm-9"><input name="customerPrefix" ng-model="vm.invoiceModel.customerPrefix" type="text" placeholder="Ex: ARO" class="form-control"><\/div><\/div><div class="col-sm-6"><label class="col-sm-3 control-label">No.<\/label><div class="col-sm-9"><input name="number" ng-model="vm.invoiceModel.number" type="text" placeholder="Ex: 123" class="form-control"><\/div><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierName.$pristine }"><label class="col-sm-2 control-label">Name<\/label><div class="col-sm-10"><input name="supplierName" ng-model="vm.invoiceModel.supplierName" type="text" placeholder="Ex: FRANK CAR HIRE LIMITED or Exec Chauffeur Ltd." class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierCompanyNumber.$pristine }"><label class="col-sm-2 control-label">Number<\/label><div class="col-sm-10"><input name="supplierCompanyNumber" ng-model="vm.invoiceModel.supplierCompanyNumber" type="text" placeholder="EX: RO 31242343" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierVatNumber.$pristine }"><label class="col-sm-2 control-label">VAT No.<\/label><div class="col-sm-10"><input name="supplierVatNumber" ng-model="vm.invoiceModel.supplierVatNumber" type="text" placeholder="EX: RO 31242343" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierAddress1.$pristine }"><label class="col-sm-2 control-label">Addr. 1<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.invoiceModel.supplierAddress1" type="text" placeholder="Ex: 566 CHISWICK HIGH ROAD, CHISWICK PARK" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierAddress2.$pristine }"><label class="col-sm-2 control-label">Addr. 2<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.invoiceModel.supplierAddress2" type="text" placeholder="Ex: OFFICE 129, BUILDING 3" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierCountry.$pristine }"><label class="col-sm-2 control-label">Country<\/label><div class="col-sm-10"><input name="supplierCountry" ng-model="vm.invoiceModel.supplierCountry" type="text" placeholder="Ex: United Kingdom" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierEmail.$pristine }"><label class="col-sm-2 control-label">Email<\/label><div class="col-sm-10"><input name="supplierEmail" ng-model="vm.invoiceModel.supplierEmail" type="text" placeholder="Ex: United Kingdom" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.supplierPhone.$pristine }"><label class="col-sm-2 control-label">Phone<\/label><div class="col-sm-10"><input name="supplierCountry" ng-model="vm.invoiceModel.supplierPhone" type="text" placeholder="Ex: United Kingdom" class="form-control"><\/div><\/div><\/div><div class="col-sm-6"><h3>Client details:<\/h3><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.websiteGuid.$pristine }"><label class="col-sm-2 control-label">Website<\/label><div class="col-sm-10"><select name="websiteGuid" class="form-control" ng-options="item.value as item.text for item in vm.invoiceModel.websites" ng-model="vm.invoiceModel.websiteGuid"><\/select><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.customerName.$pristine }"><label class="col-sm-2 control-label">Name<\/label><div class="col-sm-10"><input name="customerName" ng-model="vm.invoiceModel.customerName" type="text" placeholder="Ex: FRANK CAR HIRE LIMITED or Exec Chauffeur Ltd." class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.customerVatNumber.$pristine }"><label class="col-sm-2 control-label">VAT No.<\/label><div class="col-sm-10"><input name="customerVatNumber" ng-model="vm.invoiceModel.customerVatNumber" type="text" placeholder="EX: RO 31242343" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.customerAddress1.$pristine }"><label class="col-sm-2 control-label">Addr. 1<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.invoiceModel.customerAddress1" type="text" placeholder="Ex: 566 CHISWICK HIGH ROAD, CHISWICK PARK" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.customerAddress2.$pristine }"><label class="col-sm-2 control-label">Addr. 2<\/label><div class="col-sm-10"><input name="streetAddress" ng-model="vm.invoiceModel.customerAddress2" type="text" placeholder="Ex: OFFICE 129, BUILDING 3" class="form-control"><\/div><\/div><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.customerCountry.$pristine }"><label class="col-sm-2 control-label">Country<\/label><div class="col-sm-10"><input name="customerCountry" ng-model="vm.invoiceModel.customerCountry" type="text" placeholder="Ex: United Kingdom" class="form-control"><\/div><\/div><div class="row"><div class="col-sm-12"><div class="col-sm-4"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.currencyCode.$pristine }"><label class="col-sm-3 control-label">Cur.<\/label><div class="col-sm-9"><select name="currencyCode" ng-model="vm.invoiceModel.currencyCode" class="form-control"><option value="EUR">EUR - &euro;<\/option><option value="USD">USD - &dollar;<\/option><option value="GBP">GBP - &pound;<\/option><option value="RON">RON<\/option><\/select><\/div><\/div><\/div><div class="col-sm-4"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.vatPercentage.$pristine }"><label class="col-sm-4 control-label">VAT %<\/label><div class="col-sm-8"><input name="vatPercentage" ng-model="vm.invoiceModel.vatPercentage" type="text" class="form-control"><\/div><\/div><\/div><div class="col-sm-4"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.ronValue.$pristine }"><label class="col-sm-4 control-label">RON<\/label><div class="col-sm-8"><input name="ronValue" ng-model="vm.invoiceModel.ronValue" type="text" class="form-control"><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="col-sm-12"><div class="col-sm-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.invoiceDate.$pristine }"><label class="col-sm-4 control-label">Date<\/label><div class="col-sm-8"><input type="text" class="form-control original-style" name="invoiceDate" placeholder="Invoice date" autocomplete="off" pick-a-date="vm.dateText" ng-model="vm.invoiceModel.dateText" update-model="vm.dateChangedHandler()" ng-required="true"><\/div><\/div><\/div><div class="col-sm-6"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.invoiceDueDate.$pristine }"><label class="col-sm-4 control-label">Due Date<\/label><div class="col-sm-8"><input type="text" class="form-control original-style" name="invoiceDueDate" placeholder="Due date" autocomplete="off" pick-a-date="vm.dueDateText" ng-model="vm.invoiceModel.dueDateText" update-model="vm.dueDateChangedHandler()" ng-required="true"><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="col-sm-3"><select name="paymentStatus" ng-model="vm.invoiceModel.paymentStatus" class="form-control"><option value="0">NotSet<\/option><option value="1">Pending<\/option><option value="3">Complete<\/option><\/select><\/div><div class="col-sm-3"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.invoicePaymentDate.$pristine }"><input type="text" class="form-control original-style" name="invoicePaymentDate" placeholder="Payment date" autocomplete="off" pick-a-date="vm.paymentDateText" ng-model="vm.invoiceModel.paymentDateText" update-model="vm.paymentDateChangedHandler()" ng-required="true"><\/div><\/div><div class="col-sm-3"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.provider.$pristine }"><div class="col-sm-12"><input name="provider" ng-model="vm.invoiceModel.provider" type="text" placeholder="Bank Transfer" class="form-control"><\/div><\/div><\/div><div class="col-sm-3"><div class="form-group" ng-class="{\'field-changed\' : !vm.invoiceDetailsForm.transactionId.$pristine }"><div class="col-sm-12"><input name="transactionId" ng-model="vm.invoiceModel.transactionId" type="text" placeholder="Transaction id" class="form-control"><\/div><\/div><\/div><\/div><\/div><\/div><div class="row"><div class="col-sm-12 table-responsive"><table class="table"><thead><tr><th>Item Description<\/th><th style="width: 90px; text-align: center;">Value<\/th><th style="width: 90px;">VAT<\/th><th style="width: 90px;">Total<\/th><th style="width: 90px;"><button class="btn btn-xs btn-primary pull-right m-r-sm" ng-click="vm.addNewItem()"><i class="fa fa-plus"><\/i> Add Item<\/button><\/th><\/tr><\/thead><tbody><tr ng-repeat="extra in vm.invoiceModel.items"><td style="border-top: none;"><div><input type="text" class="form-control" ng-model="extra.description"><\/div><\/td><td style="border-top: none;"><input type="text" class="form-control text-right" ng-change="vm.extrasChanged()" ng-model-options="{ debounce: 500 }" ng-model="extra.value"><\/td><td style="border-top: none;"><div class="form-control text-right" readonly>{{extra.value * vm.invoiceModel.vatPercentage / 100 | number : 2}}<\/div><\/td><td style="border-top: none;"><div class="form-control text-right" readonly>{{extra.value * (1 + vm.invoiceModel.vatPercentage / 100) | number : 2}}<\/div><\/td><td style="border-top: none; padding-top: 10px;"><button class="btn btn-sm btn-danger pull-right m-r-sm" ng-click="vm.removeInvoiceItem($index)"><i class="fa fa-remove"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table><\/div><\/div><div class="row text-center ng-hide" ng-hide="vm.userDetailsForm.$pristine"><div class="col-sm-12"><button class="btn btn-primary m-r-sm" ng-click="vm.saveInvoice()">Save<\/button> <button class="btn btn-danger m-l-sm" ng-click="vm.dismiss()">Close dialog<\/button><\/div><\/div><\/form>'})}(),function(){"use strict";function t(n,t,i,r,u,f,e){var o=this;o.braintreeInstance=null;o.showLoading=!0;o.errors=[];o.$onInit=function(){e.getBraintreeClientToken(o.websiteGuid,o.invoicesGuids).then(function(n){o.paymentModel=n.data.result;o.initVueScripts()})};o.initVueScripts=function(){var n=Date.now();f.loadStyle("/Scripts/vuejs/css/chunk-common.css?et="+n).then(function(){f.loadScript("/Scripts/vuejs/js/chunk-vendors.js?et="+n).then(function(){f.loadScript("/Scripts/vuejs/js/chunk-common.js?et="+n).then(function(){f.loadScript("/Scripts/vuejs/stripePaymentForm.js?et="+n).then(function(){r(function(){o.showLoading=!1})})})})})};o.setupBraintreeDropin=function(n){o.showLoading=!1;braintree.dropin.create({authorization:n,container:"#dropin-container",threeDSecure:!0,card:{cardholderName:!0}},o.braintreeInstanceCreated)};o.braintreeInstanceCreated=function(n,t){n==null&&(o.braintreeInstance=t)};o.makePayment=function(){console.log("make payment",o);o.errors=[];var n={amount:o.paymentModel.amount.toString(),email:o.paymentModel.email};o.braintreeInstance.requestPaymentMethod({threeDSecure:n},function(n,t){n?(console.log("Error",n),r(function(){o.errors.push(n.message)})):(o.paymentModel.paymentNonce=t.nonce,r(function(){o.paymentInProgress=!0}),e.completeBraintreePayment(o.paymentModel).then(function(n){n.data.success&&o.dismiss&&o.dismiss();r(function(){o.paymentInProgress=!1})}))})}}var n=angular.module("bookingApp");n.component("braintreePayment",{controller:["$scope","$http","$window","$timeout","$uibModal","htmlPageService","bookingApi",t],controllerAs:"vm",bindings:{websiteGuid:"<",invoicesGuids:"<",dismiss:"&"},template:'<div class="row m-t-xl m-b-xl" ng-show="vm.showLoading"><div class="col-sm-12 text-center"><i class="fa fa-2x fa-spinner fa-spin"><\/i><h3>Loading<\/h3><\/div><\/div><form name="vm.invoiceDetailsForm" class="form-horizontal ng-hide" ng-show="!vm.showLoading" novalidate><div id="stripePaymentFormApp" stripe-id="{{vm.paymentModel.stripeId}}" website-guid="{{vm.paymentModel.websiteGuid}}" invoice-guid="{{vm.paymentModel.invoicesGuids}}" description="{{vm.paymentModel.description}}" company-name="ChauffeurBookingSoftware.com" source="detailsPage" amount="{{vm.paymentModel.amount}}" currency="{{vm.paymentModel.currencyCode}}"><\/div><div class="row text-center errorListRow" ng-show="vm.errors.length > 0"><div class="col-sm-12"><ul class="list-unstyled mb-10 text-danger"><li ng-repeat="error in vm.errors">{{error}}<\/li><\/ul><\/div><\/div><\/form><style>\r\n    .braintree-form__field-group label {\r\n        width: 100%;\r\n    }\r\n\r\n    #braintree__card-view-input__cardholder-name {\r\n        font-weight: 400;\r\n    }\r\n<\/style>'})}(),function(){"use strict";function t(n,t,i,r,u,f){var e=this;e.submitted=!1;e.$onInit=function(){};e.$onChanges=function(n){n.documentModel.currentValue&&(n.documentModel.currentValue.validate||(e.documentModel.hasError=function(){var n=e.submitted&&!e.documentModel.expirationDateText&&e.documentModel.image&&e.documentModel.image.guid;return e.submitted&&e.documentIsMandatory&&(n=n&&!e.documentModel.expirationDateText),n},e.documentModel.isValid=function(){return!e.documentModel.hasError()},e.documentModel.validate=function(){return e.submitted=!0,e.documentModel.isValid()}),n.documentModel.currentValue.expirationDateText&&(e.documentModel.expirationDate=moment(n.documentModel.currentValue.expirationDateText,i.Settings.ServerDateTimeFormat),e.documentModel.expirationDateText=n.documentModel.currentValue.expirationDate.format(i.Settings.ServerDateTimeFormat),e.documentModel.expirationDateDisplay=n.documentModel.currentValue.expirationDate.format("dddd, DD MMM YYYY")))};e.documentExpirationDateChangedHandler=function(){if(e.documentModel.expirationDate){var n=moment(e.documentModel.expirationDate);e.documentModel.expirationDateText=n.format(i.Settings.ServerDateTimeFormat);e.documentModel.expirationDateDisplay=n.format("dddd, DD MMM YYYY")}else e.documentModel.expirationDateText=null,e.documentModel.expirationDateDisplay=null};e.uploadImage=function(n){n&&f.upload({url:"/Files/UploadFile/",file:n}).then(function(n){e.documentModel||(e.documentModel={});e.documentModel.image=n.data.result},function(n){u.showNotification("error","Could not upload file. Please try again.");console.log("Error status: "+n.status)})}}var n=angular.module("bookingApp");n.component("editDriverDocument",{controller:["$timeout","$window","AppSettings","bookingApi","htmlPageService","Upload",t],controllerAs:"vm",bindings:{documentModel:"<",documentName:"<",documentIsMandatory:"<"},template:'<div class="row m-b-xl"><div class="col-sm-12"><div class="row"><div class="col-md-12"><h3>{{vm.documentName}}:<\/h3><\/div><\/div><div class="row"><div class="col-sm-12 m-t-xs" ng-show="vm.documentModel.image != null"><div class="m-t-md" style="display: inline-block; position: relative;"><img style="max-height: 200px;" class="img-responsive" ng-src="{{vm.documentModel.image.url}}"> <button type="button" ng-click="vm.documentModel.image = null" style="position: absolute; width: 25px; height: 25px; background-color: #f90808; opacity: 1; color: #fff; z-index: 999; right: -5px; top: -5px; border-radius: 50%; font-size: 21px; border: 2px solid #fff; line-height: 18px; -webkit-box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.35); box-shadow: 0 0 1px 1px rgba(0, 0, 0, 0.35);" class="close"><span aria-hidden="true">×<\/span><\/button><\/div><\/div><\/div><div class="row"><div class="col-md-5"><div class="form-group" ng-class="{ \'has-error\': vm.documentModel.hasError()}"><input type="text" class="form-control original-style" name="documentDate" placeholder="Expiration date" autocomplete="off" pick-a-date="vm.documentModel.expirationDate" ng-model="vm.documentModel.expirationDateDisplay" update-model="vm.documentExpirationDateChangedHandler()"><div class="help-block ng-hide" ng-show="vm.submitted && !vm.documentModel.expirationDateText && vm.documentModel.image.guid">Please select expiration date.<\/div><div class="has-error" ng-show="vm.submitted && vm.documentIsMandatory && !vm.documentModel.image.guid"><div class="help-block">This document is required.<\/div><\/div><\/div><\/div><div class="col-md-5"><input type="text" class="form-control" name="documentNumber" placeholder="Document number" autocomplete="off" ng-model="vm.documentModel.documentNumber"><\/div><div class="col-md-2"><button type="button" class="btn btn-success" tabindex="-1" ngf-select="vm.uploadImage($file)">Upload<\/button><\/div><\/div><\/div><\/div>'})}(),function(){"use strict";function t(){var n=this;n.$onInit=function(){n.bookingInfo.extras||(n.bookingInfo.extras=[])};n.addNewExtra=function(){var r=n.bookingInfo.extras.findIndex(function(n){return n.description===""}),t,i;r>=0||(t={guid:n.guid(),description:"",numberOfItems:1,companyAmount:null,driverAmount:null,hasVat:n.bookingInfo.hasVat},i=n.bookingInfo.extras.findIndex(function(n){return n.isTaxItem}),i<0?n.bookingInfo.extras.push(t):n.bookingInfo.extras.splice(i,0,t))};n.addMeetAndGreet=function(){var r="Meet & Greet",u=n.bookingInfo.extras.findIndex(function(n){return n.description===r}),t,i;u>=0||(t={guid:n.guid(),description:r,numberOfItems:1,companyAmount:null,driverAmount:null,hasVat:n.bookingInfo.hasVat},i=n.bookingInfo.extras.findIndex(function(n){return n.isTaxItem}),i<0?n.bookingInfo.extras.push(t):n.bookingInfo.extras.splice(i,0,t))};n.deleteExtra=function(t){var i=n.bookingInfo.extras.findIndex(function(n){return n.guid===t});i>=0&&n.bookingInfo.extras.splice(i,1)};n.extrasChanged=function(){n.bookingExtrasChanged&&n.bookingExtrasChanged()};n.$onChanges=function(t){t.bookingInfo.currentValue&&(n.bookingInfo=t.bookingInfo.currentValue,n.bookingInfo.extras||(n.bookingInfo.extras=[]))};n.raiseEvent=function(){var t=n.bookingInfo;t.isValid=n.isValid();n.bookingInfo.isValid=t.isValid;n.bookingInfoChanged({bookingInfo:t})};n.guid=function(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}}var n=angular.module("bookingApp");n.component("bookingExtraServices",{controller:["$rootScope","$timeout","$scope","AppSettings","bookingApi","htmlPageService",t],controllerAs:"vm",bindings:{bookingInfo:"<",bookingExtrasChanged:"&"},template:'<div class="booking-extras"><div class="row"><div class="col-md-6"><h3>Extra services<\/h3><\/div><div class="col-md-6"><button class="btn btn-xs btn-primary pull-right m-r-sm" ng-click="vm.addNewExtra()"><i class="fa fa-plus"><\/i> Add Item<\/button> <button class="btn btn-xs btn-success pull-right m-r-sm" ng-click="vm.addMeetAndGreet()"><i class="fa fa-plus"><\/i> Add Meet & Greet<\/button><\/div><\/div><div class="row"><div class="col-sm-12 table-responsive"><table class="table"><thead><tr><th>Item Description<\/th><th style="width: 90px; text-align: center;">No. Items<\/th><th style="width: 90px; text-align: center;">Item. Price<\/th><th style="width: 90px;">Company<\/th><th style="width: 90px;">Driver<\/th><th style="width: 90px;">Action<\/th><\/tr><\/thead><tbody><tr ng-repeat="extra in vm.bookingInfo.extras"><td style="border-top: none;"><div><input type="text" class="form-control" ng-model="extra.description"><\/div><\/td><td style="border-top: none;"><input type="text" class="form-control" ng-show="!extra.isTaxItem" ng-change="vm.extrasChanged()" ng-model="extra.numberOfItems" ng-model-options="{ debounce: 500 }"><\/td><td style="border-top: none;"><input type="text" class="form-control" ng-show="!extra.isTaxItem" ng-change="vm.extrasChanged()" ng-model="extra.companyAmount" ng-model-options="{ debounce: 500 }"><\/td><td style="border-top: none;"><div class="form-control text-right" readonly ng-hide="vm.bookingInfo.hasVat">{{extra.companyTotal | number : 2}}<\/div><input type="text" class="form-control text-right" readonly ng-change="vm.extrasChanged()" ng-model-options="{ debounce: 500 }" ng-show="vm.bookingInfo.hasVat" ng-model="extra.companyTotal"><\/td><td style="border-top: none;"><input type="text" class="form-control" style="max-width: 70px;" ng-model="extra.driverAmount" ng-model-options="{ debounce: 500 }"><\/td><td style="border-top: none; padding-top: 10px;"><button class="btn btn-sm btn-danger pull-right m-r-sm" ng-click="vm.deleteExtra(extra.guid)"><i class="fa fa-remove"><\/i> Delete<\/button><\/td><\/tr><\/tbody><\/table><\/div><\/div><\/div>'})}(),function(){"use strict";var n=angular.module("bookingApp");n.controller("nextBookingsController",["$rootScope","$uibModal","htmlPageService","bookingApi",function(n,t,i,r){var u=this;u.showDeleteBookingModal=function(n){t.open({template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Cancel booking - {{vm.booking.customerId}} ?<\/h4><\/div><div class="modal-body"><div><b>Pickup Date:<\/b> {{vm.booking.pickupDateTime}}<\/div><br><div><b>From:<\/b> {{vm.booking.from.addressName}}<\/div><br><div ng-hide="!vm.booking.to"><b>To:<\/b> {{vm.booking.to.addressName}}<\/div><br ng-hide="!vm.booking.to"><hr><br><div class="text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.cancel()" data-dismiss="modal">Close<\/button> <button type="submit" class="btn btn-danger m-l-sm" ng-click="vm.cancelBooking()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Cancel booking<\/button><\/div><\/div>',resolve:{bookingId:function(){return n}},controller:["$uibModalInstance",function(t){var u=this;u.bookingId=n;u.$uibModalInstance=t;u.cancel=function(){u.$uibModalInstance.dismiss("cancel")};u.cancelBooking=function(){r.deleteBooking(u.bookingId).then(function(n){if(n.data.success){i.showNotification("success","Booking was canceled.");var t=document.getElementById(u.bookingId);$(t).fadeOut(600,function(){$(this).remove()});u.cancel()}else i.showNotificationList("error",n.data.errors)},function(){i.showNotification("error","Error when canceling booking.")})};u.$onInit=function(){r.getBookingBasicDetails(u.bookingId).then(function(n){u.booking=n.data},function(){i.showNotification("error","Error when reading booking details.")})}}],controllerAs:"vm",windowClass:"animated fadeIn"})};u.showAssignDriverModel=function(n){t.open({template:"<assign-driver booking-id='vm.bookingId' modal-instance='vm.$uibModalInstance'><\/assign-driver>",resolve:{bookingId:function(){return n}},controller:["$uibModalInstance",function(t){var i=this;i.bookingId=n;i.$uibModalInstance=t}],controllerAs:"vm",windowClass:"animated fadeIn"})};u.showQuoteBookingModal=function(n){t.open({template:"<booking-quick-quote booking-id='vm.bookingId' modal-instance='vm.$uibModalInstance'><\/booking-quick-quote>",resolve:{bookingId:function(){return n}},controller:["$uibModalInstance",function(t){var i=this;i.bookingId=n;i.$uibModalInstance=t}],controllerAs:"vm",windowClass:"animated fadeIn"})}}])}(),function(){"use strict";var n=angular.module("bookingApp");n.controller("invoicesController",["$rootScope","$uibModal","htmlPageService","bookingApi","AppSettings",function(n,t,i,r,u){var f=this;f.showEditInvoiceDialog=function(n){t.open({template:'<div class="modal-header"><button type="button" ng-click="vm.cancel()" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;<\/span><\/button><h4 class="modal-title">Invoice - {{vm.invoice.number}}<\/h4><\/div><div class="modal-body"><div><b>Client:<\/b> {{vm.invoice.customerName}}<\/div><div><b>Date:<\/b> {{vm.invoice.issueDate}}<\/div><br><form novalidate><div class="form-group"><label for="selectedPaymentStatus">Payment status:<\/label><select class="form-control" ng-options="i for i in vm.invoice.paymentStatuses" id="selectedPaymentStatus" name="selectedPaymentStatus" required ng-model="vm.invoice.selectedPaymentStatus"><\/select><\/div><div class="form-group"><label for="selectedPaymentStatus">Payed at:<\/label> <input id="paymentDate" name="paymentDate" type="text" class="form-control original-style" placeholder="Payment date" autocomplete="off" pick-a-date="vm.paymentDate" ng-model="vm.paymentDateText" update-model="vm.paymentDateChangedHandler()" ng-required="true"><\/div><div class="form-group"><label for="notes">Notes:<\/label> <textarea id="notes" name="notes" rows="4" class="form-control original-style" ng-model="vm.invoice.notes"><\/textarea><\/div><\/form><div class="text-center"><button type="button" class="btn btn-primary m-r-sm" ng-click="vm.save()"><i class="fa fa-spinner fa-pulse fa-fw" ng-show="vm.sending"><\/i> Save<\/button> <button type="submit" class="btn btn-danger m-l-sm" ng-click="vm.cancel()">Cancel<\/button><\/div><\/div>',resolve:{invoiceId:function(){return n}},controllerAs:"vm",windowClass:"animated fadeIn",controller:["$uibModalInstance",function(t){var f=this;f.invoiceId=n;f.$uibModalInstance=t;f.cancel=function(){f.$uibModalInstance.dismiss("cancel")};f.paymentDateChangedHandler=function(){var n=moment(f.paymentDate);f.invoice.paymentDate=n.format(u.Settings.ServerDateTimeFormat);f.paymentDateText=n.format("dddd, DD MMM YYYY");console.log(f.invoice.paymentDate)};f.save=function(){f.sending||(f.sending=!0,r.updateInvoicePaymentStatus(f.invoice).then(function(){i.showNotification("success","Invoice was updated.");f.cancel();f.sending=!1},function(){i.showNotification("error","Error when updating invoice details.");f.sending=!1}))};f.$onInit=function(){r.getInvoiceDetails(f.invoiceId).then(function(n){f.invoice=n.data;var t=moment(f.invoice.paymentDate,u.Settings.ServerDateTimeFormat);f.paymentDate=t.toDate();f.paymentDateText=t.format("dddd, DD MMM YYYY")},function(){i.showNotification("error","Error when reading booking details.")})}}]}).result.then(function(){},function(){})}}])}()